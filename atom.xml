<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LuckyBoyğŸ¥</title>
  
  
  <link href="https://wuwawawa.github.io/atom.xml" rel="self"/>
  
  <link href="https://wuwawawa.github.io/"/>
  <updated>2023-05-24T04:06:35.709Z</updated>
  <id>https://wuwawawa.github.io/</id>
  
  <author>
    <name>LuckyBoyğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mybatis</title>
    <link href="https://wuwawawa.github.io/posts/da3e1361.html"/>
    <id>https://wuwawawa.github.io/posts/da3e1361.html</id>
    <published>2023-05-24T04:02:50.000Z</published>
    <updated>2023-05-24T04:06:35.709Z</updated>
    
    
    
    
    <category term="ä¸­é—´ä»¶" scheme="https://wuwawawa.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
    <category term="ä¸­é—´ä»¶" scheme="https://wuwawawa.github.io/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>HashMapå’ŒTreeMap</title>
    <link href="https://wuwawawa.github.io/posts/9a196584.html"/>
    <id>https://wuwawawa.github.io/posts/9a196584.html</id>
    <published>2023-05-22T09:47:10.000Z</published>
    <updated>2023-05-22T14:49:55.102Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HashMapç»§æ‰¿ä½“ç³»">HashMapç»§æ‰¿ä½“ç³»</h2><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522184524368.png" alt="image-20230522184524368"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap</span>&lt;K,V&gt; <span class="keyword">extends</span> <span class="title class_">AbstractMap</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K,V&gt;, Cloneable, Serializable</span><br></pre></td></tr></table></figure><p>HashMapæ˜¯Mapé‡Œé¢çš„ä¸€ä¸ªå®ç°ç±»ã€‚</p><p>æ²¡æœ‰é¢å¤–éœ€è¦å­¦ä¹ çš„ç‰¹æœ‰æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨Mapé‡Œé¢çš„æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p><p>ç‰¹ç‚¹éƒ½æ˜¯ç”±é”®å†³å®šçš„ï¼šæ— åºã€ä¸é‡å¤ã€æ— ç´¢å¼•</p><p>HashMapè·ŸHashSetåº•å±‚åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å“ˆå¸Œè¡¨ç»“æ„</p><h2 id="HashMapåº•å±‚åŸç†">HashMapåº•å±‚åŸç†</h2><div class="tabs" id="d8861ef8-b02e-43e2-925f-acf859a71222"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#d8861ef8-b02e-43e2-925f-acf859a71222-1"><i class="fas fa-atom"></i>1</button></li><li class="tab"><button type="button" data-href="#d8861ef8-b02e-43e2-925f-acf859a71222-2"><i class="far fa-sun"></i>2</button></li><li class="tab"><button type="button" data-href="#d8861ef8-b02e-43e2-925f-acf859a71222-3"><i class="fas fa-wind"></i>3</button></li><li class="tab"><button type="button" data-href="#d8861ef8-b02e-43e2-925f-acf859a71222-4"><i class="fas fa-fire-alt"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="d8861ef8-b02e-43e2-925f-acf859a71222-1"><p>å½“åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡çš„æ—¶å€™ï¼Œåœ¨åº•å±‚åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º16ï¼Œè´Ÿè½½å› å­ä¸º0.75çš„<code>Node&lt;K,V&gt;[] table</code>æ•°ç»„ã€‚</p><p>åœ¨åˆ©ç”¨putæ–¹æ³•å°±å¯ä»¥æ·»åŠ æ•°æ®äº†ï¼Œputæ–¹æ³•çš„åº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªEntryå¯¹è±¡ï¼ŒEntryå¯¹è±¡è®°å½•çš„å°±æ˜¯è¦æ·»åŠ çš„é”®å’Œå€¼ã€‚</p><p><span class='p red'>å†åˆ©ç”¨é”®è®¡ç®—å‡ºé”®çš„Hashå€¼ï¼Œåªè¦é”®çš„Hashå€¼ï¼Œå’Œå€¼æ— å…³ã€‚</span></p><p>ç„¶åå†è®¡ç®—å‡ºæ•°ç»„ä¸­è¯¥å­˜å…¥çš„ç´¢å¼•4ï¼Œå¦‚æœè¯¥ä½ç½®ä¸ºnullï¼Œå°±ç›´æ¥æ·»åŠ è¿›å»ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522195854184.png" alt="image-20230522195854184" style="zoom:50%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522200359353.png" alt="image-20230522200359353" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d8861ef8-b02e-43e2-925f-acf859a71222-2"><p>å†æ·»åŠ ä¸€ä¸ªEntryå¯¹è±¡ï¼Œè®¡ç®—å‡ºæ¥çš„ç´¢å¼•è¿˜æ˜¯4ï¼Œé‚£æ­¤æ—¶4ç´¢å¼•å¤„å°±ä¸æ˜¯nulläº†ã€‚</p><p>è°ƒç”¨equalsæ–¹æ³•æ¯”è¾ƒé”®çš„å±æ€§å€¼ï¼Œåªæ¯”è¾ƒé”®çš„å±æ€§å€¼ï¼Œ</p><p>å¦‚æœé”®é‡Œé¢çš„æ•°æ®æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¦†ç›–åŸæœ‰çš„Entryå¯¹è±¡ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522200427206.png" alt="image-20230522200427206" style="zoom:67%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522200447565.png" alt="image-20230522200447565" style="zoom: 67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d8861ef8-b02e-43e2-925f-acf859a71222-3"><p>å¦‚æœequalæ¯”è¾ƒå®Œåï¼Œå‘ç°é”®ä¸ä¸€æ ·ï¼Œå°±ä¼šæ·»åŠ æ–°çš„Entryå¯¹è±¡</p><p>åœ¨JDK8ä»¥å‰ï¼Œæ–°å…ƒç´ æ·»åŠ åˆ°æ•°ç»„å½“ä¸­ï¼Œæ—§å…ƒç´ æŒ‚åœ¨ä¸‹é¢ï¼Œå½¢æˆä¸€æ¡é“¾è¡¨</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522200715009.png" alt="image-20230522200715009" style="zoom:67%;" /><p>åœ¨JDK8ä»¥åå°±æ²¡æœ‰é‚£ä¹ˆå¤æ‚äº†</p><p>æ–°çš„å…ƒç´ ç›´æ¥æŒ‚åœ¨è€å…ƒç´ çš„ä¸‹é¢ï¼Œå½¢æˆä¸€æ¡é“¾è¡¨</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522200803368.png" alt="image-20230522200803368" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d8861ef8-b02e-43e2-925f-acf859a71222-4"><p>é¢å¤–çš„ï¼Œåœ¨JDK8çš„æ—¶å€™ï¼Œä¸ºäº†æå‡æ€§èƒ½ï¼Œå½“é“¾è¡¨çš„é•¿åº¦è¶…è¿‡8ä¸”æ•°ç»„çš„é•¿åº¦å¤§äºç­‰äº64çš„æ—¶å€™ï¼Œé“¾è¡¨å°±ä¼šè‡ªåŠ¨è½¬æˆçº¢é»‘æ ‘ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522201115466.png" alt="image-20230522201115466" style="zoom:67%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522201131434.png" alt="image-20230522201131434" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <blockquote><p>æ€»ç»“</p></blockquote><ol><li><p>HashMapåº•å±‚æ˜¯å“ˆå¸Œè¡¨ç»“æ„çš„</p></li><li><p>ä¾èµ–hashCodeæ–¹æ³•å’Œequalsæ–¹æ³•ä¿è¯<span class='p red'>é”®çš„å”¯ä¸€</span></p></li><li><p>å¦‚æœé”®å­˜å‚¨çš„æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œéœ€è¦é‡å†™hashCodeå’Œequalsæ–¹æ³•</p></li><li><p>å¦‚æœå€¼å­˜å‚¨è‡ªå®šä¹‰å¯¹è±¡ï¼Œä¸éœ€è¦é‡å†™hashCodeå’Œequalsæ–¹æ³•</p></li></ol><hr><hr><h2 id="HashMapå…³é”®å­—æ®µåˆ†æ">HashMapå…³é”®å­—æ®µåˆ†æ</h2><div class="tabs" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-1"><i class="fas fa-bug"></i>1</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-2"><i class="fas fa-cannabis"></i>2</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-3"><i class="fas fa-candy-cane"></i>3</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-4"><i class="fas fa-child"></i>4</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-5"><i class="fas fa-seedling"></i>5</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-6"><i class="fas fa-leaf"></i>6</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-7"><i class="fab fa-apple"></i>7</button></li><li class="tab"><button type="button" data-href="#77fc3bbe-ef4c-40d7-8b63-40523f4490a0-8"><i class="fas fa-tree"></i>8</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-1"><p>è¿™ä¸ªå­—æ®µè¡¨ç¤ºé»˜è®¤çš„å“ˆå¸Œè¡¨çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯<code>HashMap</code>åº•å±‚ä½¿ç”¨æ•°ç»„çš„é»˜è®¤é•¿åº¦ï¼Œåœ¨<code>HashMap</code>å½“ä¸­åº•å±‚æ‰€ä½¿ç”¨çš„çš„æ•°ç»„çš„é•¿åº¦å¿…é¡»æ˜¯<code>2</code>çš„æ•´æ•°æ¬¡å¹‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The default initial capacity - MUST be a power of two.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_INITIAL_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-2"><p>è¿™ä¸ªå­—æ®µè¡¨ç¤ºå“ˆå¸Œè¡¨å½“ä¸­æ•°ç»„çš„æœ€å¤§é•¿åº¦ï¼Œ<code>HashMap</code>åº•å±‚ä½¿ç”¨çš„æ•°ç»„é•¿åº¦ä¸èƒ½è¶…è¿‡è¿™ä¸ªå€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The maximum capacity, used if a higher value is implicitly specified</span></span><br><span class="line"><span class="comment"> * by either of the constructors with arguments.</span></span><br><span class="line"><span class="comment"> * MUST be a power of two &lt;= 1&lt;&lt;30.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAXIMUM_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-3"><p>å­—æ®µ<code>DEFAULT_LOAD_FACTOR</code>çš„ä½œç”¨è¡¨ç¤ºåœ¨<code>HashMap</code>å½“ä¸­é»˜è®¤çš„è´Ÿè½½å› å­çš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The load factor used when none specified in constructor.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">DEFAULT_LOAD_FACTOR</span> <span class="operator">=</span> <span class="number">0.75f</span>;</span><br></pre></td></tr></table></figure><p>åœ¨å®é™…æƒ…å†µå½“ä¸­æˆ‘ä»¬å¹¶ä¸æ˜¯å½“<code>HashMap</code>å½“ä¸­çš„æ•°ç»„å®Œå…¨è¢«ä½¿ç”¨å®Œä¹‹åæ‰è¿›è¡Œæ‰©å®¹ï¼Œå› ä¸ºå¦‚æœæ•°ç»„å¿«è¢«ä½¿ç”¨å®Œä¹‹åï¼Œå†åŠ å…¥æ•°æ®äº§ç”Ÿå“ˆå¸Œå†²çªçš„å¯èƒ½æ€§å°±ä¼šå¾ˆå¤§ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸ä¼šè®¾ç½®ä¸€ä¸ªè´Ÿè½½å› å­<code>(load factor)</code>ï¼Œå½“æ•°ç»„çš„ä½¿ç”¨ç‡è¶…è¿‡è¿™ä¸ªå€¼çš„æ—¶å€™å°±è¿›è¡Œæ‰©å®¹ï¼Œå³å½“(æ•°ç»„é•¿åº¦ä¸º<code>L</code>ï¼Œæ•°ç»„å½“ä¸­æ•°æ®ä¸ªæ•°ä¸º<code>S</code>ï¼Œè´Ÿè½½å› å­ä¸º<code>F</code>)ï¼š</p><p>S&gt;=L*F</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-4"><p><code>TREEIFY_THRESHOLD</code> è¿™ä¸ªå­—æ®µä¸»è¦è¡¨ç¤ºå°†é“¾è¡¨ï¼ˆåœ¨<code>JDK</code>å½“ä¸­æ˜¯é‡‡ç”¨é“¾åœ°å€æ³•å»è§£å†³å“ˆå¸Œå†²çªçš„é—®é¢˜ï¼‰å˜æˆä¸€ä¸ªçº¢é»‘æ ‘çš„æ¡ä»¶ï¼Œåœ¨<code>JDK1.8</code>ä¹‹å<code>JDK</code>ä¸­å®ç°<code>HashMap</code>ä¸ä»…é‡‡ç”¨é“¾åœ°å€æ³•å»è§£å†³å“ˆå¸Œå†²çªï¼Œè€Œä¸”é“¾è¡¨æ»¡è¶³ä¸€å®šæ¡ä»¶ä¹‹åä¼šå°†é“¾è¡¨å˜æˆä¸€é¢—çº¢é»‘æ ‘ã€‚è€Œå°†é“¾è¡¨å˜æˆä¸€é¢—çº¢é»‘æ ‘çš„<code>å¿…è¦æ¡ä»¶</code>æ˜¯é“¾è¡¨å½“ä¸­æ•°æ®çš„ä¸ªæ•°è¦å¤§äºç­‰äº<code>TREEIFY_THRESHOLD</code>ï¼Œè¯·å¤§å®¶æ³¨æ„æ˜¯<code>å¿…è¦æ¡ä»¶</code>ä¸æ˜¯<code>å……åˆ†æ¡ä»¶</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ»¡è¶³è¿™ä¸ªæ¡ä»¶è¿˜ä¸è¡Œï¼Œå®ƒè¿˜éœ€è¦æ»¡è¶³å¦å¤–ä¸€ä¸ªæ¡ä»¶ï¼Œå°±æ˜¯å“ˆå¸Œè¡¨ä¸­æ•°ç»„çš„é•¿åº¦è¦å¤§äºç­‰äº<code>MIN_TREEIFY_CAPACITY</code>ï¼Œ<code>MIN_TREEIFY_CAPACITY</code>åœ¨<code>JDK</code>å½“ä¸­çš„é»˜è®¤å€¼æ˜¯64ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The bin count threshold for using a tree rather than list for a</span></span><br><span class="line"><span class="comment"> * bin.  Bins are converted to trees when adding an element to a</span></span><br><span class="line"><span class="comment"> * bin with at least this many nodes. The value must be greater</span></span><br><span class="line"><span class="comment"> * than 2 and should be at least 8 to mesh with assumptions in</span></span><br><span class="line"><span class="comment"> * tree removal about conversion back to plain bins upon</span></span><br><span class="line"><span class="comment"> * shrinkage.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TREEIFY_THRESHOLD</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The smallest table capacity for which bins may be treeified.</span></span><br><span class="line"><span class="comment"> * (Otherwise the table is resized if too many nodes in a bin.)</span></span><br><span class="line"><span class="comment"> * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts</span></span><br><span class="line"><span class="comment"> * between resizing and treeification thresholds.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MIN_TREEIFY_CAPACITY</span> <span class="operator">=</span> <span class="number">64</span>;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-5"><p><code>UNTREEIFY_THRESHOLD</code>è¡¨ç¤ºå½“åœ¨è¿›è¡Œ<code>resize</code>æ“ä½œçš„è¿‡ç¨‹å½“ä¸­ï¼Œçº¢é»‘æ ‘å½“ä¸­çš„èŠ‚ç‚¹ä¸ªæ•°å°äº<code>UNTREEIFY_THRESHOLD</code>æ—¶ï¼Œå°±éœ€è¦å°†ä¸€é¢—çº¢é»‘æ ‘é‡æ–°æ¢å¤æˆé“¾è¡¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The bin count threshold for untreeifying a (split) bin during a</span></span><br><span class="line"><span class="comment"> * resize operation. Should be less than TREEIFY_THRESHOLD, and at</span></span><br><span class="line"><span class="comment"> * most 6 to mesh with shrinkage detection under removal.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">UNTREEIFY_THRESHOLD</span> <span class="operator">=</span> <span class="number">6</span>;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-6"><p><code>table</code>æ•°ç»„å¯¹è±¡å°±æ˜¯<code>HashMap</code>åº•å±‚å½“ä¸­çœŸæ­£ç”¨äºå­˜å‚¨æ•°æ®çš„æ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The table, initialized on first use, and resized as</span></span><br><span class="line"><span class="comment"> * necessary. When allocated, length is always a power of two.</span></span><br><span class="line"><span class="comment"> * (We also tolerate length zero in some operations to allow</span></span><br><span class="line"><span class="comment"> * bootstrapping mechanics that are currently not needed.)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-7"><p><code>size</code>è¡¨ç¤ºå“ˆå¸Œè¡¨ä¸­å­˜å‚¨çš„<code>key-value</code>å¯¹è±¡çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯æ”¾å…¥äº†å¤šå°‘ä¸ªé”®å€¼å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The number of key-value mappings contained in this map.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> <span class="type">int</span> size;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="77fc3bbe-ef4c-40d7-8b63-40523f4490a0-8"><p><code>threshold</code>è¡¨ç¤ºå®¹å™¨å½“ä¸­èƒ½å¤Ÿå­˜å‚¨çš„æ•°æ®ä¸ªæ•°çš„é˜ˆå€¼ï¼Œå½“<code>HashMap</code>å½“ä¸­å­˜å‚¨çš„æ•°æ®çš„ä¸ªæ•°è¶…è¿‡è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œ<code>HashMap</code>åº•å±‚ä½¿ç”¨çš„æ•°ç»„å°±éœ€è¦è¿›è¡Œæ‰©å®¹ã€‚ä¸‹åˆ—å…¬å¼ä¸­<code>Capacity</code>è¡¨ç¤ºåº•å±‚æ•°ç»„çš„é•¿åº¦ï¼ˆ<code>2</code>çš„æ•´æ•°æ¬¡å¹‚ï¼Œæ³¨æ„ä¸<code>size</code>è¿›è¡ŒåŒºåˆ†ï¼‰ã€‚</p><p>threshold = LoadFactor * Capacity</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>HashMapåº•å±‚èŠ‚ç‚¹ç±»</p></blockquote><p><code>Node&lt;K,V&gt;[] table</code>åº•å±‚å½“ä¸­çœŸæ­£ç”¨äºå­˜å‚¨æ•°æ®çš„æ•°ç»„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K,V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>.Entry&lt;K,V&gt; &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> hash;</span><br><span class="line">        <span class="keyword">final</span> K key;</span><br><span class="line">        V value;</span><br><span class="line">        Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">        Node(<span class="type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">            <span class="built_in">this</span>.hash = hash;</span><br><span class="line">            <span class="built_in">this</span>.key = key;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> K <span class="title function_">getKey</span><span class="params">()</span>        &#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> V <span class="title function_">getValue</span><span class="params">()</span>      &#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> String <span class="title function_">toString</span><span class="params">()</span> &#123; <span class="keyword">return</span> key + <span class="string">&quot;=&quot;</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> V <span class="title function_">setValue</span><span class="params">(V newValue)</span> &#123;</span><br><span class="line">            <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> value;</span><br><span class="line">            value = newValue;</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (o == <span class="built_in">this</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">                <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                    Objects.equals(value, e.getValue()))</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="HashMapä¸»è¦æ–¹æ³•åˆ†æ">HashMapä¸»è¦æ–¹æ³•åˆ†æ</h2><h3 id="æ„é€ æ–¹æ³•">æ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="comment">// æŒ‡å®šåˆå§‹å®¹é‡çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal initial capacity: &quot;</span> +</span><br><span class="line">                initialCapacity);</span><br><span class="line">    <span class="comment">// å¦‚æœå¤§äºå…è®¸çš„æœ€å¤§å®¹é‡ï¼Œå°±å°†æ•°ç»„çš„é•¿åº¦è¿™æ˜¯ä¸ºæœ€å¤§å®¹é‡</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal load factor: &quot;</span> +</span><br><span class="line">                loadFactor);</span><br><span class="line">    <span class="built_in">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="comment">//å› ä¸ºæˆ‘ä»¬éœ€è¦åº•å±‚ä½¿ç”¨çš„æ•°ç»„tableçš„é•¿åº¦æ˜¯2çš„æ•´æ•°æ¬¡å¹‚ï¼Œè€Œæˆ‘ä»¬ä¹‹ååœ¨åˆå§‹åŒ–å‡½æ•°å½“ä¸­ä¼šå…è®¸ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°ç»„é•¿åº¦çš„å¤§å°</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯ç”¨æˆ·è¾“å…¥çš„æ•°å­—å¯èƒ½ä¸æ˜¯2çš„æ•´æ•°æ¬¡å¹‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®å˜æˆ2çš„æ•´æ•°æ¬¡å¹‚</span></span><br><span class="line">    <span class="comment">//tableSizeForæ–¹æ³•å¯ä»¥å°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®å˜æˆå¤§äºç­‰äºè¿™ä¸ªæ•°çš„æœ€å°çš„2çš„æ•´æ•°æ¬¡å¹‚ã€‚</span></span><br><span class="line">    <span class="built_in">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="put">put</h3><div class="tabs" id="e79f4da6-a38b-4729-ab7b-06e2c986f535"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#e79f4da6-a38b-4729-ab7b-06e2c986f535-1"><i class="fas fa-bug"></i>put</button></li><li class="tab"><button type="button" data-href="#e79f4da6-a38b-4729-ab7b-06e2c986f535-2"><i class="fas fa-cannabis"></i>putVal</button></li><li class="tab"><button type="button" data-href="#e79f4da6-a38b-4729-ab7b-06e2c986f535-3"><i class="fas fa-candy-cane"></i>resize</button></li><li class="tab"><button type="button" data-href="#e79f4da6-a38b-4729-ab7b-06e2c986f535-4"><i class="fas fa-child"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="e79f4da6-a38b-4729-ab7b-06e2c986f535-1"><p>åœ¨<code>put</code>å‡½æ•°å½“ä¸­é¦–å…ˆè®¡ç®—å‚æ•°<code>key</code>çš„å“ˆå¸Œå€¼ï¼Œç„¶åè°ƒç”¨<code>putVal</code>å‡½æ•°çœŸæ­£çš„å°†è¾“å…¥æ’å…¥åˆ°æ•°æ®å½“ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‚æ•°ä¸€ï¼šé”®</span></span><br><span class="line"><span class="comment">//å‚æ•°äºŒï¼šå€¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šè¢«è¦†ç›–å…ƒç´ çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰è¦†ç›–ï¼Œè¿”å›null</span></span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ©ç”¨é”®è®¡ç®—å‡ºå¯¹åº”çš„å“ˆå¸Œå€¼ï¼Œå†æŠŠå“ˆå¸Œå€¼è¿›è¡Œä¸€äº›é¢å¤–çš„å¤„ç†</span></span><br><span class="line"><span class="comment">//ç®€å•ç†è§£ï¼šè¿”å›å€¼å°±æ˜¯è¿”å›é”®çš„å“ˆå¸Œå€¼</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><mark class="hl-label green">æ•´ä½“æµç¨‹</mark></p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220712235514945-220342780.png" alt="img" style="zoom:60%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e79f4da6-a38b-4729-ab7b-06e2c986f535-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‚æ•°ä¸€ï¼šé”®çš„å“ˆå¸Œå€¼</span></span><br><span class="line">    <span class="comment">//å‚æ•°äºŒï¼šé”®</span></span><br><span class="line">    <span class="comment">//å‚æ•°ä¸‰ï¼šå€¼</span></span><br><span class="line">    <span class="comment">//å‚æ•°å››ï¼šå¦‚æœé”®é‡å¤äº†æ˜¯å¦ä¿ç•™</span></span><br><span class="line">    <span class="comment">//   trueï¼Œè¡¨ç¤ºè€å…ƒç´ çš„å€¼ä¿ç•™ï¼Œä¸ä¼šè¦†ç›–</span></span><br><span class="line">    <span class="comment">//   falseï¼Œè¡¨ç¤ºè€å…ƒç´ çš„å€¼ä¸ä¿ç•™ï¼Œä¼šè¿›è¡Œè¦†ç›–</span></span><br><span class="line">    <span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent, <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">        <span class="comment">//å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œç”¨æ¥è®°å½•å“ˆå¸Œè¡¨ä¸­æ•°ç»„çš„åœ°å€å€¼ã€‚</span></span><br><span class="line">        Node&lt;K, V&gt;[] tab;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸´æ—¶çš„ç¬¬ä¸‰æ–¹å˜é‡ï¼Œç”¨æ¥è®°å½•é”®å€¼å¯¹å¯¹è±¡çš„åœ°å€å€¼</span></span><br><span class="line">        Node&lt;K, V&gt; p;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºå½“å‰æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºç´¢å¼•</span></span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŠŠå“ˆå¸Œè¡¨ä¸­æ•°ç»„çš„åœ°å€å€¼ï¼Œèµ‹å€¼ç»™å±€éƒ¨å˜é‡tab</span></span><br><span class="line">        tab = table;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tab == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//1.å¦‚æœå½“å‰æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ æ•°æ®ï¼Œåº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤é•¿åº¦ä¸º16ï¼ŒåŠ è½½å› å­ä¸º0.75çš„æ•°ç»„</span></span><br><span class="line">            <span class="comment">//2.å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ æ•°æ®ï¼Œä¼šçœ‹æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦è¾¾åˆ°äº†æ‰©å®¹çš„æ¡ä»¶</span></span><br><span class="line">            <span class="comment">//å¦‚æœæ²¡æœ‰è¾¾åˆ°æ‰©å®¹æ¡ä»¶ï¼Œåº•å±‚ä¸ä¼šåšä»»ä½•æ“ä½œ</span></span><br><span class="line">            <span class="comment">//å¦‚æœè¾¾åˆ°äº†æ‰©å®¹æ¡ä»¶ï¼Œåº•å±‚ä¼šæŠŠæ•°ç»„æ‰©å®¹ä¸ºåŸå…ˆçš„ä¸¤å€ï¼Œå¹¶æŠŠæ•°æ®å…¨éƒ¨è½¬ç§»åˆ°æ–°çš„å“ˆå¸Œè¡¨ä¸­</span></span><br><span class="line">            tab = resize();</span><br><span class="line">            <span class="comment">//è¡¨ç¤ºæŠŠå½“å‰æ•°ç»„çš„é•¿åº¦èµ‹å€¼ç»™n</span></span><br><span class="line">            n = tab.length;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‹¿ç€æ•°ç»„çš„é•¿åº¦è·Ÿé”®çš„å“ˆå¸Œå€¼è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—å‡ºå½“å‰é”®å€¼å¯¹å¯¹è±¡ï¼Œåœ¨æ•°ç»„ä¸­åº”å­˜å…¥çš„ä½ç½®</span></span><br><span class="line">        i = (n - <span class="number">1</span>) &amp; hash;<span class="comment">//index</span></span><br><span class="line">        <span class="comment">//è·å–æ•°ç»„ä¸­å¯¹åº”å…ƒç´ çš„æ•°æ®</span></span><br><span class="line">        p = tab[i];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">//åº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªé”®å€¼å¯¹å¯¹è±¡ï¼Œç›´æ¥æ”¾åˆ°æ•°ç»„å½“ä¸­</span></span><br><span class="line">            tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;K, V&gt; e;</span><br><span class="line">            K k;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç­‰å·çš„å·¦è¾¹ï¼šæ•°ç»„ä¸­é”®å€¼å¯¹çš„å“ˆå¸Œå€¼</span></span><br><span class="line">            <span class="comment">//ç­‰å·çš„å³è¾¹ï¼šå½“å‰è¦æ·»åŠ é”®å€¼å¯¹çš„å“ˆå¸Œå€¼</span></span><br><span class="line">            <span class="comment">//å¦‚æœé”®ä¸ä¸€æ ·ï¼Œæ­¤æ—¶è¿”å›false</span></span><br><span class="line">            <span class="comment">//å¦‚æœé”®ä¸€æ ·ï¼Œè¿”å›true</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">b1</span> <span class="operator">=</span> p.hash == hash;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (b1 &amp;&amp; ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                e = p;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode) &#123;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­æ•°ç»„ä¸­è·å–å‡ºæ¥çš„é”®å€¼å¯¹æ˜¯ä¸æ˜¯çº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹</span></span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨æ–¹æ³•putTreeValï¼ŒæŠŠå½“å‰çš„èŠ‚ç‚¹æŒ‰ç…§çº¢é»‘æ ‘çš„è§„åˆ™æ·»åŠ åˆ°æ ‘å½“ä¸­ã€‚</span></span><br><span class="line">                e = ((TreeNode&lt;K, V&gt;) p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœä»æ•°ç»„ä¸­è·å–å‡ºæ¥çš„é”®å€¼å¯¹ä¸æ˜¯çº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹</span></span><br><span class="line">                <span class="comment">//è¡¨ç¤ºæ­¤æ—¶ä¸‹é¢æŒ‚çš„æ˜¯é“¾è¡¨</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">//æ­¤æ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼ŒæŒ‚åœ¨ä¸‹é¢å½¢æˆé“¾è¡¨</span></span><br><span class="line">                        p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">                        <span class="comment">//åˆ¤æ–­å½“å‰é“¾è¡¨é•¿åº¦æ˜¯å¦è¶…è¿‡8ï¼Œå¦‚æœè¶…è¿‡8ï¼Œå°±ä¼šè°ƒç”¨æ–¹æ³•treeifyBin</span></span><br><span class="line">                        <span class="comment">//treeifyBinæ–¹æ³•çš„åº•å±‚è¿˜ä¼šç»§ç»­åˆ¤æ–­</span></span><br><span class="line">                        <span class="comment">//åˆ¤æ–­æ•°ç»„çš„é•¿åº¦æ˜¯å¦å¤§äºç­‰äº64</span></span><br><span class="line">                        <span class="comment">//å¦‚æœåŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±ä¼šæŠŠè¿™ä¸ªé“¾è¡¨è½¬æˆçº¢é»‘æ ‘</span></span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>)</span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//eï¼š  0x0044  ddd  444</span></span><br><span class="line">                    <span class="comment">//è¦æ·»åŠ çš„å…ƒç´ ï¼š 0x0055   ddd   555</span></span><br><span class="line">                    <span class="comment">//å¦‚æœå“ˆå¸Œå€¼ä¸€æ ·ï¼Œå°±ä¼šè°ƒç”¨equalsæ–¹æ³•æ¯”è¾ƒå†…éƒ¨çš„å±æ€§å€¼æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    p = e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœeä¸ºnullï¼Œè¡¨ç¤ºå½“å‰ä¸éœ€è¦è¦†ç›–ä»»ä½•å…ƒç´ </span></span><br><span class="line">            <span class="comment">//å¦‚æœeä¸ä¸ºnullï¼Œè¡¨ç¤ºå½“å‰çš„é”®æ˜¯ä¸€æ ·çš„ï¼Œå€¼ä¼šè¢«è¦†ç›–</span></span><br><span class="line">            <span class="comment">//e:0x0044  ddd  555</span></span><br><span class="line">            <span class="comment">//è¦æ·»åŠ çš„å…ƒç´ ï¼š 0x0055   ddd   555</span></span><br><span class="line">            <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">                <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//ç­‰å·çš„å³è¾¹ï¼šå½“å‰è¦æ·»åŠ çš„å€¼</span></span><br><span class="line">                    <span class="comment">//ç­‰å·çš„å·¦è¾¹ï¼š0x0044çš„å€¼</span></span><br><span class="line">                    e.value = value;</span><br><span class="line">                &#125;</span><br><span class="line">                afterNodeAccess(e);</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//thresholdï¼šè®°å½•çš„å°±æ˜¯æ•°ç»„çš„é•¿åº¦ * 0.75ï¼Œå“ˆå¸Œè¡¨çš„æ‰©å®¹æ—¶æœº  16 * 0.75 = 12</span></span><br><span class="line">        <span class="keyword">if</span> (++size &gt; threshold) &#123;</span><br><span class="line">            resize();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¡¨ç¤ºå½“å‰æ²¡æœ‰è¦†ç›–ä»»ä½•å…ƒç´ ï¼Œè¿”å›null</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e79f4da6-a38b-4729-ab7b-06e2c986f535-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="comment">// æ—§æ•°ç»„çš„æ•°ç»„é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCap</span> <span class="operator">=</span> (oldTab == <span class="literal">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="comment">// æ—§çš„æ‰©å®¹çš„é˜ˆå€¼</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldThr</span> <span class="operator">=</span> threshold;</span><br><span class="line">    <span class="type">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">float</span> <span class="variable">ft</span> <span class="operator">=</span> (<span class="type">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="type">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="type">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¸Šé¢çš„ä»£ç ä¸»è¦æ˜¯è®¡ç®—å¾—åˆ°æ–°çš„é˜ˆå€¼ newThr å’Œæ•°ç»„é•¿åº¦ newCap</span></span><br><span class="line">    </span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    <span class="comment">// å¼€è¾Ÿæ–°çš„æ•°ç»„ç©ºé—´</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> <span class="title class_">Node</span>[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="comment">// ç°åœ¨éœ€è¦å°†æ—§æ•°ç»„å½“ä¸­çš„æ•°æ®åŠ å…¥åˆ°æ–°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="literal">null</span>) &#123;</span><br><span class="line">                oldTab[j] = <span class="literal">null</span>;</span><br><span class="line">                <span class="comment">// e.next == null è¡¨ç¤ºåªæœ‰ä¸€ä¸ªæ•°æ®ï¼Œå¹¶æ²¡æœ‰å½¢æˆ 2 ä¸ª</span></span><br><span class="line">                <span class="comment">// æ•°æ®ä»¥ä¸Šçš„é“¾è¡¨ï¼Œå› æ­¤å¯ä»¥ç›´æ¥åŠ å…¥åˆ°å¿ƒå¾—æ•°ç»„ å½“ä¸­</span></span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="literal">null</span>)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    <span class="comment">// å¦‚æœèŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œåˆ™åœ¨å°†çº¢é»‘æ ‘å½“ä¸­çš„èŠ‚ç‚¹åŠ å…¥åˆ°æ–°æ•°ç»„å½“ä¸­</span></span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="built_in">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                    <span class="comment">// é“¾è¡¨çš„ä»£ç æ¯”è¾ƒå¤æ‚ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸‹é¢çš„åˆ†æ</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="literal">null</span>, loTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="literal">null</span>, hiTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="literal">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="literal">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e79f4da6-a38b-4729-ab7b-06e2c986f535-4"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="remove">remove</h3><p>æ•´ä¸ªå‡½æ•°åˆ†æˆä¸€ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ul><li>å…ˆæ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹ã€‚</li><li>åˆ é™¤æ‰¾åˆ°çš„èŠ‚ç‚¹ã€‚</li></ul><div class="tabs" id="893ebc87-56df-4723-a233-b33f7144b79e"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#893ebc87-56df-4723-a233-b33f7144b79e-1"><i class="fas fa-seedling"></i>remove</button></li><li class="tab"><button type="button" data-href="#893ebc87-56df-4723-a233-b33f7144b79e-2"><i class="fas fa-leaf"></i>removeNode</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="893ebc87-56df-4723-a233-b33f7144b79e-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">remove</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = removeNode(hash(key), key, <span class="literal">null</span>, <span class="literal">false</span>, <span class="literal">true</span>)) == <span class="literal">null</span> ?</span><br><span class="line">        <span class="literal">null</span> : e.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="893ebc87-56df-4723-a233-b33f7144b79e-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title function_">removeNode</span><span class="params">(<span class="type">int</span> hash, Object key, Object value,</span></span><br><span class="line"><span class="params">                           <span class="type">boolean</span> matchValue, <span class="type">boolean</span> movable)</span> &#123;</span><br><span class="line">    <span class="comment">// matchValue è¿™ä¸ªå‚æ•°å¦‚æœä¸º true è¡¨ç¤ºä¼ å…¥çš„å‚æ•° value</span></span><br><span class="line">    <span class="comment">// å’ŒæŸ¥æ‰¾åˆ°çš„æ•°æ®çš„ value ç›¸ç­‰æ‰è¿›è¡Œåˆ é™¤</span></span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="type">int</span> n, index;</span><br><span class="line">    <span class="comment">// å…ˆæ‰¾åˆ°èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (p = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="literal">null</span>) &#123;</span><br><span class="line">        Node&lt;K,V&gt; node = <span class="literal">null</span>, e; K k; V v;</span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            node = p;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((e = p.next) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                        ((k = e.key) == key ||</span><br><span class="line">                         (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                        node = e;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    p = e;</span><br><span class="line">                &#125; <span class="keyword">while</span> ((e = e.next) != <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (node != <span class="literal">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||</span><br><span class="line">                             (value != <span class="literal">null</span> &amp;&amp; value.equals(v)))) &#123;</span><br><span class="line">            <span class="keyword">if</span> (node <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="built_in">this</span>, tab, movable);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (node == p)</span><br><span class="line">                tab[index] = node.next;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                p.next = node.next;</span><br><span class="line">            ++modCount;</span><br><span class="line">            --size;</span><br><span class="line">            afterNodeRemoval(node);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="LinkedHashMap">LinkedHashMap</h2><p>LinkedHashMapæ˜¯HashMapçš„å­ç±»ï¼Œä¸LinkedHashMapç±»ä¼¼</p><ul><li><p>ç”±é”®å†³å®šï¼š<span class='p red'>æœ‰åº</span>ã€ä¸é‡å¤ã€æ— ç´¢å¼•ã€‚</p></li><li><p>è¿™é‡Œçš„æœ‰åºæŒ‡çš„æ˜¯ä¿è¯å­˜å‚¨å’Œå–å‡ºçš„å…ƒç´ é¡ºåºä¸€è‡´</p></li><li><p>åŸç†ï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯ä¾ç„¶å“ˆå¸Œè¡¨ï¼Œåªæ˜¯æ¯ä¸ªé”®å€¼å¯¹å…ƒç´ åˆé¢å¤–çš„å¤šäº†ä¸€ä¸ªåŒé“¾è¡¨çš„æœºåˆ¶è®°å½•å­˜å‚¨çš„é¡ºåºã€‚</p></li></ul><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230521133546661.png" alt="image-20230521133546661"></p><div class="tag link"><a class="link-card" title="LinkedHashSet" href="/posts/edc5fe5c.html#LinkedHashSet"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/favicon.png"/></div><div class="right"><p class="text">LinkedHashSet</p><p class="url">/posts/edc5fe5c.html#LinkedHashSet</p></div></a></div><hr><hr><h2 id="TreeMap">TreeMap</h2><ul><li><p>TreeMapè·ŸTreeSetåº•å±‚åŸç†ä¸€æ ·ï¼Œéƒ½æ˜¯çº¢é»‘æ ‘ç»“æ„çš„ã€‚</p></li><li><p>ç”±é”®å†³å®šç‰¹æ€§ï¼šä¸é‡å¤ã€æ— ç´¢å¼•ã€å¯æ’åº</p></li><li><p>å¯æ’åºï¼š<span class='p red'>å¯¹é”®è¿›è¡Œæ’åº</span>ã€‚</p></li><li><p>æ³¨æ„ï¼šé»˜è®¤æŒ‰ç…§é”®çš„ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œä¹Ÿå¯ä»¥è‡ªå·±è§„å®šé”®çš„æ’åºè§„åˆ™</p></li></ul><blockquote><p>æ¯”è¾ƒè§„åˆ™</p></blockquote><ul><li><p>å®ç°Comparableæ¥å£ï¼ŒæŒ‡å®šæ¯”è¾ƒè§„åˆ™ã€‚</p></li><li><p>åˆ›å»ºé›†åˆæ—¶ä¼ é€’Comparatoræ¯”è¾ƒå™¨å¯¹è±¡ï¼ŒæŒ‡å®šæ¯”è¾ƒè§„åˆ™ã€‚</p></li></ul><blockquote><p>TreeMapæ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œé”®æ˜¯å¦éœ€è¦é‡å†™hashCodeå’Œequalsæ–¹æ³•ï¼Ÿ</p></blockquote><p>æ­¤æ—¶æ˜¯ä¸éœ€è¦é‡å†™çš„</p><p>åœ¨Javaä¸­ï¼Œ<code>TreeMap</code> æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„ï¼Œå®ƒçš„å…ƒç´ æ’åºæ˜¯æ ¹æ® key çš„è‡ªç„¶é¡ºåºæˆ–è€…æ ¹æ®æä¾›çš„æ¯”è¾ƒå™¨ï¼ˆ<code>Comparator</code>ï¼‰æ¥å®ç°çš„ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ <code>TreeMap</code> æ—¶ï¼Œæ— éœ€é‡å†™ key çš„ <code>hashCode</code> å’Œ <code>equals</code> æ–¹æ³•ã€‚ç›¸åï¼Œä½ éœ€è¦ç¡®ä¿ key ç±»å®ç°äº† <code>Comparable</code> æ¥å£æˆ–è€…å‘ <code>TreeMap</code> æä¾›ä¸€ä¸ª <code>Comparator</code> å®ä¾‹ã€‚</p><hr><h3 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºé›†åˆå¯¹è±¡</span></span><br><span class="line">TreeMap&lt;Integer, String&gt; treeMap = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;(((o1, o2) -&gt; o2 - o1));</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.æ·»åŠ å…ƒç´ </span></span><br><span class="line">treeMap.put(<span class="number">1</span>,<span class="string">&quot;å¥¥åˆ©å¥¥&quot;</span>);</span><br><span class="line">treeMap.put(<span class="number">2</span>,<span class="string">&quot;é›ªç¢§&quot;</span>);</span><br><span class="line">treeMap.put(<span class="number">3</span>,<span class="string">&quot;å…­ä¸ªæ ¸æ¡ƒ&quot;</span>);</span><br><span class="line">treeMap.put(<span class="number">4</span>,<span class="string">&quot;åº·å¸ˆå‚…&quot;</span>);</span><br><span class="line">treeMap.put(<span class="number">5</span>,<span class="string">&quot;å¯å£å¯ä¹&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.éå†å…ƒç´ </span></span><br><span class="line">treeMap.forEach((k,v)-&gt;&#123;</span><br><span class="line">    System.out.println(k+<span class="string">&quot;=&quot;</span>+v);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>5=å¯å£å¯ä¹<br>4=åº·å¸ˆå‚…<br>3=å…­ä¸ªæ ¸æ¡ƒ<br>2=é›ªç¢§<br>1=å¥¥åˆ©å¥¥</p><hr><h3 id="åº•å±‚åŸç†">åº•å±‚åŸç†</h3><blockquote><p>TreeMapä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å†…éƒ¨å±æ€§</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">K key;<span class="comment">//é”®</span></span><br><span class="line">V value;<span class="comment">//å€¼</span></span><br><span class="line">Entry&lt;K,V&gt; left;<span class="comment">//å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">Entry&lt;K,V&gt; right;<span class="comment">//å³å­èŠ‚ç‚¹</span></span><br><span class="line">Entry&lt;K,V&gt; parent;<span class="comment">//çˆ¶èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">boolean</span> color;<span class="comment">//èŠ‚ç‚¹çš„é¢œè‰²</span></span><br></pre></td></tr></table></figure><blockquote><p>TreeMapç±»ä¸­ä¸­è¦çŸ¥é“çš„ä¸€äº›æˆå‘˜å˜é‡å’Œæ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeMap</span>&lt;K,V&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¯”è¾ƒå™¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;? <span class="built_in">super</span> K&gt; comparator;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt; root;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é›†åˆçš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç©ºå‚æ„é€ å°±æ˜¯æ²¡æœ‰ä¼ é€’æ¯”è¾ƒå™¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        comparator = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¸¦å‚æ„é€ å°±æ˜¯ä¼ é€’äº†æ¯”è¾ƒå™¨å¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> K&gt; comparator)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.comparator = comparator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> put(key, value, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><mark class="hl-label blue">æ·»åŠ å…ƒç´ è¿‡ç¨‹</mark> <div class="tabs" id="5bf345b5-27ff-4798-bc80-e63b974c626f"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#5bf345b5-27ff-4798-bc80-e63b974c626f-1"><i class="fas fa-seedling"></i>put</button></li><li class="tab"><button type="button" data-href="#5bf345b5-27ff-4798-bc80-e63b974c626f-2"><i class="fas fa-leaf"></i>put</button></li><li class="tab"><button type="button" data-href="#5bf345b5-27ff-4798-bc80-e63b974c626f-3"><i class="fab fa-apple"></i>addEntry</button></li><li class="tab"><button type="button" data-href="#5bf345b5-27ff-4798-bc80-e63b974c626f-4"><i class="fas fa-tree"></i>fixAfterInsertion</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="5bf345b5-27ff-4798-bc80-e63b974c626f-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> put(key, value, <span class="literal">true</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5bf345b5-27ff-4798-bc80-e63b974c626f-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> V <span class="title function_">put</span><span class="params">(K key, V value, <span class="type">boolean</span> replaceOld)</span> &#123;</span><br><span class="line">    <span class="comment">//è·å–æ ¹èŠ‚ç‚¹çš„åœ°å€å€¼ï¼Œèµ‹å€¼ç»™å±€éƒ¨å˜é‡t</span></span><br><span class="line">    Entry&lt;K,V&gt; t = root;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºnull</span></span><br><span class="line">    <span class="comment">//å¦‚æœä¸ºnullï¼Œè¡¨ç¤ºå½“å‰æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ ï¼Œä¼šæŠŠå½“å‰è¦æ·»åŠ çš„å…ƒç´ ï¼Œå½“åšæ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">//å¦‚æœä¸ä¸ºnullï¼Œè¡¨ç¤ºå½“å‰ä¸æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ ï¼Œè·³è¿‡è¿™ä¸ªåˆ¤æ–­ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç </span></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">//æ–¹æ³•çš„åº•å±‚ï¼Œä¼šåˆ›å»ºä¸€ä¸ªEntryå¯¹è±¡ï¼ŒæŠŠä»–å½“åšæ ¹èŠ‚ç‚¹</span></span><br><span class="line">        addEntryToEmptyMap(key, value);</span><br><span class="line">        <span class="comment">//è¡¨ç¤ºæ­¤æ—¶æ²¡æœ‰è¦†ç›–ä»»ä½•çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¡¨ç¤ºä¸¤ä¸ªå…ƒç´ çš„é”®æ¯”è¾ƒä¹‹åçš„ç»“æœ</span></span><br><span class="line">    <span class="type">int</span> cmp;</span><br><span class="line">    <span class="comment">//è¡¨ç¤ºå½“å‰è¦æ·»åŠ èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">    Entry&lt;K,V&gt; parent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¡¨ç¤ºå½“å‰çš„æ¯”è¾ƒè§„åˆ™</span></span><br><span class="line">    <span class="comment">//å¦‚æœæˆ‘ä»¬æ˜¯é‡‡å–é»˜è®¤çš„è‡ªç„¶æ’åºï¼Œé‚£ä¹ˆæ­¤æ—¶comparatorè®°å½•çš„æ˜¯nullï¼Œcprè®°å½•çš„ä¹Ÿæ˜¯null</span></span><br><span class="line">    <span class="comment">//å¦‚æœæˆ‘ä»¬æ˜¯é‡‡å–æ¯”è¾ƒå»æ’åºæ–¹å¼ï¼Œé‚£ä¹ˆæ­¤æ—¶comparatorè®°å½•çš„æ˜¯å°±æ˜¯æ¯”è¾ƒå™¨</span></span><br><span class="line">    Comparator&lt;? <span class="built_in">super</span> K&gt; cpr = comparator;</span><br><span class="line">    <span class="comment">//è¡¨ç¤ºåˆ¤æ–­å½“å‰æ˜¯å¦æœ‰æ¯”è¾ƒå™¨å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//å¦‚æœä¼ é€’äº†æ¯”è¾ƒå™¨å¯¹è±¡ï¼Œå°±æ‰§è¡Œifé‡Œé¢çš„ä»£ç ï¼Œæ­¤æ—¶ä»¥æ¯”è¾ƒå™¨çš„è§„åˆ™ä¸ºå‡†</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¼ é€’æ¯”è¾ƒå™¨å¯¹è±¡ï¼Œå°±æ‰§è¡Œelseé‡Œé¢çš„ä»£ç ï¼Œæ­¤æ—¶ä»¥è‡ªç„¶æ’åºçš„è§„åˆ™ä¸ºå‡†</span></span><br><span class="line">    <span class="keyword">if</span> (cpr != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = cpr.compare(key, t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> t.value;</span><br><span class="line">                <span class="keyword">if</span> (replaceOld || oldValue == <span class="literal">null</span>) &#123;</span><br><span class="line">                    t.value = value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//æŠŠé”®è¿›è¡Œå¼ºè½¬ï¼Œå¼ºè½¬æˆComparableç±»å‹çš„</span></span><br><span class="line">        <span class="comment">//è¦æ±‚ï¼šé”®å¿…é¡»è¦å®ç°Comparableæ¥å£ï¼Œå¦‚æœæ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£</span></span><br><span class="line">        <span class="comment">//æ­¤æ—¶åœ¨å¼ºè½¬çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™ã€‚</span></span><br><span class="line">        Comparable&lt;? <span class="built_in">super</span> K&gt; k = (Comparable&lt;? <span class="built_in">super</span> K&gt;) key;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="comment">//æŠŠæ ¹èŠ‚ç‚¹å½“åšå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">            parent = t;</span><br><span class="line">            <span class="comment">//è°ƒç”¨compareToæ–¹æ³•ï¼Œæ¯”è¾ƒæ ¹èŠ‚ç‚¹å’Œå½“å‰è¦æ·»åŠ èŠ‚ç‚¹çš„å¤§å°å…³ç³»</span></span><br><span class="line">            cmp = k.compareTo(t.key);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                <span class="comment">//å¦‚æœæ¯”è¾ƒçš„ç»“æœä¸ºè´Ÿæ•°</span></span><br><span class="line">                <span class="comment">//é‚£ä¹ˆç»§ç»­åˆ°æ ¹èŠ‚ç‚¹çš„å·¦è¾¹å»æ‰¾</span></span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                <span class="comment">//å¦‚æœæ¯”è¾ƒçš„ç»“æœä¸ºæ­£æ•°</span></span><br><span class="line">                <span class="comment">//é‚£ä¹ˆç»§ç»­åˆ°æ ¹èŠ‚ç‚¹çš„å³è¾¹å»æ‰¾</span></span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœæ¯”è¾ƒçš„ç»“æœä¸º0ï¼Œä¼šè¦†ç›–</span></span><br><span class="line">                <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> t.value;</span><br><span class="line">                <span class="keyword">if</span> (replaceOld || oldValue == <span class="literal">null</span>) &#123;</span><br><span class="line">                    t.value = value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°±ä¼šæŠŠå½“å‰èŠ‚ç‚¹æŒ‰ç…§æŒ‡å®šçš„è§„åˆ™è¿›è¡Œæ·»åŠ </span></span><br><span class="line">    addEntry(key, value, parent, cmp &lt; <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5bf345b5-27ff-4798-bc80-e63b974c626f-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addEntry</span><span class="params">(K key, V value, Entry&lt;K, V&gt; parent, <span class="type">boolean</span> addToLeft)</span> &#123;</span><br><span class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(key, value, parent);</span><br><span class="line">    <span class="keyword">if</span> (addToLeft)</span><br><span class="line">        parent.left = e;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        parent.right = e;</span><br><span class="line">    <span class="comment">//æ·»åŠ å®Œæ¯•ä¹‹åï¼Œéœ€è¦æŒ‰ç…§çº¢é»‘æ ‘çš„è§„åˆ™è¿›è¡Œè°ƒæ•´</span></span><br><span class="line">    fixAfterInsertion(e);</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5bf345b5-27ff-4798-bc80-e63b974c626f-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">fixAfterInsertion</span><span class="params">(Entry&lt;K,V&gt; x)</span> &#123;</span><br><span class="line">    <span class="comment">//å› ä¸ºçº¢é»‘æ ‘çš„èŠ‚ç‚¹é»˜è®¤å°±æ˜¯çº¢è‰²çš„</span></span><br><span class="line">    x.color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒ‰ç…§çº¢é»‘è§„åˆ™è¿›è¡Œè°ƒæ•´</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//parentOf:è·å–xçš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">//parentOf(parentOf(x)):è·å–xçš„çˆ·çˆ·èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">//leftOf:è·å–å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (x != <span class="literal">null</span> &amp;&amp; x != root &amp;&amp; x.parent.color == RED) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çˆ·çˆ·èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹è¿˜æ˜¯å³å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">//ç›®çš„ï¼šä¸ºäº†è·å–å½“å‰èŠ‚ç‚¹çš„å”å”èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (parentOf(x) == leftOf(parentOf(parentOf(x)))) &#123;</span><br><span class="line">            <span class="comment">//è¡¨ç¤ºå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çˆ·çˆ·èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">//é‚£ä¹ˆä¸‹é¢å°±å¯ä»¥ç”¨rightOfè·å–åˆ°å½“å‰èŠ‚ç‚¹çš„å”å”èŠ‚ç‚¹</span></span><br><span class="line">            Entry&lt;K,V&gt; y = rightOf(parentOf(parentOf(x)));</span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line">                <span class="comment">//å”å”èŠ‚ç‚¹ä¸ºçº¢è‰²çš„å¤„ç†æ–¹æ¡ˆ</span></span><br><span class="line">                <span class="comment">//æŠŠçˆ¶èŠ‚ç‚¹è®¾ç½®ä¸ºé»‘è‰²</span></span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                <span class="comment">//æŠŠå”å”èŠ‚ç‚¹è®¾ç½®ä¸ºé»‘è‰²</span></span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line">                <span class="comment">//æŠŠçˆ·çˆ·èŠ‚ç‚¹è®¾ç½®ä¸ºçº¢è‰²</span></span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                <span class="comment">//æŠŠçˆ·çˆ·èŠ‚ç‚¹è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹</span></span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//å”å”èŠ‚ç‚¹ä¸ºé»‘è‰²çš„å¤„ç†æ–¹æ¡ˆ</span></span><br><span class="line">                <span class="comment">//è¡¨ç¤ºåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºçˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span> (x == rightOf(parentOf(x))) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//è¡¨ç¤ºå½“å‰èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹</span></span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    <span class="comment">//å·¦æ—‹</span></span><br><span class="line">                    rotateLeft(x);</span><br><span class="line">                &#125;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateRight(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//è¡¨ç¤ºå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çˆ·çˆ·èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">//é‚£ä¹ˆä¸‹é¢å°±å¯ä»¥ç”¨leftOfè·å–åˆ°å½“å‰èŠ‚ç‚¹çš„å”å”èŠ‚ç‚¹</span></span><br><span class="line">            Entry&lt;K,V&gt; y = leftOf(parentOf(parentOf(x)));</span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (x == leftOf(parentOf(x))) &#123;</span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    rotateRight(x);</span><br><span class="line">                &#125;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateLeft(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠŠæ ¹èŠ‚ç‚¹è®¾ç½®ä¸ºé»‘è‰²</span></span><br><span class="line">    root.color = BLACK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="æ€è€ƒé¢˜">æ€è€ƒé¢˜</h3><blockquote><p>TreeMapæ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œé”®æ˜¯å¦éœ€è¦é‡å†™hashCodeå’Œequalsæ–¹æ³•ï¼Ÿ</p></blockquote><p>æ­¤æ—¶æ˜¯ä¸éœ€è¦é‡å†™çš„</p><p>åœ¨Javaä¸­ï¼Œ<code>TreeMap</code> æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„ï¼Œå®ƒçš„å…ƒç´ æ’åºæ˜¯æ ¹æ® key çš„è‡ªç„¶é¡ºåºæˆ–è€…æ ¹æ®æä¾›çš„æ¯”è¾ƒå™¨ï¼ˆ<code>Comparator</code>ï¼‰æ¥å®ç°çš„ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ <code>TreeMap</code> æ—¶ï¼Œæ— éœ€é‡å†™ key çš„ <code>hashCode</code> å’Œ <code>equals</code> æ–¹æ³•ã€‚ç›¸åï¼Œä½ éœ€è¦ç¡®ä¿ key ç±»å®ç°äº† <code>Comparable</code> æ¥å£æˆ–è€…å‘ <code>TreeMap</code> æä¾›ä¸€ä¸ª <code>Comparator</code> å®ä¾‹ã€‚</p><blockquote><p>HashMapæ˜¯å“ˆå¸Œè¡¨ç»“æ„çš„ï¼ŒJDK8å¼€å§‹ç”±æ•°ç»„ï¼Œé“¾è¡¨ï¼Œçº¢é»‘æ ‘ç»„æˆçš„ï¼Œæ—¢ç„¶æœ‰çº¢é»‘æ ‘ï¼ŒHashMapçš„é”®æ˜¯å¦éœ€è¦å®ç°Compareableæ¥å£æˆ–è€…ä¼ é€’æ¯”è¾ƒå™¨å¯¹è±¡å‘¢ï¼Ÿ</p></blockquote><p>ä¸éœ€è¦çš„ã€‚</p><p>å› ä¸ºåœ¨HashMapçš„åº•å±‚ï¼Œé»˜è®¤æ˜¯åˆ©ç”¨å“ˆå¸Œå€¼çš„å¤§å°å…³ç³»æ¥åˆ›å»ºçº¢é»‘æ ‘çš„</p><blockquote><p>TreeMapå’ŒHashMapè°çš„æ•ˆç‡æ›´é«˜ï¼Ÿ</p></blockquote><p>å¦‚æœæ˜¯æœ€åæƒ…å†µï¼Œæ·»åŠ äº†8ä¸ªå…ƒç´ ï¼Œè¿™8ä¸ªå…ƒç´ å½¢æˆäº†é“¾è¡¨ï¼Œæ­¤æ—¶TreeMapçš„æ•ˆç‡è¦æ›´é«˜</p><p>ä½†æ˜¯è¿™ç§æƒ…å†µå‡ºç°çš„å‡ ç‡éå¸¸çš„å°‘ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œè¿˜æ˜¯HashMapçš„æ•ˆç‡è¦æ›´é«˜ã€‚</p><blockquote><p>ä½ è§‰å¾—åœ¨Mapé›†åˆä¸­ï¼Œjavaä¼šæä¾›ä¸€ä¸ªå¦‚æœé”®é‡å¤äº†ï¼Œä¸ä¼šè¦†ç›–çš„putæ–¹æ³•å‘¢ï¼Ÿ</p></blockquote><p>putIfAbsent</p><p>ä¼ é€’ä¸€ä¸ªæ€æƒ³ï¼š</p><p>â€‹    ä»£ç ä¸­çš„é€»è¾‘éƒ½æœ‰ä¸¤é¢æ€§ï¼Œå¦‚æœæˆ‘ä»¬åªçŸ¥é“äº†å…¶ä¸­çš„Aé¢ï¼Œè€Œä¸”ä»£ç ä¸­è¿˜å‘ç°äº†æœ‰å˜é‡å¯ä»¥æ§åˆ¶ä¸¤é¢æ€§çš„å‘ç”Ÿã€‚</p><p>â€‹    é‚£ä¹ˆè¯¥é€»è¾‘ä¸€å®šä¼šæœ‰Bé¢ã€‚</p><p>â€‹    ä¹ æƒ¯ï¼š</p><p>â€‹        booleanç±»å‹çš„å˜é‡æ§åˆ¶ï¼Œä¸€èˆ¬åªæœ‰ABä¸¤é¢ï¼Œå› ä¸ºbooleanåªæœ‰ä¸¤ä¸ªå€¼</p><p>â€‹        intç±»å‹çš„å˜é‡æ§åˆ¶ï¼Œä¸€èˆ¬è‡³å°‘æœ‰ä¸‰é¢ï¼Œå› ä¸ºintå¯ä»¥å–å¤šä¸ªå€¼ã€‚</p><p>â€‹</p><blockquote><p>ä¸‰ç§åŒåˆ—é›†åˆï¼Œä»¥åå¦‚ä½•é€‰æ‹©ï¼Ÿ</p></blockquote><p>â€‹    HashMap LinkedHashMap TreeMap</p><p>â€‹    é»˜è®¤ï¼šHashMapï¼ˆæ•ˆç‡æœ€é«˜ï¼‰</p><p>â€‹    å¦‚æœè¦ä¿è¯å­˜å–æœ‰åºï¼šLinkedHashMap</p><p>â€‹    å¦‚æœè¦è¿›è¡Œæ’åºï¼šTreeMap</p>]]></content>
    
    
    <summary type="html">HashMapã€TreeMapè§£æ</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>åŒåˆ—é›†åˆæ¥å£Map</title>
    <link href="https://wuwawawa.github.io/posts/eee6e16.html"/>
    <id>https://wuwawawa.github.io/posts/eee6e16.html</id>
    <published>2023-05-22T08:08:46.000Z</published>
    <updated>2023-05-22T09:56:58.464Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Mapç»§æ‰¿ä½“ç³»">Mapç»§æ‰¿ä½“ç³»</h2><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522164255312.png" alt="image-20230522164255312" style="zoom:67%;" /><p>åŒåˆ—é›†åˆçš„ç‰¹ç‚¹</p><p>â‘  åŒåˆ—é›†åˆä¸€æ¬¡éœ€è¦å­˜ä¸€å¯¹æ•°æ®ï¼Œåˆ†åˆ«ä¸ºé”®å’Œå€¼</p><p>â‘¡ é”®ä¸èƒ½é‡å¤ï¼Œå€¼å¯ä»¥é‡å¤</p><p>â‘¢ é”®å’Œå€¼æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ¯ä¸€ä¸ªé”®åªèƒ½æ‰¾åˆ°è‡ªå·±å¯¹åº”çš„å€¼</p><p>â‘£ é”®+å€¼è¿™ä¸ªæ•´ä½“æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œé”®å€¼å¯¹â€æˆ–è€…â€œé”®å€¼å¯¹å¯¹è±¡â€ï¼Œåœ¨Javaä¸­å«åš â€œEntryå¯¹è±¡â€</p><hr><hr><h2 id="Mapæ¥å£å¸¸è§æ–¹æ³•">Mapæ¥å£å¸¸è§æ–¹æ³•</h2><p>Mapæ˜¯åŒåˆ—é›†åˆçš„é¡¶å±‚æ¥å£ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å…¨éƒ¨åŒåˆ—é›†åˆéƒ½å¯ä»¥ç»§æ‰¿ä½¿ç”¨çš„</p><p>å¾€Mapé›†åˆä¸­æ·»åŠ keyå·²ç»å­˜åœ¨çš„æ–°é”®å€¼å¯¹ï¼Œä¼šè¦†ç›–åŸæ¥çš„é”®å€¼å¯¹ã€‚</p><table><thead><tr><th style="text-align:left">æ–¹æ³•åç§°</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left"><code>V put(K key, V value)</code></td><td style="text-align:left">æ·»åŠ å…ƒç´ </td></tr><tr><td style="text-align:left"><code>V remove(Object key)</code></td><td style="text-align:left">æ ¹æ®é”®åˆ é™¤é”®å€¼å¯¹å…ƒç´ </td></tr><tr><td style="text-align:left"><code>V get(Object key)</code></td><td style="text-align:left">æ ¹æ®keyè·å–value</td></tr><tr><td style="text-align:left"><code>V getOrDefault(Object key, V defaultValue)</code></td><td style="text-align:left">æ ¹æ®keyè·å–valueï¼Œå¸¦é»˜è®¤å€¼</td></tr><tr><td style="text-align:left"><code>void clear()</code></td><td style="text-align:left">ç§»é™¤æ‰€æœ‰çš„é”®å€¼å¯¹å…ƒç´ </td></tr><tr><td style="text-align:left"><code>boolean containsKey(Object key)</code></td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«æŒ‡å®šçš„é”®</td></tr><tr><td style="text-align:left"><code>boolean containsValue(Object value)</code></td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«æŒ‡å®šçš„å€¼</td></tr><tr><td style="text-align:left"><code>boolean isEmpty()</code></td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</td></tr><tr><td style="text-align:left"><code>int size()</code></td><td style="text-align:left">é›†åˆçš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯é›†åˆä¸­é”®å€¼å¯¹çš„ä¸ªæ•°</td></tr><tr><td style="text-align:left"><code>void putAll(Map&lt;? extends K, ? extends V&gt; m)</code></td><td style="text-align:left">æ·»åŠ å¤šä¸ªé”®å€¼å¯¹</td></tr><tr><td style="text-align:left"><code>Set&lt;K&gt; keySet()</code></td><td style="text-align:left">è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰keyå…ƒç´ çš„Seté›†åˆ</td></tr><tr><td style="text-align:left"><code>Collection&lt;V&gt; values()</code></td><td style="text-align:left">è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰valueå…ƒç´ çš„Collectioné›†åˆ</td></tr><tr><td style="text-align:left"><code>Set&lt;Map.Entry&lt;K, V&gt;&gt; entrySet()</code></td><td style="text-align:left">è¿”å›Mapé›†åˆä¸­æ‰€æœ‰é”®å€¼å¯¹çš„ä¸€ä¸ªSeté›†åˆ</td></tr><tr><td style="text-align:left"><code>void forEach(BiConsumer&lt;? super K, ? super V&gt; action)</code></td><td style="text-align:left">ç»“åˆlambdaéå†é›†åˆ</td></tr></tbody></table><blockquote><p>æ·»åŠ å…ƒç´ V put(K key, V value)</p></blockquote><p>åœ¨æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœé”®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆç›´æŒ‰æŠŠé”®å€¼å¯¹å¯¹è±¡æ·»åŠ åˆ°mapé›†åˆå½“ä¸­ï¼Œæ–¹æ³•è¿”å›nullã€‚</p><p>åœ¨æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœå¥æ˜¯å­˜åœ¨çš„ï¼Œé‚£ä¹ˆä¼šæŠŠåŸæœ‰çš„é”®å€¼å¯¹å¯¹è±¡è¦†ç›–ã€‚ä¼šæŠŠè¢«è¦†ç›–çš„å€¼è¿›è¡Œè¿”å›ã€‚</p><hr><hr><h2 id="Mapéå†æ–¹å¼">Mapéå†æ–¹å¼</h2><div class="tabs" id="cc6a501f-d013-469f-bffd-54511506df74"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#cc6a501f-d013-469f-bffd-54511506df74-1"><i class="fas fa-cat"></i>é”®æ‰¾å€¼</button></li><li class="tab"><button type="button" data-href="#cc6a501f-d013-469f-bffd-54511506df74-2"><i class="fas fa-horse"></i>é”®å€¼å¯¹</button></li><li class="tab"><button type="button" data-href="#cc6a501f-d013-469f-bffd-54511506df74-3"><i class="fas fa-dove"></i>Lambdaè¡¨è¾¾å¼</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="cc6a501f-d013-469f-bffd-54511506df74-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºMapé›†åˆçš„å¯¹è±¡</span></span><br><span class="line">HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.æ·»åŠ å…ƒç´ </span></span><br><span class="line">map.put(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;22&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;333&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.é€šè¿‡é”®æ‰¾å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.1è·å–æ‰€æœ‰çš„é”®</span></span><br><span class="line">Set&lt;String&gt; keySet = map.keySet();</span><br><span class="line"><span class="comment">//3.2éå†å•åˆ—é›†åˆï¼Œè·å–value</span></span><br><span class="line"><span class="keyword">for</span> (String key : keySet) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> map.get(key);</span><br><span class="line">    System.out.println(<span class="string">&quot;key = &quot;</span> + key);</span><br><span class="line">    System.out.println(<span class="string">&quot;value = &quot;</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>key = 1<br>value = 1<br>key = 2<br>value = 22<br>key = 3<br>value = 333</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="cc6a501f-d013-469f-bffd-54511506df74-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºMapé›†åˆçš„å¯¹è±¡</span></span><br><span class="line">HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.æ·»åŠ å…ƒç´ </span></span><br><span class="line">map.put(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;22&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;333&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.é€šè¿‡é”®å€¼å¯¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.1è·å–æ‰€æœ‰çš„é”®å€¼å¯¹</span></span><br><span class="line">Set&lt;Map.Entry&lt;String, String&gt;&gt; entrySet = map.entrySet();</span><br><span class="line"><span class="comment">//3.2éå†å•åˆ—é›†åˆï¼Œè·å–keyå’Œvalue</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : entrySet) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">    System.out.println(<span class="string">&quot;key = &quot;</span> + key);</span><br><span class="line">    System.out.println(<span class="string">&quot;value = &quot;</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="cc6a501f-d013-469f-bffd-54511506df74-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºMapé›†åˆçš„å¯¹è±¡</span></span><br><span class="line">HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.æ·»åŠ å…ƒç´ </span></span><br><span class="line">map.put(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;22&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;333&quot;</span>);</span><br><span class="line"></span><br><span class="line">map.forEach((key,value)-&gt;&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;key = &quot;</span> + key);</span><br><span class="line">    System.out.println(<span class="string">&quot;value = &quot;</span> + value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="Map-Entryè¯´æ˜">Map.Entryè¯´æ˜</h2><p>Mapæ˜¯javaä¸­çš„æ¥å£ï¼Œ<code>Map.Entry</code>æ˜¯Mapçš„ä¸€ä¸ªå†…éƒ¨æ¥å£ã€‚ç‚¹è¿›Mapä¸­ï¼Œåœ¨æºç 375è¡Œçš„ä½ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Entry</span>&lt;K,V&gt; &#123;</span><br><span class="line"></span><br><span class="line">        K <span class="title function_">getKey</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">        V <span class="title function_">getValue</span><span class="params">()</span>;</span><br><span class="line">            </span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Mapæä¾›äº†ä¸€äº›å¸¸ç”¨æ–¹æ³•ï¼Œå¦‚<code>keySet()</code>ã€<code>entrySet()</code>ç­‰æ–¹æ³•ï¼Œ<code>keySet()</code>æ–¹æ³•è¿”å›å€¼æ˜¯Mapä¸­keyå€¼çš„é›†åˆï¼›<code>entrySet()</code>çš„è¿”å›å€¼ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªSeté›†åˆï¼Œæ­¤é›†åˆçš„ç±»å‹ä¸º<code>Map.Entry</code>ã€‚</p><p><code>Map.Entry</code>æ˜¯Mapå£°æ˜çš„ä¸€ä¸ªå†…éƒ¨æ¥å£ï¼Œæ­¤æ¥å£ä¸ºæ³›å‹æ¥å£ï¼Œå®šä¹‰ä¸º<code>Entry&lt;K,V&gt;</code>ã€‚å®ƒè¡¨ç¤ºMapä¸­çš„ä¸€ä¸ªå®ä½“ï¼ˆä¸€ä¸ªkey-valueå¯¹ï¼‰ã€‚æ¥å£ä¸­æœ‰getKey(),getValueæ–¹æ³•ã€‚</p><blockquote><p>Map.Entryä½¿ç”¨</p></blockquote><p>é€šå¸¸æ˜¯éå†æ—¶ä¼šä½¿ç”¨å®ƒï¼ŒMapå¹¶æ²¡ç”¨ç»§æ‰¿Collectionæ¥å£ï¼Œå¹¶ä¸èƒ½ä½¿ç”¨è¿­ä»£å™¨éå†ã€‚</p><p>ä»¥å‰ï¼Œæˆ‘ä»¬ä¾¿åˆ©ä¸€ä¸ªMapé›†åˆæ—¶ï¼Œéœ€è¦è·å–keyçš„å€¼ï¼Œç„¶åå†è·å–valueçš„å€¼ï¼Œç¨å¾®æœ‰äº¿ç‚¹ç‚¹éº»çƒ¦ï¼Œéº»çƒ¦è¿˜æ˜¯æ¬¡è¦çš„ï¼Œä¸»è¦æ˜¯ä»Mapä¸­å–å¾—å…³é”®å­—ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»æ¯æ¬¡é‡å¤è¿”å›åˆ°Mapä¸­å–å¾—ç›¸å¯¹çš„å€¼ï¼Œè¿™æ˜¯å¾ˆç¹çå’Œè´¹æ—¶çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ›´åŠ ç®€å•çš„é€”å¾„ã€‚Mapç±»æä¾›äº†ä¸€ä¸ªç§°ä¸ºentrySet()çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>Set&lt;Map.Entry&lt;K, V&gt;&gt;</code>ã€‚æ¥ç€ï¼Œ<code>Map.Entry</code>ç±»æä¾›äº†ä¸€ä¸ª<code>getKey()</code>æ–¹æ³•å’Œä¸€ä¸ª<code>getValue()</code>æ–¹æ³•ï¼Œå› æ­¤ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥è¢«ç»„ç»‡å¾—æ›´ç¬¦åˆé€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">map.put(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">map.put(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">map.put(<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">map.put(<span class="number">7</span>,<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">Set&lt;Map.Entry&lt;Integer, Integer&gt;&gt; entrySet = map.entrySet();</span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; next : entrySet) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">key</span> <span class="operator">=</span> next.getKey();</span><br><span class="line">    <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> next.getValue();</span><br><span class="line">    System.out.println(<span class="string">&quot;key = &quot;</span> + key);</span><br><span class="line">    System.out.println(<span class="string">&quot;value = &quot;</span> + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Mapç»§æ‰¿ä½“ç³»ã€æ¥å£æ–¹æ³•ã€éå†æ–¹å¼</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>å †PriorityQueueå’ŒArrayDeque</title>
    <link href="https://wuwawawa.github.io/posts/c320ea51.html"/>
    <id>https://wuwawawa.github.io/posts/c320ea51.html</id>
    <published>2023-05-22T00:21:06.000Z</published>
    <updated>2023-05-23T12:27:33.433Z</updated>
    
    <content type="html"><![CDATA[<img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230521200611562.png" alt="image-20230521200611562" style="zoom: 50%;" /><h2 id="PriorityQueue">PriorityQueue</h2><h3 id="æ•°æ®ç»“æ„-å †">æ•°æ®ç»“æ„-å †</h3><p>å‰é¢ä»‹ç»è¿‡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡º(FIFO)çš„æ•°æ®ç»“æ„ï¼Œä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œæ“ä½œçš„æ•°æ®å¯èƒ½å¸¦æœ‰ä¼˜å…ˆçº§ï¼Œä¸€èˆ¬å‡ºé˜Ÿåˆ—æ—¶ï¼Œå¯èƒ½éœ€è¦ä¼˜å…ˆçº§é«˜çš„å…ƒç´ å…ˆå‡ºé˜Ÿåˆ—ï¼Œè¯¥åœºæ™¯ä¸‹ï¼Œä½¿ç”¨é˜Ÿåˆ—æ˜¾ç„¶ä¸åˆé€‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®ç»“æ„åº”è¯¥æä¾›ä¸¤ä¸ªæœ€åŸºæœ¬çš„æ“ä½œï¼Œä¸€ä¸ªæ˜¯è¿”å›æœ€é«˜ä¼˜å…ˆçº§å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯æ·»åŠ æ–°çš„å¯¹è±¡ã€‚è¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—(Priority Queue)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PriorityQueue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line">queue.offer(<span class="number">50</span>);</span><br><span class="line">queue.offer(<span class="number">60</span>);</span><br><span class="line">queue.offer(<span class="number">30</span>);</span><br><span class="line">queue.offer(<span class="number">25</span>);</span><br><span class="line">queue.offer(<span class="number">70</span>);</span><br><span class="line">queue.offer(<span class="number">20</span>);</span><br><span class="line">queue.offer(<span class="number">10</span>);</span><br><span class="line">queue.offer(<span class="number">40</span>);</span><br><span class="line">System.out.println(queue);</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼š[10, 30, 20, 40, 70, 50, 25, 60]</span></span><br></pre></td></tr></table></figure><blockquote><p>è§‚å¯Ÿä¸€ä¸‹å…ƒç´ æ‰“å°é¡ºåºæœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿèƒ½ä¸èƒ½ç”¨å·²çŸ¥çš„æŸç§çš„æ•°æ®ç»“æ„æ¥æè¿°PriorityQueueè¿™æ ·çš„é›†åˆå‘¢ï¼Ÿ</p></blockquote><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™äº›å…ƒç´ å¹¶ä¸æ˜¯æŒ‰æ·»åŠ é¡ºåºæ‰“å°çš„ï¼Œæ’é™¤äº†çº¿æ€§è¡¨ã€é“¾è¡¨ã€é˜Ÿåˆ—è¿™ä¸‰ç§çš„å¯èƒ½æ€§ã€‚</p><p>å…¶æ¬¡ï¼Œæ‰“å°çš„é¡ºåºå¹¶ä¸æ˜¯æŒ‰ç…§å…ƒç´ çš„å‡åºæˆ–é™åºæ’åˆ—çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ’é™¤äº†æœ‰åºæ•°ç»„ã€äºŒå‰æ’åºæ ‘çš„å¯èƒ½æ€§ã€‚</p><p>é‚£ä¹ˆå‰©ä¸‹çš„å°±åªå‰©ä¸‹å“ˆå¸Œè¡¨å’Œ<span class='p green'>å †</span>äº†ã€‚</p><blockquote><mark class="hl-label green">å †çš„æ€§è´¨</mark> </blockquote><p>å †æ˜¯ä¸€ç§<span class='p blue'>ç‰¹æ®Šçš„æ ‘</span>ã€‚</p><p>åªè¦æ»¡è¶³ä»¥ä¸‹ä¸¤ç‚¹ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå †ï¼š</p><ul><li>å †æ˜¯ä¸€ä¸ª<span class='p green'>å®Œå…¨äºŒå‰æ ‘</span></li><li>å †ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¿…é¡»å¤§äºç­‰äºï¼ˆæˆ–å°äºç­‰äºï¼‰å…¶å­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼</li></ul><p>ç¬¬ä¸€ç‚¹ï¼Œå †å¿…é¡»æ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ã€‚å®Œå…¨äºŒå‰æ ‘è¦æ±‚ï¼Œé™¤äº†æœ€åä¸€å±‚ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹ä¸ªæ•°éƒ½æ˜¯æ»¡çš„ï¼Œæœ€åä¸€å±‚çš„èŠ‚ç‚¹éƒ½é å·¦æ’åˆ—ï¼Œè‡ªç„¶å †ä¹Ÿå…·æœ‰å®Œå…¨äºŒå‰æ ‘çš„æ‰€æœ‰æ€§è´¨</p><p>ç¬¬äºŒç‚¹ï¼Œå †ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹çš„å€¼å¿…é¡»å¤§äºç­‰äºï¼ˆæˆ–è€…å°äºç­‰äºï¼‰å…¶å­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ¢ä¸€ç§è¯´æ³•ï¼Œå †ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºï¼ˆæˆ–è€…å°äºç­‰äºï¼‰å…¶å·¦å³å­èŠ‚ç‚¹çš„å€¼ã€‚è¿™ä¸¤ç§è¡¨è¿°æ˜¯ç­‰ä»·çš„ã€‚</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºç­‰äºå­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å€¼çš„å †ï¼Œæˆ‘ä»¬å«åš<code>å¤§é¡¶å †</code>ã€‚</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å°äºç­‰äºå­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å€¼çš„å †ï¼Œæˆ‘ä»¬å«åš<code>å°é¡¶å †</code>ã€‚</p><p>å¦‚æœè¦è·å¾—æœ‰åºçš„ç‰¹æ€§ï¼Œ é€ä¸ªå‡ºé˜Ÿ(poll) ï¼šè¡Œ! ç”¨è¿­ä»£å™¨ï¼šä¸è¡Œ!</p><hr><h3 id="æºç å®ç°">æºç å®ç°</h3><blockquote><p>å­˜å‚¨æ–¹å¼</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é»˜è®¤æ•°ç»„å¤§å°</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_INITIAL_CAPACITY</span> <span class="operator">=</span> <span class="number">11</span>;</span><br><span class="line"><span class="comment">//å­˜å‚¨å…ƒç´ çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">transient</span> Object[] queue;</span><br><span class="line"><span class="comment">//é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">//å¦‚æœcomparatorä¸ºnullï¼Œåˆ™é˜Ÿåˆ—æŒ‰ç…§å…ƒç´ è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºï¼Œå¦åˆ™æŒ‰ç…§comparatoræŒ‡å®šçš„é¡ºåºè¿›è¡Œæ’åº</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;? <span class="built_in">super</span> E&gt; comparator;</span><br><span class="line"><span class="comment">//é˜Ÿåˆ—è¢«ä¿®æ”¹çš„æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">transient</span> <span class="type">int</span> <span class="variable">modCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>å †åº•å±‚æ˜¯ç”¨æ•°ç»„å®ç°ï¼Œå…¶ä¸­queue[n]çš„ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸ºqueue[2n+1]å’Œqueue[2(n+1)]ã€‚</p><hr><h4 id="å †çš„æ’å…¥">å †çš„æ’å…¥</h4><p>offerå‡½æ•°æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š</p><ul><li><p>å¦‚æœå †ä¸ºç©ºï¼Œåˆ™æ— éœ€æ‰©å®¹ï¼Œä¹Ÿæ— éœ€è°ƒæ•´</p></li><li><p>å¦åˆ™ï¼š</p><p>1ã€åˆ¤æ–­æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚éœ€è¦è°ƒç”¨growæ–¹æ³•<br>2ã€æ’å…¥å…ƒç´ åï¼Œæœ‰å¯èƒ½ç ´åäº†å †çš„å¹³è¡¡ï¼Œè°ƒç”¨siftUp(ä¸Šæ»¤)æ–¹æ³•è°ƒæ•´å †è‡³å¹³è¡¡</p></li></ul><div class="tabs" id="eddc6051-32c1-445c-8877-50ed82a70a46"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#eddc6051-32c1-445c-8877-50ed82a70a46-1"><i class="fas fa-cat"></i>offerå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#eddc6051-32c1-445c-8877-50ed82a70a46-2"><i class="fas fa-horse"></i>growå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#eddc6051-32c1-445c-8877-50ed82a70a46-3"><i class="fas fa-dove"></i>siftUpå‡½æ•°</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="eddc6051-32c1-445c-8877-50ed82a70a46-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">offer</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= queue.length)</span><br><span class="line">        grow(i + <span class="number">1</span>);</span><br><span class="line">    size = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">        queue[<span class="number">0</span>] = e;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        siftUp(i, e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="eddc6051-32c1-445c-8877-50ed82a70a46-2"><p>å †çš„æ‰©å®¹ä¸ArrayListç›¸ä¼¼ï¼š</p><ul><li>è‹¥æ•°ç»„å®¹é‡å°äº64ï¼Œæ‰©å¤§ä¸ºåŸæ¥å®¹é‡çš„2å€+2</li><li>è‹¥æ•°ç»„å®¹é‡å¤§äºç­‰äº64ï¼Œæ‰©å¤§ä¸ºåŸæ¥çš„1.5å€</li><li>å°†åŸæ¥çš„æ•°ç»„æ‹·è´åˆ°æ–°çš„æ•°ç»„ï¼Œå¹¶ä¸¢å¼ƒåŸæ¥çš„æ•°ç»„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">grow</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> queue.length;</span><br><span class="line">    <span class="comment">// Double size if small; else grow by 50%</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + ((oldCapacity &lt; <span class="number">64</span>) ?</span><br><span class="line">                                     (oldCapacity + <span class="number">2</span>) :</span><br><span class="line">                                     (oldCapacity &gt;&gt; <span class="number">1</span>));</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    queue = Arrays.copyOf(queue, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="eddc6051-32c1-445c-8877-50ed82a70a46-3"><p>ä»¥å°æ ¹å †ä¸ºä¾‹ï¼š</p><p>è‡ªåº•å‘ä¸Šï¼Œä¸æ–­æ¯”è¾ƒã€äº¤æ¢</p><p>å‡è®¾æ’å…¥å…ƒç´ E,æŠŠEæ’å…¥åˆ°å †çš„æœ«å°¾,å‡è®¾åœ¨æ•°ç»„queueçš„kä½ç½®æ’å…¥å…ƒç´ key</p><ul><li><p>ä¸æ–­çš„æ¯”è¾ƒkeyä¸kçš„çˆ¶èŠ‚ç‚¹eï¼ˆå³queue[(k-1)/2]) çš„å…³ç³»</p><p>1ã€è‹¥key&lt;eï¼Œåˆ™queue[k]=eï¼Œkå›æº¯è‡³e<br>2ã€è‹¥key&gt;=eæˆ–è€…kå·²ç»åˆ°è¾¾æ ¹èŠ‚ç‚¹ï¼Œåˆ™ç»“æŸå¾ªç¯</p></li><li><p>queue[k]=E</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftUpUsingComparator</span><span class="params">(<span class="type">int</span> k, E x)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">parent</span> <span class="operator">=</span> (k - <span class="number">1</span>) &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">e</span> <span class="operator">=</span> queue[parent];</span><br><span class="line">        <span class="keyword">if</span> (comparator.compare(x, (E) e) &gt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        queue[k] = e;</span><br><span class="line">        k = parent;</span><br><span class="line">    &#125;</span><br><span class="line">    queue[k] = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><mark class="hl-label green">æ’å…¥ç¤ºæ„å›¾</mark> <div class="tabs" id="2c1a2338-21d1-4774-a1a4-409ddc8ad324"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#2c1a2338-21d1-4774-a1a4-409ddc8ad324-1"><i class="fas fa-cat"></i>1</button></li><li class="tab"><button type="button" data-href="#2c1a2338-21d1-4774-a1a4-409ddc8ad324-2"><i class="fas fa-horse"></i>2</button></li><li class="tab"><button type="button" data-href="#2c1a2338-21d1-4774-a1a4-409ddc8ad324-3"><i class="fas fa-dove"></i>3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="2c1a2338-21d1-4774-a1a4-409ddc8ad324-1"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522095612801.png" alt="image-20230522095612801" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2c1a2338-21d1-4774-a1a4-409ddc8ad324-2"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522095647563.png" alt="image-20230522095647563" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2c1a2338-21d1-4774-a1a4-409ddc8ad324-3"><p>æ­¤æ—¶å·²ç»ç¬¦åˆå°æ ¹å †çš„è¦æ±‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522095717386.png" alt="image-20230522095717386" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h4 id="å †çš„åˆ é™¤">å †çš„åˆ é™¤</h4><p>è°ƒç”¨pollæ–¹æ³•ï¼Œä¼šåˆ é™¤å †é¡¶å…ƒç´ </p><p>åˆ é™¤ä¹‹åï¼ŒæŠŠæœ«å°¾å…ƒç´ ç›´æ¥æ”¾åˆ°å †é¡¶ï¼Œåˆ™ç ´åäº†å †çš„å¹³è¡¡</p><p>è°ƒç”¨siftDownï¼ˆä¸‹å ï¼‰å‡½æ•°ä½¿å †é‡æ–°æ¢å¤å¹³è¡¡</p><p>siftDownä¸siftUpç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯è‡ªé¡¶å‘ä¸‹</p><p>è¢«åˆ é™¤çš„å…ƒç´ ç”¨å †åº•å…ƒç´ æ›¿ä»£ï¼Œç„¶åè®©è¯¥å…ƒç´ ä¸æ–­â€œä¸‹å â€ï¼Œç›´åˆ°æ— æ³•ä¸‹å ä¸ºæ­¢</p><blockquote><p>siftDownåŸç†</p></blockquote><p>ä»¥å°æ ¹å †ä¸ºä¾‹ï¼š</p><p>è‡ªé¡¶å‘ä¸‹ï¼Œé€‰æ‹©è¾ƒå°çš„å­èŠ‚ç‚¹ï¼Œä¸æ–­æ¯”è¾ƒã€äº¤æ¢ç›´åˆ°ï¼š</p><p>1ã€ä¸‹æ ‡è¶Šç•Œ<br>2ã€èŠ‚ç‚¹çš„å€¼åŒæ—¶å°äºç­‰äºå·¦å­©å­å’Œå³å­©å­</p><p>å‡è®¾æ•°ç»„queueæœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ºkeyï¼Œä¸‹æ ‡kä»0ï¼ˆå †é¡¶ï¼‰å¼€å§‹å½“kå­˜åœ¨å·¦å­©å­æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹å¾ªç¯ï¼š</p><p>è‹¥kæœ‰å³å­©å­ï¼Œåˆ™æ¯”è¾ƒå·¦å­©å­å’Œå³å­©å­çš„å¤§å°ï¼Œå¹¶é€‰å‡ºè¾ƒå°å­©å­child æ¯”è¾ƒkeyä¸c=queuelchila]çš„å¤§å°ï¼š</p><p>1ã€ è‹¥key&lt;=cï¼Œç»“æŸå¾ªç¯<br>2ã€è‹¥key&gt;cï¼Œåˆ™queue[k]=c,k=childï¼Œç»§ç»­å¾ªç¯</p><p>æœ€åqueue[k]=key</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">siftDownUsingComparator</span><span class="params">(<span class="type">int</span> k, E x)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">half</span> <span class="operator">=</span> size &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k &lt; half) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">child</span> <span class="operator">=</span> (k &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">c</span> <span class="operator">=</span> queue[child];</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> child + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (right &lt; size &amp;&amp;</span><br><span class="line">            comparator.compare((E) c, (E) queue[right]) &gt; <span class="number">0</span>)</span><br><span class="line">            c = queue[child = right];</span><br><span class="line">        <span class="keyword">if</span> (comparator.compare(x, (E) c) &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        queue[k] = c;</span><br><span class="line">        k = child;</span><br><span class="line">    &#125;</span><br><span class="line">    queue[k] = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="å †çš„å»ºç«‹">å †çš„å»ºç«‹</h4><p>å½“æ„é€ å‡½æ•°ä¼ å…¥ä¸€ä¸ªé›†åˆçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ heapifyæ–¹æ³•è¿›è¡Œå †çš„è°ƒæ•´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initFromCollection</span><span class="params">(Collection&lt;? extends E&gt; c)</span> &#123;</span><br><span class="line">    initElementsFromCollection(c);</span><br><span class="line">    heapify();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">heapify</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> (size &gt;&gt;&gt; <span class="number">1</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        siftDown(i, (E) queue[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><mark class="hl-label blue">æ¼”ç¤º</mark> <p>è°ƒæ•´ä¸ºæœ€å°å †</p><p>i = (size &gt;&gt;&gt; 1) - 1æ‰¾åˆ°ç¬¬ä¸€ä¸ªéå¶å­èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230522101817238.png" alt="image-20230522101817238" style="zoom:67%;" /><hr><h3 id="å †æ’åº">å †æ’åº</h3><p>ç»™å®šæ— åºæ•°ç»„arrayï¼Œé•¿åº¦ä¸ºnï¼Œå°†æ•°ç»„æ’æˆæœ‰åºåºåˆ—</p><p>è¦æ±‚æ—¶é—´å¤æ‚åº¦ä¸ºO(NlogN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1ï¼‰</p><div class="tabs" id="c4068611-0241-463f-bdf4-6d2e574df7e0"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#c4068611-0241-463f-bdf4-6d2e574df7e0-1"><i class="fas fa-award"></i>æ–¹æ¡ˆä¸€</button></li><li class="tab"><button type="button" data-href="#c4068611-0241-463f-bdf4-6d2e574df7e0-2"><i class="fas fa-baseball-ball"></i>æ–¹æ¡ˆäºŒ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="c4068611-0241-463f-bdf4-6d2e574df7e0-1"><p>åˆ©ç”¨PriorityQueue</p><p>1ã€æ–°å»ºå¦å¤–ä¸€ä¸ªæœ€å°å †<br>2ã€è°ƒç”¨Næ¬¡offeræ–¹æ³•ï¼Œå°†å…ƒç´ ä¾æ¬¡æ’å…¥æœ€å°å †T1 (N)=O(NlogN)ï¼ŒS1(N)=O(N)<br>3ã€æ‰§è¡Œnæ¬¡pollï¼ŒæŠŠå †é¡¶å…ƒç´ ä¾æ¬¡å¤åˆ¶è¿›åŸæ•°ç»„ï¼ŒT2(N)=O(NlogN)ï¼ŒS(N)=0(1)</p><p>æ€»æ—¶é—´å¤æ‚åº¦T(N)=O(NlogN)+O(NlogN)=O(NlogN)</p><p>æ€»ç©ºé—´å¤æ‚åº¦S(N)=O(N)+0(1)+O(N)</p><p>é¢è¯•å®˜å¯èƒ½ä¼šé—®ä½ </p><p>å¯å¦æŠŠç©ºé—´å¤æ‚åº¦ä¼˜åŒ–ä¸ºO(1)ï¼Ÿ</p><p>é‚£å°±éœ€è¦ç”¨åˆ°æ–¹æ¡ˆäºŒ</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c4068611-0241-463f-bdf4-6d2e574df7e0-2"><p>å †æ’åºï¼ŒHeapSort</p><p>å°†æ•°ç»„æœ¬èº«çœ‹æˆæœ€å¤§å †ï¼Œå€ŸåŠ©heapifyå‡½æ•°ï¼Œå°†æ•°ç»„æ„é€ æˆæœ€å¤§å †</p><p>1ã€åˆ©ç”¨heapifyå‡½æ•°æ€è·¯ï¼Œæ„å»º<span class='p green'>æœ€å¤§å †</span><br>2ã€ç§»é™¤å †é¡¶å…ƒç´ ï¼Œäº¤æ¢åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œ<span class='p red'>å¹¶è®©å †çš„å¤§å°å‡å°‘1</span>ï¼Œå†è°ƒç”¨siftDown<br>3ã€ä¸æ–­æ‰§è¡Œ2ï¼Œç›´åˆ°å †çš„å¤§å°ä¸º1ï¼Œæ’åºå®Œæ¯•</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="å¤§é¡¶å †å°é¡¶å †">å¤§é¡¶å †å°é¡¶å †</h3><p>ä»¥å­˜å‚¨Integerä¸ºä¾‹</p><div class="tabs" id="e0dd0eb7-e5ae-435c-8a2e-e0c5133de091"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#e0dd0eb7-e5ae-435c-8a2e-e0c5133de091-1"><i class="fas fa-cat"></i>å¤§é¡¶å †çš„å®ç°</button></li><li class="tab"><button type="button" data-href="#e0dd0eb7-e5ae-435c-8a2e-e0c5133de091-2"><i class="fas fa-horse"></i>å°é¡¶å †çš„å®ç°</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="e0dd0eb7-e5ae-435c-8a2e-e0c5133de091-1"><p><code>å¤§é¡¶å †</code>ï¼šå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½<span class='p red'>å¤§äº</span>ç­‰äºå­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å€¼çš„å †</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PriorityQueue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(</span><br><span class="line">        ((o1, o2) -&gt; o2-o1)</span><br><span class="line">);</span><br><span class="line">queue.offer(<span class="number">50</span>);</span><br><span class="line">queue.offer(<span class="number">60</span>);</span><br><span class="line">queue.offer(<span class="number">30</span>);</span><br><span class="line">queue.offer(<span class="number">25</span>);</span><br><span class="line">queue.offer(<span class="number">70</span>);</span><br><span class="line">queue.offer(<span class="number">20</span>);</span><br><span class="line">queue.offer(<span class="number">10</span>);</span><br><span class="line">queue.offer(<span class="number">40</span>);</span><br><span class="line">System.out.println(queue);</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼š[70, 60, 30, 40, 50, 20, 10, 25]</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0dd0eb7-e5ae-435c-8a2e-e0c5133de091-2"><p><code>å°é¡¶å †</code>ï¼šå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½<span class='p green'>å°äº</span>ç­‰äºå­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹å€¼çš„å †</p><p>é»˜è®¤çš„PriorityQueueå°±æ˜¯ä¸€ä¸ªå°é¡¶å †</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="ArrayDeque">ArrayDeque</h2><p>è¿™é‡Œä¸»è¦è·Ÿä»‹ç»<code>JDK</code>ç»™æˆ‘ä»¬æä¾›çš„ä¸€ç§ç”¨æ•°ç»„å®ç°çš„<span class='p green'>åŒç«¯é˜Ÿåˆ—</span>ï¼Œåœ¨ä¹‹å‰çš„æ–‡ç« æˆ‘ä»¬å·²ç»ä»‹ç»äº†ä¸€ç§<strong>åŒç«¯é˜Ÿåˆ—</strong>ï¼Œä¸è¿‡ä¸<code>ArrayDeque</code>ä¸åŒçš„æ˜¯ï¼Œ<code>LinkedList</code>çš„åŒç«¯é˜Ÿåˆ—ä½¿ç”¨åŒå‘é“¾è¡¨å®ç°çš„ã€‚</p><div class="tag link"><a class="link-card" title="LinkedListç»§æ‰¿ä½“ç³»" href="/posts/7ec37ec5.html#LinkedListç»§æ‰¿ä½“ç³»"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/favicon.png"/></div><div class="right"><p class="text">LinkedListç»§æ‰¿ä½“ç³»</p><p class="url">/posts/7ec37ec5.html#LinkedListç»§æ‰¿ä½“ç³»</p></div></a></div><blockquote><p>æ•´ä½“åˆ†æ</p></blockquote><p>æˆ‘ä»¬é€šå¸¸æ‰€è°ˆè®ºåˆ°çš„é˜Ÿåˆ—éƒ½æ˜¯ä¸€ç«¯è¿›ä¸€ç«¯å‡ºï¼Œè€ŒåŒç«¯é˜Ÿåˆ—çš„ä¸¤ç«¯åˆ™éƒ½æ˜¯å¯è¿›å¯å‡ºã€‚</p><p><code>ArrayDeque</code>åº•å±‚æ˜¯ä½¿ç”¨æ•°ç»„å®ç°çš„ï¼Œè€Œä¸”æ•°ç»„çš„é•¿åº¦å¿…é¡»æ˜¯<code>2</code>çš„æ•´æ•°æ¬¡å¹‚ï¼Œè¿™ä¹ˆæ“ä½œçš„åŸå› æ˜¯ä¸ºäº†åé¢ä½è¿ç®—å¥½æ“ä½œã€‚åœ¨<code>ArrayDeque</code>å½“ä¸­æœ‰ä¸¤ä¸ªæ•´å½¢å˜é‡<code>head</code>å’Œ<code>tail</code>ï¼Œåˆ†åˆ«æŒ‡å‘å³ä¾§çš„ç¬¬ä¸€ä¸ªè¿›å…¥é˜Ÿåˆ—çš„æ•°æ®å’Œå·¦ä¾§ç¬¬ä¸€ä¸ªè¿›è¡Œé˜Ÿåˆ—çš„æ•°æ®ï¼Œæ•´ä¸ªå†…å­˜å¸ƒå±€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715010318405-150064473.png" alt="img" style="zoom: 67%;" /><p>å…¶ä¸­<code>tail</code>æŒ‡çš„ä½ç½®æ²¡æœ‰æ•°æ®ï¼Œ<code>head</code>æŒ‡çš„ä½ç½®å­˜åœ¨æ•°æ®ã€‚</p><div class="tabs" id="6960b700-7eac-4d0a-babe-81852ff7156c"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#6960b700-7eac-4d0a-babe-81852ff7156c-1"><i class="fas fa-award"></i>1</button></li><li class="tab"><button type="button" data-href="#6960b700-7eac-4d0a-babe-81852ff7156c-2"><i class="fas fa-baseball-ball"></i>2</button></li><li class="tab"><button type="button" data-href="#6960b700-7eac-4d0a-babe-81852ff7156c-3"><i class="fas fa-bone"></i>3</button></li><li class="tab"><button type="button" data-href="#6960b700-7eac-4d0a-babe-81852ff7156c-4"><i class="fas fa-anchor"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="6960b700-7eac-4d0a-babe-81852ff7156c-1"><p>å‘é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ æ•°æ®ï¼Œå†…å­˜å½“ä¸­æ•°æ®å˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715010328930-112988730.png" alt="img" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6960b700-7eac-4d0a-babe-81852ff7156c-2"><p>é˜Ÿåˆ—å¤´éƒ¨æ·»åŠ æ•°æ®ï¼Œå†…å­˜å½“ä¸­æ•°æ®å˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715010339150-1082019999.png" alt="img" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6960b700-7eac-4d0a-babe-81852ff7156c-3"><p>é˜Ÿå°¾å…ƒç´ åˆ é™¤ï¼Œå†…å­˜å½“ä¸­æ•°æ®å˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715010352215-1154696099.png" alt="img" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6960b700-7eac-4d0a-babe-81852ff7156c-4"><p>é˜Ÿé¦–å…ƒç´ åˆ é™¤</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715010402157-1785624671.png" alt="img" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="æºç åˆ†æ">æºç åˆ†æ</h3><h4 id="å…³é”®å­—æ®µ">å…³é”®å­—æ®µ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åº•å±‚ç”¨äºå­˜å‚¨å…·ä½“æ•°æ®çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elements;</span><br><span class="line"><span class="comment">// è¿™å°±æ˜¯å‰é¢è°ˆåˆ°çš„ head</span></span><br><span class="line"><span class="keyword">transient</span> <span class="type">int</span> head;</span><br><span class="line"><span class="comment">// ä¸ä¸Šæ–‡è°ˆåˆ°çš„ tail å«ä¹‰ä¸€æ ·</span></span><br><span class="line"><span class="keyword">transient</span> <span class="type">int</span> tail;</span><br><span class="line"><span class="comment">// MIN_INITIAL_CAPACITY è¡¨ç¤ºæ•°ç»„ elements çš„æœ€çŸ­é•¿åº¦</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MIN_INITIAL_CAPACITY</span> <span class="operator">=</span> <span class="number">8</span>;</span><br></pre></td></tr></table></figure><hr><h4 id="æ„é€ å‡½æ•°">æ„é€ å‡½æ•°</h4><ul><li>é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ•°ç»„é»˜è®¤ç”³è¯·çš„é•¿åº¦ä¸º<code>16</code>ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayDeque</span><span class="params">()</span> &#123;</span><br><span class="line">    elements = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">16</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="å…³é”®å‡½æ•°">å…³é”®å‡½æ•°</h4><div class="tabs" id="e0ae5b59-a787-48a2-b770-38f92dae3c98"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-1"><i class="fas fa-seedling"></i>addLast</button></li><li class="tab"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-2"><i class="fas fa-leaf"></i>addFirst</button></li><li class="tab"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-3"><i class="fab fa-apple"></i>doubleCapacity</button></li><li class="tab"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-4"><i class="fas fa-tree"></i>æ‰©å®¹å›¾ç¤º</button></li><li class="tab"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-5"><i class="fas fa-heartbeat"></i>pollFirst</button></li><li class="tab"><button type="button" data-href="#e0ae5b59-a787-48a2-b770-38f92dae3c98-6"><i class="fas fa-cookie-bite"></i>pollLast</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tail çš„åˆå§‹å€¼ä¸º 0 </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addLast</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    elements[tail] = e;</span><br><span class="line">    <span class="comment">// è¿™é‡Œè¿›è¡Œçš„ &amp; ä½è¿ç®— ç›¸å½“äºå–ä½™æ•°æ“ä½œ</span></span><br><span class="line">    <span class="comment">// (tail + 1) &amp; (elements.length - 1) == (tail + 1) % elements.length</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ“ä½œä¸»è¦æ˜¯ç”¨äºåˆ¤æ–­æ•°ç»„æ˜¯å¦æ»¡äº†ï¼Œå¦‚æœæ»¡äº†åˆ™éœ€è¦æ‰©å®¹</span></span><br><span class="line">    <span class="comment">// åŒæ—¶è¿™ä¸ªæ“ä½œå°† tail + 1ï¼Œå³ tail = tail + 1</span></span><br><span class="line">    <span class="keyword">if</span> ( (tail = (tail + <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>)) == head)</span><br><span class="line">        doubleCapacity();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// head çš„åˆå§‹å€¼ä¸º 0 </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    <span class="comment">// è‹¥æ­¤æ—¶æ•°ç»„é•¿åº¦elements.length = 16</span></span><br><span class="line">    <span class="comment">// é‚£ä¹ˆä¸‹é¢ä»£ç æ‰§è¡Œè¿‡å head = 15</span></span><br><span class="line">    <span class="comment">// ä¸‹é¢ä»£ç çš„æ“ä½œç»“æœå’Œä¸‹é¢ä¸¤è¡Œä»£ç å«ä¹‰ä¸€è‡´</span></span><br><span class="line">    <span class="comment">// elements[(head - 1 + elements.length) % elements.length] = e</span></span><br><span class="line">    <span class="comment">// head = (head - 1 + elements.length) % elements.length</span></span><br><span class="line">    elements[head = (head - <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>)] = e;</span><br><span class="line">    <span class="keyword">if</span> (head == tail)</span><br><span class="line">        doubleCapacity();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doubleCapacity</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">assert</span> head == tail;</span><br><span class="line">    <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> elements.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> n - p; <span class="comment">// number of elements to the right of p</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> n &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Sorry, deque too big&quot;</span>);</span><br><span class="line">    Object[] a = <span class="keyword">new</span> <span class="title class_">Object</span>[newCapacity];</span><br><span class="line">    <span class="comment">// ä¸Šé¢æ˜¯å‡½æ•° System.arraycopy çš„å‡½æ•°å‚æ•°åˆ—è¡¨</span></span><br><span class="line">    System.arraycopy(elements, p, a, <span class="number">0</span>, r);</span><br><span class="line">    System.arraycopy(elements, <span class="number">0</span>, a, r, p);</span><br><span class="line">    elements = a;</span><br><span class="line">    head = <span class="number">0</span>;</span><br><span class="line">    tail = n;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-4"><p>æ‰©å®¹ä¹‹åå°†åŸæ¥æ•°ç»„çš„æ•°æ®æ‹·è´åˆ°äº†æ–°æ•°ç»„å½“ä¸­ï¼Œè™½ç„¶æ•°æ®åœ¨æ—§æ•°ç»„å’Œæ–°æ•°ç»„å½“ä¸­çš„é¡ºåºå‘ç”Ÿå˜åŒ–äº†ï¼Œä½†æ˜¯ä»–ä»¬çš„ç›¸å¯¹é¡ºåºå´æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä»–ä»¬çš„é€»è¾‘é¡ºåºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œçš„é€»è¾‘å¯èƒ½æœ‰ç‚¹ç»•ï¼Œå¤§å®¶åœ¨è¿™é‡Œå¯ä»¥å¥½å¥½æ€è€ƒä¸€ä¸‹ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220715185849697-121038371.png" alt="img" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">pollFirst</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="type">E</span> <span class="variable">result</span> <span class="operator">=</span> (E) elements[h];</span><br><span class="line">    <span class="comment">// Element is null if deque empty</span></span><br><span class="line">    <span class="keyword">if</span> (result == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    elements[h] = <span class="literal">null</span>;     <span class="comment">// Must null out slot</span></span><br><span class="line">    head = (h + <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e0ae5b59-a787-48a2-b770-38f92dae3c98-6"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">pollLast</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è®¡ç®—å‡ºå¾…åˆ é™¤çš„æ•°æ®çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> (tail - <span class="number">1</span>) &amp; (elements.length - <span class="number">1</span>);</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="type">E</span> <span class="variable">result</span> <span class="operator">=</span> (E) elements[t];</span><br><span class="line">    <span class="keyword">if</span> (result == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// å°†éœ€è¦åˆ é™¤çš„æ•°æ®çš„ä¸‹æ ‡å€¼è®¾ç½®ä¸º null è¿™æ ·è¿™å—å†…å­˜å°±</span></span><br><span class="line">    <span class="comment">// å¯ä»¥è¢«å›æ”¶äº†</span></span><br><span class="line">    elements[t] = <span class="literal">null</span>;</span><br><span class="line">    tail = t;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
    
    
    <summary type="html">å †ï¼šPriorityQueueã€ArrayDequeå’ŒLinkedList</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>é˜Ÿåˆ—æ¥å£Queue</title>
    <link href="https://wuwawawa.github.io/posts/54307854.html"/>
    <id>https://wuwawawa.github.io/posts/54307854.html</id>
    <published>2023-05-21T11:58:41.000Z</published>
    <updated>2023-05-21T14:14:35.891Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Queueä½“ç³»æ¶æ„">Queueä½“ç³»æ¶æ„</h2><p>Queueæ¥å£æä¾›äº†é˜Ÿåˆ—æ•°æ®ç»“æ„çš„åŠŸèƒ½ã€‚å®ƒç»§æ‰¿äº†Collectionæ¥å£ï¼Œ ç”¨äºä¿å­˜å°†è¦æŒ‰FIFO(å…ˆè¿›å…ˆå‡º)é¡ºåºå¤„ç†çš„å…ƒç´ ã€‚</p><p>å®ƒæ˜¯ä¸€ä¸ªæœ‰åºçš„å¯¹è±¡åˆ—è¡¨ï¼Œå…¶ç”¨é€”ä»…é™äºåœ¨åˆ—è¡¨æœ«å°¾æ’å…¥å…ƒç´ å’Œä»åˆ—è¡¨å¼€å¤´åˆ é™¤å…ƒç´ ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230521200611562.png" alt="image-20230521200611562" style="zoom: 50%;" /><hr><hr><h2 id="Queueæ¥å£çš„æ–¹æ³•">Queueæ¥å£çš„æ–¹æ³•</h2><p>Queueæ¥å£åŒ…æ‹¬Collectionæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚</p><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">æ¥æº</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left"><code>boolean add(E e)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">å°†æŒ‡å®šçš„å…ƒç´ æ’å…¥åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼Œå¹¶åœ¨æˆåŠŸæ—¶è¿”å›trueã€‚</td></tr><tr><td style="text-align:left"><code>boolean addAll(Collection&lt;? extends E&gt; c)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">æ·»åŠ å¤šä¸ªå…ƒç´ è‡³é˜Ÿåˆ—å°¾éƒ¨</td></tr><tr><td style="text-align:left"><code>int size()</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">è¿”å›é›†åˆçš„é•¿åº¦</td></tr><tr><td style="text-align:left"><code>boolean isEmpty()</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</td></tr><tr><td style="text-align:left"><code>boolean remove(Object o)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">ç§»é™¤æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>boolean removeIf(Predicate&lt;? super E&gt; filter)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">æ ¹æ®æ¡ä»¶è¿›è¡Œç§»é™¤</td></tr><tr><td style="text-align:left"><code>boolean removeAll(Collection&lt;?&gt; c)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">ç§»é™¤å¤šä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left"><code>void clear()</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">æ¸…ç©ºé›†åˆä¸­çš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>boolean contains(Object o)</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>Iterator&lt; E &gt; iterator()</code></td><td style="text-align:left"><span class='p blue'>Collection</span></td><td style="text-align:left">è¿”å›è¿­ä»£å™¨å¯¹è±¡</td></tr><tr><td style="text-align:left"><code>boolean offer(E e)</code></td><td style="text-align:left"><span class='p green'>Queue</span></td><td style="text-align:left">æ·»åŠ åˆ°é˜Ÿåˆ—å°¾éƒ¨</td></tr><tr><td style="text-align:left"><code>E remove()</code></td><td style="text-align:left"><span class='p green'>Queue</span></td><td style="text-align:left">åˆ é™¤å¹¶è¿”å›è¯¥é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ ,å¦‚æœé˜Ÿåˆ—ä¸ºç©º,åˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>E poll()</code></td><td style="text-align:left"><span class='p green'>Queue</span></td><td style="text-align:left">è¿”å›å¹¶åˆ é™¤è¯¥é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ , å¦‚æœé˜Ÿåˆ—ä¸ºç©º,åˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>E peek()</code></td><td style="text-align:left"><span class='p green'>Queue</span></td><td style="text-align:left">è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>E element()</code></td><td style="text-align:left"><span class='p green'>Queue</span></td><td style="text-align:left">è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr></tbody></table><mark class="hl-label blue">åˆ†ç±»</mark> <div class="tabs" id="30fb45ed-f2eb-4ed0-8f0f-7555fff212e1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-1"><i class="fas fa-cat"></i>å‹å…¥å…ƒç´ (æ·»åŠ )</button></li><li class="tab"><button type="button" data-href="#30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-2"><i class="fas fa-horse"></i>å¼¹å‡ºå…ƒç´ (åˆ é™¤)</button></li><li class="tab"><button type="button" data-href="#30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-3"><i class="fas fa-dove"></i>è·å–é˜Ÿå¤´å…ƒç´ (ä¸åˆ é™¤)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-1"><blockquote><p><strong>add()ã€offer()</strong></p></blockquote><ul><li>ç›¸åŒï¼šæœªè¶…å‡ºå®¹é‡ï¼Œä»é˜Ÿå°¾å‹å…¥å…ƒç´ ï¼Œè¿”å›å‹å…¥çš„é‚£ä¸ªå…ƒç´ ã€‚</li><li>åŒºåˆ«ï¼šåœ¨è¶…å‡ºå®¹é‡æ—¶ï¼Œadd()æ–¹æ³•ä¼šå¯¹æŠ›å‡ºå¼‚å¸¸ï¼Œoffer()è¿”å›false</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-2"><blockquote><p><strong>remove()ã€poll()</strong></p></blockquote><ul><li>ç›¸åŒï¼šå®¹é‡å¤§äº0çš„æ—¶å€™ï¼Œåˆ é™¤å¹¶è¿”å›é˜Ÿå¤´è¢«åˆ é™¤çš„é‚£ä¸ªå…ƒç´ ã€‚</li><li>åŒºåˆ«ï¼šåœ¨å®¹é‡ä¸º0çš„æ—¶å€™ï¼Œremove()ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œpoll()è¿”å›false</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="30fb45ed-f2eb-4ed0-8f0f-7555fff212e1-3"><blockquote><p><strong>element()ã€peek()</strong></p></blockquote><ul><li>ç›¸åŒï¼šå®¹é‡å¤§äº0çš„æ—¶å€™ï¼Œéƒ½è¿”å›é˜Ÿå¤´å…ƒç´ ã€‚ä½†æ˜¯ä¸åˆ é™¤ã€‚</li><li>åŒºåˆ«ï¼šå®¹é‡ä¸º0çš„æ—¶å€™ï¼Œelement()ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œpeek()è¿”å›nullã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="Dequeæ¥å£çš„æ–¹æ³•">Dequeæ¥å£çš„æ–¹æ³•</h2><p>Dequeæ¥å£æä¾›äº†åŒç«¯é˜Ÿåˆ—(Deque)çš„åŠŸèƒ½ã€‚å®ƒç»§æ‰¿äº†Queueæ¥å£ï¼ŒåŒ…æ‹¬Collectionå’ŒQueueæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚</p><p>Dequeæ˜¯ä¸€ä¸ªçº¿æ€§collectionï¼Œæ”¯æŒåœ¨ä¸¤ç«¯æ’å…¥å’Œç§»é™¤å…ƒç´ ã€‚Dequeçš„å®ç°ç±»æ˜¯LinkedListã€ArrayDequeã€LinkedBlockingDequeï¼Œå…¶ä¸­LinkedListæ˜¯æœ€å¸¸ç”¨çš„ã€‚</p><p>é™¤äº†Queueæ¥å£ä¸­å¯ç”¨çš„æ–¹æ³•ä¹‹å¤–ï¼ŒDequeè¿˜åŒ…æ‹¬ä»¥ä¸‹æ–¹æ³•ï¼š</p><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left"><code>void addFirst(E e)</code></td><td style="text-align:left">åœ¨åŒç«¯é˜Ÿåˆ—çš„å¼€å¤´æ·»åŠ æŒ‡å®šçš„å…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>void addLast(E e)</code></td><td style="text-align:left">åœ¨åŒç«¯é˜Ÿåˆ—çš„æœ«å°¾æ·»åŠ æŒ‡å®šçš„å…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>boolean offerFirst(E e)</code></td><td style="text-align:left">åœ¨åŒç«¯é˜Ÿåˆ—çš„å¼€å¤´æ·»åŠ æŒ‡å®šçš„å…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™è¿”å›false</td></tr><tr><td style="text-align:left"><code>boolean offerLast(E e)</code></td><td style="text-align:left">åœ¨åŒç«¯é˜Ÿåˆ—çš„æœ«å°¾æ·»åŠ æŒ‡å®šçš„å…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™è¿”å›false</td></tr><tr><td style="text-align:left"><code>E removeFirst()</code></td><td style="text-align:left">è¿”å›å¹¶åˆ é™¤åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>E removeLast()</code></td><td style="text-align:left">è¿”å›å¹¶åˆ é™¤åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>E pollFirst()</code></td><td style="text-align:left">è¿”å›å¹¶åˆ é™¤åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>E pollLast()</code></td><td style="text-align:left">è¿”å›å¹¶åˆ é™¤åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>E getFirst()</code></td><td style="text-align:left">è¿”å›åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>E getLast()</code></td><td style="text-align:left">è¿”å›åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å¼•å‘å¼‚å¸¸</td></tr><tr><td style="text-align:left"><code>E peekFirst()</code></td><td style="text-align:left">è¿”å›åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>E peekLast()</code></td><td style="text-align:left">è¿”å›åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr><tr><td style="text-align:left"><code>boolean removeFirstOccurrence(Object o)</code></td><td style="text-align:left">åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ,ä¸å­˜åœ¨æ—¶è¿”å›false</td></tr><tr><td style="text-align:left"><code>boolean removeLastOccurrence(Object o)</code></td><td style="text-align:left">åˆ é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ,ä¸å­˜åœ¨æ—¶è¿”å›false</td></tr></tbody></table><hr><p>Javaå †æ ˆStackç±»å·²ç»è¿‡æ—¶ï¼ŒJavaå®˜æ–¹æ¨èä½¿ç”¨Dequeæ›¿ä»£Stackä½¿ç”¨ã€‚</p><p>ä»¥ä¸‹æ˜¯Dequeæ¥å£æä¾›çš„ç”¨äºå®ç°æ ˆçš„æ–¹æ³•ï¼š</p><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left"><code>void push(E e)</code></td><td style="text-align:left">åœ¨åŒç«¯é˜Ÿåˆ—çš„å¼€å¤´æ·»åŠ å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E pop()</code></td><td style="text-align:left">ä»åŒç«¯é˜Ÿåˆ—çš„å¼€å¤´åˆ é™¤å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E peek()</code></td><td style="text-align:left">è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å›null</td></tr></tbody></table><p>push = addFirst</p><p>pop = removeFirst</p><p>åªæ˜¯ä½¿ç”¨äº†ä¸åŒçš„æ–¹æ³•åä½“ç°é˜Ÿåˆ—è¡¨ç¤ºæ ˆç»“æ„æ—¶çš„ç‰¹ç‚¹</p><p>å½“æˆ‘ä»¬æŠŠDequeä½œä¸ºStackä½¿ç”¨æ—¶ï¼Œæ³¨æ„åªè°ƒç”¨push()/pop()/peek()æ–¹æ³•ï¼Œä¸è¦è°ƒç”¨addFirst()/removeFirst()/peekFirst()æ–¹æ³•ï¼Œè¿™æ ·ä»£ç æ›´åŠ æ¸…æ™°ã€‚</p><hr><p>å½“ peek() poll() peek() remove()è¿™äº›æ“ä½œä¸å¸¦Firstæ—¶ï¼Œé»˜è®¤æ˜¯firstï¼Œæ“ä½œå¯¹è±¡æ˜¯é˜Ÿé¦–</p><p>add()å’Œoffer()é»˜è®¤æ˜¯é˜Ÿå°¾</p><table><thead><tr><th style="text-align:left">Queueæ–¹æ³•</th><th style="text-align:left">ç­‰æ•ˆDequeæ–¹æ³•</th></tr></thead><tbody><tr><td style="text-align:left"><code>add(e)</code></td><td style="text-align:left"><code>addLast(e)</code></td></tr><tr><td style="text-align:left"><code>offer(e)</code></td><td style="text-align:left"><code>offerLast(e)</code></td></tr><tr><td style="text-align:left"><code>remove()</code></td><td style="text-align:left"><code>removeFirst()</code></td></tr><tr><td style="text-align:left"><code>poll()</code></td><td style="text-align:left"><code>pollFirst()</code></td></tr><tr><td style="text-align:left"><code>element()</code></td><td style="text-align:left"><code>getFirst()</code></td></tr><tr><td style="text-align:left"><code>peek()</code></td><td style="text-align:left"><code>peekFirst()</code></td></tr></tbody></table><hr><hr><h2 id="Queueéå†æ–¹å¼">Queueéå†æ–¹å¼</h2><p>Queueéå†æ–¹æ³•ä¸ŠåŸºæœ¬ä¸Šä¸Collectionçš„ä¸€è‡´ã€‚</p><ol><li>è¿­ä»£å™¨éå†</li><li>å¢å¼ºforéå†</li><li>Lambdaè¡¨è¾¾å¼</li></ol><div class="tag link"><a class="link-card" title="Collectioné›†åˆçš„éå†æ–¹å¼" href="/posts/71c14870.html#Collectionéå†æ–¹å¼"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/favicon.png"/></div><div class="right"><p class="text">Collectioné›†åˆçš„éå†æ–¹å¼</p><p class="url">/posts/71c14870.html#Collectionéå†æ–¹å¼</p></div></a></div>]]></content>
    
    
    <summary type="html">Queueä½“ç³»æ¶æ„ã€Queueæ¥å£æ–¹æ³•ã€Dequeæ¥å£æ–¹æ³•</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>HashSetå’ŒTreeSet</title>
    <link href="https://wuwawawa.github.io/posts/edc5fe5c.html"/>
    <id>https://wuwawawa.github.io/posts/edc5fe5c.html</id>
    <published>2023-05-20T03:29:18.000Z</published>
    <updated>2023-05-24T01:28:09.820Z</updated>
    
    <content type="html"><![CDATA[<img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/Set%E4%BD%93%E7%B3%BB%E5%9B%BE1.jpg" alt="Setä½“ç³»å›¾1" style="zoom:50%;" /><h2 id="HashSet">HashSet</h2><p>HashSeté›†åˆåº•å±‚é‡‡å–å“ˆå¸Œè¡¨(HashMap)å­˜å‚¨æ•°æ®,<s>èº«åœ¨Collectionå¿ƒåœ¨ Map</s></p><p>å“ˆå¸Œè¡¨æ˜¯ä¸€ç§å¯¹äºå¢åˆ æ”¹æŸ¥æ•°æ®æ€§èƒ½éƒ½è¾ƒå¥½çš„ç»“æ„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">()</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="å“ˆå¸Œè¡¨ç»„æˆ">å“ˆå¸Œè¡¨ç»„æˆ</h3><p>JDK8ä¹‹å‰ï¼šæ•°ç»„+é“¾è¡¨</p><p>JDK8å¼€å§‹ï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</p><p>åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å€¼å«åšå“ˆå¸Œå€¼ï¼Œæ˜¯å“ˆå¸Œè¡¨çš„çµé­‚æ‰€åœ¨ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230520194828555.png" alt="image-20230520194828555" style="zoom:67%;" /><p>å¦‚æœå·²ç»é‡å†™hashcodeæ–¹æ³•ï¼Œä¸åŒçš„å¯¹è±¡åªè¦å±æ€§å€¼ç›¸åŒï¼Œè®¡ç®—å‡ºçš„å“ˆå¸Œå€¼å°±æ˜¯ä¸€æ ·çš„ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230520195353131.png" alt="image-20230520195353131" style="zoom:75%;" /><p>åœ¨å°éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸åŒçš„å±æ€§å€¼æˆ–è€…ä¸åŒçš„åœ°å€å€¼è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼ä¹Ÿæœ‰å¯èƒ½ä¸€æ ·ã€‚ï¼ˆ<span class='p red'>å“ˆå¸Œç¢°æ’</span>ï¼‰</p><hr><h3 id="åº•å±‚åŸç†">åº•å±‚åŸç†</h3><div class="tabs" id="515cce44-45a3-4097-8f7e-6ad0a4ce246a"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#515cce44-45a3-4097-8f7e-6ad0a4ce246a-1"><i class="fas fa-cat"></i>HashSetJDK8ä»¥å‰åº•å±‚åŸç†</button></li><li class="tab"><button type="button" data-href="#515cce44-45a3-4097-8f7e-6ad0a4ce246a-2"><i class="fas fa-horse"></i>HashSetJDK8åº•å±‚åŸç†</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="515cce44-45a3-4097-8f7e-6ad0a4ce246a-1"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/14_JKD8%E4%BB%A5%E5%89%8D%E5%93%88%E5%B8%8C%E8%A1%A8.png" alt="14_JKD8ä»¥å‰å“ˆå¸Œè¡¨"  /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="515cce44-45a3-4097-8f7e-6ad0a4ce246a-2"><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/15_JKD8%E4%BB%A5%E5%90%8E%E5%93%88%E5%B8%8C%E8%A1%A8.png" alt="15_JKD8ä»¥åå“ˆå¸Œè¡¨"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ol><li><p><code>HashSet&lt;String&gt; hm = new HashSet&lt;&gt;();</code></p></li><li><p><code>int index = (æ•°ç»„é•¿åº¦-1) &amp; å“ˆå¸Œå€¼;</code></p></li><li><p>ä¸€æ ·ï¼šä¸å­˜</p><p>ä¸ä¸€æ ·ï¼šå­˜å…¥æ•°ç»„ï¼Œå½¢æˆé“¾è¡¨</p><ul><li><p>JDK8ä»¥å‰ï¼šæ–°æ•°ç»„å­˜å…¥æ•°ç»„ï¼Œè€å…ƒç´ æŒ‚åœ¨æ–°å…ƒç´ ä¸‹é¢</p></li><li><p>JDK8ä»¥åï¼šæ–°å…ƒç´ ç›´æ¥æŒ‚åœ¨è€å…ƒç´ ä¸‹é¢</p></li></ul></li></ol><p>æ‰©å®¹æ—¶æœºï¼š</p><ul><li>å½“æ•°ç»„ä¸­å­˜äº†16*0.75=12ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ•°ç»„å°±ä¼šæ‰©å®¹æˆåŸå…ˆçš„ä¸¤å€ã€‚</li><li>JDK8ä»¥åï¼Œå½“è”è¡¨é•¿åº¦<span class='p red'>è¶…è¿‡8</span>ï¼Œä¸”æ•°ç»„é•¿åº¦<span class='p red'>å¤§äºç­‰äº64</span>ï¼Œé‚£ä¹ˆå½“å‰çš„é“¾è¡¨å°±ä¼šè‡ªåŠ¨è½¬æˆçº¢é»‘æ ‘ã€‚</li></ul><blockquote><p>æ³¨æ„</p></blockquote><p>å¦‚æœé›†åˆä¸­å­˜å‚¨çš„æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œå¿…é¡»è¦é‡å†™<span class='p red'>hashCode</span>å’Œ<span class='p red'>equals</span>æ–¹æ³•</p><hr><h3 id="HashSetçš„ä¸‰ä¸ªé—®é¢˜">HashSetçš„ä¸‰ä¸ªé—®é¢˜</h3><div class="tabs" id="eddb45d3-b9a7-4d4c-8827-37b9acb7a487"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#eddb45d3-b9a7-4d4c-8827-37b9acb7a487-1"><i class="fas fa-cat"></i>é—®é¢˜1</button></li><li class="tab"><button type="button" data-href="#eddb45d3-b9a7-4d4c-8827-37b9acb7a487-2"><i class="fas fa-horse"></i>é—®é¢˜2</button></li><li class="tab"><button type="button" data-href="#eddb45d3-b9a7-4d4c-8827-37b9acb7a487-3"><i class="fas fa-dove"></i>é—®é¢˜3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="eddb45d3-b9a7-4d4c-8827-37b9acb7a487-1"><blockquote><p>é—®é¢˜1ï¼šHashSetä¸ºä»€ä¹ˆå­˜å’Œå–çš„é¡ºåºä¸ä¸€æ ·ï¼Ÿ</p></blockquote><p>HashSet éå†å…ƒç´ çš„é¡ºåºæ˜¯åŸºäºå“ˆå¸Œè¡¨ä¸­å…ƒç´ çš„å­˜å‚¨ä½ç½®æ¥è¿›è¡Œçš„ï¼Œä»æ•°ç»„çš„0ç´¢å¼•å¼€å§‹ï¼Œä¸€æ¡é“¾è¡¨ä¸€æ¡é“¾è¡¨è¿™æ ·éå†çš„ã€‚ï¼Œè€Œå“ˆå¸Œè¡¨ä¸­å…ƒç´ çš„å­˜å‚¨ä½ç½®æ˜¯ç”±å“ˆå¸Œå€¼å†³å®šçš„ï¼Œå› æ­¤ï¼Œå…ƒç´ çš„éå†é¡ºåºä¸å…ƒç´ æ·»åŠ çš„é¡ºåºæ— å…³ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230520212602484.png" alt="image-20230520212602484" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="eddb45d3-b9a7-4d4c-8827-37b9acb7a487-2"><blockquote><p>é—®é¢˜2ï¼šHashSetä¸ºä»€ä¹ˆæ²¡æœ‰ç´¢å¼•ï¼Ÿ</p></blockquote><p>ç´¢å¼•æ²¡æœ‰æ„ä¹‰</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="eddb45d3-b9a7-4d4c-8827-37b9acb7a487-3"><blockquote><p>HashSetæ˜¯åˆ©ç”¨ä»€ä¹ˆæœºåˆ¶ä¿è¯æ•°æ®å»é‡çš„ï¼Ÿ</p></blockquote><p>HashCodeæ–¹æ³•+equalsæ–¹æ³•</p><p>åˆ©ç”¨HashCodeæ–¹æ³•å¾—åˆ°Hashå€¼ï¼Œå¾—åˆ°Hashå€¼åå°±å¯ä»¥çŸ¥é“å½“å‰å…ƒç´ æ˜¯æ·»åŠ åˆ°æ•°ç»„ä¸­çš„å“ªä¸ªä½ç½®ã€‚</p><p>å¦‚æœè¯¥ä½ç½®å·²ç»å­˜åœ¨å…ƒç´ ï¼ŒHashSetä¼šequalsæ–¹æ³•æ¯”è¾ƒè¯¥å…ƒç´ ä¸å·²å­˜åœ¨å…ƒç´ çš„å€¼å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™ä¸è¿›è¡Œæ“ä½œï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™å°†è¯¥å…ƒç´ åŠ å…¥ HashSet ä¸­ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="æ¡ˆä¾‹æ¼”ç¤º">æ¡ˆä¾‹æ¼”ç¤º</h3><div class="tabs" id="b39c48bf-8146-47ec-b2a0-8db90e8ab7c8"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-1"><i class="fas fa-bug"></i>1</button></li><li class="tab"><button type="button" data-href="#b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-2"><i class="fas fa-cannabis"></i>2</button></li><li class="tab"><button type="button" data-href="#b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-3"><i class="fas fa-candy-cane"></i>3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-1"><p>æ­¤æ—¶å¹¶æ²¡æœ‰é‡å†™equalså’ŒHashcodeæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">student</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºä¸‰ä¸ªå­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;lisi&quot;</span>, <span class="number">24</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;wangwu&quot;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åˆ›å»ºé›†åˆæ·»åŠ å…ƒç´ </span></span><br><span class="line">HashSet&lt;Student&gt; hs = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.æ·»åŠ å…ƒç´ </span></span><br><span class="line">System.out.println(hs.add(s1));</span><br><span class="line">System.out.println(hs.add(s2));</span><br><span class="line">System.out.println(hs.add(s3));</span><br><span class="line">System.out.println(hs.add(s4));</span><br><span class="line"><span class="comment">//4.æ‰“å°é›†åˆ</span></span><br><span class="line">System.out.println(hs);</span><br></pre></td></tr></table></figure><p>true<br>true<br>true<br>true<br>[Student(name=zhangsan, age=23), Student(name=lisi, age=24), Student(name=zhangsan, age=23), Student(name=wangwu, age=25)]</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b39c48bf-8146-47ec-b2a0-8db90e8ab7c8-3"><p>åœ¨Studentç±»æ·»åŠ ä¸Š@EqualsAndHashCodeåè¾“å‡ºï¼š</p><p>true<br>false<br>true<br>true<br>[Student(name=zhangsan, age=23), Student(name=lisi, age=24), Student(name=wangwu, age=25)]</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="LinkedHashSet">LinkedHashSet</h2><p>LinkedHashSetç»§æ‰¿äºHashSetï¼Œæ–¹æ³•ä¸HashSetä¸€è‡´ã€‚</p><p>LinkedHashSetåº•å±‚æ˜¯ä¸€ä¸ª LinkedHashMapï¼Œåº•å±‚ç»´æŠ¤äº†ä¸€ä¸ª<span class='p green'>æ•°ç»„+åŒå‘é“¾è¡¨</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedHashSet</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="built_in">super</span>(<span class="number">16</span>, <span class="number">.75f</span>, <span class="literal">true</span>);</span><br><span class="line">   &#125;</span><br><span class="line">HashSet(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor, <span class="type">boolean</span> dummy) &#123;</span><br><span class="line">       map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ul><li><span class='p red'>æœ‰åº</span>ã€ä¸é‡å¤ã€æ— ç´¢å¼•ã€‚</li><li>è¿™é‡Œçš„æœ‰åºæŒ‡çš„æ˜¯ä¿è¯å­˜å‚¨å’Œå–å‡ºçš„å…ƒç´ é¡ºåºä¸€è‡´ã€‚</li><li><span class='p red'>åŸç†</span>ï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯ä¾ç„¶å“ˆå¸Œè¡¨ï¼Œåªæ˜¯æ¯ä¸ªå…ƒç´ åˆé¢å¤–çš„å¤šäº†ä¸€ä¸ªåŒé“¾è¡¨çš„æœºåˆ¶è®°å½•å­˜å‚¨çš„é¡ºåºã€‚</li></ul><p>ä¾‹å­</p><ul><li>ç¬¬ä¸€ä¸ªå…ƒç´ æ ¹æ®Hashå€¼å¾—åˆ°æ•°ç»„ä¸­è¯¥å­˜å…¥çš„ä½ç½®ä¸º8ï¼Œè¯¥ä½ç½®æ²¡æœ‰å…ƒç´ ä¸ºnullï¼Œç›´æ¥æ·»åŠ è¿›å»ï¼Œäºæ­¤åŒæ—¶åº•å±‚è¿˜å¤šäº†åŒå‘é“¾è¡¨ï¼Œå¤´ç»“ç‚¹å°±ä¸ºåˆšåˆšæ·»åŠ çš„å…ƒç´ </li><li>ç»§ç»­æ·»åŠ ç¬¬äºŒä¸ªå…ƒç´ ï¼Œè®¡ç®—å‡ºç¬¬äºŒä¸ªå…ƒç´ è¯¥å­˜å…¥çš„ç´¢å¼•ä¸º3ç´¢å¼•ï¼Œæ²¡æœ‰å…ƒç´ ç›´æ¥æ·»åŠ ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ç¬¬äºŒä¸ªå…ƒç´ ç›´æ¥å½¢æˆåŒå‘é“¾è¡¨</li><li>ç»§ç»­æ·»åŠ ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Œæ ¹æ®Hashå€¼è®¡ç®—å‡ºç¬¬ä¸‰ä¸ªå…ƒç´ è¯¥å­˜å…¥çš„ç´¢å¼•ä¸º3ç´¢å¼•ï¼Œå­˜åœ¨å…ƒç´ ï¼Œæ ¹æ®equalsæ–¹æ³•ï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å±æ€§å€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸ä¸€æ ·ï¼Œæ ¹æ®JDK8ä»¥åçš„è§„åˆ™ï¼Œæ–°çš„å…ƒç´ æŒ‚åœ¨ä¸‹é¢ï¼Œäºæ­¤åŒæ—¶ï¼Œç¬¬äºŒä¸ªå…ƒç´ å’Œç¬¬ä¸‰ä¸ªå…ƒç´ è¿˜è¦å†å½¢æˆåŒå‘é“¾è¡¨</li><li>ç»§ç»­æ·»åŠ ç¬¬å››ä¸ªå…ƒç´ ï¼Œè®¡ç®—å‡ºç¬¬äºŒä¸ªå…ƒç´ è¯¥å­˜å…¥çš„ç´¢å¼•ä¸º0ç´¢å¼•ï¼Œä¸ç¬¬ä¸‰ä¸ªå…ƒç´ å½¢æˆåŒå‘é“¾è¡¨</li><li>æ·»åŠ å®Œæˆï¼Œæ­¤æ—¶å¤´ç»“ç‚¹å°±ä¸º8å…ƒç´ ï¼Œå°¾èŠ‚ç‚¹ä¸º0å…ƒç´ </li></ul><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230521133546661.png" alt="image-20230521133546661"></p><p>åœ¨éå†çš„æ—¶å€™å°±å’ŒHashSetä¸ä¸€æ ·äº†ï¼ˆä»æ•°ç»„çš„0ç´¢å¼•å¼€å§‹ä¸€æ¡é“¾è¡¨ä¸€æ¡é“¾è¡¨éå†ï¼‰ï¼Œåœ¨LinkedHashSetä¸­ï¼Œä»å¤´ç»“ç‚¹å¼€å§‹ä»¥æ­¤éå†ï¼Œç›´è‡³å°¾èŠ‚ç‚¹ã€‚</p><p>è¿™æ—¶å€™è·å¾—çš„æ•°æ®ï¼Œå°±å’Œæ·»åŠ å…ƒç´ çš„é¡ºåºä¸€æ ·äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºä¸‰ä¸ªå­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;lisi&quot;</span>, <span class="number">24</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;wangwu&quot;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åˆ›å»ºé›†åˆæ·»åŠ å…ƒç´ </span></span><br><span class="line">LinkedHashSet&lt;Student&gt; lhs = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.æ·»åŠ å…ƒç´ </span></span><br><span class="line">System.out.println(lhs.add(s1));</span><br><span class="line">System.out.println(lhs.add(s2));</span><br><span class="line">System.out.println(lhs.add(s3));</span><br><span class="line">System.out.println(lhs.add(s4));</span><br><span class="line"><span class="comment">//4.æ‰“å°é›†åˆ</span></span><br><span class="line">System.out.println(lhs);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>true<br>false<br>true<br>true<br>[Student(name=zhangsan, age=23), Student(name=lisi, age=24), Student(name=wangwu, age=25)]</p><hr><hr><h2 id="TreeSet">TreeSet</h2><h3 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h3><p>å»¶ç»­äº†Seté›†åˆä¸¤ä¸ªç‰¹ç‚¹ï¼šä¸é‡å¤ã€æ— ç´¢å¼•</p><p>ä½†æ˜¯TreeSetå¤šäº†ä¸€ä¸ªç‰¹ç‚¹ï¼š<span class='p red'>å¯æ’åº</span></p><p>å¯æ’åºï¼šæŒ‰ç…§å…ƒç´ çš„é»˜è®¤è§„åˆ™ï¼ˆæœ‰å°åˆ°å¤§ï¼‰æ’åºã€‚</p><p>TreeSeté›†åˆåº•å±‚æ˜¯åŸºäº<span class='p red'>çº¢é»‘æ ‘</span>çš„æ•°æ®ç»“æ„å®ç°æ’åºçš„ï¼Œå¢åˆ æ”¹æŸ¥æ€§èƒ½éƒ½è¾ƒå¥½ã€‚</p><p>ä¸ä¾èµ–Hashcodeå’Œequalsæ–¹æ³•</p><hr><h3 id="æ–¹æ³•">æ–¹æ³•</h3><p>TreeSetå®ç°äº†NavigableSetï¼ŒNavigableSetæ˜¯ä¸€ä¸ªæ¥å£ï¼Œç»§æ‰¿è‡ªSortedSetæ¥å£ï¼Œç”¨äºå®ç°å¯å¯¼èˆªçš„Setã€‚å®ƒå…·æœ‰SortedSetæ‰€æ‹¥æœ‰çš„ä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚èƒ½å¤Ÿè‡ªåŠ¨è¿›è¡Œæ’åºã€å»é‡ç­‰ï¼ŒåŒæ—¶è¿˜å…·å¤‡ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚é¡ºåºéå†å…ƒç´ ã€è·å–ç‰¹å®šåŒºé—´å†…çš„å…ƒç´ ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeSet</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">NavigableSet</span>&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">æ¥æº</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left"><code>E first()</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è·å–å½“å‰é›†åˆçš„é¦–å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E last()</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è·å–å½“å‰é›†åˆçš„å°¾å…ƒç´ </td></tr><tr><td style="text-align:left"><code>SortedSet&lt;E&gt; headSet(E toElement)</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è¿”å›å€¼å°äºçš„toElementå­é›†</td></tr><tr><td style="text-align:left"><code>SortedSet&lt;E&gt; tailSet(E fromElement)</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è¿”å›å€¼å¤§äºæˆ–ç­‰äºfromElementçš„å­é›†</td></tr><tr><td style="text-align:left"><code>SortedSet&lt;E&gt; subSet(E fromElement, E toElement)</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è¿”å›å€¼èŒƒå›´ä¸º[fromElement,toElement)èŒƒå›´çš„å­é›†</td></tr><tr><td style="text-align:left"><code>Iterator&lt;E&gt; iterator()</code></td><td style="text-align:left"><code>SortedSet</code></td><td style="text-align:left">è¿”å›è¿­ä»£å™¨</td></tr><tr><td style="text-align:left"><code>E lower(E e)</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å°äºæŒ‡å®šå…ƒç´ çš„é‚£äº›å…ƒç´ ä¸­æœ€å¤§çš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E floor(E e)</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">å›å°äºæˆ–ç­‰äºæŒ‡å®šå…ƒç´ çš„é‚£äº›å…ƒç´ ä¸­æœ€å¤§çš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E ceiling(E e)</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å¤§äºæˆ–ç­‰äºæŒ‡å®šå…ƒç´ çš„é‚£äº›å…ƒç´ ä¸­çš„æœ€å°å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E higher(E e)</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å¤§äºæŒ‡å®šå…ƒç´ çš„é‚£äº›å…ƒç´ ä¸­çš„æœ€å°å…ƒç´ </td></tr><tr><td style="text-align:left"><code>E pollFirst()</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å¹¶ä»é›†åˆä¸­åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left"><code>E pollLast()</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å¹¶ä»é›†åˆä¸­åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left"><code>Iterator&lt;E&gt; descendingIterator()</code></td><td style="text-align:left"><code>NavigableSet</code></td><td style="text-align:left">è¿”å›å¯ç”¨äºä»¥ç›¸åé¡ºåºè¿­ä»£é›†åˆçš„è¿­ä»£å™¨</td></tr></tbody></table><hr><h3 id="é»˜è®¤æ’åºè§„åˆ™">é»˜è®¤æ’åºè§„åˆ™</h3><ul><li><p>å¯¹äºæ•°å€¼ç±»å‹ï¼šIntegerï¼ŒDoubleï¼Œé»˜è®¤æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºè¿›è¡Œæ’åºã€‚</p></li><li><p>å¯¹äºå­—ç¬¦ã€å­—ç¬¦ä¸²ç±»å‹ï¼šæŒ‰ç…§å­—ç¬¦åœ¨ASCIç è¡¨ä¸­çš„æ•°å­—å‡åºè¿›è¡Œæ’åºã€‚</p></li><li><p>å¦‚æœè¦ä½¿ç”¨è‡ªå®šä¹‰çš„æ’åºè§„åˆ™æ¥æ’åºå…ƒç´ ï¼Œå¯ä»¥åœ¨åˆ›å»ºTreeSetæ—¶ä¼ å…¥ä¸€ä¸ªComparatorå¯¹è±¡ï¼Œå®ç°è‡ªå®šä¹‰çš„æ¯”è¾ƒé€»è¾‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTreeSetä¼šæ ¹æ®Comparatorå¯¹è±¡çš„æ¯”è¾ƒç»“æœæ¥æ’åºå…ƒç´ ã€‚</p></li></ul><hr><h3 id="æ¡ˆä¾‹æ¼”ç¤º-2">æ¡ˆä¾‹æ¼”ç¤º</h3><p>éœ€æ±‚ï¼šåˆ›å»ºTreeSeté›†åˆï¼Œå¹¶æ·»åŠ 3ä¸ªå­¦ç”Ÿå¯¹è±¡</p><p>å­¦ç”Ÿå¯¹è±¡å±æ€§ï¼šå§“åï¼Œå¹´é¾„ã€‚</p><p>è¦æ±‚æŒ‰ç…§å­¦ç”Ÿçš„å¹´é¾„è¿›è¡Œæ’åºï¼ŒåŒå¹´é¾„æŒ‰ç…§å§“åå­—æ¯æ’åˆ—ï¼ˆæš‚ä¸è€ƒè™‘ä¸­æ–‡ï¼‰ åŒå§“åï¼ŒåŒå¹´é¾„è®¤ä¸ºæ˜¯åŒä¸€ä¸ªäºº</p><div class="tabs" id="876ca747-d446-48f5-8a59-9b81d6730fb3"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#876ca747-d446-48f5-8a59-9b81d6730fb3-1"><i class="fas fa-cat"></i>Studentç±»</button></li><li class="tab"><button type="button" data-href="#876ca747-d446-48f5-8a59-9b81d6730fb3-2"><i class="fas fa-dove"></i>æ¯”è¾ƒå™¨æ’åº</button></li><li class="tab"><button type="button" data-href="#876ca747-d446-48f5-8a59-9b81d6730fb3-3"><i class="fas fa-horse"></i>beanç±»å®ç°Comparableæ¥å£æŒ‡å®šæ¯”è¾ƒè§„åˆ™</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="876ca747-d446-48f5-8a59-9b81d6730fb3-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="876ca747-d446-48f5-8a59-9b81d6730fb3-2"><p>åˆ›å»ºTreeSetå¯¹è±¡æ—¶å€™ï¼Œä¼ é€’æ¯”è¾ƒå™¨ComparatoræŒ‡å®šè§„åˆ™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åˆ›å»ºä¸‰ä¸ªå­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">24</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;wangwu&quot;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åˆ›å»ºé›†åˆæ·»åŠ å…ƒç´ </span></span><br><span class="line">TreeSet&lt;Student&gt; ts = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;((stu1,stu2)-&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span> (stu1.getAge()==stu2.getAge())&#123;</span><br><span class="line">        <span class="keyword">return</span> stu1.getName().compareTo(stu2.getName());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stu1.getAge()-stu2.getAge();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.æ·»åŠ å…ƒç´ </span></span><br><span class="line">ts.add(s1);</span><br><span class="line">ts.add(s2);</span><br><span class="line">ts.add(s3);</span><br><span class="line"><span class="comment">//4.æ‰“å°é›†åˆ</span></span><br><span class="line">System.out.println(ts);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><p>[Student(name=zhangsan, age=23), Student(name=zhangsan, age=24), Student(name=wangwu, age=25)]</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="876ca747-d446-48f5-8a59-9b81d6730fb3-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Student&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Student o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.getAge()==o.getAge())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.getName().compareTo(o.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getAge()-o.getAge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š[Student(name=zhangsan, age=23), Student(name=zhangsan, age=24), Student(name=wangwu, age=25)]</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><span class='p red'>æ³¨æ„</span><p>å¦‚æœä¸¤ç§æ–¹å¼éƒ½å­˜åœ¨ï¼Œä¼˜å…ˆé€‰æ‹©ä¼ å…¥çš„æ¯”è¾ƒå™¨</p><hr><h3 id="æ€»ç»“">æ€»ç»“</h3><blockquote><p>Tree Seté›†åˆçš„ç‰¹ç‚¹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p></blockquote><p>å¯æ’åºã€ä¸é‡å¤ã€æ— ç´¢å¼•</p><p>åº•å±‚åŸºäºçº¢é»‘æ ‘å®ç°æ’åºï¼Œå¢åˆ æ”¹æŸ¥æ€§èƒ½è¾ƒå¥½</p><blockquote><p>TreeSeté›†åˆè‡ªå®šä¹‰æ’åºè§„åˆ™æœ‰å‡ ç§æ–¹å¼</p></blockquote><p>æ–¹å¼ä¸€ï¼šJavabeanç±»å®ç°Comparableæ¥å£ï¼ŒæŒ‡å®šæ¯”è¾ƒè§„åˆ™</p><p>æ–¹å¼äºŒï¼šåˆ›å»ºé›†åˆæ—¶ï¼Œè‡ªå®šä¹‰Comparatoræ¯”è¾ƒå™¨å¯¹è±¡ï¼ŒæŒ‡å®šæ¯”è¾ƒè§„åˆ™</p><blockquote><p>æ–¹æ³•è¿”å›å€¼çš„ç‰¹ç‚¹</p></blockquote><p>è´Ÿæ•°ï¼šè¡¨ç¤ºå½“å‰è¦æ·»åŠ çš„å…ƒç´ æ˜¯å°çš„ï¼Œå­˜å·¦è¾¹</p><p>æ­£æ•°ï¼šè¡¨ç¤ºå½“å‰è¦æ·»åŠ çš„å…ƒç´ æ˜¯å¤§çš„ï¼Œå­˜å³è¾¹</p><p>0ï¼šè¡¨ç¤ºå½“å‰è¦æ·»åŠ çš„å…ƒç´ å·²ç»å­˜åœ¨ï¼Œèˆå¼ƒ</p><hr><hr><h2 id="æ€»ç»“-2">æ€»ç»“</h2><ol><li><p>å¦‚æœæƒ³è¦é›†åˆä¸­çš„å…ƒç´ å¯é‡å¤</p><ul><li>ç”¨ArrayListé›†åˆï¼ŒåŸºäºæ•°ç»„çš„ã€‚<span class='p red'>ï¼ˆç”¨çš„æœ€å¤šï¼‰</span></li></ul></li><li><p>å¦‚æœæƒ³è¦é›†åˆä¸­çš„å…ƒç´ å¯é‡å¤ï¼Œè€Œä¸”å½“å‰çš„<span class='p red'>å¢åˆ æ“ä½œæ˜æ˜¾å¤šäºæŸ¥è¯¢</span></p><ul><li>ç”¨LinkedListé›†åˆï¼ŒåŸºäºé“¾è¡¨çš„ã€‚</li></ul></li><li><p>å¦‚æœæƒ³å¯¹é›†åˆä¸­çš„å…ƒç´ å»é‡</p><ul><li>ç”¨HashSeté›†åˆï¼ŒåŸºäºå“ˆå¸Œè¡¨çš„ã€‚<span class='p red'>ï¼ˆç”¨çš„æœ€å¤šï¼‰</span></li></ul></li><li><p>å¦‚æœæƒ³å¯¹é›†åˆä¸­çš„å…ƒç´ å»é‡ï¼Œè€Œä¸”<span class='p red'>ä¿è¯å­˜å–é¡ºåº</span></p><ul><li>ç”¨LinkedHashSeté›†åˆï¼ŒåŸºäºå“ˆå¸Œè¡¨å’ŒåŒé“¾è¡¨ï¼Œæ•ˆç‡ä½äºHashSetã€‚</li></ul></li><li><p>å¦‚æœæƒ³å¯¹é›†åˆä¸­çš„å…ƒç´ è¿›è¡Œ<span class='p red'>æ’åº</span></p><ul><li>ç”¨TreeSeté›†åˆï¼ŒåŸºäºçº¢é»‘æ ‘ã€‚åç»­ä¹Ÿå¯ä»¥ç”¨Listé›†åˆå®ç°æ’åºã€‚</li></ul></li></ol>]]></content>
    
    
    <summary type="html">HashSetã€LinkedHashSetå’ŒTreeSetè§£æ</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æ— åºé›†åˆæ¥å£Set</title>
    <link href="https://wuwawawa.github.io/posts/c6185e82.html"/>
    <id>https://wuwawawa.github.io/posts/c6185e82.html</id>
    <published>2023-05-20T02:36:16.000Z</published>
    <updated>2023-05-20T03:30:16.226Z</updated>
    
    <content type="html"><![CDATA[<img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/Set%E4%BD%93%E7%B3%BB%E5%9B%BE1.jpg" alt="Setä½“ç³»å›¾1" style="zoom:50%;" /><h2 id="Seté›†åˆçš„æ¦‚è¿°å’Œç‰¹ç‚¹">Seté›†åˆçš„æ¦‚è¿°å’Œç‰¹ç‚¹</h2><blockquote><p>Seté›†åˆçš„æ¦‚è¿°</p></blockquote><ul><li>æ— åºé›†åˆ,è¿™é‡Œçš„æ— åºæŒ‡çš„æ˜¯å­˜å–é¡ºåº</li><li>ç”¨æˆ·ä¸å¯ä»¥ç²¾ç¡®æ§åˆ¶åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®</li><li>ä¸Listé›†åˆä¸åŒ,åˆ—è¡¨ä¸å…è®¸é‡å¤çš„å…ƒç´ </li></ul><blockquote><p>Seté›†åˆçš„ç‰¹ç‚¹</p></blockquote><ul><li>æ— åºï¼š å­˜å’Œå–çš„å…ƒç´ é¡ºåºä¸ä¸€è‡´</li><li>æ— ç´¢å¼•ï¼š æ²¡æœ‰å¸¦ç´¢å¼•çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æ™®é€šforå¾ªç¯éå†ï¼Œä¹Ÿä¸èƒ½é€šè¿‡ç´¢å¼•æ¥è·å–å…ƒç´ </li><li>ä¸é‡å¤ï¼š å¯ä»¥å»é™¤é‡å¤</li></ul><blockquote><p>Seté›†åˆçš„å®ç°ç±»</p></blockquote><ul><li>HashSetï¼šæ— åºã€ä¸é‡å¤ã€æ— ç´¢å¼•</li><li>LinkedHashSetï¼š<span class='p blue'>æœ‰åº</span>ã€ä¸é‡å¤ã€æ— ç´¢å¼•</li><li>TreeSetï¼š<span class='p green'>å¯æ’åº</span>ã€ä¸é‡å¤ã€æ— ç´¢å¼•</li></ul><h2 id="Seté›†åˆæ–¹æ³•">Seté›†åˆæ–¹æ³•</h2><p>Setæ¥å£ä¸­çš„æ–¹æ³•ä¸ŠåŸºæœ¬ä¸Šä¸Collectionçš„APIä¸€è‡´ã€‚</p><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">boolean add(E e)</td><td style="text-align:left">æ·»åŠ å…ƒç´ </td></tr><tr><td style="text-align:left">boolean addAll(Collection&lt;? extends E&gt; c)</td><td style="text-align:left">æ·»åŠ å¤šä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left">boolean remove(Object o)</td><td style="text-align:left">ç§»é™¤æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean removeIf(Predicate&lt;? super E&gt; filter)</td><td style="text-align:left">æ ¹æ®æ¡ä»¶è¿›è¡Œç§»é™¤</td></tr><tr><td style="text-align:left">boolean removeAll(Collection&lt;?&gt; c);</td><td style="text-align:left">ç§»é™¤å¤šä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left">void clear()</td><td style="text-align:left">æ¸…ç©ºé›†åˆä¸­çš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean contains(Object o)</td><td style="text-align:left">åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean isEmpty()</td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</td></tr><tr><td style="text-align:left">int size()</td><td style="text-align:left">é›†åˆçš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</td></tr></tbody></table><h2 id="Setéå†æ–¹å¼">Setéå†æ–¹å¼</h2><p>Setéå†æ–¹æ³•ä¸ŠåŸºæœ¬ä¸Šä¸Collectionçš„ä¸€è‡´ã€‚</p><ol><li>è¿­ä»£å™¨éå†</li><li>å¢å¼ºforéå†</li><li>Lambdaè¡¨è¾¾å¼</li></ol><div class="tag link"><a class="link-card" title="Collectioné›†åˆçš„éå†æ–¹å¼" href="/posts/71c14870.html#Collectionéå†æ–¹å¼"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/favicon.png"/></div><div class="right"><p class="text">Collectioné›†åˆçš„éå†æ–¹å¼</p><p class="url">/posts/71c14870.html#Collectionéå†æ–¹å¼</p></div></a></div>]]></content>
    
    
    <summary type="html">Setä¸­å¸¸è§çš„æ–¹æ³•å’Œéå†æ–¹å¼</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>ArrayListå’ŒLinkedList</title>
    <link href="https://wuwawawa.github.io/posts/7ec37ec5.html"/>
    <id>https://wuwawawa.github.io/posts/7ec37ec5.html</id>
    <published>2023-05-16T13:40:28.000Z</published>
    <updated>2023-05-24T00:23:13.248Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ArrayListç»§æ‰¿ä½“ç³»åˆ†æ">ArrayListç»§æ‰¿ä½“ç³»åˆ†æ</h2><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231107149-2112590708.png" alt="img" style="zoom:67%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure><div class="tabs" id="41484376-eb71-4843-b44f-05f3c2bd6ccd"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#41484376-eb71-4843-b44f-05f3c2bd6ccd-1"><i class="fas fa-cookie-bite"></i>AbstractList</button></li><li class="tab"><button type="button" data-href="#41484376-eb71-4843-b44f-05f3c2bd6ccd-2"><i class="fas fa-dragon"></i>List</button></li><li class="tab"><button type="button" data-href="#41484376-eb71-4843-b44f-05f3c2bd6ccd-3"><i class="fas fa-cat"></i>RandomAccess</button></li><li class="tab"><button type="button" data-href="#41484376-eb71-4843-b44f-05f3c2bd6ccd-4"><i class="fas fa-dove"></i>Cloneable</button></li><li class="tab"><button type="button" data-href="#41484376-eb71-4843-b44f-05f3c2bd6ccd-5"><i class="fas fa-horse"></i>Serializable</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="41484376-eb71-4843-b44f-05f3c2bd6ccd-1"><p>è¿™ä¸ªæŠ½è±¡ç±»ä¹Ÿå®ç°äº†<code>List</code>æ¥å£é‡Œé¢çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸ºå…¶æä¾›äº†é»˜è®¤ä»£ç å®ç°ï¼Œæ¯”å¦‚è¯´<code>AbstractList</code>ä¸­å¯¹<code>indexOf</code>çš„å®ç°å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯è¿”å›å¯¹è±¡ o åœ¨å®¹å™¨å½“ä¸­çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡è¿­ä»£å™¨å»éå†æ•°æ®</span></span><br><span class="line">    ListIterator&lt;E&gt; it = listIterator();</span><br><span class="line">    <span class="keyword">if</span> (o==<span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (it.next()==<span class="literal">null</span>)</span><br><span class="line">                <span class="comment">// è¿”å›æ•°æ® o çš„ä¸‹æ ‡</span></span><br><span class="line">                <span class="keyword">return</span> it.previousIndex();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext())</span><br><span class="line">            <span class="keyword">if</span> (o.equals(it.next()))</span><br><span class="line">                <span class="comment">// è¿”å›æ•°æ® o çš„ä¸‹æ ‡</span></span><br><span class="line">                <span class="keyword">return</span> it.previousIndex();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="41484376-eb71-4843-b44f-05f3c2bd6ccd-2"><p>è¿™ä¸ªæ¥å£ä¸»è¦å®šä¹‰äº†ä¸€äº›listé›†åˆå¸¸ç”¨çš„æ–¹æ³•è®©<code>ArrayList</code>è¿›è¡Œå®ç°ï¼Œ</p><p>æ¯”å¦‚<code>add</code>ï¼Œ<code>addAll</code>ï¼Œ<code>contains</code>ï¼Œ<code>remove</code>ï¼Œ<code>set</code>ï¼Œ<code>get</code>ï¼Œ<code>size</code>ï¼Œ<code>indexOf</code>ï¼Œ<code>listIterator</code>ç­‰ç­‰æ–¹æ³•ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="41484376-eb71-4843-b44f-05f3c2bd6ccd-3"><p>æ ‡è®°æ¥å£ï¼Œå†…éƒ¨å¹¶æ²¡æœ‰æŠ½è±¡æ–¹æ³•ã€‚</p><p>è¿™ä¸ªæ¥å£çš„å«ä¹‰è¡¨ç¤ºå¯ä»¥éšæœºè®¿é—®<code>ArrayList</code>å½“ä¸­çš„æ•°æ®ï¼Œæ‹¿ä»€ä¹ˆæ˜¯éšæœºè®¿é—®å‘¢ï¼Ÿéšæœºè®¿é—®å°±æ˜¯è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥åœ¨å¸¸é‡æ—¶é—´å¤æ‚åº¦å†…è®¿é—®æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(1)</code>ã€‚å› ä¸ºåœ¨<code>ArrayList</code>å½“ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹æ˜¯<code>æ•°ç»„</code>ï¼Œè€Œæ•°ç»„æ˜¯å¯ä»¥éšæœºè®¿é—®çš„ã€‚</p><p>è€Œé“¾è¡¨æ˜¯ä¸å¯ä»¥éšæœºè®¿é—®çš„ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æƒ³é€šè¿‡ä¸‹æ ‡è®¿é—®é“¾è¡¨å½“ä¸­çš„æŸä¸ªæ•°æ®ï¼Œéœ€è¦ä»å¤´ç»“ç‚¹æˆ–è€…å°¾èŠ‚ç‚¹å¼€å§‹éå†ï¼Œç›´åˆ°éå†åˆ°ä¸‹æ ‡å¯¹åº”çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸‹å›¾ä¸­çš„å•é“¾è¡¨æ‰¾åˆ°ç¬¬3ä¸ªæ•°æ®ï¼Œéœ€è¦ä»å¤´å¼€å§‹éå†ï¼Œè€Œè¿™ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231535445-1718441250.png" alt="img"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="41484376-eb71-4843-b44f-05f3c2bd6ccd-4"><p>å®ç°<code>Cloneable</code>æ¥å£é‚£ä¹ˆå®ç°<code>Cloneable</code>çš„ç±»å°±èƒ½å¤Ÿè°ƒç”¨<code>clone</code>è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å®ç°<code>Cloneable</code>æ¥å£å°±è°ƒç”¨æ–¹æ³•ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸<code>java.lang.CloneNotSupportedException</code>ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="41484376-eb71-4843-b44f-05f3c2bd6ccd-5"><p>Serializableæ¥å£ä¸»è¦ç”¨äºåºåˆ—åŒ–ï¼Œæ‰€è°“åºåˆ—åŒ–å°±æ˜¯èƒ½å°†å¯¹è±¡å†™å…¥ç£ç›˜ï¼Œååºåˆ—åŒ–å°±æ˜¯èƒ½å¤Ÿå°†å¯¹è±¡ä»ç£ç›˜å½“ä¸­è¯»å–å‡ºæ¥ï¼Œå¦‚æœæƒ³åºåˆ—åŒ–å’Œååºåˆ—åŒ–<code>ArrayList</code>çš„å®ä¾‹å¯¹è±¡å°±å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ï¼Œå¦‚æœæ²¡æœ‰å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨å®ä¾‹åŒ–çš„æ—¶å€™ç¨‹åºæ‰§è¡Œä¼šæŠ¥é”™ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="ArrayListå…³é”®å­—æ®µåˆ†æ">ArrayListå…³é”®å­—æ®µåˆ†æ</h2><p>åœ¨<code>ArrayList</code>å½“ä¸­ä¸»è¦æœ‰ä»¥ä¸‹è¿™äº›å­—æ®µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ArrayListå½“ä¸­é»˜è®¤åˆå§‹åŒ–å®¹é‡,ä½¿ç”¨æ— å‚æ„é€ å™¨ï¼Œåˆ™elementData[]åˆå§‹å®¹é‡ä¸º0,ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ‰©å®¹ä¸º10</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_CAPACITY</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="comment">// å­˜æ”¾å…·ä½“æ•°æ®çš„æ•°ç»„ ArrayList åº•å±‚å°±æ˜¯ä½¿ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨çš„</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elementData;</span><br><span class="line"><span class="comment">// size è¡¨ç¤ºå®¹å™¨å½“ä¸­æ•°æ®çš„ä¸ªæ•° æ³¨æ„å’Œå®¹å™¨çš„é•¿åº¦åŒºåˆ†å¼€æ¥</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"><span class="comment">// å½“å®¹å™¨å½“ä¸­æ²¡æœ‰å…ƒç´ çš„æ—¶å€™å°† elementData èµ‹å€¼ä¸ºä»¥ä¸‹æ•°æ®ï¼ˆä¸åŒæƒ…å†µä¸ä¸€æ ·ï¼‰</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤ä¸ªå‡½æ•°æ˜¯ ArrayList çš„æ„é€ å‡½æ•°ï¼Œä»ä¸‹é¢ä¸¤ä¸ªå‡½æ•°å½“ä¸­</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬å¯ä»¥çœ‹å‡º EMPTY_ELEMENTDATA å’Œ DEFAULTCAPACITY_EMPTY_ELEMENTDATA ä½¿ç”¨åŒºåˆ«</span></span><br><span class="line"><span class="comment">// EMPTY_ELEMENTDATA æ˜¯å®¹å™¨å®¹é‡ä¸º0æ—¶ä½¿ç”¨ï¼ŒDEFAULTCAPACITY_EMPTY_ELEMENTDATAæ˜¯é»˜è®¤æ„é€ çš„æ—¶å€™ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.elementData = <span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Capacity: &quot;</span>+</span><br><span class="line">                initialCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»º ArrayList å¯¹è±¡æ—¶ï¼Œå¦‚æœä½¿ç”¨æ— å‚æ„é€ å™¨ï¼Œåˆ™ elementData[] åˆå§‹å®¹é‡ä¸º 0</span></span><br><span class="line">    <span class="built_in">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="ArrayListä¸»è¦æ–¹æ³•åˆ†æ">ArrayListä¸»è¦æ–¹æ³•åˆ†æ</h2><h3 id="add">add</h3><p><code>add</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºå¾€å®¹å™¨çš„æœ«å°¾å¢åŠ æ•°æ®ï¼Œä¹Ÿæ˜¯<code>ArrayList</code>å½“ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ã€‚ä¸»è¦å·¥ä½œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231130867-1867898666.png" alt="img" style="zoom:67%;" /><p>é¦–å…ˆè°ƒç”¨å‡½æ•°<code>ensureCapacityInternal</code>ç¡®ä¿<code>ArrayList</code>å½“ä¸­çš„æ•°ç»„é•¿åº¦èƒ½å¤Ÿæ»¡è¶³éœ€æ±‚ï¼Œä¸ç„¶æ•°ç»„ä¼šæŠ¥æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸ï¼Œ<code>add</code>å‡½æ•°è°ƒç”¨è¿‡ç¨‹å½“ä¸­æ‰€æ¶‰åŠåˆ°çš„å‡½æ•°å¦‚ä¸‹ã€‚</p><div class="tabs" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-1">add</button></li><li class="tab"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-2">ensureCapacityInternal</button></li><li class="tab"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-3">calculateCapacity</button></li><li class="tab"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-4">ensureExplicitCapacity</button></li><li class="tab"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-5">growâ­ï¸</button></li><li class="tab"><button type="button" data-href="#6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-6">hugeCapacity</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿ elementData çš„å®¹é‡æœ‰ size + 1 ï¼Œå¦åˆ™å­˜å‚¨æ•°æ®çš„æ—¶å€™æ•°ç»„å°±ä¼šè¶Šç•Œ</span></span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// size è¡¨ç¤ºå®¹å™¨å½“ä¸­æ•°æ®çš„ä¸ªæ•° æ³¨æ„å’Œå®¹å™¨çš„é•¿åº¦åŒºåˆ†å¼€æ¥</span></span><br><span class="line">    <span class="comment">// åŠ å…¥æ•°æ®ä¹‹å å®¹å™¨å½“ä¸­æ•°æ®çš„ä¸ªæ•°ä¹Ÿè¦ + 1</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// minCapacity è¡¨ç¤º ArrayList ä¸­çš„æ•°ç»„æœ€å°çš„é•¿åº¦</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensureCapacityInternal</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    ensureExplicitCapacity(</span><br><span class="line">        <span class="comment">// è¿™ä¸ªå‡½æ•°è®¡ç®—æ•°ç»„çš„æœ€å°é•¿åº¦</span></span><br><span class="line">        calculateCapacity(elementData, minCapacity)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">calculateCapacity</span><span class="params">(Object[] elementData, <span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯æ— å‚æ„é€ çš„è¯ï¼Œå–é»˜è®¤é•¿åº¦å’Œéœ€æ±‚é•¿åº¦ minCapacity ä¸­æ¯”è¾ƒå¤§çš„å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensureExplicitCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªè¡¨ç¤ºå®¹å™¨å‘ç”Ÿæ”¹å˜çš„æ¬¡æ•°ï¼Œæˆ‘ä»¬åœ¨åç»­åˆ†æè¿­ä»£å™¨çš„æ—¶å€™è¿›è¡Œåˆ†æ</span></span><br><span class="line">    modCount++;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// å¦‚æœæœ€å°çš„éœ€æ±‚å®¹é‡ minCapacity å¤§äºç°åœ¨å®¹å™¨å½“ä¸­æ•°ç»„çš„é•¿åº¦ï¼Œåˆ™éœ€è¦è¿›è¡Œæ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">grow</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> elementData.length;</span><br><span class="line">    <span class="comment">// æ–°æ•°ç»„çš„é•¿åº¦ä¸ºåŸæ•°ç»„çš„é•¿åº¦çš„1.5å€ï¼Œå³ç§»ä¸€ä½ç›¸å½“äºé™¤ä»¥2</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// å¦‚æœæ–°æ•°ç»„çš„é•¿åº¦ï¼Œå°äºéœ€è¦çš„æœ€å°çš„å®¹é‡ï¼Œåˆ™æ›´æ–°æ•°ç»„çš„é•¿åº¦ä¸º minCapacity</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯åˆ¤æ–­æ•´æ•°æ˜¯å¦å‘ç”Ÿæº¢å‡º</span></span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="6a318352-1ba6-4cb9-9bbe-84d380a0a3cf-6"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">hugeCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">    MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ä¸Šè¿°ä»£ç çš„è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231142437-124193873.png" alt="img" style="zoom: 50%;" /><hr><hr><h3 id="getå’Œset">getå’Œset</h3><div class="tabs" id="c18f7a24-21a8-44ee-ae7e-1a8287cc5f76"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#c18f7a24-21a8-44ee-ae7e-1a8287cc5f76-1"><i class="fas fa-atom"></i>get</button></li><li class="tab"><button type="button" data-href="#c18f7a24-21a8-44ee-ae7e-1a8287cc5f76-2"><i class="far fa-sun"></i>set</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="c18f7a24-21a8-44ee-ae7e-1a8287cc5f76-1"><p>è·å–å¯¹åº”ä¸‹æ ‡çš„æ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿›è¡Œæ•°ç»„ä¸‹æ ‡çš„æ£€æŸ¥ï¼Œå¦‚æœä¸‹æ ‡è¶…è¿‡ ArrayList ä¸­æ•°æ®çš„ä¸ªæ•°ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="comment">// æ³¨æ„è¿™é‡Œæ˜¯å®¹å™¨å½“ä¸­æ•°æ®çš„ä¸ªæ•° ä¸æ˜¯æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> elementData(index);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rangeCheck</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(outOfBoundsMsg(index));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">E <span class="title function_">elementData</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›å¯¹åº”ä¸‹æ ‡çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> (E) elementData[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c18f7a24-21a8-44ee-ae7e-1a8287cc5f76-2"><p>è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨äºè®¾ç½®æŒ‡å®šä¸‹æ ‡çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"> </span><br><span class="line">    <span class="type">E</span> <span class="variable">oldValue</span> <span class="operator">=</span> elementData(index);</span><br><span class="line">    elementData[index] = element;</span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="remove">remove</h3><p>åˆ é™¤<code>ArrayList</code>å½“ä¸­çš„æ•°æ®</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231154448-1597746352.png" alt="img" style="zoom:80%;" /><div class="tabs" id="7a56d341-394e-4470-add8-6e8a906bebcf"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#7a56d341-394e-4470-add8-6e8a906bebcf-1">remove(int index)</button></li><li class="tab"><button type="button" data-href="#7a56d341-394e-4470-add8-6e8a906bebcf-2">remove(Object o)</button></li><li class="tab"><button type="button" data-href="#7a56d341-394e-4470-add8-6e8a906bebcf-3">fastRemove(int index)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="7a56d341-394e-4470-add8-6e8a906bebcf-1"><p>é€šè¿‡ä¸‹æ ‡åˆ é™¤æ•°æ®ï¼Œè¿™ä¸ªå‡½æ•°çš„æ„ä¹‰æ˜¯åˆ é™¤ä¸‹æ ‡ä¸º index çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// é¦–å…ˆæ£€æŸ¥ä¸‹æ ‡æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•ï¼ŒæŠ›å‡ºä¸‹æ ‡è¶Šç•Œå¼‚å¸¸</span></span><br><span class="line">    rangeCheck(index);</span><br><span class="line"> </span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="type">E</span> <span class="variable">oldValue</span> <span class="operator">=</span> elementData(index);</span><br><span class="line">  <span class="comment">// å› ä¸ºåˆ é™¤æŸä¸ªæ•°æ®ï¼Œéœ€è¦å°†è¯¥æ•°æ®åé¢çš„æ•°æ®å¾€æ•°ç»„å‰é¢ç§»åŠ¨</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œéœ€è¦è®¡ç®—éœ€è¦ç§»åŠ¨çš„æ•°æ®çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">numMoved</span> <span class="operator">=</span> size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// é€šè¿‡æ‹·è´ç§»åŠ¨æ•°æ®</span></span><br><span class="line">        <span class="comment">// è¿™ä¸ªå‡½æ•°çš„æ„ä¹‰æ˜¯å°† index + 1å’Œå…¶ä¹‹åçš„æ•°æ®æ•´ä½“ç§»åŠ¨åˆ° index</span></span><br><span class="line">        <span class="comment">// çš„ä½ç½®</span></span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    <span class="comment">// å› ä¸ºæœ€åä¸€ä¸ªæ•°æ®å·²ç»æ‹·è´åˆ°å‰ä¸€ä¸ªä½ç½®äº†ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®ä¸º null</span></span><br><span class="line">    <span class="comment">// å¯ä»¥åšåƒåœ¾å›æ”¶äº†</span></span><br><span class="line">    elementData[--size] = <span class="literal">null</span>; </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a56d341-394e-4470-add8-6e8a906bebcf-2"><p>åˆ é™¤å®¹å™¨å½“ä¸­çš„ç¬¬ä¸€ä¸ªç­‰äº o çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (elementData[index] == <span class="literal">null</span>) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>; index &lt; size; index++)</span><br><span class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                fastRemove(index);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a56d341-394e-4470-add8-6e8a906bebcf-3"><p>è¿™ä¸ªæ–¹æ³•å’Œç¬¬ä¸€ä¸ª remove æ–¹æ³•åŸç†ä¸€è‡´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">fastRemove</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="type">int</span> <span class="variable">numMoved</span> <span class="operator">=</span> size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)</span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    elementData[--size] = <span class="literal">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="toString">toString</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LinkedList&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    list.add(i);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(list);</span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœï¼š</span></span><br><span class="line"><span class="comment">// [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br></pre></td></tr></table></figure><p><code>toString</code>æ–¹æ³•æ²¡æœ‰ç›´æ¥åœ¨<code>ArrayList</code>å½“ä¸­å®ç°ï¼Œè€Œæ˜¯åœ¨å®ƒç»§æ‰¿çš„ç±»<code>AbstractCollection</code>å½“ä¸­å®ç°çš„ï¼Œ<code>toString</code>çš„æºä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// å¾—åˆ° ArrayList çš„è¿­ä»£å™¨ </span></span><br><span class="line">    Iterator&lt;E&gt; it = iterator();</span><br><span class="line">    <span class="comment">// å¦‚æœå®¹å™¨å½“ä¸­æ²¡æœ‰æ•°æ®åˆ™è¿”å›ç©º</span></span><br><span class="line">    <span class="keyword">if</span> (! it.hasNext())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[]&quot;</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    sb.append(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">e</span> <span class="operator">=</span> it.next();</span><br><span class="line">        <span class="comment">// å°†å¯¹è±¡åŠ å…¥åˆ° StringBuilder å½“ä¸­ï¼Œè¿™é‡ŒåŠ å…¥çš„ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        <span class="comment">// ä½†æ˜¯åœ¨ append æºä»£ç å½“ä¸­ä¼šåŒæ ·ä¼šä½¿ç”¨ String.ValueOf </span></span><br><span class="line">        <span class="comment">// å¾—åˆ°å¯¹è±¡çš„ toString æ–¹æ³•çš„ç»“æœ</span></span><br><span class="line">        sb.append(e == <span class="built_in">this</span> ? <span class="string">&quot;(this Collection)&quot;</span> : e);</span><br><span class="line">        <span class="keyword">if</span> (! it.hasNext())</span><br><span class="line">            <span class="keyword">return</span> sb.append(<span class="string">&#x27;]&#x27;</span>).toString();</span><br><span class="line">        sb.append(<span class="string">&#x27;,&#x27;</span>).append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœå®¹å™¨å½“ä¸­æ²¡æœ‰æ•°æ®ï¼Œç›´æ¥è¿”å›[]ã€‚</li><li>å¦‚æœå®¹å™¨å½“ä¸­æœ‰æ•°æ®çš„è¯ï¼Œé‚£ä¹ˆé€šè¿‡è¿­ä»£æ¯ä¸ªæ•°æ®ï¼Œè°ƒç”¨<code>StringBuilder</code>çš„<code>append</code>æ–¹æ³•ï¼Œå°†æ•°æ®åŠ å…¥åˆ°è¾“å‡ºçš„<code>StringBuilder</code>å¯¹è±¡å½“ä¸­ã€‚åœ¨<code>append</code>æ–¹æ³•ä¸­æ·»åŠ åˆ°<code>StringBuilder</code>å½“ä¸­çš„å­—ç¬¦ä¸²ä»ç„¶æ˜¯<code>ArrayList</code>å½“ä¸­æ•°æ®å¯¹è±¡çš„<code>toString</code>æ–¹æ³•è¿”å›çš„æ•°æ®ã€‚</li></ul><hr><h3 id="equals">equals</h3><p>åœ¨<code>ArrayList</code>å½“ä¸­çš„<code>equals</code>æ–¹æ³•å’Œ<code>toString</code>æ–¹æ³•ä¸ä¸€æ ·ï¼Œ</p><p><code>equlas</code>æ–¹æ³•æ˜¯åœ¨ç±»<code>AbstractList</code>å½“ä¸­å®ç°çš„ï¼Œå…¶æºä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="built_in">this</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> List))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">    ListIterator&lt;E&gt; e1 = listIterator();</span><br><span class="line">    ListIterator&lt;?&gt; e2 = ((List&lt;?&gt;) o).listIterator();</span><br><span class="line">    <span class="keyword">while</span> (e1.hasNext() &amp;&amp; e2.hasNext()) &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">o1</span> <span class="operator">=</span> e1.next();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o2</span> <span class="operator">=</span> e2.next();</span><br><span class="line">        <span class="keyword">if</span> (!(o1==<span class="literal">null</span> ? o2==<span class="literal">null</span> : o1.equals(o2)))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> !(e1.hasNext() || e2.hasNext());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„ä¸»è¦æµç¨‹ï¼š</p><ul><li>é¦–å…ˆåˆ¤æ–­<code>o</code>å’Œ<code>this</code>æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</li><li>å¦‚æœå¯¹è±¡æ²¡æœ‰å®ç°<code>List</code>æ¥å£è¿”å›<code>false</code>ã€‚</li><li>é€ä¸ªåˆ¤æ–­è¿­ä»£å™¨é‡Œé¢çš„å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼ˆè°ƒequalsï¼‰ï¼Œå¦‚æœä¸¤ä¸ªé“¾è¡¨å½“ä¸­èŠ‚ç‚¹æ•°ç›®ä¸€æ ·è€Œä¸”éƒ½ç›¸ç­‰åˆ™è¿”å›<code>true</code>å¦åˆ™è¿”å›<code>false</code>ã€‚</li></ul><hr><h3 id="clone">clone</h3><p>é›†åˆçš„ <code>clone</code> æ–¹æ³•æ‰§è¡Œçš„æ˜¯æµ…æ‹·è´ã€‚è¿™æ„å‘³ç€ï¼Œæ–°åˆ›å»ºçš„é›†åˆå¯¹è±¡ä¼šåŒ…å«åŸå§‹é›†åˆä¸­çš„åŒä¸€ç»„å¯¹è±¡å¼•ç”¨ã€‚å¦‚æœåŸå§‹é›†åˆä¸­çš„å¯¹è±¡æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆåœ¨æ–°é›†åˆä¸­å¯¹è¿™äº›å¯¹è±¡æ‰€åšçš„æ›´æ”¹ä¹Ÿä¼šåæ˜ åœ¨åŸå§‹é›†åˆä¸­ã€‚</p><p>å¦‚æœéœ€è¦æ‰§è¡Œæ·±æ‹·è´ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–æŠ€æœ¯æˆ–æ‰‹åŠ¨å¤åˆ¶å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„å¯¹è±¡å¼•ç”¨æ¥å®ç°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ Java åºåˆ—åŒ– API æˆ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Apache Commons Lang åº“ï¼‰æ¥æ‰§è¡Œæ·±æ‹·è´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">clone</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ArrayList&lt;?&gt; v = (ArrayList&lt;?&gt;) <span class="built_in">super</span>.clone();</span><br><span class="line">        v.elementData = Arrays.copyOf(elementData, size);</span><br><span class="line">        v.modCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">        <span class="comment">// this shouldn&#x27;t happen, since we are Cloneable</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InternalError</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•´ä¸ªæ‹·è´è¿‡ç¨‹å¦‚ä¸‹å¦‚æ‰€ç¤ºï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220707231203740-1128103203.png" alt="img" style="zoom:50%;" /><p>è™½ç„¶å‘ç”Ÿäº†æ•°ç»„çš„æ‹·è´ï¼Œä½†æ˜¯æ‹·è´ä¹‹åçš„æ•°ç»„ä¸­æ•°æ®çš„æŒ‡å‘å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªæ•°ç»„æŒ‡å‘çš„å†…å®¹æ˜¯ä¸€æ ·çš„ã€‚</p><hr><hr><h2 id="ArrayListè¿­ä»£å™¨Iterator">ArrayListè¿­ä»£å™¨Iterator</h2><h3 id="Iteratorå­—æ®µåˆ†æ">Iteratorå­—æ®µåˆ†æ</h3><p><code>Itr</code>ç±»æ˜¯<code>ArrayList</code>çš„å†…éƒ¨ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä»”ç»†åˆ†æ<code>Itr</code>ç±»çš„å®ç°ã€‚</p><p>åœ¨<code>Itr</code>ç±»å½“ä¸­ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªå­—æ®µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡ å½“æˆ‘ä»¬ new è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™è¿™ä¸ªå€¼é»˜è®¤åˆå§‹åŒ–ä¸º0</span></span><br><span class="line"><span class="type">int</span> cursor;       </span><br><span class="line"><span class="comment">// ä¸Šä¸€ä¸ªé€šè¿‡ next æ–¹æ³•è¿”å›çš„å…ƒç´ çš„ä¸‹æ ‡  </span></span><br><span class="line"><span class="type">int</span> <span class="variable">lastRet</span> <span class="operator">=</span> -<span class="number">1</span>; </span><br><span class="line"><span class="type">int</span> <span class="variable">expectedModCount</span> <span class="operator">=</span> modCount; </span><br></pre></td></tr></table></figure><p><code>modCount</code>è¡¨ç¤ºæ•°ç»„å½“ä¸­æ•°æ®æ”¹å˜çš„æ¬¡æ•° ,æ˜¯<code>ArrayList</code>å½“ä¸­çš„ç±»å˜é‡ã€‚</p><p><code>expectedModCount </code>æ˜¯<code>ArrayListå†…éƒ¨ç±» Itr</code>ä¸­çš„ç±»å˜é‡ ç„¶åå°†è¿™ä¸ªå˜é‡ä¿å­˜åˆ° expectedModCountå½“ä¸­ã€‚ä½¿ç”¨ expectedModCount ä¸»è¦ç”¨äº fast-fail æœºåˆ¶ã€‚</p><p><code>modCount</code>ï¼ˆè‹±æ–‡å…¨ç§°ä¸ºï¼šmodifications countï¼Œä¿®æ”¹æ¬¡æ•°ï¼‰è¿™ä¸ªå­—æ®µã€‚å½“<code>ArrayList</code>å½“ä¸­å‘ç”Ÿä¸€æ¬¡<strong>ç»“æ„ä¿®æ”¹</strong>(<code>Structural modifications</code>)æ—¶ï¼Œ<code>modCount</code>å°±++ã€‚æ‰€è°“<strong>ç»“æ„ä¿®æ”¹</strong>å°±æ˜¯é‚£äº›è®©<code>ArrayList</code>å½“ä¸­æ•°ç»„çš„æ•°æ®ä¸ªæ•°<code>size</code>å‘ç”Ÿå˜åŒ–çš„æ“ä½œï¼Œæ¯”å¦‚è¯´<code>add</code>ã€<code>remove</code>æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•ä¸€ä¸ªæ˜¯å¢åŠ æ•°æ®ï¼Œä¸€ä¸ªæ˜¯åˆ é™¤æ•°æ®ï¼Œéƒ½ä¼šå¯¼è‡´å®¹å™¨å½“ä¸­æ•°æ®ä¸ªæ•°å‘ç”Ÿå˜åŒ–ã€‚è€Œ<code>set</code>æ–¹æ³•å°±ä¸ä¼šæ˜¯çš„<code>modCount</code>å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºæ²¡æœ‰æ”¹å˜å®¹å™¨å½“ä¸­æ•°æ®çš„ä¸ªæ•°ã€‚</p><hr><h3 id="nextå’Œhasnext">nextå’Œhasnext</h3><div class="tabs" id="b80a58c5-9f6c-45f6-ac2d-8de41ea96561"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#b80a58c5-9f6c-45f6-ac2d-8de41ea96561-1"><i class="fas fa-atom"></i>hasNext()</button></li><li class="tab"><button type="button" data-href="#b80a58c5-9f6c-45f6-ac2d-8de41ea96561-2"><i class="far fa-sun"></i>next()</button></li><li class="tab"><button type="button" data-href="#b80a58c5-9f6c-45f6-ac2d-8de41ea96561-3"><i class="fas fa-wind"></i>checkForComodification()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="b80a58c5-9f6c-45f6-ac2d-8de41ea96561-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ª size æ˜¯å¤–éƒ¨ç±» ArrayList å½“ä¸­çš„ size è¡¨ç¤ºçš„æ˜¯ ArrayListå½“ä¸­æ•°æ®å…ƒç´ çš„ä¸ªæ•°ï¼Œ</span></span><br><span class="line">    <span class="comment">// cursor çš„åˆå§‹å€¼ä¸º 0 æ¯è°ƒç”¨ä¸€ä¸ª next cursorçš„å€¼å°±+1ï¼Œå½“ç­‰äº size æ˜¯å®¹å™¨å½“ä¸­çš„æ•°æ®å·²ç»éå†å®Œæˆäº† hasNext å°±è¿”å› false äº†</span></span><br><span class="line">    <span class="keyword">return</span> cursor != size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b80a58c5-9f6c-45f6-ac2d-8de41ea96561-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯ç”¨äºæ£€æµ‹åœ¨æ•°æ®è¿­ä»£çš„è¿‡ç¨‹å½“ä¸­ ArrayList æ˜¯å¦å‘ç”Ÿ ç»“æ„ä¿®æ”¹</span></span><br><span class="line">    <span class="comment">// å¦‚æœå‘ç”Ÿç»“æ„ä¿®æ”¹å°±æŠ›å‡º ConcurrentModificationException å¼‚å¸¸</span></span><br><span class="line">    checkForComodification();</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> cursor;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoSuchElementException</span>();</span><br><span class="line">    Object[] elementData = ArrayList.<span class="built_in">this</span>.elementData;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ConcurrentModificationException</span>();</span><br><span class="line">    <span class="comment">// æ›´æ”¹ cursor çš„å€¼ å¹¶å°†å…¶è®¾ç½®ä¸ºä¸‹ä¸€ä¸ªè¿”å›å…ƒç´ çš„ä¸‹æ ‡ è¿™ä¸€ç‚¹æˆ‘ä»¬åœ¨</span></span><br><span class="line">    <span class="comment">// å­—æ®µåˆ†æçš„æ—¶å€™å·²ç»è°ˆåˆ°è¿‡äº†</span></span><br><span class="line">    cursor = i + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// è¿”å›æ•°æ® è¡¨è¾¾å¼ lastRet = i çš„è¿”å›å€¼ä¸º i </span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªè¡¨è¾¾å¼ä¸ä»…å°† lastRet çš„å€¼èµ‹å€¼ä¸º i åŒæ—¶è¿”å› i</span></span><br><span class="line">    <span class="comment">// å› æ­¤å¯ä»¥è¿”å›ä¸‹æ ‡ä¸º i çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b80a58c5-9f6c-45f6-ac2d-8de41ea96561-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">checkForComodification</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå‘ç”Ÿ ç»“æ„ä¿®æ”¹é‚£ä¹ˆ modCount çš„å€¼ä¼š++ é‚£ä¹ˆå°±å’Œ expectedModCount ä¸ç›¸ç­‰äº†</span></span><br><span class="line">    <span class="comment">// expectedModCount åˆå§‹åŒ–çš„æ—¶å€™ä»¤å…¶ç­‰äº expectedModCount</span></span><br><span class="line">    <span class="keyword">if</span> (modCount != expectedModCount)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ConcurrentModificationException</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <p>ä¸ºä»€ä¹ˆè¦æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸å‘¢ï¼Œæˆ‘ä»¬å…ˆæƒ³æƒ³æ˜¯ä»€ä¹ˆå¯¼è‡´<code>modCount</code>å‘ç”Ÿå˜åŒ–ã€‚è‚¯å®šè¿­ä»£å™¨åœ¨è¿›è¡Œéå†çš„åŒæ—¶ï¼Œä¿®æ”¹äº†<code>modCount</code>çš„å€¼ï¼Œé€šå¸¸è¿™ç§ç°è±¡çš„å‘ç”Ÿå‡ºç°åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå› æ­¤æŠ›å‡º<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚åƒè¿™ç§é€šè¿‡è¿­ä»£å™¨éå†è¿‡ç¨‹è¿›è¡Œæ£€æŸ¥å¹¶ä¸”å½“å‘ç”Ÿä¸ç¬¦åˆæ¡ä»¶çš„æƒ…å†µä¸‹æŠ›å‡ºå¼‚å¸¸çš„ç°è±¡å°±ç§°ä½œ<code>Fast-fail</code>ã€‚</p><hr><h3 id="remove-2">remove</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>();</span><br><span class="line">    <span class="comment">// è¿›è¡Œåˆæ³•æ€§æ£€æŸ¥ï¼Œçœ‹æ˜¯å¦éœ€è¦æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    checkForComodification();</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ ArrayList çš„removeæ–¹æ³•å®ç°</span></span><br><span class="line">        ArrayList.<span class="built_in">this</span>.remove(lastRet);</span><br><span class="line">        cursor = lastRet;</span><br><span class="line">        lastRet = -<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å› ä¸º remove ä¼šæ”¹å˜ modCount çš„å€¼ï¼Œå› æ­¤éœ€è¦å°† expectedModCount é‡æ–°èµ‹å€¼</span></span><br><span class="line">        expectedModCount = modCount;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ConcurrentModificationException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="ArrayListæ€»ç»“">ArrayListæ€»ç»“</h2><h3 id="æ—¶é—´å¤æ‚åº¦åˆ†æ">æ—¶é—´å¤æ‚åº¦åˆ†æ</h3><ul><li>å› ä¸º<code>ArrayList</code>æ˜¯éšæœºå­˜å–çš„ï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡ä¸‹æ ‡æŸ¥æ‰¾æ•°æ®çš„æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(1)</code>ã€‚</li><li>æ’å…¥æ•°æ®çš„æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(n)</code>ã€‚</li></ul><h3 id="æ‰©å®¹æœºåˆ¶">æ‰©å®¹æœºåˆ¶</h3><p>â‘  åˆ©ç”¨ç©ºå‚åˆ›å»ºçš„é›†åˆï¼Œåœ¨åº•å±‚åˆ›å»ºä¸€ä¸ªé»˜è®¤é•¿åº¦ä¸º0çš„æ•°ç»„</p><p>â‘¡ æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œåº•å±‚ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•¿åº¦ä¸º10çš„æ•°ç»„</p><p>â‘¢ å­˜æ»¡æ—¶ï¼Œä¼šæ‰©å®¹1.5å€</p><p>â‘£ å¦‚æœä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ ï¼Œ1.5å€è¿˜æ”¾ä¸ä¸‹ï¼Œåˆ™æ–°åˆ›å»ºæ•°ç»„çš„é•¿åº¦ä»¥å®é™…ä¸ºå‡†</p><blockquote><p>ä¸ºä»€ä¹ˆæ˜¯1.5å€</p></blockquote><p>å‡è®¾æˆ‘ä»¬åœ¨ä½¿ç”¨<code>ArrayList</code>çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šåˆå§‹åŒ–çš„æ—¶å€™æ•°ç»„çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´åˆå§‹é•¿åº¦ä¸º<code>ArrayList</code>çš„é»˜è®¤é•¿åº¦ä¹Ÿå°±æ˜¯10ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬ä¸åœåœ°å¾€å®¹å™¨å½“ä¸­å¢åŠ æ•°æ®ï¼Œæ‰©å®¹å¯¼è‡´çš„æ•°ç»„é•¿åº¦çš„å˜åŒ–å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ¨ªè½´è¡¨ç¤ºæ‰©å®¹æ¬¡æ•°ï¼Œçºµè½´è¡¨ç¤ºæ•°ç»„é•¿åº¦ï¼Œè“è‰²çš„æ‰©å®¹ä¸ºåŸæ•°ç»„é•¿åº¦çš„1.5å€ï¼Œå¦å¤–ä¸€æ¡æ˜¯2å€ã€‚æˆ‘ä»¬å¾ˆæ¸…æ™°çš„å‘ç°æ‰©å®¹ä¸ºåŸæ¥çš„<code>2å€</code>åœ¨åæœŸçš„æ•°ç»„é•¿åº¦å°†ä¼šè¿œå¤§äºæ‰©å®¹<code>1.5å€</code>ã€‚è¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬ä¼šæµªè´¹å¾ˆå¤§çš„æ•°ç»„ç©ºé—´ï¼Œæ¯”å¦‚è¯´åˆšå¥½åŠ å…¥æœ€åä¸€ä¸ªæ•°æ®çš„æ—¶å€™å¯¼è‡´<code>ArrayList</code>è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œè¿™å¯èƒ½æ˜¯<code>ArrayList</code>åœ¨è®¾è®¡æ—¶å€™çš„è€ƒé‡ã€‚</p><img src="https://img2022.cnblogs.com/blog/2519003/202207/2519003-20220707231216216-531592090.png" alt="img" style="zoom:67%;" /><p>1.5^8=25.6</p><p>2^8=256</p><hr><hr><h2 id="LinkedListç»§æ‰¿ä½“ç³»">LinkedListç»§æ‰¿ä½“ç³»</h2><p>é¦–å…ˆå…ˆç›´è§‚çš„çœ‹ä¸€ä¸‹<code>LinedList</code>çš„ç»§æ‰¿ä½“ç³»å’Œå®ç°çš„æ¥å£</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220704233923694-1289934053.png" alt="img" style="zoom:67%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractSequentialList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure><ul><li>å®ç°äº†<code>List</code>æ¥å£ï¼Œè¿™ä¸ªæ¥å£å®šä¹‰äº†ä¸€äº›å¸¸è§çš„å®¹å™¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>add</code>ã€<code>addAll</code>ã€<code>get</code>ã€<code>set</code>ã€<code>contains</code>ã€<code>sort</code>ç­‰ç­‰ã€‚</li><li>å®ç°äº†<code>Deque</code>æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½ å¯ä»¥ç®€å•çš„è®¤ä¸ºæ˜¯ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œä¸¤å¤´éƒ½å¯ä»¥è¿›å¯ä»¥å‡ºï¼Œå®ƒå®šä¹‰çš„æ–¹æ³•æœ‰<code>getFirst</code>ã€<code>getLast</code>ã€<code>addFirst</code>ã€<code>addLast</code>ã€<code>removeFirst</code>ã€<code>removeLast</code>ã€<code>peekFirst</code>ã€<code>peekLast</code>ç­‰ç­‰ã€‚</li><li>å®ç°<code>Cloneable</code>å’Œ<code>Serializable</code>æ¥å£ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿè¿›è¡Œæ·±æ‹·è´å’Œåºåˆ—åŒ–ã€‚</li><li><code>AbstractSequentialList</code>ä¸»è¦æ˜¯ç»™ä¸€äº›æ¥å£æ–¹æ³•æä¾›é»˜è®¤å®ç°ã€‚</li></ul><p>é“¾è¡¨ä½œä¸ºä¸€ä¸ªå®¹å™¨è‚¯å®šéœ€è¦å°†æ•°æ®åŠ å…¥åˆ°å®¹å™¨å½“ä¸­ï¼Œä¹Ÿéœ€è¦ä»å®¹å™¨å½“ä¸­å¾—åˆ°æŸä¸ªæ•°æ®ï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨å®¹å™¨å½“ä¸­ï¼Œå› æ­¤æœ‰<code>add</code>ã€<code>addAll</code>ã€<code>get</code>ã€<code>set</code>ã€<code>contains</code>ã€<code>sort</code>è¿™äº›æ–¹æ³•æ˜¯å¾ˆè‡ªç„¶çš„ã€‚æ­¤å¤–<code>LinedList</code>å®ç°çš„æ˜¯åŒå‘é“¾è¡¨ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“åœ¨é“¾è¡¨çš„ä»»æ„ä½ç½®è¿›è¡Œæ’å…¥å’Œåˆ é™¤ï¼Œå½“æˆ‘ä»¬åœ¨é“¾è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤çš„æ—¶å€™å°±å¯ä»¥æ»¡è¶³<code>Deque</code>çš„éœ€æ±‚äº†ï¼ˆåŒç«¯é˜Ÿåˆ—éœ€è¦èƒ½å¤Ÿåœ¨é˜Ÿåˆ—çš„å¤´å’Œå°¾è¿›è¡Œå‡ºé˜Ÿå’Œå…¥é˜Ÿï¼Œå°±ç›¸å½“äºæ’å…¥å’Œåˆ é™¤ï¼‰ï¼Œå› æ­¤<code>LinedList</code>å®ç°<code>getFirst</code>ã€<code>getLast</code>ã€<code>addFirst</code>ã€<code>addLast</code>ã€<code>removeFirst</code>ã€<code>removeLast</code>ä¹Ÿå°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚</p><hr><hr><h2 id="LinkedListæ•´ä½“ç»“æ„">LinkedListæ•´ä½“ç»“æ„</h2><mark class="hl-label blue">ä¸»è¦å­—æ®µ</mark> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// ç”¨äºè®°å½•é“¾è¡¨å½“ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯æœ‰å‡ ä¸ªæ•°æ®</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Pointer to first node.</span></span><br><span class="line"><span class="comment">    * Invariant: (first == null &amp;&amp; last == null) ||</span></span><br><span class="line"><span class="comment">    *            (first.prev == null &amp;&amp; first.item != null)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">transient</span> Node&lt;E&gt; first; <span class="comment">// æŒ‡å‘åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Pointer to last node.</span></span><br><span class="line"><span class="comment">    * Invariant: (first == null &amp;&amp; last == null) ||</span></span><br><span class="line"><span class="comment">    *            (last.next == null &amp;&amp; last.item != null)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">transient</span> Node&lt;E&gt; last; <span class="comment">// æŒ‡å‘åŒå‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹</span></span><br></pre></td></tr></table></figure><mark class="hl-label green">å†…éƒ¨èŠ‚ç‚¹çš„å½¢å¼</mark> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt; &#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"> </span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = element;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„å­—æ®µåˆ†æï¼Œ<code>LinkedList</code>å†…éƒ¨ç»“æ„ä¸»è¦å¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/2519003-20220704233936333-32626593.png" alt="img" style="zoom:67%;" /><p>é“¾è¡¨å½“ä¸­æœ‰<code>first</code>å’Œ<code>last</code>å­—æ®µä¸»è¦æŒ‡å‘é“¾è¡¨å½“ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœé“¾è¡¨å½“ä¸­æ²¡æœ‰èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»–ä»¬éƒ½æ˜¯<code>null</code>ï¼Œå¦‚æœé“¾è¡¨å½“ä¸­æœ‰ä¸€ä¸ªèŠ‚ç‚¹ä»–ä»¬æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœé“¾è¡¨ä¸­èŠ‚ç‚¹ä¸ªæ•°å¤§äº2ï¼Œä»–ä»¬åˆ†åˆ«æŒ‡å‘ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><hr><h2 id="LinkedListä¸»è¦æ–¹æ³•">LinkedListä¸»è¦æ–¹æ³•</h2><h3 id="add-2">add</h3><p><code>add</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯å‘é“¾è¡¨å°¾éƒ¨å¢åŠ ä¸€ä¸ªå…ƒç´ ã€‚</p><div class="tabs" id="f35b9d04-2acd-45e7-b0f1-fd07df6de800"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#f35b9d04-2acd-45e7-b0f1-fd07df6de800-1"><i class="fas fa-cat"></i>add</button></li><li class="tab"><button type="button" data-href="#f35b9d04-2acd-45e7-b0f1-fd07df6de800-2"><i class="fas fa-horse"></i>linkLast</button></li><li class="tab"><button type="button" data-href="#f35b9d04-2acd-45e7-b0f1-fd07df6de800-3"><i class="fas fa-heartbeat"></i>linkBefore</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="f35b9d04-2acd-45e7-b0f1-fd07df6de800-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯å‘é“¾è¡¨å°¾éƒ¨å¢åŠ ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f35b9d04-2acd-45e7-b0f1-fd07df6de800-2"><p>å‘é“¾è¡¨å°¾éƒ¨å¢åŠ ä¸€ä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">linkLast</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(l, e, <span class="literal">null</span>);</span><br><span class="line">    last = newNode;</span><br><span class="line">    <span class="keyword">if</span> (l == <span class="literal">null</span>)</span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        l.next = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f35b9d04-2acd-45e7-b0f1-fd07df6de800-3"><p><code>linkBefore</code>å’Œ<code>linkLast</code>çš„ä½œç”¨ç›¸åï¼Œæ˜¯åœ¨æŸä¸ªèŠ‚ç‚¹å‰é¢æ’å…¥æ•°æ®<code>e</code>ï¼Œå¤§ä½“å’Œå‰é¢çš„<code>linkLast</code>æ–¹æ³•ä¸€è‡´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Inserts element e before non-null Node succ.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">linkBefore</span><span class="params">(E e, Node&lt;E&gt; succ)</span> &#123;</span><br><span class="line">    <span class="comment">// assert succ != null;</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; pred = succ.prev;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(pred, e, succ);</span><br><span class="line">    succ.prev = newNode;</span><br><span class="line">    <span class="keyword">if</span> (pred == <span class="literal">null</span>)</span><br><span class="line">        first = newNode;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        pred.next = newNode;</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="getå’Œset-2">getå’Œset</h3><div class="tabs" id="2ca762ce-3adb-46d9-b490-59bdef0bbc39"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#2ca762ce-3adb-46d9-b490-59bdef0bbc39-1"><i class="fas fa-award"></i>get</button></li><li class="tab"><button type="button" data-href="#2ca762ce-3adb-46d9-b490-59bdef0bbc39-2"><i class="fas fa-baseball-ball"></i>set</button></li><li class="tab"><button type="button" data-href="#2ca762ce-3adb-46d9-b490-59bdef0bbc39-3"><i class="fas fa-bone"></i>node</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="2ca762ce-3adb-46d9-b490-59bdef0bbc39-1"><p>é€šè¿‡ä¸‹æ ‡è·å–æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    checkElementIndex(index); <span class="comment">// åˆ¤æ–­ä¸‹æ ‡æ˜¯å¦åˆæ³•</span></span><br><span class="line">    <span class="keyword">return</span> node(index).item; <span class="comment">// å–å‡ºå¯¹åº”çš„æ•°æ®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2ca762ce-3adb-46d9-b490-59bdef0bbc39-2"><p>æ›´æ–°æŸä¸ªä¸‹æ ‡çš„æ•°æ®<code>item</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">       checkElementIndex(index); <span class="comment">// åˆ¤æ–­ä¸‹æ ‡æ˜¯å¦åˆæ³•</span></span><br><span class="line">       Node&lt;E&gt; x = node(index);</span><br><span class="line">       <span class="type">E</span> <span class="variable">oldVal</span> <span class="operator">=</span> x.item;</span><br><span class="line">       x.item = element; <span class="comment">// æ›´æ–°æ•°æ®</span></span><br><span class="line">       <span class="keyword">return</span> oldVal; <span class="comment">// è¿”å›æ—§æ•°æ®</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2ca762ce-3adb-46d9-b490-59bdef0bbc39-3"><p>æ ¹æ®ä¸‹æ ‡æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Node&lt;E&gt; <span class="title function_">node</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°ç¬¬ index + 1 ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="comment">// åˆ¤æ–­å¯¹åº”ä½ç½®çš„å…ƒç´ æ˜¯ç¦»é“¾è¡¨å¤´éƒ¨è¿‘è¿˜æ˜¯ç¦»é“¾è¡¨å°¾éƒ¨è¿‘ï¼Œå“ªå¤´è¿‘å°±ä»å“ªå¤´éå†</span></span><br><span class="line">    <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;</span><br><span class="line">        Node&lt;E&gt; x = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++)</span><br><span class="line">            x = x.next;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;E&gt; x = last;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> size - <span class="number">1</span>; i &gt; index; i--)</span><br><span class="line">            x = x.prev;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="remove-3">remove</h3><div class="tabs" id="c97870d9-78a0-4bce-98ab-0dca438c346f"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#c97870d9-78a0-4bce-98ab-0dca438c346f-1"><i class="fas fa-atom"></i>remove</button></li><li class="tab"><button type="button" data-href="#c97870d9-78a0-4bce-98ab-0dca438c346f-2"><i class="far fa-sun"></i>unlink</button></li><li class="tab"><button type="button" data-href="#c97870d9-78a0-4bce-98ab-0dca438c346f-3"><i class="fas fa-wind"></i>unlinkFirst</button></li><li class="tab"><button type="button" data-href="#c97870d9-78a0-4bce-98ab-0dca438c346f-4"><i class="fas fa-fire-alt"></i>unlinkLast</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="c97870d9-78a0-4bce-98ab-0dca438c346f-1"><p>åˆ é™¤é“¾è¡¨å½“ä¸­çš„æŸä¸ªå…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå…ƒç´ ä¸º nullï¼Œå°±åˆ é™¤é“¾è¡¨å½“ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸º null çš„å…ƒç´ </span></span><br><span class="line">    <span class="comment">// ä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡º LinkedList æ”¯æŒå€¼ä¸º null çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="literal">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x.item == <span class="literal">null</span>) &#123;</span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="literal">null</span>; x = x.next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.equals(x.item)) &#123;</span><br><span class="line">                unlink(x);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c97870d9-78a0-4bce-98ab-0dca438c346f-2"><p>åˆ é™¤æŸä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Unlinks non-null node x.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">E <span class="title function_">unlink</span><span class="params">(Node&lt;E&gt; x)</span> &#123;</span><br><span class="line">    <span class="comment">// assert x != null;</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> x.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = x.next;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; prev = x.prev;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœå‰ä¸€ä¸ªèŠ‚ç‚¹ä¸º null è¯´æ˜è¢«åˆ é™¤çš„å°±æ˜¯é¦–èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦è·Ÿæ–°é¦–èŠ‚ç‚¹ä¸ºåŸæ¥èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ next</span></span><br><span class="line">    <span class="keyword">if</span> (prev == <span class="literal">null</span>) &#123;</span><br><span class="line">        first = next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        prev.next = next;</span><br><span class="line">        x.prev = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// åŒæ ·çš„ï¼Œå¦‚æœ next ä¸º null ï¼Œé‚£ä¹ˆè¢«åˆ é™¤çš„èŠ‚ç‚¹å°±æ˜¯ä¸ºèŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦æ›´æ–° last ä¸ºè¢«åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (next == <span class="literal">null</span>) &#123;</span><br><span class="line">        last = prev;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        next.prev = prev;</span><br><span class="line">        x.next = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    x.item = <span class="literal">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c97870d9-78a0-4bce-98ab-0dca438c346f-3"><p>åˆ é™¤é“¾è¡¨å½“ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> E <span class="title function_">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> &#123;</span><br><span class="line">    <span class="comment">// f è¡¨ç¤ºå¤´ç»“ç‚¹ï¼Œä¸” f ä¸ç­‰äº null</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> f.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    f.item = <span class="literal">null</span>;</span><br><span class="line">    f.next = <span class="literal">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    first = next; <span class="comment">// å¤´ç»“ç‚¹å˜æˆfçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (next == <span class="literal">null</span>)</span><br><span class="line">        last = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        next.prev = <span class="literal">null</span>;</span><br><span class="line">    size--; <span class="comment">// åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹é“¾è¡¨å½“ä¸­æ•°æ®å°‘äº†ä¸€ä¸ªï¼Œå› æ­¤size--</span></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c97870d9-78a0-4bce-98ab-0dca438c346f-4"><p>åˆ é™¤é“¾è¡¨å½“ä¸­æœ€åä¸€ä¸ªèŠ‚ç‚¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> E <span class="title function_">unlinkLast</span><span class="params">(Node&lt;E&gt; l)</span> &#123;</span><br><span class="line">    <span class="comment">// assert l == last &amp;&amp; l != null;</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> l.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; prev = l.prev;</span><br><span class="line">    l.item = <span class="literal">null</span>;</span><br><span class="line">    l.prev = <span class="literal">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    last = prev;</span><br><span class="line">    <span class="keyword">if</span> (prev == <span class="literal">null</span>)</span><br><span class="line">        first = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        prev.next = <span class="literal">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="clone-2">clone</h3><p>å½“æˆ‘ä»¬æƒ³è¦å…‹éš†ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é€šå¸¸æ˜¯å°†è¢«å…‹éš†çš„å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>LinkedList</code>çš„<code>clone</code>æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“<code>LinkedList</code>çš„å…‹éš†æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„é“¾è¡¨ä½†æ˜¯æ²¡æœ‰æ”¹å˜é‡Œé¢çš„æ•°æ®ï¼Œå› æ­¤å¦‚æœä½ ä¿®æ”¹å…‹éš†é“¾è¡¨ä¸­çš„æ•°æ®çš„è¯ï¼ŒåŸæ¥çš„é“¾è¡¨é‡Œé¢çš„æ•°æ®ä¹Ÿä¼šæ”¹ã€‚</p><div class="tabs" id="ce746b79-24bb-4517-9916-86e9830c22b2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ce746b79-24bb-4517-9916-86e9830c22b2-1"><i class="fas fa-bug"></i>clone</button></li><li class="tab"><button type="button" data-href="#ce746b79-24bb-4517-9916-86e9830c22b2-2"><i class="fas fa-cannabis"></i>superClone</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ce746b79-24bb-4517-9916-86e9830c22b2-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">clone</span><span class="params">()</span> &#123;</span><br><span class="line">    LinkedList&lt;E&gt; clone = superClone();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Put clone into &quot;virgin&quot; state</span></span><br><span class="line">    clone.first = clone.last = <span class="literal">null</span>;</span><br><span class="line">    clone.size = <span class="number">0</span>;</span><br><span class="line">    clone.modCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize clone with our elements</span></span><br><span class="line">    <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != <span class="literal">null</span>; x = x.next)</span><br><span class="line">        clone.add(x.item);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ce746b79-24bb-4517-9916-86e9830c22b2-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> LinkedList&lt;E&gt; <span class="title function_">superClone</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (LinkedList&lt;E&gt;) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InternalError</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
    
    
    <summary type="html">ArrayListå’ŒLinkedListè®¾è®¡åˆ†æ</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰åºé›†åˆæ¥å£List</title>
    <link href="https://wuwawawa.github.io/posts/494ad091.html"/>
    <id>https://wuwawawa.github.io/posts/494ad091.html</id>
    <published>2023-05-16T11:22:46.000Z</published>
    <updated>2023-05-20T03:04:35.445Z</updated>
    
    <content type="html"><![CDATA[<img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/List%E4%BD%93%E7%B3%BB%E5%9B%BE1.jpg" alt="Listä½“ç³»å›¾1" style="zoom:50%;" /><h2 id="Listé›†åˆçš„æ¦‚è¿°å’Œç‰¹ç‚¹">Listé›†åˆçš„æ¦‚è¿°å’Œç‰¹ç‚¹</h2><blockquote><p>Listé›†åˆçš„æ¦‚è¿°</p></blockquote><ul><li>æœ‰åºé›†åˆ,è¿™é‡Œçš„æœ‰åºæŒ‡çš„æ˜¯å­˜å–é¡ºåº</li><li>ç”¨æˆ·å¯ä»¥ç²¾ç¡®æ§åˆ¶åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®,ç”¨æˆ·å¯ä»¥é€šè¿‡æ•´æ•°ç´¢å¼•è®¿é—®å…ƒç´ ,å¹¶æœç´¢åˆ—è¡¨ä¸­çš„å…ƒç´ </li><li>ä¸Seté›†åˆä¸åŒ,åˆ—è¡¨é€šå¸¸å…è®¸é‡å¤çš„å…ƒç´ </li></ul><blockquote><p>Listé›†åˆçš„ç‰¹ç‚¹</p></blockquote><ul><li>æœ‰åºï¼š å­˜å’Œå–çš„å…ƒç´ é¡ºåºä¸€è‡´</li><li>æœ‰ç´¢å¼•ï¼š å¯ä»¥é€šè¿‡ç´¢å¼•æ“ä½œå…ƒç´ </li><li>å¯é‡å¤ï¼šå­˜å‚¨çš„å…ƒç´ å¯ä»¥é‡å¤</li></ul><hr><hr><h2 id="Listé›†åˆçš„ç‰¹æœ‰æ–¹æ³•">Listé›†åˆçš„ç‰¹æœ‰æ–¹æ³•</h2><ul><li>Collectionçš„æ–¹æ³•Listéƒ½ç»§æ‰¿äº†</li><li>Listé›†åˆå› ä¸ºæœ‰ç´¢å¼•ï¼Œç´¢å¼•å¤šäº†å¾ˆå¤šç´¢å¼•æ“ä½œçš„æ–¹æ³•</li></ul><table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th></tr></thead><tbody><tr><td>void add(int index,E element)</td><td>åœ¨æ­¤é›†åˆä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td>E remove(int index)</td><td>åˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ ï¼Œè¿”å›è¢«åˆ é™¤çš„å…ƒç´ </td></tr><tr><td>E set(int index,E element)</td><td>ä¿®æ”¹æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ ï¼Œè¿”å›è¢«ä¿®æ”¹çš„å…ƒç´ </td></tr><tr><td>E get(int index)</td><td>è¿”å›æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ </td></tr><tr><td>int indexOf(Object o);</td><td>è¿”å›æŒ‡å®šå…ƒç´ çš„ç´¢å¼•</td></tr><tr><td>ListIterator&lt; E &gt; listIterator();</td><td>è¿”å›åˆ—è¡¨è¿­ä»£å™¨</td></tr></tbody></table><blockquote><p>Listç³»åˆ—é›†åˆä¸­ä¸¤ä¸ªå¢åŠ çš„æ–¹æ³•</p></blockquote><p>ç¬¬ä¸€ä¸ªCollectionæ¥å£ä¸­æ–¹æ³• <code> boolean add(E e);</code>æ·»åŠ æŒ‡å®šçš„å…ƒç´ ,è¿”å›å€¼è¡¨ç¤ºå½“å‰å…ƒç´ æ˜¯å¦æ·»åŠ æˆåŠŸ</p><p>ç¬¬äºŒä¸ªListæ¥å£ä¸­æ–¹æ³• <code> void add(int index,E element)</code> æ·»åŠ æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œæ— è¿”å›å€¼</p><blockquote><p>Listç³»åˆ—é›†åˆä¸­ä¸¤ä¸ªåˆ é™¤çš„æ–¹æ³•</p></blockquote><p>ç¬¬ä¸€ä¸ªCollectionæ¥å£ä¸­æ–¹æ³•  <code> boolean remove(Object o)</code>åˆ é™¤æŒ‡å®šçš„å…ƒç´ ,è¿”å›å€¼è¡¨ç¤ºå½“å‰å…ƒç´ æ˜¯å¦åˆ é™¤æˆåŠŸ</p><p>ç¬¬äºŒä¸ªListæ¥å£ä¸­æ–¹æ³• <code> E remove(int index)</code> åˆ é™¤æŒ‡å®šç´¢å¼•çš„å…ƒç´ ,è¿”å›å€¼è¡¨ç¤ºå®é™…åˆ é™¤çš„å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. åˆ›å»ºé›†åˆå¹¶æ·»åŠ å…ƒç´ </span></span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="number">1</span>);</span><br><span class="line">list.add(<span class="number">2</span>);</span><br><span class="line">list.add(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. åˆ é™¤å…ƒç´ </span></span><br><span class="line"><span class="comment">//è¯·é—®ï¼šæ­¤æ—¶åˆ é™¤çš„æ˜¯1è¿™ä¸ªå…ƒç´ ï¼Œè¿˜æ˜¯1ç´¢å¼•ä¸Šçš„å…ƒç´  ä¸ºä»€ä¹ˆ</span></span><br><span class="line"><span class="comment">//åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœå‡ºç°äº†é‡è½½ç°è±¡</span></span><br><span class="line"><span class="comment">//ä¼˜å…ˆè°ƒç”¨ï¼Œå®å‚å’Œå½¢å‚ç±»å‹ä¸€è‡´çš„é‚£ä¸ªæ–¹æ³•</span></span><br><span class="line">list.remove(<span class="number">1</span>);</span><br><span class="line">System.out.println(list);</span><br><span class="line"><span class="comment">//[1, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰‹åŠ¨è£…ç®±,æ‰‹åŠ¨æŠŠåŸºæœ¬æ•°æ®ç±»å‹çš„1ï¼Œå˜æˆIntegerç±»å‹</span></span><br><span class="line"><span class="comment">// æ­¤æ—¶åˆ é™¤çš„å°±æ˜¯1è¿™ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> Integer.valueOf(<span class="number">1</span>);</span><br><span class="line">list.remove(i);</span><br><span class="line">System.out.println(list);</span><br><span class="line"><span class="comment">//[3]</span></span><br></pre></td></tr></table></figure><hr><h2 id="Listé›†åˆçš„éå†æ–¹å¼">Listé›†åˆçš„éå†æ–¹å¼</h2><p>Listç»§æ‰¿äºCollectionï¼Œä¸‰ç§éå†æ–¹å¼ä¹Ÿéƒ½å¯ä»¥ç”¨</p><ul><li>è¿­ä»£å™¨éå†</li><li>å¢å¼ºforéå†</li><li>Lambdaè¡¨è¾¾å¼éå†</li></ul><p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿˜æœ‰ä¸¤ç§å•ç‹¬çš„éå†æ–¹å¼</p><ul><li>åˆ—è¡¨è¿­ä»£å™¨éå†</li><li>æ™®é€šforå¾ªç¯ï¼ˆå› ä¸ºListé›†åˆå­˜åœ¨ç´¢å¼•ï¼‰</li></ul><p>åˆ›å»ºé›†åˆå¹¶æ·»åŠ å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. åˆ›å»ºé›†åˆå¹¶æ·»åŠ å…ƒç´ </span></span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;ccc&quot;</span>);</span><br></pre></td></tr></table></figure><div class="tabs" id="1c246663-c60c-42f3-ba8d-77e38f358527"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#1c246663-c60c-42f3-ba8d-77e38f358527-1"><i class="fas fa-child"></i>è¿­ä»£å™¨</button></li><li class="tab"><button type="button" data-href="#1c246663-c60c-42f3-ba8d-77e38f358527-2"><i class="fas fa-child"></i>å¢å¼ºfor</button></li><li class="tab"><button type="button" data-href="#1c246663-c60c-42f3-ba8d-77e38f358527-3"><i class="fas fa-child"></i>Lambdaè¡¨è¾¾å¼</button></li><li class="tab"><button type="button" data-href="#1c246663-c60c-42f3-ba8d-77e38f358527-4"><i class="fas fa-cookie-bite"></i>åˆ—è¡¨è¿­ä»£å™¨</button></li><li class="tab"><button type="button" data-href="#1c246663-c60c-42f3-ba8d-77e38f358527-5"><i class="fas fa-cookie-bite"></i>æ™®é€šfor</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="1c246663-c60c-42f3-ba8d-77e38f358527-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.è¿­ä»£å™¨</span></span><br><span class="line">Iterator&lt;String&gt; iterator = list.iterator();</span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1c246663-c60c-42f3-ba8d-77e38f358527-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.å¢å¼ºfor</span></span><br><span class="line"><span class="keyword">for</span> (String str : list) &#123;</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1c246663-c60c-42f3-ba8d-77e38f358527-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.Lambdaè¡¨è¾¾å¼</span></span><br><span class="line"> list.forEach(System.out::println);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1c246663-c60c-42f3-ba8d-77e38f358527-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.åˆ—è¡¨è¿­ä»£å™¨</span></span><br><span class="line">ListIterator&lt;String&gt; stringListIterator = list.listIterator();</span><br><span class="line"><span class="keyword">while</span> (stringListIterator.hasNext()) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span>  stringListIterator.next();</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1c246663-c60c-42f3-ba8d-77e38f358527-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5.æ™®é€šforå¾ªç¯</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">    System.out.println(list.get(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><code>ListIterator</code>æ¥å£ç»§æ‰¿äº†<code>Iterator</code>æ¥å£</p><p><code>interface ListIterator&lt;E&gt; extends Iterator&lt;E&gt;</code></p><p><code>Iterator</code>åŸæœ‰æ–¹æ³•<code>boolean hasNext()</code> å’Œ <code>E next()</code></p><p><code>ListIterator</code>æ–°åŠ äº†<code>boolean hasPrevious();</code>å’Œ<code>E previous()</code>å‘å‰éå†</p><p>å’Œ<code>void add(E e)</code>æ·»åŠ å…ƒç´ çš„æ–¹æ³•</p><blockquote><p>äº”ç§éå†æ–¹å¼å¯¹æ¯”</p></blockquote><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230516205838333.png" alt="image-20230516205838333" style="zoom:67%;" />]]></content>
    
    
    <summary type="html">Listä¸­å¸¸è§çš„æ–¹æ³•å’Œäº”ç§éå†æ–¹å¼</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>é¡¶å±‚æ¥å£Collection</title>
    <link href="https://wuwawawa.github.io/posts/71c14870.html"/>
    <id>https://wuwawawa.github.io/posts/71c14870.html</id>
    <published>2023-05-16T06:05:20.000Z</published>
    <updated>2023-05-23T12:33:19.927Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é›†åˆä½“ç³»ç»“æ„">é›†åˆä½“ç³»ç»“æ„</h2><p>Javaçš„å®¹å™¨ä¸»è¦åˆ†ä¸º2ä¸ªå¤§ç±»ï¼Œå³<code>Collection</code>å’Œ<code>Map</code>ã€‚</p><ul><li><span class='p red'>Collection æ¥å£ï¼ˆå•åˆ—é›†åˆï¼‰</span>ï¼šå¯ä»¥å­˜æ”¾å¤šä¸ªå…ƒç´ ã€‚æ¯ä¸ªå…ƒç´ å¯ä»¥æ˜¯ Object<p>Collection æ¥å£æœ‰ä¸¤ä¸ªé‡è¦å­æ¥å£ï¼šListï¼ˆæœ‰åºé›†åˆï¼‰å’Œ Setï¼ˆæ— åºé›†åˆï¼‰</p></li><li><span class='p blue'>Map æ¥å£ï¼ˆåŒåˆ—é›†åˆï¼‰</span>ï¼šç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ï¼škey - valueï¼ˆåŒåˆ—å…ƒç´ ï¼‰<p>key å’Œ value å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¼•ç”¨æ•°æ®ç±»å‹ã€‚å…¶ä¸­ key ä¸èƒ½é‡å¤ï¼Œvalue å¯ä»¥é‡å¤</p><p>key å’Œ value å­˜åœ¨å•ä¸€å¯¹åº”å…³ç³»ã€‚é€šè¿‡ç‰¹å®šçš„ key ä¸€å®šèƒ½æ‰¾åˆ°æŒ‡å®šçš„ value</p></li></ul><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230516142001202.png" alt="image-20230516142001202" style="zoom:67%;" /><hr><hr><h2 id="Collectionç»§æ‰¿ä½“ç³»">Collectionç»§æ‰¿ä½“ç³»</h2><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230516142842394.png" alt="image-20230516142842394" style="zoom:67%;" /><p>æ ¹æ®å›¾ï¼Œé¦–å…ˆæä¸€ä¸‹<code>List</code> <code>Queue</code> <code>Set</code> è¿™ä¸‰ä¸ªçš„åŒºåˆ«ã€‚</p><p><code>List(å¯¹ä»˜é¡ºåºçš„å¥½å¸®æ‰‹)</code>: æ·»åŠ çš„å…ƒç´ æ˜¯æœ‰åºã€å¯é‡å¤ã€æœ‰ç´¢å¼•çš„ã€‚<br><code>Set(æ³¨é‡ç‹¬ä¸€æ— äºŒçš„æ€§è´¨)</code>ï¼šæ·»åŠ çš„å…ƒç´ æ˜¯æ— åºçš„ã€ä¸å¯é‡å¤ã€æ— ç´¢å¼•çš„ã€‚<br><code>Queue(å®ç°æ’é˜ŸåŠŸèƒ½çš„å«å·æœº)</code>:æŒ‰ç‰¹å®šçš„æ’é˜Ÿè§„åˆ™æ¥ç¡®å®šå…ˆåé¡ºåºï¼Œå­˜å‚¨çš„å…ƒç´ æ˜¯æœ‰åºçš„ã€å¯é‡å¤çš„ã€‚</p><hr><hr><h2 id="Collectionæ¥å£æ–¹æ³•">Collectionæ¥å£æ–¹æ³•</h2><p>Collectionæ˜¯å•åˆ—é›†åˆçš„ç¥–å®—æ¥å£ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å…¨éƒ¨å•åˆ—é›†åˆéƒ½å¯ä»¥ç»§æ‰¿ä½¿ç”¨çš„ã€‚</p><p>JDKä¸æä¾›æ­¤æ¥å£çš„ä»»ä½•ç›´æ¥å®ç°.å®ƒæä¾›æ›´å…·ä½“çš„å­æ¥å£(å¦‚Setå’ŒList)å®ç°</p><table><thead><tr><th style="text-align:left">æ–¹æ³•å</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">boolean add(E e)</td><td style="text-align:left">æ·»åŠ å…ƒç´ </td></tr><tr><td style="text-align:left">boolean addAll(Collection&lt;? extends E&gt; c)</td><td style="text-align:left">æ·»åŠ å¤šä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left">boolean remove(Object o)</td><td style="text-align:left">ç§»é™¤æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean removeIf(Predicate&lt;? super E&gt; filter)</td><td style="text-align:left">æ ¹æ®æ¡ä»¶è¿›è¡Œç§»é™¤</td></tr><tr><td style="text-align:left">boolean removeAll(Collection&lt;?&gt; c)</td><td style="text-align:left">ç§»é™¤å¤šä¸ªå…ƒç´ </td></tr><tr><td style="text-align:left">void clear()</td><td style="text-align:left">æ¸…ç©ºé›†åˆä¸­çš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean contains(Object o)</td><td style="text-align:left">åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td style="text-align:left">boolean isEmpty()</td><td style="text-align:left">åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º</td></tr><tr><td style="text-align:left">int size()</td><td style="text-align:left">é›†åˆçš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</td></tr></tbody></table><blockquote><p>æ·»åŠ å…ƒç´  boolean add(E e)</p></blockquote><p>ç»†èŠ‚1ï¼šå¦‚æœæˆ‘ä»¬è¦å¾€Listç³»åˆ—é›†åˆæ·»åŠ æ•°æ®ï¼Œé‚£ä¹ˆæ–¹æ³•æ°¸è¿œè¿”å›tureï¼Œå› ä¸ºListç³»åˆ—æ˜¯å…è®¸å…ƒç´ é‡å¤çš„ã€‚</p><p>ç»†èŠ‚2ï¼šå¦‚æœæˆ‘ä»¬è¦å¾€Setç³»åˆ—é›†åˆæ·»åŠ æ•°æ®</p><p>å¦‚æœå½“å‰è¦æ·»åŠ çš„å…ƒç´ ä¸å­˜åœ¨ï¼Œæ–¹æ³•è¿”å›trueï¼Œè¡¨ç¤ºæ·»åŠ æˆåŠŸã€‚</p><p>å¦‚æœå½“å‰è¦æ·»åŠ çš„å…ƒç´ å­˜åœ¨ï¼Œæ–¹æ³•è¿”å›falseï¼Œè¡¨ç¤ºæ·»åŠ å¤±è´¥ã€‚</p><p>å› ä¸ºSetç³»åˆ—é›†åˆä¸å…è®¸é‡å¤ã€‚</p><blockquote><p>ç§»é™¤å…ƒç´  boolean remove(Object o)</p></blockquote><p>ç»†èŠ‚1ï¼šæ ¹æ®å…ƒç´ çš„å¯¹è±¡è¿›è¡Œåˆ é™¤ï¼Œä¸èƒ½é€šè¿‡ç´¢å¼•åˆ ï¼Œå› ä¸ºSetç³»åˆ—æ˜¯æ²¡æœ‰ç´¢å¼•çš„ï¼Œåœ¨Collectionä¸­å®šä¹‰çš„æ˜¯å…±æ€§çš„æ–¹æ³•ã€‚</p><p>ç»†èŠ‚2ï¼šæ–¹æ³•ä¼šæœ‰ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„è¿”å›å€¼ï¼Œåˆ é™¤æˆåŠŸè¿”å›trueï¼Œåˆ é™¤å¤±è´¥è¿”å›falseã€‚å¦‚æœè¦åˆ é™¤çš„å…ƒç´ ä¸å­˜åœ¨ï¼Œå°±ä¼šåˆ é™¤å¤±è´¥ã€‚</p><blockquote><p>åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ…å« boolean contains(Object o)</p></blockquote><p>åº•å±‚æ˜¯ä¾èµ–equalsæ–¹æ³•è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœé›†åˆä¸­å­˜å‚¨çš„æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œä¹Ÿæƒ³é€šè¿‡containsæ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦åŒ…å«ï¼Œé‚£ä¹ˆåœ¨è‡ªå®šä¹‰ç±»ä¸­ï¼Œä¸€å®šè¦é‡å†™equalsæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.åˆ›å»ºé›†åˆçš„å¯¹è±¡</span></span><br><span class="line">Collection&lt;Studebt&gt; coll = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.åˆ›å»ºä¸‰ä¸ªå­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>,<span class="number">23</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;lisi&quot;</span>,<span class="number">24</span>);</span><br><span class="line"><span class="type">Student</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;wangwu&quot;</span>,<span class="number">23</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.æŠŠå­¦ç”Ÿå¯¹è±¡æ·»åŠ åˆ°é›†åˆå½“ä¸­</span></span><br><span class="line">coll.add(s1);</span><br><span class="line">coll.add(s2);</span><br><span class="line">coll.add(s3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.åˆ¤æ–­é›†åˆä¸­æŸä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡æ˜¯å¦åŒ…å«ï¼Œå¦‚æœåŒå§“ååŒå¹´é¾„ï¼Œå°±è®¤ä¸ºæ˜¯</span></span><br><span class="line"><span class="type">Student</span> <span class="variable">s4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;zhangsan&quot;</span>,<span class="number">23</span>);</span><br><span class="line"><span class="comment">// å› ä¸ºcontainsæ–¹æ³•åœ¨åº•å±‚ä¾èµ–equalsæ–¹æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸€è‡´çš„ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœå­˜çš„æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œæ²¡æœ‰é‡å†™equalsæ–¹æ³•ï¼Œé‚£ä¹ˆé»˜è®¤ä½¿ç”¨Objectç±»ä¸­çš„equalsæ–¹æ³•è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="comment">// è€ŒObjectç±»ä¸­equalsæ–¹æ³•ï¼Œä¾èµ–åœ°å€å€¼å°±è¡Œåˆ¤æ–­ã€‚</span></span><br><span class="line"><span class="comment">// æ‰€ä»¥ï¼Œéœ€è¦åœ¨è‡ªå®šä¹‰çš„ç±»ä¸­ï¼Œé‡å†™equalsæ–¹æ³•å°±å¯ä»¥äº†ã€‚</span></span><br><span class="line">System.out.println(coll.contains(s4));</span><br></pre></td></tr></table></figure><hr><hr><h2 id="Collectionéå†æ–¹å¼">Collectionéå†æ–¹å¼</h2><p>Collectioné€šç”¨éå†æ–¹å¼æœ‰ä¸‰ç§ï¼š</p><ol><li>è¿­ä»£å™¨éå†</li><li>å¢å¼ºforéå†</li><li>Lambdaè¡¨è¾¾å¼</li></ol><hr><h3 id="è¿­ä»£å™¨éå†">è¿­ä»£å™¨éå†</h3><p>è¿­ä»£å™¨åœ¨Javaä¸­çš„ç±»æ˜¯<span class='p red'>Iterator</span>ï¼Œè¿­ä»£å™¨æ˜¯é›†åˆä¸“ç”¨çš„éå†æ–¹å¼ã€‚</p><mark class="hl-label blue">Collectioné›†åˆè·å–è¿­ä»£å™¨</mark> <table><thead><tr><th style="text-align:left">æ–¹æ³•åç§°</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Iterator&lt; E &gt; iterator()</td><td style="text-align:left">è¿”å›è¿­ä»£å™¨å¯¹è±¡ï¼Œé»˜è®¤æŒ‡å‘å½“å‰é›†åˆçš„0ç´¢å¼•</td></tr></tbody></table><mark class="hl-label green">iteratorä¸­çš„å¸¸ç”¨æ–¹æ³•</mark> <table><thead><tr><th>æ–¹æ³•åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>boolean hasNext()</td><td>åˆ¤æ–­å½“å‰ä½ç½®æ˜¯å¦æœ‰å…ƒç´ ï¼Œæœ‰å…ƒç´ è¿”å›trueï¼Œæ²¡æœ‰å…ƒç´ è¿”å›false</td></tr><tr><td>E next()</td><td>è·å–å½“å‰ä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†è¿­ä»£å™¨å¯¹è±¡ç§»å‘ä¸‹ä¸€ä¸ªä½ç½®</td></tr></tbody></table><div class="tabs" id="453454f2-6b5c-4dc3-a93a-77c2d76544de"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#453454f2-6b5c-4dc3-a93a-77c2d76544de-1"><i class="fas fa-cat"></i>å¼€å§‹æƒ…å†µ</button></li><li class="tab"><button type="button" data-href="#453454f2-6b5c-4dc3-a93a-77c2d76544de-2"><i class="fas fa-horse"></i>ç»“æŸæƒ…å†µ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="453454f2-6b5c-4dc3-a93a-77c2d76544de-1"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230516170605737.png" alt="image-20230516170605737" style="zoom: 50%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="453454f2-6b5c-4dc3-a93a-77c2d76544de-2"><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230516172114394.png" alt="image-20230516172114394"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><mark class="hl-label red">ç»†èŠ‚æ³¨æ„ç‚¹</mark> <ol><li>å½“ä¸Šé¢çš„å¾ªç¯ç»“æŸåï¼Œè¿­ä»£å™¨æŒ‡å‘é›†åˆçš„æœ«å°¾ï¼Œå†å¼ºè¡Œè°ƒç”¨nextæ–¹æ³•è·å–å…ƒç´ çš„è¯ï¼Œå°±ä¼šæŠ¥é”™NoSuchElementException</li><li>è¿­ä»£å™¨éå†å®Œæ¯•åï¼Œè¿­ä»£å™¨æ˜¯ä¸ä¼šå¤ä½çš„ï¼Œå¦‚æœè¦æƒ³é‡æ–°éå†ä¸€æ¬¡ï¼Œå¯ä»¥é‡æ–°è·å–è¿­ä»£å™¨å¯¹è±¡</li><li>å¾ªç¯ä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡nextæ–¹æ³•ï¼Œå› ä¸ºåœ¨whileåˆ¤æ–­æ¡ä»¶ä¸­åªåˆ¤æ–­äº†ä¸€æ¬¡hasNextï¼ŒhasNextå’Œnextè¦ä¸€ä¸€å¯¹åº”</li><li>è¿­ä»£å™¨éå†æ—¶ï¼Œä¸èƒ½ä½¿ç”¨é›†åˆçš„æ–¹æ³•è¿›è¡Œå¢åŠ æˆ–è€…åˆ é™¤(ä¼šå¯¼è‡´expectedModCountå’ŒmodCountä¸ç›¸ç­‰)ï¼Œå¦‚æœå®åœ¨è¦åˆ é™¤ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è¿­ä»£å™¨æä¾›çš„removeæ–¹æ³•è¿›è¡Œåˆ é™¤</li></ol><hr><h3 id="å¢å¼ºforéå†">å¢å¼ºforéå†</h3><p>å¢å¼ºforçš„åº•å±‚å°±æ˜¯è¿­ä»£å™¨ï¼Œä¸ºäº†ç®€åŒ–è¿­ä»£å™¨çš„ä»£ç ä¹¦å†™çš„ã€‚</p><p>å®ƒæ˜¯JDK5ä¹‹åå‡ºç°çš„ï¼Œå…¶å†…éƒ¨åŸç†å°±æ˜¯ä¸€ä¸ªIteratorè¿­ä»£å™¨</p><p>å¢å¼ºforå¾ªç¯å¯ä»¥ç”¨æ¥éå†æ•°ç»„å’Œå®ç°äº†<code>Iterable</code>æ¥å£çš„é›†åˆå¯¹è±¡ã€‚</p><p>åœ¨Javaä¸­ï¼Œæ‰€æœ‰çš„å•åˆ—é›†åˆéƒ½å®ç°äº†<code>Iterable</code>æ¥å£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å¢å¼ºforå¾ªç¯éå†è¿™äº›é›†åˆã€‚</p><p>å•åˆ—é›†åˆåŒ…æ‹¬<code>List</code>ã€<code>Set</code>ã€<code>Queue</code>ç­‰ï¼Œä½†ä¸åŒ…æ‹¬<code>Map</code>ï¼Œå› ä¸º<code>Map</code>æ˜¯åŒåˆ—é›†åˆã€‚</p><mark class="hl-label green">æ ¼å¼</mark> <p>idea å¿«é€Ÿç”Ÿæˆæ–¹å¼   <code>é›†åˆçš„åå­—.for</code></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">for</span>(å…ƒç´ æ•°æ®ç±»å‹ å˜é‡å : æ•°ç»„æˆ–è€…é›†åˆ)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span>(String s in coll)&#123;</span><br><span class="line">System<span class="selector-class">.out</span><span class="selector-class">.println</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><mark class="hl-label red">æ³¨æ„ç‚¹</mark> <p>så…¶å®å°±æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹å˜é‡ï¼Œåœ¨å¾ªç¯çš„è¿‡ç¨‹ä¸­ä¾æ¬¡è¡¨ç¤ºé›†åˆä¸­çš„æ¯ä¸€ä¸ªæ•°æ®</p><p>ä¿®æ”¹å¢å¼ºforä¸­çš„å˜é‡ï¼Œä¸ä¼šæ”¹å˜é›†åˆä¸­åŸæœ¬çš„æ•°æ®</p><hr><h3 id="Lambdaè¡¨è¾¾å¼éå†">Lambdaè¡¨è¾¾å¼éå†</h3><p>å¾—ç›ŠäºJDK 8å¼€å§‹çš„æ–°æŠ€æœ¯Lambdaè¡¨è¾¾å¼ï¼Œæä¾›äº†ä¸€ç§æ›´ç®€å•ã€æ›´ç›´æ¥çš„éå†é›†åˆçš„æ–¹å¼ã€‚</p><table><thead><tr><th>æ–¹æ³•åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>defalut void forEach(Consumer&lt;? super T&gt; action)</td><td>ç»“åˆlambdaéå†é›†åˆ</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒ¿åå†…éƒ¨ç±»çš„å½¢å¼</span></span><br><span class="line">coll.forEach(<span class="keyword">new</span> <span class="title class_">Consumer</span>&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambdaè¡¨è¾¾å¼</span></span><br><span class="line">coll.forEach(s -&gt; System.out.println(s));</span><br></pre></td></tr></table></figure><mark class="hl-label blue">åº•å±‚åŸç†</mark> <p>æ–¹æ³•å†…éƒ¨ä¹Ÿä¼šå¾ªç¯éå†é›†åˆï¼Œä¾æ¬¡å¾—åˆ°æ¯ä¸€ä¸ªå…ƒç´ ï¼ŒæŠŠå¾—åˆ°çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œä¼ é€’ç»™acceptæ–¹æ³•æ¶ˆè´¹</p><hr><hr><h2 id="Collectionéå†è§„å¾‹">Collectionéå†è§„å¾‹</h2><ol><li>éå†é¡ºåºä¸å…ƒç´ æ·»åŠ çš„é¡ºåºæœ‰å…³çš„é›†åˆï¼šArrayListã€LinkedListã€LinkedHashSetã€ArrayDequeã€LinkedListã€‚</li><li>éå†é¡ºåºä¸Comparatoræœ‰å…³çš„é›†åˆï¼šPriorityQueueã€TreeSetã€‚</li></ol><p>PriorityQueueéå†å¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œå› ä¸ºPriorityQueueæ˜¯ä¸€ç§åŸºäºå †çš„æ•°æ®ç»“æ„ï¼Œå †é¡¶å…ƒç´ æ°¸è¿œæ˜¯ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ï¼Œè€Œéå†PriorityQueueéœ€è¦è®¿é—®æ‰€æœ‰å…ƒç´ ï¼Œå› æ­¤ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´è®¿é—®é‚£äº›ä¼˜å…ˆçº§è¾ƒä½çš„å…ƒç´ ã€‚</p><p>PriorityQueue ä½¿ç”¨æ•°ç»„å­˜å‚¨ï¼Œä½œä¸ºå †ï¼Œä½ åªèƒ½è·å¾—ä»–çš„æœ€å¤§ï¼Œæœ€å°å€¼ï¼Œå¯ä»¥å­˜å‚¨é‡å¤çš„å€¼ã€‚</p><p>TreeSetå¯ä»¥ä¿è¯æ•°æ®å…¨éƒ¨æŒ‰ç…§æŸä¸ªé¡ºåºæ’åˆ—ï¼Œä¸å…è®¸é‡å¤ï¼Œå¯è·å¾—å…¶ä¸­çš„ä»»æ„å€¼ï¼Œæä¾›æ¯”ä¼˜å…ˆé˜Ÿåˆ—æ›´å¤šçš„ç‰¹æ€§ï¼Œä½†åŒæ ·æ„å‘³ç€éœ€è¦è¿›è¡Œæ›´å¤šçš„è®¡ç®—ã€‚</p>]]></content>
    
    
    <summary type="html">é›†åˆä½“ç³»ç»“æ„å’Œé¡¶å±‚æ¥å£Collection</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
    <category term="å®¹å™¨" scheme="https://wuwawawa.github.io/tags/%E5%AE%B9%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>Java8æ–°ç‰¹æ€§</title>
    <link href="https://wuwawawa.github.io/posts/397c083a.html"/>
    <id>https://wuwawawa.github.io/posts/397c083a.html</id>
    <published>2023-05-10T08:05:42.000Z</published>
    <updated>2023-05-16T05:47:33.610Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Java8æ–°ç‰¹æ€§çš„å¥½å¤„">Java8æ–°ç‰¹æ€§çš„å¥½å¤„</h2><ol><li>é€Ÿåº¦æ›´å¿«</li><li>ä»£ç æ›´å°‘ï¼ˆLambdaç®€åŒ–ä»£ç ä¹¦å†™ï¼‰</li><li>å¼ºå¤§çš„Stream API</li><li>ä¾¿äºå¹¶è¡Œ</li><li>æœ€å¤§åŒ–å‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼šOptional</li><li>Nashornå¼•æ“ï¼Œå…è®¸åœ¨JVMä¸Šè¿è¡ŒJSåº”ç”¨</li></ol><hr><hr><h2 id="æ¥å£å˜åŒ–">æ¥å£å˜åŒ–</h2><p>åœ¨JDK 8 ä»¥å‰ï¼Œæ¥å£ä¸­åªæœ‰æŠ½è±¡æ–¹æ³•å’Œé™æ€å¸¸é‡ï¼Œä¼šå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼šåœ¨æ¥å£ä¸­æ–°å¢æ–¹æ³•ï¼Œæ‰€æœ‰å®ç°ç±»éƒ½è¦é‡å†™è¯¥æ–¹æ³•ï¼Œä¸åˆ©äºæ¥å£çš„æ‰©å±•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface æ¥å£å&#123;</span><br><span class="line">é™æ€å¸¸é‡ï¼ˆ<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span>ï¼‰;</span><br><span class="line">æŠ½è±¡æ–¹æ³•ï¼ˆ<span class="keyword">public</span> <span class="keyword">abstract</span>ï¼‰;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨JDK 8 ä¹‹åï¼Œæ¥å£ä¸­å¢åŠ äº†defaultæ–¹æ³•å’Œstaticæ–¹æ³•ï¼Œåˆ†åˆ«ä½¿ç”¨ static å’Œ default å…³é”®å­—ä¿®é¥°ï¼Œè¿™ä¸¤ç§æ–¹æ³•å¯ä»¥æœ‰æ–¹æ³•ä½“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">interface æ¥å£å&#123;</span><br><span class="line">é™æ€å¸¸é‡ï¼ˆ<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span>ï¼‰;</span><br><span class="line">æŠ½è±¡æ–¹æ³•ï¼ˆ<span class="keyword">public</span> <span class="keyword">abstract</span>ï¼‰;</span><br><span class="line">é»˜è®¤æ–¹æ³•</span><br><span class="line">é™æ€æ–¹æ³•</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><mark class="hl-label blue">åŒºåˆ«</mark> <ol><li>é»˜è®¤æ–¹æ³•é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œé™æ€æ–¹æ³•é€šè¿‡æ¥å£åè°ƒç”¨</li><li>é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿ï¼Œå®ç°ç±»å¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£é»˜è®¤æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥é‡å†™æ¥å£é»˜è®¤æ–¹æ³•</li><li>é™æ€æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå®ç°ç±»ä¸èƒ½é‡å†™æ¥å£çš„é™æ€æ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨æ¥å£åè°ƒç”¨</li></ol><hr><h3 id="é»˜è®¤æ–¹æ³•">é»˜è®¤æ–¹æ³•</h3><p>åœ¨JDK8ä»¥å‰æ¥å£ä¸­åªèƒ½æœ‰æŠ½è±¡æ–¹æ³•å’Œé™æ€å¸¸é‡ï¼Œä¼šå­˜åœ¨ä»¥ä¸‹çš„é—®é¢˜ï¼š<br>å¦‚æœæ¥å£ä¸­æ–°å¢æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ç°ç±»éƒ½å¿…é¡»è¦æŠ½è±¡è¿™ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéå¸¸ä¸åˆ©äºæ¥å£çš„æ‰©å±•çš„ã€‚</p><div class="tabs" id="ca8a7413-161b-4f1e-a04b-8bf7f205b9aa"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-1"><i class="fas fa-cat"></i>è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-2"><i class="fas fa-horse"></i>ä½¿ç”¨</button></li><li class="tab"><button type="button" data-href="#ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-3"><i class="fas fa-dove"></i>æ ·ä¾‹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface æ¥å£å&#123;</span><br><span class="line">ä¿®é¥°ç¬¦ <span class="keyword">default</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å&#123;</span><br><span class="line">æ–¹æ³•ä½“;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-2"><ol><li>å®ç°ç±»ç›´æ¥è°ƒç”¨æ¥å£çš„é»˜è®¤æ–¹æ³•</li><li>å®ç°ç±»é‡å†™æ¥å£çš„é»˜è®¤æ–¹æ³•</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca8a7413-161b-4f1e-a04b-8bf7f205b9aa-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨æ¥å£ä¸­æ–°å¢æ–¹æ³•ï¼Œæ‰€æœ‰å®ç°ç±»éƒ½è¦é‡å†™è¯¥æ–¹æ³•ï¼Œä¸åˆ©äºæ¥å£çš„æ‰©å±•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">default</span> String <span class="title function_">testDefaultMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•æ‰§è¡Œäº†&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="é™æ€æ–¹æ³•">é™æ€æ–¹æ³•</h3><p>JDK8ä¸­ä¸ºæ¥å£æ–°å¢äº†é™æ€æ–¹æ³•ï¼Œä½œç”¨ä¹Ÿæ˜¯ä¸ºäº†æ¥å£çš„æ‰©å±•<div class="tabs" id="2bbf712d-0e57-4b42-aaec-bfc43b69f6a5"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-1"><i class="fas fa-atom"></i>è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-2"><i class="far fa-sun"></i>ä½¿ç”¨</button></li><li class="tab"><button type="button" data-href="#2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-3"><i class="fas fa-wind"></i>æ ·ä¾‹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface æ¥å£å&#123;</span><br><span class="line">    ä¿®é¥°ç¬¦ <span class="keyword">static</span> è¿”å›å€¼ç±»å‹ æ–¹æ³•å&#123;</span><br><span class="line">    æ–¹æ³•ä½“;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-2"><p>æ¥å£ä¸­çš„é™æ€æ–¹æ³•åœ¨å®ç°ç±»ä¸­æ˜¯ä¸èƒ½è¢«é‡å†™çš„ï¼Œè°ƒç”¨çš„è¯åªèƒ½é€šè¿‡æ¥å£ç±»å‹æ¥å®ç°: æ¥å£å.é™æ€æ–¹æ³•å();</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2bbf712d-0e57-4b42-aaec-bfc43b69f6a5-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TestInterA</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ¨æ¥å£ä¸­æ–°å¢æ–¹æ³•ï¼Œæ‰€æœ‰å®ç°ç±»éƒ½è¦é‡å†™è¯¥æ–¹æ³•ï¼Œä¸åˆ©äºæ¥å£çš„æ‰©å±•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testAbstract01</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testAbstract02</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testStaticMethod</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestInterAé‡Œé¢çš„é™æ€æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">testDefaultMethod</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestInterAé‡Œé¢çš„é»˜è®¤æ–¹æ³•testDefaultMethod&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></p><hr><hr><h2 id="Comparatoræ¥å£">Comparatoræ¥å£</h2><h3 id="åº•å±‚åŸç†åˆ†æ">åº•å±‚åŸç†åˆ†æ</h3><p>Comparatoræ¥å£ç”¨æ¥å®šä¹‰ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„æ¯”è¾ƒæ–¹æ³•ï¼Œå®ƒæœ‰ä¸€ä¸ªå«åš<code>compare</code>çš„æ–¹æ³•ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><p><code>int compare(T o1,T o2)</code></p><p>æŸ¥çœ‹sortæ–¹æ³•çš„ç›¸å…³æºç ï¼šå¦‚æœcompareçš„è¿”å›å€¼ä¸ºæ­£æ•°ï¼Œå°±äº¤æ¢è¿›è¡Œæ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/cbcf171cd6bc494abfe61be71508287a.png" alt="img" style="zoom:67%;" /><p>ç»“è®º</p><ul><li>å¦‚æœ o1 &gt; o2 æ—¶compare(o1,o2)è¿”å›æ­£æ•°ï¼Œé‚£ä¹ˆäº¤æ¢ä½ç½®åå¤§çš„å…ƒç´ åœ¨åï¼Œè¿™å°±å®ç°äº†å‡åºæ’åºï¼›</li><li>å¦‚æœ o1 &lt; o2 æ—¶compare(o1,o2)è¿”å›è´Ÿæ•°ï¼Œé‚£ä¹ˆäº¤æ¢ä½ç½®åå°çš„å…ƒç´ åœ¨åï¼Œè¿™å°±å®ç°äº†é™åºæ’åºã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡åºã€‚</span></span><br><span class="line"><span class="comment">// è‹¥o1 - o2 &lt; 0ï¼Œåˆ™o1å°äºo2ï¼Œä¸ç”¨äº¤æ¢ï¼Œå³ä¸ºå‡åºã€‚</span></span><br><span class="line"><span class="comment">// è‹¥o1 - o2 &gt; 0ï¼Œåˆ™o1å¤§äºo2ï¼Œäº¤æ¢åå°çš„åœ¨å‰ï¼Œå¤§çš„åœ¨åï¼Œå³ä¸ºå‡åºã€‚</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span> o1, <span class="type">int</span> o2)</span>&#123;</span><br><span class="line">     <span class="keyword">return</span> o1 -o2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™åºã€‚</span></span><br><span class="line"><span class="comment">// è‹¥o2 - o1 &lt; 0ï¼Œåˆ™o2å°äºo1ï¼Œä¸ç”¨äº¤æ¢ï¼Œå³é™åºã€‚</span></span><br><span class="line"><span class="comment">// è‹¥o2 - o1 &gt; 0ï¼Œåˆ™o2å¤§äºo1ï¼Œäº¤æ¢åå¤§çš„åœ¨å‰ï¼Œå°çš„åœ¨åï¼Œå³ä¸ºé™åºã€‚</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span> o1, <span class="type">int</span> o2)</span>&#123;</span><br><span class="line">     <span class="keyword">return</span> o2 -o1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¯”è¾ƒå™¨çš„ä½¿ç”¨">æ¯”è¾ƒå™¨çš„ä½¿ç”¨</h3><p>ä¸ºäº†å¯¹ä¸€ä¸ªé›†åˆè¿›è¡Œæ’åºï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒå™¨(Comparator)å®ä¾‹ä¼ é€’ç»™<code>Stream.sorted</code>ã€<code>Collections.sort</code>ã€<code>List.sort</code>å’Œ<code>Arrays.sort</code>æ–¹æ³•ã€‚</p><p>æ¯”è¾ƒå™¨(Comparator)è¿˜å¯ä»¥æ§åˆ¶<code>SortedSet</code>çš„é¡ºåºå’Œ<code>SortedMap</code>æ•°æ®ç»“æ„çš„é”®é¡ºåºã€‚</p><h3 id="æ¯”è¾ƒå™¨çš„æ–¹æ³•">æ¯”è¾ƒå™¨çš„æ–¹æ³•</h3><p>åœ¨<code>Java 8</code>ä¸­ï¼Œæ¯”è¾ƒå™¨æ¥å£å¼•å…¥äº†ä¸€äº›é™æ€å’Œé»˜è®¤çš„æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°†æ¯”è¾ƒå™¨ä¸<code>Stream.sorted</code>ã€<code>List.sort</code>ã€<code>Collections.sort</code>å’Œ<code>Arrays.sort</code>ä¸€èµ·ä½¿ç”¨æ¥å¯¹é›†åˆå’Œ<code>Map</code>è¿›è¡Œæ’åºã€‚</p><div class="tabs" id="061c08cf-c9fe-4314-ae92-e318b541721f"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#061c08cf-c9fe-4314-ae92-e318b541721f-1"><i class="fas fa-seedling"></i>reversed</button></li><li class="tab"><button type="button" data-href="#061c08cf-c9fe-4314-ae92-e318b541721f-2"><i class="fas fa-leaf"></i>reverseOrder</button></li><li class="tab"><button type="button" data-href="#061c08cf-c9fe-4314-ae92-e318b541721f-3"><i class="fab fa-apple"></i>3</button></li><li class="tab"><button type="button" data-href="#061c08cf-c9fe-4314-ae92-e318b541721f-4"><i class="fas fa-tree"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="061c08cf-c9fe-4314-ae92-e318b541721f-1"><p>reversedæ˜¯Javaæ¯”è¾ƒå™¨åŠŸèƒ½æ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚reversedè¿”å›ä¸€ä¸ªæ¯”è¾ƒå™¨ï¼Œè¯¥æ¯”è¾ƒå™¨å¼ºåˆ¶æ‰§è¡Œåå‘æ’åºã€‚å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><p><code>default Comparator&lt;T&gt; reversed() </code></p><p>è¦ä½¿ç”¨<code>reversed</code>æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å®ä¾‹åŒ–æˆ‘ä»¬çš„æ¯”è¾ƒå™¨å¹¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p><p><code>reversed</code>å°†è¿”å›æ–°çš„æ¯”è¾ƒå™¨å®ä¾‹ï¼Œè¯¥å®ä¾‹å°†å¼ºåŠ è¯¥æ¯”è¾ƒå™¨çš„åå‘æ’åºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Student&gt; nameComparator = (s1, s2) -&gt; s1.getName().compareTo(s2.getName());</span><br><span class="line">Collections.sort(list, nameComparator.reversed()); </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="061c08cf-c9fe-4314-ae92-e318b541721f-2"><p>reverseOrderæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿”å›æ¯”è¾ƒå™¨ï¼Œå¯¹å¯¹è±¡é›†åˆè¿›è¡Œåå‘è‡ªç„¶æ’åºã€‚</p><p>å¯¹äºè‡ªç„¶æ’åºï¼Œä¸€ä¸ªç±»éœ€è¦å®ç°æ¯”è¾ƒå™¨å¹¶å®šä¹‰compareToæ–¹æ³•ã€‚</p><p>ä¸€ä¸ªå¯¹è±¡é›†åˆæ ¹æ®è‡ªç„¶æ’åºä¸­çš„compareToè¿›è¡Œæ’åºã€‚</p><p>Comparator.reverseOrderåè½¬äº†è‡ªç„¶æ’åºã€‚</p><p>å®ƒåœ¨å†…éƒ¨è°ƒç”¨Collections.reverseOrder()å¹¶è¿”å›æ¯”è¾ƒå™¨å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;? <span class="built_in">super</span> T&gt;&gt; Comparator&lt;T&gt; <span class="title function_">reverseOrder</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Collections.reverseOrder();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="061c08cf-c9fe-4314-ae92-e318b541721f-3"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="061c08cf-c9fe-4314-ae92-e318b541721f-4"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="å¹¶è¡Œæµä¸ä¸²è¡Œæµ">å¹¶è¡Œæµä¸ä¸²è¡Œæµ</h2><ul><li>å¹¶è¡Œæµå°±æ˜¯æŠŠä¸€ä¸ªå†…å®¹åˆ†ä¸ºå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ç”¨ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æµï¼Œç›¸æ¯”è¾ƒäºä¸²è¡Œæµï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡</li><li>Java8ä¸­å°†å…¶è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å¯¹æ•°æ®è¿›è¡Œå¹¶è¡Œæ“ä½œã€‚</li><li>Stream API å¯ä»¥å£°æ˜æ€§åœ°é€šè¿‡parallel()å’Œsequential()åœ¨å¹¶è¡Œæµä¸é¡ºåºæµä¹‹é—´è¿›è¡Œåˆ‡æ¢</li></ul><hr><hr><h2 id="Lambdaè¡¨è¾¾å¼">Lambdaè¡¨è¾¾å¼</h2><ul><li>Lambdaæ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠLambdaè¡¨è¾¾å¼ç†è§£ä¸ºæ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ï¼ˆå°†ä»£ç åƒæ•°æ®ä¸€æ ·è¿›è¡Œä¼ é€’ï¼‰ã€‚</li><li>ä½¿ç”¨å®ƒå¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´çµæ´»çš„ä»£ç ã€‚ä½œä¸ºä¸€ç§æ›´ç´§å‡‘çš„ä»£ç é£æ ¼ï¼Œæ˜¯Javaçš„è¯­è¨€è¡¨è¾¾èƒ½åŠ›å¾—åˆ°äº†æå‡</li></ul><blockquote><span class='p red'>lambdaè¡¨è¾¾å¼ä½¿ç”¨å‰æ</span></blockquote><p>å¿…é¡»æœ‰æ¥å£,æ¥å£ä¸­æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•(å‡½æ•°å¼æ¥å£)</p><p>Lambdaè¡¨è¾¾å¼æ˜¯å¯æ¨å¯¼å¯ä»¥çœç•¥çš„ï¼ŒLambdaè¡¨è¾¾å¼å¯ä»¥æ¨å¯¼å‡ºæ¥ï¼Œçœç•¥å°±æ˜¯é‡å†™å”¯ä¸€çš„æŠ½è±¡æ–¹æ³•è¿›è€Œå¯ä»¥è¿›ä¸€æ­¥å¯¹å‚æ•°å’Œè¿”å›å€¼è¿›è¡Œç®€åŒ–</p><ol><li><p>ä¸¾ä¾‹ï¼š (o1,o2) -&gt; Integer.compare(o1,o2);</p></li><li><p>æ ¼å¼ï¼š</p><ul><li><code>-&gt;ï¼š</code>lambdaæ“ä½œç¬¦æˆ–ç®­å¤´æ“ä½œç¬¦</li><li><code>-&gt;å·¦è¾¹ï¼š</code>lambdaå½¢å‚åˆ—è¡¨ï¼ˆå…¶å®å°±æ˜¯æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨ï¼‰</li><li><code>-&gt;å³è¾¹ï¼š</code>lambdaä½“ï¼ˆå…¶å®å°±æ˜¯é‡å†™çš„æŠ½è±¡æ–¹æ³•çš„æ–¹æ³•ä½“ï¼‰</li></ul></li><li><p>Lambdaè¡¨è¾¾å¼çš„ä½¿ç”¨ï¼š</p><ul><li><p>Lambdaå½¢å‚åˆ—è¡¨çš„å‚æ•°ç±»å‹å¯ä»¥çœç•¥</p></li><li><p>å¦‚æœLambdaå½¢å‚åˆ—è¡¨åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå…¶ä¸€å¯¹()ä¹Ÿå¯ä»¥çœç•¥</p></li><li><p>Lambdaä½“åº”è¯¥ä½¿ç”¨ä¸€å¯¹{}åŒ…è£¹</p></li><li><p>å¦‚æœLambdaä½“åªæœ‰ä¸€æ¡æ‰§è¡Œè¯­å¥(å¯èƒ½æ˜¯returnè¯­å¥),å¯ä»¥çœç•¥è¿™ä¸€å¯¹{}å’Œreturnå…³é”®å­—</p></li></ul></li></ol><p>åˆ†ä¸º6ç§æƒ…å†µä»‹ç»</p><div class="tabs" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-1"><i class="fas fa-bug"></i>æ ¼å¼ä¸€</button></li><li class="tab"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-2"><i class="fas fa-cannabis"></i>æ ¼å¼äºŒ</button></li><li class="tab"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-3"><i class="fas fa-candy-cane"></i>æ ¼å¼ä¸‰</button></li><li class="tab"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-4"><i class="fas fa-child"></i>æ ¼å¼å››</button></li><li class="tab"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-5"><i class="fas fa-heartbeat"></i>æ ¼å¼äº”</button></li><li class="tab"><button type="button" data-href="#a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-6"><i class="fas fa-cookie-bite"></i>æ ¼å¼å…­</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-1"><p><code>è¯­æ³•æ ¼å¼ä¸€ï¼š</code>æ— å‚æ— è¿”å›å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    <span class="type">Runnable</span> <span class="variable">runnable01</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½  çš„ åŸ å¸‚ å¥½ åƒ ä¸ æ¬¢ è¿ æˆ‘&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    runnable01.run();</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    <span class="type">Runnable</span> <span class="variable">runnable02</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;æ‰€ ä»¥ æˆ‘ åª å¥½ è½¬ èº« ç¦» å¼€ äº†&quot;</span>);</span><br><span class="line">    runnable02.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-2"><p><code>è¯­æ³•æ ¼å¼äºŒï¼š</code>Lambdaéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test03</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    Consumer&lt;String&gt; consumer01 = <span class="keyword">new</span> <span class="title class_">Consumer</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    consumer01.accept(<span class="string">&quot;å…¶å®æˆ‘å­˜è¿‡ä½ ç…§ç‰‡ ä¹Ÿç ”ç©¶è¿‡ä½ çš„æ˜Ÿåº§&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    Consumer&lt;String&gt; consumer02 = (String s) -&gt; &#123;System.out.println(s);&#125;;</span><br><span class="line">    consumer02.accept(<span class="string">&quot;ä½ å–œæ¬¢çš„æ­Œæˆ‘ä¹Ÿä¼šå»å¬ ä½ å–œæ¬¢çš„äº‹ç‰©æˆ‘ä¹Ÿä¼šæƒ³å»äº†è§£&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-3"><p><code>è¯­æ³•æ ¼å¼ä¸‰ï¼š</code>æ•°æ®ç±»å‹å¯ä»¥çœç•¥ï¼Œå› ä¸ºå¯ç”±<code>ç±»å‹æ¨æ–­</code>å¾—å‡º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    Consumer&lt;String&gt; consumer01 = <span class="keyword">new</span> <span class="title class_">Consumer</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    consumer01.accept(<span class="string">&quot;æˆ‘è¿œæ¯”è¡¨é¢ä¸Šæ›´å–œæ¬¢ä½ &quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    Consumer&lt;String&gt; consumer02 = (s) -&gt; &#123;System.out.println(s);&#125;;</span><br><span class="line">    consumer02.accept(<span class="string">&quot;ä½†æˆ‘æ²¡æœ‰è¯´&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-4"><p><code>è¯­æ³•æ ¼å¼å››ï¼š</code>Lambdaè‹¥åªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°çš„å°æ‹¬å·å¯ä»¥çœç•¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    Consumer&lt;String&gt; consumer01 = <span class="keyword">new</span> <span class="title class_">Consumer</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    consumer01.accept(<span class="string">&quot;æˆ‘è¿œæ¯”è¡¨é¢ä¸Šæ›´å–œæ¬¢ä½ &quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    Consumer&lt;String&gt; consumer02 = s -&gt; &#123;System.out.println(s);&#125;;</span><br><span class="line">    consumer02.accept(<span class="string">&quot;ä½†æˆ‘æ²¡æœ‰è¯´&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-5"><p><code>è¯­æ³•æ ¼å¼äº”ï¼š</code>Lambdaéœ€è¦ä¸¤ä¸ªæˆ–ä»¥ä¸Šå‚æ•°ï¼Œå¤šæ¡æ‰§è¡Œè¯­å¥ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator01 = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">            System.out.println(o1);</span><br><span class="line">            System.out.println(o2);</span><br><span class="line">            <span class="keyword">return</span> o1.compareTo(o2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    System.out.println(comparator01.compare(<span class="number">95</span>, <span class="number">27</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator02 = (o1, o2) -&gt; &#123;</span><br><span class="line">        System.out.println(o1);</span><br><span class="line">        System.out.println(o2);</span><br><span class="line">        <span class="keyword">return</span> o1.compareTo(o2);</span><br><span class="line">    &#125;;</span><br><span class="line">    System.out.println(comparator02.compare(<span class="number">12</span>, <span class="number">21</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a8a76b8b-df65-4a0a-a2c4-660e9341c1fe-6"><p><code>è¯­æ³•æ ¼å¼å…­ï¼š</code>å½“Lambdaä½“åªæœ‰ä¸€æ¡è¯­å¥æ—¶ï¼Œreturnä¸{}è‹¥æœ‰ï¼Œåˆ™éƒ½å¯ä»¥çœç•¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator01 = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> o1.compareTo(o2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    System.out.println(comparator01.compare(<span class="number">95</span>, <span class="number">27</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator02 = (o1, o2) -&gt; o1.compareTo(o2);</span><br><span class="line">    System.out.println(comparator02.compare(<span class="number">12</span>, <span class="number">21</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="å‡½æ•°å¼æ¥å£">å‡½æ•°å¼æ¥å£</h2><ul><li>Lambdaè¡¨è¾¾å¼çš„æœ¬è´¨ï¼šä½œä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹</li><li>å¦‚æœåœ¨ä¸€ä¸ªæ¥å£ä¸­ï¼Œåªå£°æ˜äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œåˆ™æ­¤æ¥å£å°±è¢«ç§°ä¸ºå‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæ¥å£ä¸Šä½¿ç”¨@FunctionalInterfaceæ³¨è§£æ¥éªŒè¯è¯¥æ¥å£æ˜¯å¦ä¸ºå‡½æ•°å¼æ¥å£ï¼ˆå¦‚æœä½ åœ¨è¯¥æ¥å£ä¸­å†™äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ™ç¼–è¯‘æœŸå°±ä¼šæŠ¥é”™ï¼‰</li><li>æ­£æ˜¯å› ä¸ºæŠ½è±¡æ–¹æ³•ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰å¯ä»¥çœç•¥@Overrideå‡½æ•°å£°æ˜ç­‰å†…å®¹</li><li>åœ¨<code>java.util.function</code>åŒ…ä¸‹å®šä¹‰äº†Java 8 çš„ä¸°å¯Œçš„å‡½æ•°å¼æ¥å£</li><li>Javaä»è¯ç”Ÿæ—¥èµ·å°±æ˜¯ä¸€ç›´å€¡å¯¼â€œä¸€åˆ‡çš†å¯¹è±¡â€ï¼Œåœ¨Javaé‡Œé¢é¢å‘å¯¹è±¡(OOP)ç¼–ç¨‹æ˜¯ä¸€åˆ‡ã€‚ä½†æ˜¯éšç€Pythonã€Scalaç­‰è¯­è¨€çš„å…´èµ·å’Œæ–°æŠ€æœ¯çš„æŒ‘æˆ˜ï¼ŒJavaä¸å¾—ä¸åšå‡ºè°ƒæ•´ä»¥ä¾¿æ”¯æŒæ›´åŠ å¹¿æ³›çš„æŠ€æœ¯è¦æ±‚ï¼Œä¹Ÿå³javaä¸ä½†å¯ä»¥æ”¯æŒOOPè¿˜å¯ä»¥æ”¯æŒOOFï¼ˆé¢å‘å‡½æ•°ç¼–ç¨‹ï¼‰</li><li>åœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å½“ä¸­ï¼Œå‡½æ•°è¢«å½“åšä¸€ç­‰å…¬æ°‘å¯¹å¾…ã€‚åœ¨å°†å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼ŒLambdaè¡¨è¾¾å¼çš„ç±»å‹æ˜¯å‡½æ•°ã€‚ä½†æ˜¯åœ¨Java8ä¸­ï¼Œæœ‰æ‰€ä¸åŒã€‚åœ¨Java8ä¸­ï¼ŒLambdaè¡¨è¾¾å¼æ˜¯å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°ï¼Œå®ƒä»¬å¿…é¡»ä¾é™„äºä¸€ç±»ç‰¹åˆ«çš„å¯¹è±¡ç±»å‹â€”â€”å‡½æ•°å¼æ¥å£ã€‚</li><li>ç®€å•çš„è¯´ï¼Œåœ¨Java8ä¸­ï¼ŒLambdaè¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚è¿™å°±æ˜¯Lambdaè¡¨è¾¾å¼å’Œå‡½æ•°å¼æ¥å£çš„å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ä¸€ä¸ªå¯¹è±¡æ˜¯å‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å°±å¯ä»¥ç”¨Lambdaè¡¨è¾¾å¼æ¥è¡¨ç¤ºã€‚</li><li>æ‰€ä»¥ä»¥å‰ç”¨åŒ¿åå®ç°ç±»è¡¨ç¤ºçš„ç°åœ¨éƒ½å¯ä»¥ç”¨Lambdaè¡¨è¾¾å¼æ¥å†™ã€‚</li></ul><blockquote><p>Javaå†…ç½®çš„å‡½æ•°å¼æ¥å£ä»‹ç»åŠä½¿ç”¨ä¸¾ä¾‹</p></blockquote><table><thead><tr><th style="text-align:center">å‡½æ•°å¼æ¥å£</th><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align:center">Consumer æ¶ˆè´¹å‹æ¥å£</td><td style="text-align:center">void accept(T t)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡åº”ç”¨æ“ä½œ</td></tr><tr><td style="text-align:center">Supplier ä¾›ç»™å‹æ¥å£</td><td style="text-align:center">T get()</td><td style="text-align:center">è¿”å›ç±»å‹ä¸ºTçš„å¯¹è±¡</td></tr><tr><td style="text-align:center">Function å‡½æ•°å‹æ¥å£</td><td style="text-align:center">R apply(T t)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡åº”ç”¨æ“ä½œè¿”å›ç»“æœ</td></tr><tr><td style="text-align:center">Predicate æ–­å®šå‹æ¥å£</td><td style="text-align:center">boolean test(T t)</td><td style="text-align:center">ç¡®å®šç±»å‹ä¸ºTçš„å¯¹è±¡æ˜¯å¦æ»¡è¶³æŸçº¦æŸ</td></tr><tr><td style="text-align:center">BiConsumer</td><td style="text-align:center">void accept(T t,U u)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºT,Uå‚æ•°åº”ç”¨æ“ä½œ</td></tr><tr><td style="text-align:center">BiPredicate</td><td style="text-align:center">boolean</td><td style="text-align:center">åŒ…å«æ–¹æ³•ä¸ºï¼šboolean test(T t,U u)</td></tr><tr><td style="text-align:center">BiFunction</td><td style="text-align:center">R apply(T t,U u)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºT,Uå‚æ•°åº”ç”¨æ“ä½œï¼Œè¿”å›Rç±»å‹çš„ç»“æœ</td></tr><tr><td style="text-align:center">UnaryOperator(Functionå­æ¥å£)</td><td style="text-align:center">T apply(T t)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡è¿›è¡Œä¸€å…ƒè¿ç®—</td></tr><tr><td style="text-align:center">BinaryOperator(BiFunctionå­æ¥å£)</td><td style="text-align:center">T apply(T t1,T t2)</td><td style="text-align:center">å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡è¿›è¡ŒäºŒå…ƒè¿ç®—</td></tr></tbody></table><div class="tabs" id="10d20ccf-24f3-4841-8532-22635d831135"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#10d20ccf-24f3-4841-8532-22635d831135-1"><i class="fas fa-cat"></i>æ¶ˆè´¹å‹</button></li><li class="tab"><button type="button" data-href="#10d20ccf-24f3-4841-8532-22635d831135-2"><i class="fas fa-horse"></i>æ–­å®šå‹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="10d20ccf-24f3-4841-8532-22635d831135-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">happyTime</span><span class="params">(<span class="type">double</span> money, Consumer&lt;Double&gt; consumer)</span> &#123;</span><br><span class="line">    consumer.accept(money);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test04</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    happyTime(<span class="number">1241</span>, <span class="keyword">new</span> <span class="title class_">Consumer</span>&lt;Double&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Double money)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;çªç„¶æƒ³å›ä¸€è¶Ÿæˆéƒ½äº†ï¼Œæœºç¥¨èŠ±è´¹&quot;</span> + money);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. Lambdaè¡¨è¾¾å¼ï¼Œå°†ä¹‹å‰çš„6è¡Œä»£ç å‹ç¼©åˆ°äº†1è¡Œ</span></span><br><span class="line">    happyTime(<span class="number">648</span>, money -&gt; System.out.println(<span class="string">&quot;å­¦ä¹ å¤ªç´¯äº†ï¼Œå¥–åŠ±è‡ªå·±ä¸€å‘648ï¼ŒèŠ±è´¹&quot;</span> + money));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">çªç„¶æƒ³å›ä¸€è¶Ÿæˆéƒ½äº†ï¼Œæœºç¥¨èŠ±è´¹1241.0</span></span><br><span class="line"><span class="comment">------------------------</span></span><br><span class="line"><span class="comment">å­¦ä¹ å¤ªç´¯äº†ï¼Œå¥–åŠ±è‡ªå·±ä¸€å‘648ï¼ŒèŠ±è´¹648.0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="10d20ccf-24f3-4841-8532-22635d831135-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®ç»™å®šçš„è§„åˆ™ï¼Œè¿‡æ»¤é›†åˆä¸­çš„å­—ç¬¦ä¸²ã€‚æ­¤è§„åˆ™ç”±Predicateçš„æ–¹æ³•å†³å®š</span></span><br><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">filterString</span><span class="params">(List&lt;String&gt; strings, Predicate&lt;String&gt; predicate)</span> &#123;</span><br><span class="line">    ArrayList&lt;String&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line">        <span class="keyword">if</span> (predicate.test(string))</span><br><span class="line">            res.add(string);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test05</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;String&gt; strings = Arrays.asList(<span class="string">&quot;ä¸œäº¬&quot;</span>, <span class="string">&quot;è¥¿äº¬&quot;</span>, <span class="string">&quot;å—äº¬&quot;</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;å¤©æ´¥&quot;</span>, <span class="string">&quot;ä¸­äº¬&quot;</span>);</span><br><span class="line">    <span class="comment">//1. ä»¥å‰çš„å†™æ³•</span></span><br><span class="line">    List&lt;String&gt; list = filterString(string s, <span class="keyword">new</span> <span class="title class_">Predicate</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> s.contains(<span class="string">&quot;äº¬&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    System.out.println(list);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. ç°åœ¨çš„å†™æ³•ï¼Œç›¸æ¯”è¾ƒä¹‹å‰çš„ä»£ç ä¼˜é›…äº†è®¸å¤š</span></span><br><span class="line">    List&lt;String&gt; res = filterString(string s, s -&gt; s.contains(<span class="string">&quot;äº¬&quot;</span>));</span><br><span class="line">    System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[ä¸œäº¬, è¥¿äº¬, å—äº¬, åŒ—äº¬, ä¸­äº¬]</span></span><br><span class="line"><span class="comment">------------------------</span></span><br><span class="line"><span class="comment">[ä¸œäº¬, è¥¿äº¬, å—äº¬, åŒ—äº¬, ä¸­äº¬]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="æ–¹æ³•å¼•ç”¨å’Œæ„é€ å™¨å¼•ç”¨">æ–¹æ³•å¼•ç”¨å’Œæ„é€ å™¨å¼•ç”¨</h2><ul><li>å½“è¦ä¼ é€’ç»™Lambdaä½“çš„æ“ä½œï¼Œå·²ç»æœ‰å®ç°çš„æ–¹æ³•äº†ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨</li><li>æ–¹æ³•å¼•ç”¨å¯ä»¥çœ‹åšä¼šLambdaè¡¨è¾¾å¼çš„æ·±å±‚æ¬¡è¡¨è¾¾ï¼Œæ¢å¥è¯è¯´ï¼Œæ–¹æ³•å¼•ç”¨å°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡æ–¹æ³•çš„åå­—æ¥æŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯Lambdaè¡¨è¾¾å¼çš„ä¸€ä¸ªè¯­æ³•ç³–</li><li>è¦æ±‚ï¼šå®ç°æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ï¼Œå¿…é¡»ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¿æŒä¸€è‡´</li><li>æ ¼å¼ï¼šä½¿ç”¨æ“ä½œç¬¦<code>::</code>å°†ç±»æˆ–å¯¹è±¡ä¸æ–¹æ³•ååˆ†å‰²å¼€æ¥</li><li>æœ‰å¦‚ä¸‹ä¸‰ç§ä½¿ç”¨æƒ…å†µ<ol><li>å¯¹è±¡::å®ä¾‹æ–¹æ³•å</li><li>ç±»::é™æ€æ–¹æ³•å</li><li>ç±»::å®ä¾‹æ–¹æ³•å</li></ol></li></ul><hr><h3 id="æ–¹æ³•å¼•ç”¨">æ–¹æ³•å¼•ç”¨</h3><p>æ–¹æ³•å¼•ç”¨çš„ä½¿ç”¨</p><ol><li>ä½¿ç”¨æƒ…å¢ƒï¼šå½“è¦ä¼ é€’ç»™Lambdaä½“çš„æ“ä½œï¼Œå·²ç»æœ‰å®ç°çš„æ–¹æ³•äº†ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼</li><li>æ–¹æ³•å¼•ç”¨ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚æ‰€ä»¥æ–¹æ³•å¼•ç”¨ï¼Œä¹Ÿæ˜¯å‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚</li><li>ä½¿ç”¨æ ¼å¼ï¼š ç±»(æˆ–å¯¹è±¡) :: æ–¹æ³•å</li><li>å…·ä½“åˆ†ä¸ºå¦‚ä¸‹çš„ä¸‰ç§æƒ…å†µï¼š<ul><li>æƒ…å†µ1ï¼šå¯¹è±¡ :: éé™æ€æ–¹æ³•</li><li>æƒ…å†µ2ï¼šç±» :: é™æ€æ–¹æ³•</li><li>æƒ…å†µ3ï¼šç±» :: éé™æ€æ–¹æ³•</li></ul></li><li>æ–¹æ³•å¼•ç”¨ä½¿ç”¨çš„è¦æ±‚ï¼šè¦æ±‚æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ç›¸åŒï¼ï¼ˆé’ˆå¯¹äºæƒ…å†µ1å’Œæƒ…å†µ2ï¼‰</li></ol><div class="tabs" id="5a1398c5-f32b-470b-81f3-16840cd41579"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#5a1398c5-f32b-470b-81f3-16840cd41579-1"><i class="far fa-sun"></i>å¯¹è±¡::éé™æ€æ–¹æ³•</button></li><li class="tab"><button type="button" data-href="#5a1398c5-f32b-470b-81f3-16840cd41579-2"><i class="fas fa-wind"></i>ç±»::é™æ€æ–¹æ³•</button></li><li class="tab"><button type="button" data-href="#5a1398c5-f32b-470b-81f3-16840cd41579-3"><i class="fas fa-fire-alt"></i>ç±»::å®ä¾‹æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="5a1398c5-f32b-470b-81f3-16840cd41579-1"><p>æŠ½è±¡æ–¹æ³•çš„<code>å½¢å‚åˆ—è¡¨</code>å’Œ<code>è¿”å›å€¼ç±»å‹</code>ä¸<code>æ–¹æ³•å¼•ç”¨</code>çš„æ–¹æ³•çš„<code>å½¢å‚åˆ—è¡¨</code>å’Œè¿”å›å€¼ç±»å‹ç›¸åŒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Consumerä¸­çš„void accept(T t)</span></span><br><span class="line"><span class="comment">//PrintStreamä¸­çš„void println(T t)</span></span><br><span class="line"><span class="comment">//å½¢å‚åˆ—è¡¨å‡ä¸º(T t)ï¼Œè¿”å›å€¼å‡ä¸ºvoidï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test06</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    Consumer&lt;String&gt; consumer01 = s -&gt; System.out.println(s);</span><br><span class="line">    consumer01.accept(<span class="string">&quot;å¥¹çš„æ‰‹åªæœ‰æˆ‘çš„æ‰‹å››åˆ†ä¹‹ä¸‰é‚£éº¼å¤§&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    <span class="type">PrintStream</span> <span class="variable">printStream</span> <span class="operator">=</span> System.out;</span><br><span class="line">    Consumer&lt;String&gt; consumer02 = printStream::println;</span><br><span class="line">    consumer02.accept(<span class="string">&quot;å¯æˆ‘é‚„æ˜¯æ²’èƒ½æŠ“ä½&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. ä½†è²Œä¼¼ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</span></span><br><span class="line">    Consumer&lt;String&gt; consumer03 = System.out::println;</span><br><span class="line">    consumer03.accept(<span class="string">&quot;èŠ±è½ä¸‹çš„æ—¶å€™æ²¡æ­» é£æ¡èµ·èŠ± åˆä¸¢ä¸‹ èŠ±æ‰æ­»äº†&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¥¹çš„æ‰‹åªæœ‰æˆ‘çš„æ‰‹å››åˆ†ä¹‹ä¸‰é‚£éº¼å¤§</span></span><br><span class="line"><span class="comment">-----------------------------</span></span><br><span class="line"><span class="comment">å¯æˆ‘é‚„æ˜¯æ²’èƒ½æŠ“ä½</span></span><br><span class="line"><span class="comment">-----------------------------</span></span><br><span class="line"><span class="comment">èŠ±è½ä¸‹çš„æ—¶å€™æ²¡æ­» é£æ¡èµ·èŠ± åˆä¸¢ä¸‹ èŠ±æ‰æ­»äº†</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5a1398c5-f32b-470b-81f3-16840cd41579-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Comparatorä¸­çš„int compare(T t1,T t2)</span></span><br><span class="line"><span class="comment">//Integerä¸­çš„int compare(T t1,T t2)</span></span><br><span class="line"><span class="comment">//å½¢å‚åˆ—è¡¨å‡ä¸º(T t1,T t2)ï¼Œè¿”å›å€¼å‡ä¸ºintï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test07</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator01 = (o1, o2) -&gt; Integer.compare(o1, o2);</span><br><span class="line">    System.out.println(comparator01.compare(<span class="number">20</span>, <span class="number">77</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator02 = Integer::compare;</span><br><span class="line">    System.out.println(comparator02.compare(<span class="number">94</span>, <span class="number">21</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">-1</span></span><br><span class="line"><span class="comment">----------------------------</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Functionä¸­çš„R apply(T t)</span></span><br><span class="line"><span class="comment">//Mathä¸­çš„Long round(Double d)</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼å’Œå‚æ•°åˆ—è¡¨ä¸ºæ³›å‹ï¼Œä¹Ÿå¯ä»¥åŒ¹é…ä¸Šï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test08</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    Function&lt;Double,Long&gt; function01 = aDouble -&gt; Math.round(aDouble);</span><br><span class="line">    System.out.println(function01.apply(<span class="number">3.141</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    Function&lt;Double,Long&gt; function02 = Math::round;</span><br><span class="line">    System.out.println(function02.apply(<span class="number">2.717</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">------------------------------</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5a1398c5-f32b-470b-81f3-16840cd41579-3"><p>ä¸€ä¸ªå‚æ•°ä½œä¸ºè°ƒç”¨è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Comparatorä¸­çš„int comapre(T t1,T t2)</span></span><br><span class="line"><span class="comment">// Stringä¸­çš„int t1.compareTo(t2)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test09</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator01 = (o1, o2) -&gt; o1.compareTo(o2);</span><br><span class="line">    System.out.println(comparator01.compare(<span class="number">94</span>, <span class="number">21</span>));</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">&quot;---------------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    Comparator&lt;Integer&gt; comparator02 = Integer::compareTo;</span><br><span class="line">    System.out.println(comparator02.compare(<span class="number">43</span>, <span class="number">96</span>));</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">---------------------------</span></span><br><span class="line"><span class="comment">-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//BiPredicateä¸­çš„boolean test(T t1, T t2);</span></span><br><span class="line"><span class="comment">//Stringä¸­çš„boolean t1.equals(t2)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test10</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    BiPredicate&lt;String,String&gt; biPredicate01 = (o1, o2) -&gt; o1.equals(o2);</span><br><span class="line">    System.out.println(biPredicate01.test(<span class="string">&quot;Kyle&quot;</span>, <span class="string">&quot;Kyle&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;----------------------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    BiPredicate&lt;String,String&gt; biPredicate02 = String::equals;</span><br><span class="line">    System.out.println(biPredicate02.test(<span class="string">&quot;Violet&quot;</span>, <span class="string">&quot;Violet&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">----------------------------------</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Functionä¸­çš„R apply(T t)</span></span><br><span class="line"><span class="comment">// Employeeä¸­çš„String toString();</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test11</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Stu</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Stu</span>(<span class="string">&quot;Kyle&quot;</span>, <span class="number">9527</span>);</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    Function&lt;Stu,String&gt; function01 = stu -&gt; stu.toString();</span><br><span class="line">    System.out.println(function01.apply(student));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æ–¹æ³•å¼•ç”¨</span></span><br><span class="line">    Function&lt;Stu,String&gt; function02 = Stu::toString;</span><br><span class="line">    System.out.println(function02.apply(student));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Stu&#123;name=&#x27;Kyle&#x27;, id=9527&#125;</span></span><br><span class="line"><span class="comment">------------------------------</span></span><br><span class="line"><span class="comment">Stu&#123;name=&#x27;Kyle&#x27;, id=9527&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="æ„é€ å™¨å¼•ç”¨å’Œæ•°ç»„å¼•ç”¨">æ„é€ å™¨å¼•ç”¨å’Œæ•°ç»„å¼•ç”¨</h3><ul><li>ä¸å‡½æ•°å¼æ¥å£ç›¸ç»“åˆï¼Œè‡ªåŠ¨ä¸å‡½æ•°å¼æ¥å£ä¸­æ–¹æ³•å…¼å®¹ã€‚</li><li>å¯ä»¥æŠŠæ„é€ å™¨å¼•ç”¨èµ‹å€¼ç»™å®šä¹‰çš„æ–¹æ³•ï¼Œè¦æ±‚æ„é€ å™¨å‚æ•°åˆ—è¡¨è¦ä¸æ¥å£ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸€è‡´ï¼ä¸”æ–¹æ³•çš„è¿”å›å€¼å³ä¸ºæ„é€ å™¨å¯¹åº”ç±»çš„å¯¹è±¡ã€‚</li></ul><div class="tabs" id="a1dd04d3-232a-4861-a5b8-a514f0e242d6"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a1dd04d3-232a-4861-a5b8-a514f0e242d6-1"><i class="fas fa-atom"></i>æ„é€ å™¨å¼•ç”¨</button></li><li class="tab"><button type="button" data-href="#a1dd04d3-232a-4861-a5b8-a514f0e242d6-2"><i class="far fa-sun"></i>æ•°ç»„å¼•ç”¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a1dd04d3-232a-4861-a5b8-a514f0e242d6-1"><p>å’Œæ–¹æ³•å¼•ç”¨ç±»ä¼¼ï¼Œå‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œæ„é€ å™¨çš„å½¢å‚åˆ—è¡¨ä¸€è‡´ã€‚</p><p>æŠ½è±¡æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å³ä¸ºæ„é€ å™¨æ‰€å±çš„ç±»çš„ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test12</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. Lambda</span></span><br><span class="line">    BiFunction&lt;String, Integer, Stu&gt; function01 = (string, integer) -&gt; <span class="keyword">new</span> <span class="title class_">Stu</span>(string, integer);</span><br><span class="line">    System.out.println(function01.apply(<span class="string">&quot;Kyle&quot;</span>, <span class="number">9527</span>));</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">&quot;-------------------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. æ„é€ å™¨å¼•ç”¨</span></span><br><span class="line">    BiFunction&lt;String, Integer, Stu&gt; function02 = Stu::<span class="keyword">new</span>;</span><br><span class="line">    System.out.println(function02.apply(<span class="string">&quot;Lucy&quot;</span>, <span class="number">9421</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Stu&#123;name=&#x27;Kyle&#x27;, id=9527&#125;</span></span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line"><span class="comment">Stu&#123;name=&#x27;Lucy&#x27;, id=9421&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a1dd04d3-232a-4861-a5b8-a514f0e242d6-2"><p>å¯ä»¥æŠŠæ•°ç»„çœ‹åšæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œåˆ™å†™æ³•ä¸æ„é€ å™¨å¼•ç”¨ä¸€è‡´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test13</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1. Lambda åˆ›å»ºä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„stringæ•°ç»„</span></span><br><span class="line">    Function&lt;Integer, String[]&gt; function01 = (integer -&gt; <span class="keyword">new</span> <span class="title class_">String</span>[integer]);</span><br><span class="line">    System.out.println(Arrays.toString(function01.apply(<span class="number">5</span>)));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;-----------------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//2. æ•°ç»„å¼•ç”¨</span></span><br><span class="line">    Function&lt;Integer, String[]&gt; function02 = String[]::<span class="keyword">new</span>;</span><br><span class="line">    System.out.println(Arrays.toString(function02.apply(<span class="number">7</span>)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[null, null, null, null, null]</span></span><br><span class="line"><span class="comment">-----------------------------</span></span><br><span class="line"><span class="comment">[null, null, null, null, null, null, null]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><hr><h2 id="å¼ºå¤§çš„Stream-APIâ­ï¸">å¼ºå¤§çš„Stream APIâ­ï¸</h2><h3 id="Stream-APIæ¦‚è¿°">Stream APIæ¦‚è¿°</h3><ul><li>Java8ä¸­æœ‰ä¸¤ä¸ªæœ€ä¸ºé‡è¦çš„æ”¹å˜ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯Stream API</li><li>Stream API(java.util.stream)æŠŠçœŸæ­£çš„å‡½æ•°å¼ç¼–ç¨‹é£æ ¼å¼•å…¥åˆ°Javaä¸­ï¼Œè¿™æ˜¯ç›®å‰ä¸ºæ­¢å¯¹Javaç±»åº“æœ€å¥½çš„è¡¥å……ï¼Œå› ä¸ºStream APIå¯ä»¥æå¤§åœ°æé«˜ç¨‹åºå‘˜ç”Ÿäº§åŠ›ï¼Œè®©ç¨‹åºå‘˜å†™å‡ºé«˜æ•ˆã€ç®€ä»‹çš„ä»£ç </li><li>Streamæ˜¯Java8 ä¸­å¤„ç†é›†åˆçš„å…³é”®æŠ½è±¡æ¦‚å¿µï¼Œå®ƒå¯ä»¥æŒ‡å®šä½ å¸Œæœ›å¯¹é›†åˆè¿›è¡Œçš„æ“ä½œï¼Œå¯ä»¥æ‰§è¡Œéå¸¸å¤æ‚çš„æŸ¥æ‰¾ã€è¿‡æ»¤å’Œæ˜ å°„æ•°æ®ç­‰æ“ä½œã€‚</li><li>ä½¿ç”¨Stream API å¯¹é›†åˆæ•°æ®è¿›è¡Œæ“ä½œï¼Œå°±ç±»ä¼¼äºä½¿ç”¨SQL æ‰§è¡Œçš„æ•°æ®åº“æŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Stream API æ¥å¹¶è¡Œæ‰§è¡Œæ“ä½œã€‚ç®€è¨€ä¹‹ï¼ŒStream API æä¾›äº†ä¸€ç§é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„å¤„ç†æ•°æ®çš„æ–¹å¼</li><li>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Stream API<ul><li>å®é™…å¼€å‘ä¸­ï¼Œé¡¹ç›®ä¸­å¤šæ•°æ•°æ®æºéƒ½æ˜¯æ¥è‡ªMySQLã€Oracle ç­‰ã€‚ä½†ç°åœ¨æ•°æ®æºå¯ä»¥æ›´å¤šäº†ï¼Œæœ‰MongDBã€Redisç­‰ï¼Œè€Œè¿™äº›NoSQLçš„æ•°æ®å°±éœ€è¦Javaå±‚é¢å»å¤„ç†ã€‚</li><li>Stream å’ŒCollectioné›†åˆçš„åŒºåˆ«ï¼šCollection æ˜¯ä¸€ç§é™æ€çš„å†…å­˜æ•°æ®ç»“æ„ï¼Œè€ŒStream æ˜¯æœ‰å…³è®¡ç®—çš„ã€‚å‰è€…æ˜¯ä¸»è¦é¢å‘å†…å­˜ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œåè€…ä¸»è¦æ˜¯é¢å‘CPUï¼Œé€šè¿‡CPU å®ç°è®¡ç®—ï¼ˆè¿™ä¹Ÿå°±æ˜¯ä¸ºå•¥ä¸€æ—¦æ‰§è¡Œç»ˆæ­¢æ“ä½œä¹‹åï¼ŒStream å°±ä¸èƒ½è¢«å†æ¬¡ä½¿ç”¨ï¼Œå¾—é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„æµæ‰è¡Œï¼‰</li></ul></li></ul><blockquote><p>å°ç»“</p></blockquote><ol><li>Stream å…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„è¿ç®—ï¼Œä¸CPU æ‰“äº¤é“ï¼›<br>é›†åˆå…³æ³¨çš„æ˜¯æ•°æ®çš„å­˜å‚¨ï¼Œä¸å†…å­˜æ‰“äº¤é“</li><li>Stream è‡ªå·±ä¸ä¼šå­˜å‚¨æ•°æ®ï¼›<br>Stream ä¸ä¼šæ”¹å˜æºå¯¹è±¡ï¼Œç›¸åï¼Œä»–ä»¬ä¼šè¿”å›ä¸€ä¸ªæŒæœ‰ç»“æœçš„æ–°Stream<br>Stream æ“ä½œæ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œè¿™æ„å‘³ç€ä»–ä»¬ä¼šç­‰åˆ°éœ€è¦ç»“æœçš„æ—¶å€™æ‰æ‰§è¡Œ</li><li>Stream æ‰§è¡Œæµç¨‹<ul><li>Streamå®ä¾‹åŒ–</li><li>ä¸€ç³»åˆ—ä¸­é—´æ“ä½œï¼ˆè¿‡æ»¤ã€æ˜ å°„ã€â€¦ï¼‰</li><li>ç»ˆæ­¢æ“ä½œ</li></ul></li><li>è¯´æ˜<ul><li>ä¸€ç³»åˆ—ä¸­é—´æ“ä½œè¿ï¼Œå¯¹æ•°æ®æºçš„æ•°æ®è¿›è¡Œå¤„ç†</li><li>ä¸€æ—¦æ‰§è¡Œç»ˆæ­¢æ“ä½œï¼Œå°±æ‰§è¡Œä¸­é—´æ“ä½œè¿ï¼Œå¹¶äº§ç”Ÿç»“æœï¼Œä¹‹åï¼Œä¸ä¼šå†è¢«ä½¿ç”¨</li></ul></li></ol><hr><h3 id="Streamçš„å®ä¾‹åŒ–">Streamçš„å®ä¾‹åŒ–</h3><div class="tabs" id="495d7dff-9394-4804-8bf5-e1083ed7e664"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#495d7dff-9394-4804-8bf5-e1083ed7e664-1"><i class="fas fa-baseball-ball"></i>æ–¹å¼ä¸€</button></li><li class="tab"><button type="button" data-href="#495d7dff-9394-4804-8bf5-e1083ed7e664-2"><i class="fas fa-bone"></i>æ–¹å¼äºŒ</button></li><li class="tab"><button type="button" data-href="#495d7dff-9394-4804-8bf5-e1083ed7e664-3"><i class="fas fa-heartbeat"></i>æ–¹å¼ä¸‰</button></li><li class="tab"><button type="button" data-href="#495d7dff-9394-4804-8bf5-e1083ed7e664-4"><i class="fas fa-cookie-bite"></i>æ–¹å¼å››</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="495d7dff-9394-4804-8bf5-e1083ed7e664-1"><p>é€šè¿‡é›†åˆåˆ›å»ºStream,ä½¿ç”¨ <code>Collection</code> æ¥å£çš„ <code>stream()</code> æ–¹æ³•æˆ– <code>parallelStream()</code> æ–¹æ³•åˆ›å»ºæµã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>);</span><br><span class="line">Stream&lt;String&gt; stream = list.stream(); <span class="comment">// åˆ›å»ºä¸²è¡Œæµ</span></span><br><span class="line">Stream&lt;String&gt; parallelStream = list.parallelStream(); <span class="comment">// åˆ›å»ºå¹¶è¡Œæµ</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„</p><p>Map æ¥å£æ˜¯ä¸ç»§æ‰¿ Collection æ¥å£çš„ï¼Œå› æ­¤ Map æ²¡æœ‰æä¾› stream() æ–¹æ³•ç”¨äºç”Ÿæˆæµå¯¹è±¡ã€‚</p><p>å¯ä»¥é€šè¿‡ Map çš„ entrySet() æ–¹æ³•è·å–ä¸€ä¸ª<code>Set&lt;Map.Entry&lt;K, V&gt;&gt;</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº† Map ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ã€‚å› ä¸º Set å®ç°äº† Collection æ¥å£ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¯¥ Set å¯¹è±¡ç”Ÿæˆæµå¯¹è±¡ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="495d7dff-9394-4804-8bf5-e1083ed7e664-2"><p>é€šè¿‡æ•°ç»„åˆ›å»ºStringï¼Œä½¿ç”¨ <code>Arrays</code> ç±»çš„ <code>stream(T[] array)</code> æ–¹æ³•åˆ›å»ºæµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] arr = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="type">IntStream</span> <span class="variable">stream</span> <span class="operator">=</span> Arrays.stream(arr); <span class="comment">// åˆ›å»ºåŸºæœ¬ç±»å‹æµ</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="495d7dff-9394-4804-8bf5-e1083ed7e664-3"><p>é€šè¿‡è‡ªå®šä¹‰åˆ›å»ºæµï¼šä½¿ç”¨ <code>Stream</code> æ¥å£æä¾›çš„é™æ€æ–¹æ³• <code>of()</code>ã€<code>iterate()</code>ã€<code>generate()</code> åˆ›å»ºæµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; stream = Stream.of(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>); <span class="comment">// åˆ›å»ºæµï¼ŒåŒ…å«æŒ‡å®šçš„å…ƒç´ </span></span><br><span class="line">Stream&lt;Integer&gt; stream = Stream.iterate(<span class="number">1</span>, n -&gt; n + <span class="number">1</span>).limit(<span class="number">5</span>); <span class="comment">// åˆ›å»ºæµï¼ŒåŒ…å« 1 åˆ° 5 çš„æ•´æ•°</span></span><br><span class="line">Stream&lt;Double&gt; stream = Stream.generate(Math::random).limit(<span class="number">5</span>); <span class="comment">// åˆ›å»ºæµï¼ŒåŒ…å« 5 ä¸ªéšæœºæ•°</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="495d7dff-9394-4804-8bf5-e1083ed7e664-4"><p>é€šè¿‡æ•°å€¼èŒƒå›´åˆ›å»ºæµï¼šä½¿ç”¨ <code>IntStream</code>ã€<code>LongStream</code> æˆ– <code>DoubleStream</code> æ¥å£æä¾›çš„ <code>range()</code>ã€<code>rangeClosed()</code> æ–¹æ³•åˆ›å»ºæµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">IntStream</span> <span class="variable">stream</span> <span class="operator">=</span> IntStream.range(<span class="number">1</span>, <span class="number">5</span>); <span class="comment">// åˆ›å»ºèŒƒå›´æµï¼ŒåŒ…æ‹¬ 1 ä¸åŒ…æ‹¬ 5</span></span><br><span class="line"><span class="type">IntStream</span> <span class="variable">stream</span> <span class="operator">=</span> IntStream.rangeClosed(<span class="number">1</span>, <span class="number">5</span>); <span class="comment">// åˆ›å»ºèŒƒå›´æµï¼ŒåŒ…æ‹¬ 1 å’Œ 5</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="Streamçš„ä¸­é—´æ“ä½œ">Streamçš„ä¸­é—´æ“ä½œ</h3><blockquote><mark class="hl-label blue">åŒ…è£…</mark> </blockquote><p><code>boxed()</code> æ–¹æ³•ä½œç”¨æ˜¯å°†åŸºæœ¬ç±»å‹æµè½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»å‹æµã€‚ä¾‹å¦‚ï¼Œå°† <code>IntStream</code> è½¬æ¢æˆ <code>Stream&lt;Integer&gt;</code>ï¼Œå°† <code>DoubleStream</code> è½¬æ¢æˆ <code>Stream&lt;Double&gt;</code> ç­‰ã€‚</p><p>è¿™é€šå¸¸æ˜¯ä¸ºäº†åœ¨æµå¤„ç†è¿‡ç¨‹ä¸­ä½¿ç”¨æŸäº›ä¸é€‚ç”¨äºåŸºæœ¬ç±»å‹çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å°†åŸºæœ¬ç±»å‹å…ƒç´ æ”¶é›†åˆ°æŸç§é›†åˆä¸­æˆ–éœ€è¦ä½¿ç”¨å¯¹è±¡å¼•ç”¨æ—¶ã€‚</p><p>ä¾‹å¦‚åŸºæœ¬æ•°æ®ç±»å‹æµçš„æ’åºä¸èƒ½ä¼ å…¥æ¯”è¾ƒå™¨ï¼Œå¾—ä½¿ç”¨åŒ…è£…ç±»å‹æµã€‚</p><blockquote><mark class="hl-label blue">ç­›é€‰ä¸åˆ‡ç‰‡</mark> </blockquote><p>ç­›é€‰ä¸åˆ‡ç‰‡æ“ä½œç”¨äºå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œè¿‡æ»¤å’Œæˆªå–ï¼Œå¸¸ç”¨çš„æ–¹æ³•åŒ…æ‹¬:</p><p><code>filter(Predicate&lt;T&gt; predicate)</code>ï¼šè¿‡æ»¤æµä¸­ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>); <span class="comment">// è¿‡æ»¤å¶æ•°</span></span><br></pre></td></tr></table></figure><p><code>distinct()</code>ï¼šå»é™¤æµä¸­é‡å¤çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().distinct(); <span class="comment">// å»é‡</span></span><br></pre></td></tr></table></figure><p><code>limit(long maxSize)</code>ï¼šæˆªå–æµä¸­çš„å‰ <code>maxSize</code> ä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().limit(<span class="number">3</span>); <span class="comment">// æˆªå–å‰ä¸‰ä¸ªå…ƒç´ </span></span><br></pre></td></tr></table></figure><p><code>skip(long n)</code>ï¼šè·³è¿‡æµä¸­çš„å‰ <code>n</code> ä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().skip(<span class="number">2</span>); <span class="comment">// è·³è¿‡å‰ä¸¤ä¸ªå…ƒç´ </span></span><br></pre></td></tr></table></figure><blockquote><mark class="hl-label blue">æ˜ å°„</mark> </blockquote><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">map(Function f)</td><td style="text-align:center">æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚</td></tr><tr><td style="text-align:center">mapToDouble(ToDoubleFunction f)</td><td style="text-align:center">æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„DoubleStreamã€‚</td></tr><tr><td style="text-align:center">mapToInt(ToIntFunction f)</td><td style="text-align:center">æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„IntStreamã€‚</td></tr><tr><td style="text-align:center">mapToLong(ToLongFunction f)</td><td style="text-align:center">æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„LongStreamã€‚</td></tr><tr><td style="text-align:center">flatMap(Function f)</td><td style="text-align:center">æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†æµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰æµè¿æ¥æˆä¸€ä¸ªæµ</td></tr></tbody></table><p>æ˜ å°„æ“ä½œç”¨äºå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œè½¬æ¢å’Œæå–ï¼Œå¸¸ç”¨çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p><p><code>map(Function&lt;T, R&gt; mapper)</code>ï¼šå°†æµä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜ å°„æˆå¦å¤–ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().map(s -&gt; s.length()); <span class="comment">// å°†å­—ç¬¦ä¸²è½¬æ¢æˆé•¿åº¦</span></span><br></pre></td></tr></table></figure><p><code>flatMap(Function&lt;T, Stream&lt;R&gt;&gt; mapper)</code>ï¼šå°†æµä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜ å°„æˆä¸€ä¸ªæµï¼Œç„¶åå°†è¿™äº›æµåˆå¹¶æˆä¸€ä¸ªæµï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;List&lt;Integer&gt;&gt; list = Arrays.asList(Arrays.asList(<span class="number">1</span>, <span class="number">2</span>), Arrays.asList(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>), Arrays.asList(<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>));</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().flatMap(Collection::stream); <span class="comment">// å°†å¤šä¸ªåˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªæµ</span></span><br></pre></td></tr></table></figure><blockquote><mark class="hl-label blue">æ’åº</mark> </blockquote><p><code>sorted()</code>ï¼šæŒ‰è‡ªç„¶é¡ºåºå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().sorted(); <span class="comment">// å¯¹æ•´æ•°åˆ—è¡¨è¿›è¡Œæ’åº å¢åº</span></span><br></pre></td></tr></table></figure><p><code>sorted(Comparator&lt;T&gt; comparator)</code>ï¼šæŒ‰æŒ‡å®šçš„æ¯”è¾ƒå™¨å¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æµã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;pear&quot;</span>);</span><br><span class="line">Stream&lt;String&gt; stream = list.stream().sorted(Comparator.comparing(String::length)); <span class="comment">// å¯¹å­—ç¬¦ä¸²åˆ—è¡¨æŒ‰é•¿åº¦è¿›è¡Œæ’åº</span></span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; list = Arrays.asList(<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream = list.stream().sorted(Comparator.reverseOrder()); <span class="comment">// å¯¹æ•´æ•°åˆ—è¡¨è¿›è¡Œæ’åº é™åº</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€†åºæ¯”è¾ƒå™¨åªå¯¹å®ç°äº† <code>Comparable</code> æ¥å£çš„ç±»å‹æœ‰æ•ˆï¼Œå¯¹äºå…¶ä»–ç±»å‹çš„å…ƒç´ ï¼Œéœ€è¦æä¾›è‡ªå®šä¹‰çš„æ¯”è¾ƒå™¨ã€‚</p><hr><h3 id="Streamçš„ç»ˆæ­¢æ“ä½œ">Streamçš„ç»ˆæ­¢æ“ä½œ</h3><p>æµçš„ç»ˆæ­¢æ“ä½œç”¨äºè§¦å‘æµçš„è®¡ç®—ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªæœ€ç»ˆçš„ç»“æœæˆ–å‰¯ä½œç”¨ã€‚å¸¸ç”¨çš„ç»ˆæ­¢æ“ä½œåŒ…æ‹¬ï¼š</p><blockquote><mark class="hl-label blue">åŒ¹é…ä¸æŸ¥æ‰¾</mark> </blockquote><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">allMatch(Predicate p)</td><td style="text-align:center">æ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ </td></tr><tr><td style="text-align:center">anyMatch(Predicate p)</td><td style="text-align:center">æ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ </td></tr><tr><td style="text-align:center">noneMatch(Predicate p)</td><td style="text-align:center">æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…æ‰€æœ‰å…ƒç´ </td></tr><tr><td style="text-align:center">findFirst()</td><td style="text-align:center">è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td style="text-align:center">findAny()</td><td style="text-align:center">è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ </td></tr><tr><td style="text-align:center">count()</td><td style="text-align:center">è¿”å›æµä¸­å…ƒç´ æ€»æ•°</td></tr><tr><td style="text-align:center">max(Comparator c)</td><td style="text-align:center">è¿”å›æµä¸­æœ€å¤§å€¼</td></tr><tr><td style="text-align:center">min(Comparator c)</td><td style="text-align:center">è¿”å›æµä¸­æœ€å°å€¼</td></tr><tr><td style="text-align:center">forEach(Consumer c)</td><td style="text-align:center">å†…éƒ¨è¿­ä»£(ä½¿ç”¨Collection æ¥å£éœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼Œç§°ä¸ºå¤–éƒ¨è¿­ä»£ã€‚ç›¸åï¼ŒStream API ä½¿ç”¨å†…éƒ¨è¿­ä»£â€”â€”å®ƒå¸®ä½ æŠŠè¿­ä»£åšäº†)</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = EmployeeData.getEmployees();</span><br><span class="line"><span class="comment">// allMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ ã€‚</span></span><br><span class="line">System.out.println(<span class="string">&quot;æ˜¯å¦æ‰€æœ‰çš„å‘˜å·¥çš„å·¥èµ„æ˜¯å¦éƒ½å¤§äº5000ï¼š&quot;</span>+employees.stream().allMatch(employee -&gt; employee.getSalary() &gt; <span class="number">5000</span>));</span><br><span class="line"><span class="comment">// anyMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ ã€‚</span></span><br><span class="line">System.out.println(<span class="string">&quot;æ˜¯å¦å­˜åœ¨å‘˜å·¥å¹´é¾„å°äº15ï¼š&quot;</span>+employees.stream().anyMatch(employee -&gt; employee.getAge() &lt; <span class="number">15</span>));</span><br><span class="line"><span class="comment">// noneMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…çš„å…ƒç´ ã€‚</span></span><br><span class="line">System.out.println(<span class="string">&quot;æ˜¯å¦ä¸å­˜åœ¨å‘˜å·¥å§“é©¬ï¼š&quot;</span>+employees.stream().noneMatch(employee -&gt; employee.getName().startsWith(<span class="string">&quot;é©¬&quot;</span>)));</span><br><span class="line"><span class="comment">//findFirstâ€”â€”è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š&quot;</span>+employees.stream().findFirst());</span><br><span class="line"><span class="comment">//findAnyâ€”â€”è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ </span></span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ &quot;</span>+employees.stream().findAny());</span><br><span class="line"><span class="comment">//countâ€”â€”è¿”å›æµä¸­å…ƒç´ çš„æ€»ä¸ªæ•°</span></span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›å…ƒç´ æ€»æ•°ï¼š&quot;</span>+employees.stream().count());</span><br><span class="line"><span class="comment">//max(Comparator c)â€”â€”è¿”å›æµä¸­æœ€å¤§å€¼</span></span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›æœ€é«˜å·¥èµ„ï¼š&quot;</span>+employees.stream().map(Employee::getSalary).max(Double::compare));</span><br><span class="line"><span class="comment">//min(Comparator c)â€”â€”è¿”å›æµä¸­æœ€å°å€¼</span></span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›æœ€å°å¹´é¾„ï¼š&quot;</span>+employees.stream().map(Employee::getAge).min(Integer::compare));</span><br><span class="line"><span class="comment">//forEach(Consumer c)â€”â€”å†…éƒ¨è¿­ä»£</span></span><br><span class="line">employees.stream().forEach(System.out::println);</span><br><span class="line">System.out.println(<span class="string">&quot;-------------&quot;</span>);</span><br><span class="line"><span class="comment">////ä½¿ç”¨é›†åˆçš„éå†æ“ä½œ</span></span><br><span class="line">employees.forEach(System.out::println);</span><br></pre></td></tr></table></figure><blockquote><mark class="hl-label blue">å½’çº¦</mark> </blockquote><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">reduce(T iden, BinaryOperator b)</td><td style="text-align:center">å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å›T</td></tr><tr><td style="text-align:center">reduce(BinaryOperator b)</td><td style="text-align:center">å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å›Optional</td></tr></tbody></table><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test22</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; nums = Arrays.asList(<span class="number">13</span>, <span class="number">32</span>, <span class="number">23</span>, <span class="number">31</span>, <span class="number">94</span>, <span class="number">20</span>, <span class="number">77</span>, <span class="number">21</span>, <span class="number">17</span>);</span><br><span class="line">    List&lt;Employee&gt; employees = EmployeeData.getEmployees();</span><br><span class="line">    <span class="comment">// reduce(T identity, BinaryOperator)â€”â€”å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å› T</span></span><br><span class="line">    <span class="comment">// ç»ƒä¹ 1ï¼šè®¡ç®—1-10çš„è‡ªç„¶æ•°çš„å’Œ</span></span><br><span class="line">    System.out.println(nums.stream().reduce(<span class="number">0</span>, Integer::sum));</span><br><span class="line">    <span class="comment">//reduce(BinaryOperator) â€”â€”å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å› Optional&lt;T&gt;</span></span><br><span class="line">    <span class="comment">// ç»ƒä¹ 2ï¼šè®¡ç®—å…¬å¸æ‰€æœ‰å‘˜å·¥å·¥èµ„æ€»å’Œ</span></span><br><span class="line">    System.out.println(employees.stream().map(Employee::getSalary).reduce((o1, o2) -&gt; o1 + o2));</span><br><span class="line">    <span class="comment">// åˆ«çš„å†™æ³•ï¼Œè®¡ç®—å¹´é¾„æ€»å’Œ</span></span><br><span class="line">    System.out.println(employees.stream().map(Employee::getAge).reduce(Integer::sum));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">328</span></span><br><span class="line"><span class="comment">Optional[48424.08]</span></span><br><span class="line"><span class="comment">Optional[273]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><blockquote><mark class="hl-label blue">æ”¶é›†</mark> </blockquote><p><code>collect(Collector&lt;T, A, R&gt; collector)</code>ï¼šå°†æµä¸­çš„å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œè¿”å›ä¸€ä¸ªæœ€ç»ˆçš„ç»“æœã€‚</p><p>Collector æ¥å£ä¸­æ–¹æ³•çš„å®ç°å†³å®šäº†å¦‚ä½•å¯¹æµæ‰§è¡Œæ”¶é›†çš„æ“ä½œ(å¦‚æ”¶é›†åˆ°Listã€Setã€Map)ã€‚</p><p>Collectorså®ç”¨ç±»æä¾›äº†å¾ˆå¤šé™æ€æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå¸¸è§æ”¶é›†å™¨å®ä¾‹ï¼Œå…·ä½“æ–¹æ³•ä¸å®ä¾‹å¦‚ä¸‹è¡¨</p><table>  <tbody>    <tr style="text-align:center">      <td bgcolor="3366ff" style="color:white">æ–¹æ³•</td>      <td bgcolor="3366ff" style="color:white">è¿”å›ç±»å‹</td>      <td bgcolor="3366ff" style="color:white">ä½œç”¨</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">toList</td>      <td bgcolor="3399ff" style="color:white">List&lt;T&gt;</td>      <td bgcolor="3399ff" style="color:white">æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°List</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">List&lt;Employee&gt; emps= list.stream().collect(Collectors.toList());</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">toSet</td>      <td bgcolor="3399ff" style="color:white">List&lt;T&gt;</td>      <td bgcolor="3399ff" style="color:white">æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°List</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">Set&lt;Employee&gt; emps= list.stream().collect(Collectors.toSet());</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">toCollection</td>      <td bgcolor="3399ff" style="color:white"> Collection&lt;T&gt;</td>      <td bgcolor="3399ff" style="color:white">æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°åˆ›å»ºçš„é›†åˆ</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">Collection&lt;Employee&gt; emps =list.stream().collect(Collectors.toCollection(ArrayList::new));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">counting</td>      <td bgcolor="3399ff" style="color:white">Long</td>      <td bgcolor="3399ff" style="color:white">è®¡ç®—æµä¸­å…ƒç´ çš„ä¸ªæ•°</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">long count = list.stream().collect(Collectors.counting());</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">summinglnt</td>      <td bgcolor="3399ff" style="color:white">Integer</td>      <td bgcolor="3399ff" style="color:white">å¯¹æµä¸­å…ƒç´ çš„æ•´æ•°å±æ€§æ±‚å’Œ</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">int total=list.stream().collect(Collectors.summingInt(Employee::getSalary));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">averagingInt</td>      <td bgcolor="3399ff" style="color:white">Double</td>      <td bgcolor="3399ff" style="color:white">è®¡ç®—æµä¸­å…ƒç´ Integerå±æ€§çš„å¹³å‡å€¼</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">double avg = list.stream().collect(Collectors.averagingInt(Employee::getSalary));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">summarizinglnt</td>      <td bgcolor="3399ff" style="color:white">IntSummaryStatistics</td>      <td bgcolor="3399ff" style="color:white">æ”¶é›†æµä¸­Integerå±æ€§çš„ç»Ÿè®¡å€¼ã€‚å¦‚:å¹³å‡å€¼</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">int SummaryStatisticsiss=list.stream().collect(Collectors.summarizingInt(Employee::getSalary));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">joining</td>      <td bgcolor="3399ff" style="color:white">String</td>      <td bgcolor="3399ff" style="color:white">è¿æ¥æµä¸­æ¯ä¸ªå­—ç¬¦ä¸²</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">String str= list.stream().map(Employee::getName).collect(Collectors.joining());</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">maxBy</td>      <td bgcolor="3399ff" style="color:white">Optional&lt;T&gt;</td>      <td bgcolor="3399ff" style="color:white">æ ¹æ®æ¯”è¾ƒå™¨é€‰æ‹©æœ€å¤§å€¼</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">optional&lt;Emp&gt;max=list.stream().collect(Collectors.maxBy(comparingInt(Employee::getSalary));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">minBy</td>      <td bgcolor="3399ff" style="color:white">Optional&lt;T&gt;</td>      <td bgcolor="3399ff" style="color:white">æ ¹æ®æ¯”è¾ƒå™¨é€‰æ‹©æœ€å°å€¼</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">Optional&lt;Emp&gt;min = list.stream().collect(Collectors.minBy(comparingInt(Employee::getSalary));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">reducing</td>      <td bgcolor="3399ff" style="color:white">å½’çº¦äº§ç”Ÿçš„ç±»å‹</td>      <td bgcolor="3399ff" style="color:white">ä»ä¸€ä¸ªä½œä¸ºç´¯åŠ å™¨çš„åˆå§‹å€¼å¼€å§‹ï¼Œåˆ©ç”¨BinaryOperatorä¸æµä¸­å…ƒç´ é€ä¸ªç»“åˆï¼Œä»è€Œå½’çº¦æˆå•ä¸ªå€¼</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">int total=list.stream().collect(Collectors.reducing(0, Employe::getSalar, Integer::sum));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">collectingAndThen</td>      <td bgcolor="3399ff" style="color:white">è½¬æ¢å‡½æ•°è¿”å›çš„ç±»å‹</td>      <td bgcolor="3399ff" style="color:white">åŒ…è£¹å¦ä¸€ä¸ªæ”¶é›†å™¨ï¼Œå¯¹å…¶ç»“æœè½¬æ¢å‡½æ•°</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">int how= list.stream().collect(Collectors.collectingAndThen(Collectors.toList(), List::size));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">groupingBy</td>      <td bgcolor="3399ff" style="color:white"> Map&lt;K, List&lt;T&gt;&gt;</td>      <td bgcolor="3399ff" style="color:white">æ ¹æ®æŸå±æ€§å€¼å¯¹æµåˆ†ç»„ï¼Œå±æ€§ä¸ºK,ç»“æœä¸ºV</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">Map&lt;Emp.Status, List&lt;Emp&gt;&gt;map= list.stream().collect(Collectors.groupingBy(Employee::getStatus));</td>    </tr>    <tr style="text-align:center">      <td bgcolor="3399ff" style="color:white">partitioningBy</td>      <td bgcolor="3399ff" style="color:white">Map&lt;Boolean,List&lt;T&gt;&gt;</td>      <td bgcolor="3399ff" style="color:white">æ ¹æ®trueæˆ–falseè¿›è¡Œåˆ†åŒº</td>    </tr>    <tr style="text-align:center">      <td colspan="3" bgcolor="33ccff" style="color:white">Map&lt;Boolean,List&lt;Emp&gt;&gt;vd=list.stream().collect(Collectors.partitioningBy(Employee::getManage));</td>    </tr></tbody></table><hr><hr><h2 id="Streamçš„ä½¿ç”¨å®ä¾‹">Streamçš„ä½¿ç”¨å®ä¾‹</h2><blockquote><p>mapä¸­å­˜å‚¨äº†å„å…ƒç´ çš„å‡ºç°æ¬¡æ•°ã€‚</p></blockquote><p>k = 2 ï¼Œv = 3</p><p>è¯´æ˜æ•°å­—2 å‡ºç°äº†3æ¬¡</p><p>ç°åœ¨è¦å°†mapä¸­å„å…ƒç´ çš„å‡ºç°æ¬¡æ•°ï¼Œä»å¤§åˆ°å°æ’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">List&lt;Map.Entry&lt;Integer, Integer&gt;&gt; mapList = map.entrySet().stream()</span><br><span class="line">            .sorted((c1, c2) -&gt; c2.getValue().compareTo(c1.getValue()))</span><br><span class="line">            .collect(Collectors.toList());</span><br></pre></td></tr></table></figure><blockquote><p>è·å¾—å·®å€¼åºåˆ—</p></blockquote><p>nums[1, 7, 4, 9, 2, 5]   å‰é¡¹å‡å»åé¡¹</p><p>å·®å€¼ [6, -3, 5, -7, 3]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] array = IntStream.range(<span class="number">1</span>, nums.length) <span class="comment">// åˆ›å»º 1åˆ° nums.length ä¸€å…± nums.length-1 å“¥</span></span><br><span class="line">                .map(i -&gt; nums[i-<span class="number">1</span>] - nums[i])<span class="comment">// æ˜ å°„</span></span><br><span class="line">                .toArray();</span><br></pre></td></tr></table></figure><blockquote><p>å–å¾—äºŒç»´Listçš„æœ€åä¸€ä¸ªå…ƒç´ å­˜å‚¨</p></blockquote><p>levels = [[3], [9, 20], [15, 7]]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; levels =<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">Stream.of(levels)</span><br><span class="line">      .flatMap(List::stream)</span><br><span class="line">      .mapToInt(list -&gt; list.get(list.size() - <span class="number">1</span>))</span><br><span class="line">      .forEach(res::add);</span><br></pre></td></tr></table></figure><p>res = [3,20,7]</p>]]></content>
    
    
    <summary type="html">Lambdaè¡¨è¾¾å¼ã€å‡½æ•°å¼æ¥å£ã€Stream API</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>äºŒå‰æ ‘</title>
    <link href="https://wuwawawa.github.io/posts/e85d694a.html"/>
    <id>https://wuwawawa.github.io/posts/e85d694a.html</id>
    <published>2023-05-10T05:04:05.000Z</published>
    <updated>2023-05-12T00:53:14.285Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¿»è½¬äºŒå‰æ ‘">ç¿»è½¬äºŒå‰æ ‘</h2><div class="tag link"><a class="link-card" title="226. ç¿»è½¬äºŒå‰æ ‘" href="https://leetcode.cn/problems/invert-binary-tree/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">226. ç¿»è½¬äºŒå‰æ ‘</p><p class="url">https://leetcode.cn/problems/invert-binary-tree/</p></div></a></div><p>ç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œç¿»è½¬è¿™æ£µäºŒå‰æ ‘ï¼Œå¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://assets.leetcode.com/uploads/2021/03/14/invert1-tree.jpg" alt="img" style="zoom:67%;" /><p>é€’å½’ä¸‰éƒ¨æ›²</p><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ã€‚</li><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶ã€‚å½“å‰èŠ‚ç‚¹ä¸ºç©ºçš„æ—¶å€™ï¼Œå°±è¿”å›</li><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ã€‚å› ä¸ºæ˜¯å…ˆå‰åºéå†ï¼Œæ‰€ä»¥å…ˆè¿›è¡Œäº¤æ¢å·¦å³å­©å­èŠ‚ç‚¹ï¼Œç„¶ååè½¬å·¦å­æ ‘ï¼Œåè½¬å³å­æ ‘ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">invertTree</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="comment">//é€’å½’å‡½æ•°çš„ç»ˆæ­¢æ¡ä»¶ï¼ŒèŠ‚ç‚¹ä¸ºç©ºæ—¶è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span>(root==<span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä¸‹é¢ä¸‰å¥æ˜¯å°†å½“å‰èŠ‚ç‚¹çš„å·¦å³å­æ ‘äº¤æ¢</span></span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> root.right;</span><br><span class="line">    root.right = root.left;</span><br><span class="line">    root.left = tmp;</span><br><span class="line">    <span class="comment">//é€’å½’äº¤æ¢å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘</span></span><br><span class="line">    invertTree(root.left);</span><br><span class="line">    <span class="comment">//é€’å½’äº¤æ¢å½“å‰èŠ‚ç‚¹çš„ å³å­æ ‘</span></span><br><span class="line">    invertTree(root.right);</span><br><span class="line">    <span class="comment">//å‡½æ•°è¿”å›æ—¶å°±è¡¨ç¤ºå½“å‰è¿™ä¸ªèŠ‚ç‚¹ï¼Œä»¥åŠå®ƒçš„å·¦å³å­æ ‘</span></span><br><span class="line">    <span class="comment">//éƒ½å·²ç»äº¤æ¢å®Œäº†</span></span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="å¯¹ç§°äºŒå‰æ ‘">å¯¹ç§°äºŒå‰æ ‘</h2><div class="tag link"><a class="link-card" title="101. å¯¹ç§°äºŒå‰æ ‘" href="https://leetcode.cn/problems/symmetric-tree/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">101. å¯¹ç§°äºŒå‰æ ‘</p><p class="url">https://leetcode.cn/problems/symmetric-tree/</p></div></a></div><p>ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œ æ£€æŸ¥å®ƒæ˜¯å¦è½´å¯¹ç§°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://assets.leetcode.com/uploads/2021/02/19/symtree1.jpg" alt="img" style="zoom:67%;" /><p>é€’å½’ä¸‰éƒ¨æ›²</p><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼</li></ol><p>å› ä¸ºæˆ‘ä»¬è¦æ¯”è¾ƒçš„æ˜¯æ ¹èŠ‚ç‚¹çš„ä¸¤ä¸ªå­æ ‘æ˜¯å¦æ˜¯ç›¸äº’ç¿»è½¬çš„ï¼Œè¿›è€Œåˆ¤æ–­è¿™ä¸ªæ ‘æ˜¯ä¸æ˜¯å¯¹ç§°æ ‘ï¼Œæ‰€ä»¥è¦æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªæ ‘ï¼Œå‚æ•°è‡ªç„¶ä¹Ÿæ˜¯å·¦å­æ ‘èŠ‚ç‚¹å’Œå³å­æ ‘èŠ‚ç‚¹ã€‚</p><p>è¿”å›å€¼è‡ªç„¶æ˜¯boolç±»å‹ã€‚</p><ol start="2"><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li></ol><p>è¦æ¯”è¾ƒä¸¤ä¸ªèŠ‚ç‚¹æ•°å€¼ç›¸ä¸ç›¸åŒï¼Œé¦–å…ˆè¦æŠŠä¸¤ä¸ªèŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µå¼„æ¸…æ¥šï¼å¦åˆ™åé¢æ¯”è¾ƒæ•°å€¼çš„æ—¶å€™å°±ä¼šæ“ä½œç©ºæŒ‡é’ˆäº†ã€‚</p><p>èŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µæœ‰ï¼šï¼ˆæ³¨æ„æˆ‘ä»¬æ¯”è¾ƒçš„å…¶å®ä¸æ˜¯å·¦å­©å­å’Œå³å­©å­ï¼Œæ‰€ä»¥å¦‚ä¸‹æˆ‘ç§°ä¹‹ä¸ºå·¦èŠ‚ç‚¹å³èŠ‚ç‚¹ï¼‰</p><ul><li>å·¦èŠ‚ç‚¹ä¸ºç©ºï¼Œå³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œä¸å¯¹ç§°ï¼Œreturn false</li><li>å·¦ä¸ä¸ºç©ºï¼Œå³ä¸ºç©ºï¼Œä¸å¯¹ç§° return false</li><li>å·¦å³éƒ½ä¸ºç©ºï¼Œå¯¹ç§°ï¼Œè¿”å›true</li></ul><p>æ­¤æ—¶å·²ç»æ’é™¤æ‰äº†èŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯å·¦å³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼š</p><ul><li>å·¦å³éƒ½ä¸ä¸ºç©ºï¼Œæ¯”è¾ƒèŠ‚ç‚¹æ•°å€¼ï¼Œä¸ç›¸åŒå°±return false</li></ul><p>æ­¤æ—¶å·¦å³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œä¸”æ•°å€¼ä¹Ÿä¸ç›¸åŒçš„æƒ…å†µæˆ‘ä»¬ä¹Ÿå¤„ç†äº†ã€‚</p><ol start="3"><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</li></ol><p>æ­¤æ—¶æ‰è¿›å…¥å•å±‚é€’å½’çš„é€»è¾‘ï¼Œå•å±‚é€’å½’çš„é€»è¾‘å°±æ˜¯å¤„ç† å·¦å³èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºï¼Œä¸”æ•°å€¼ç›¸åŒçš„æƒ…å†µã€‚</p><ul><li>æ¯”è¾ƒäºŒå‰æ ‘å¤–ä¾§æ˜¯å¦å¯¹ç§°ï¼šä¼ å…¥çš„æ˜¯å·¦èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œå³èŠ‚ç‚¹çš„å³å­©å­ã€‚</li><li>æ¯”è¾ƒå†…æµ‹æ˜¯å¦å¯¹ç§°ï¼Œä¼ å…¥å·¦èŠ‚ç‚¹çš„å³å­©å­ï¼Œå³èŠ‚ç‚¹çš„å·¦å­©å­ã€‚</li><li>å¦‚æœå·¦å³éƒ½å¯¹ç§°å°±è¿”å›true ï¼Œæœ‰ä¸€ä¾§ä¸å¯¹ç§°å°±è¿”å›false ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSymmetric</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root==<span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è°ƒç”¨é€’å½’å‡½æ•°ï¼Œæ¯”è¾ƒå·¦èŠ‚ç‚¹ï¼Œå³èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> dfs(root.left,root.right);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">dfs</span><span class="params">(TreeNode left, TreeNode right)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (left == <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (left==<span class="literal">null</span> || right == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (left.val!=right.val)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dfs(left.left,right.right)&amp;&amp;dfs(left.right,right.left);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦â­ï¸">äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦â­ï¸</h2><div class="tag link"><a class="link-card" title="104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦" href="https://leetcode.cn/problems/maximum-depth-of-binary-tree/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</p><p class="url">https://leetcode.cn/problems/maximum-depth-of-binary-tree/</p></div></a></div><div class="tag link"><a class="link-card" title="559. nå‰æ ‘çš„æœ€å¤§æ·±åº¦" href="https://leetcode.cn/problems/maximum-depth-of-n-ary-tree/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">559. nå‰æ ‘çš„æœ€å¤§æ·±åº¦</p><p class="url">https://leetcode.cn/problems/maximum-depth-of-n-ary-tree/</p></div></a></div><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾å‡ºå…¶æœ€å¤§æ·±åº¦ã€‚</p><p>ç¤ºä¾‹ï¼š<br>ç»™å®šäºŒå‰æ ‘ <code>[3,9,20,null,null,15,7]</code>ï¼Œ</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   <span class="number">3</span></span><br><span class="line">  / <span class="string">\</span></span><br><span class="line"> <span class="number">9</span>  <span class="number">20</span></span><br><span class="line"> /  <span class="string">\</span></span><br><span class="line"><span class="number">15</span>   <span class="number">7</span></span><br></pre></td></tr></table></figure><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼šå‚æ•°å°±æ˜¯ä¼ å…¥æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿”å›å°±è¿”å›è¿™æ£µæ ‘çš„æ·±åº¦ï¼Œæ‰€ä»¥è¿”å›å€¼ä¸ºintç±»å‹ã€‚</li><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœä¸ºç©ºèŠ‚ç‚¹çš„è¯ï¼Œå°±è¿”å›0ï¼Œè¡¨ç¤ºé«˜åº¦ä¸º0ã€‚</li><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ï¼šå…ˆæ±‚å®ƒçš„å·¦å­æ ‘çš„æ·±åº¦ï¼Œå†æ±‚å³å­æ ‘çš„æ·±åº¦ï¼Œæœ€åå–å·¦å³æ·±åº¦æœ€å¤§çš„æ•°å€¼å†+1 ï¼ˆåŠ 1æ˜¯å› ä¸ºç®—ä¸Šå½“å‰ä¸­é—´èŠ‚ç‚¹ï¼‰å°±æ˜¯ç›®å‰èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘çš„æ·±åº¦ã€‚</li></ol><p>å…³é”®ï¼š</p><p>æ ¹èŠ‚ç‚¹çš„é«˜åº¦å…¶å®å°±æ˜¯äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‚</p><p>éœ€è¦<code>ååºéå†</code>ä»ä½å‘ä¸Šè¿”å›é«˜åº¦ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/%E4%BA%8C%E5%8F%89%E6%A0%91.jpg" alt="äºŒå‰æ ‘" style="zoom:67%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">leftDepth</span> <span class="operator">=</span> maxDepth(root.left);</span><br><span class="line">        <span class="type">int</span> rightDepth= maxDepth(root.right);</span><br><span class="line">        <span class="keyword">return</span> Math.max(leftDepth,rightDepth)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="äºŒå‰æ ‘çš„æœ€å°æ·±åº¦">äºŒå‰æ ‘çš„æœ€å°æ·±åº¦</h2><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾å‡ºå…¶æœ€å°æ·±åº¦ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://assets.leetcode.com/uploads/2020/10/12/ex_depth.jpg" alt="img" style="zoom:67%;" /><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼š<span class="attr">root</span> = [<span class="number">3</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line">è¾“å‡ºï¼š<span class="number">2</span></span><br></pre></td></tr></table></figure><p>ç›´è§‰ä¸Šå¥½åƒå’Œæ±‚æœ€å¤§æ·±åº¦å·®ä¸å¤šï¼Œå…¶å®è¿˜æ˜¯å·®ä¸å°‘çš„ã€‚</p><p>æœ¬é¢˜ä¾ç„¶æ˜¯å‰åºéå†å’Œååºéå†éƒ½å¯ä»¥ï¼Œå‰åºæ±‚çš„æ˜¯æ·±åº¦ï¼Œååºæ±‚çš„æ˜¯é«˜åº¦ã€‚</p><hr><hr><h2 id="äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ">äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</h2><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p><p>ç™¾åº¦ç™¾ç§‘ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªèŠ‚ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªèŠ‚ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚â€</p><p>èŠ‚ç‚¹5,4 çš„å…¬å…±ç¥–å…ˆä¸º 5  ï¼ŒèŠ‚ç‚¹5ï¼Œ1çš„å…¬å…±ç¥–å…ˆä¸º3</p><p><img src="https://assets.leetcode.com/uploads/2018/12/14/binarytree.png" alt="img"></p><p>é‡åˆ°è¿™ä¸ªé¢˜ç›®é¦–å…ˆæƒ³çš„æ˜¯è¦æ˜¯èƒ½è‡ªåº•å‘ä¸ŠæŸ¥æ‰¾å°±å¥½äº†ï¼Œè¿™æ ·å°±å¯ä»¥æ‰¾åˆ°å…¬å…±ç¥–å…ˆäº†ã€‚</p><p>é‚£ä¹ˆäºŒå‰æ ‘å¦‚ä½•å¯ä»¥è‡ªåº•å‘ä¸ŠæŸ¥æ‰¾å‘¢ï¼Ÿ</p><p>å›æº¯å•Šï¼ŒäºŒå‰æ ‘å›æº¯çš„è¿‡ç¨‹å°±æ˜¯ä»ä½åˆ°ä¸Šã€‚</p><p>ååºéå†ï¼ˆå·¦å³ä¸­ï¼‰å°±æ˜¯å¤©ç„¶çš„å›æº¯è¿‡ç¨‹ï¼Œå¯ä»¥æ ¹æ®å·¦å³å­æ ‘çš„è¿”å›å€¼ï¼Œæ¥å¤„ç†ä¸­èŠ‚ç‚¹çš„é€»è¾‘ã€‚</p><p>æ¥ä¸‹æ¥å°±çœ‹å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªèŠ‚ç‚¹æ˜¯èŠ‚ç‚¹qå’ŒèŠ‚ç‚¹pçš„å…¬å…±ç¥–å…ˆå‘¢ã€‚</p><p>é¦–å…ˆæœ€å®¹æ˜“æƒ³åˆ°çš„ä¸€ä¸ªæƒ…å†µï¼šå¦‚æœæ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå‘ç°å·¦å­æ ‘å‡ºç°ç»“ç‚¹pï¼Œå³å­æ ‘å‡ºç°èŠ‚ç‚¹qï¼Œæˆ–è€… å·¦å­æ ‘å‡ºç°ç»“ç‚¹qï¼Œå³å­æ ‘å‡ºç°èŠ‚ç‚¹pï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹å°±æ˜¯èŠ‚ç‚¹på’Œqçš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚ å³æƒ…å†µä¸€ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230511221814323.png" alt="image-20230511221814323" style="zoom:67%;" /><p>åˆ¤æ–­é€»è¾‘æ˜¯ å¦‚æœé€’å½’éå†é‡åˆ°qï¼Œå°±å°†qè¿”å›ï¼Œé‡åˆ°p å°±å°†pè¿”å›ï¼Œ</p><p>é‚£ä¹ˆå¦‚æœ å·¦å³å­æ ‘çš„è¿”å›å€¼éƒ½ä¸ä¸ºç©ºï¼Œè¯´æ˜æ­¤æ—¶çš„ä¸­èŠ‚ç‚¹ï¼Œä¸€å®šæ˜¯q å’Œp çš„æœ€è¿‘ç¥–å…ˆã€‚</p><p>ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯èŠ‚ç‚¹æœ¬èº«p(q)ï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ªå­å­™èŠ‚ç‚¹qÂ§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">lowestCommonAncestor</span><span class="params">(TreeNode root, TreeNode p, TreeNode q)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span> || root == p || root == q) &#123; <span class="comment">// é€’å½’ç»“æŸæ¡ä»¶</span></span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ååºéå†</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">left</span> <span class="operator">=</span> lowestCommonAncestor(root.left, p, q);</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">right</span> <span class="operator">=</span> lowestCommonAncestor(root.right, p, q);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(left == <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) &#123; <span class="comment">// è‹¥æœªæ‰¾åˆ°èŠ‚ç‚¹ p æˆ– q</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left == <span class="literal">null</span> &amp;&amp; right != <span class="literal">null</span>) &#123; <span class="comment">// è‹¥æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left != <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) &#123; <span class="comment">// è‹¥æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123; <span class="comment">// è‹¥æ‰¾åˆ°ä¸¤ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="å¹³è¡¡äºŒå‰æ ‘">å¹³è¡¡äºŒå‰æ ‘</h2><hr><hr><h2 id="äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„">äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</h2><div class="tag link"><a class="link-card" title="257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„" href="https://leetcode.cn/problems/binary-tree-paths/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</p><p class="url">https://leetcode.cn/problems/binary-tree-paths/</p></div></a></div><p>ç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼ŒæŒ‰ ä»»æ„é¡ºåº ï¼Œè¿”å›æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è·¯å¾„ã€‚</p><p>å¶å­èŠ‚ç‚¹ æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><img src="https://assets.leetcode.com/uploads/2021/03/12/paths-tree.jpg" alt="img" style="zoom:67%;" /><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šroot = [1,2,3,null,5]<br>è¾“å‡ºï¼š[â€œ1-&gt;2-&gt;5â€,â€œ1-&gt;3â€]</p><hr><hr><h2 id="æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼â­ï¸">æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼â­ï¸</h2><div class="tag link"><a class="link-card" title="513. æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼" href="https://leetcode.cn/problems/find-bottom-left-tree-value/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">513. æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼</p><p class="url">https://leetcode.cn/problems/find-bottom-left-tree-value/</p></div></a></div><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„ æ ¹èŠ‚ç‚¹ <code>root</code>ï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘çš„ æœ€åº•å±‚ æœ€å·¦è¾¹ èŠ‚ç‚¹çš„å€¼ã€‚</p><p>å‡è®¾äºŒå‰æ ‘ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><img src="https://assets.leetcode.com/uploads/2020/12/14/tree2.jpg" alt="img" style="zoom:67%;" /><p>è¾“å‡º: 7</p><div class="tabs" id="0e595ee9-d0e0-428a-b10c-1f89283cc4f9"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0e595ee9-d0e0-428a-b10c-1f89283cc4f9-1"><i class="fas fa-cat"></i>å›æº¯å†™æ³•</button></li><li class="tab"><button type="button" data-href="#0e595ee9-d0e0-428a-b10c-1f89283cc4f9-2"><i class="fas fa-horse"></i>ç²¾ç®€å›æº¯</button></li><li class="tab"><button type="button" data-href="#0e595ee9-d0e0-428a-b10c-1f89283cc4f9-3"><i class="fas fa-cookie-bite"></i>å±‚åº</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0e595ee9-d0e0-428a-b10c-1f89283cc4f9-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">maxDepth</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line">    <span class="type">int</span> result;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">findBottomLeftValue</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        traversal(root, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">traversal</span><span class="params">(TreeNode root, <span class="type">int</span> depth)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(root.left== <span class="literal">null</span> &amp;&amp; root .right ==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(depth&gt;maxDepth)&#123;</span><br><span class="line">                maxDepth=depth;</span><br><span class="line">                result=root.val;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(root.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">            depth++;</span><br><span class="line">            traversal(root.left,depth);</span><br><span class="line">            depth--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(root.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">            depth++;</span><br><span class="line">            traversal(root.right,depth);</span><br><span class="line">            depth--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0e595ee9-d0e0-428a-b10c-1f89283cc4f9-2"><p>å›æº¯é€»è¾‘å…¶å®å°±éšè—åœ¨<code>traversal(root.left,depth+1);</code>ä¸­çš„ <code>depth+1</code>ã€‚ æ¯æ¬¡å‡½æ•°è°ƒç”¨å®Œï¼Œdepthä¾ç„¶æ˜¯æ²¡æœ‰åŠ ä¸Š1çš„ï¼Œè¿™å°±æ˜¯å›æº¯äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">maxDepth</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line"><span class="type">int</span> result;</span><br><span class="line"><span class="type">int</span> <span class="title function_">findBottomLeftValue</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    traversal(root, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">traversal</span><span class="params">(TreeNode root, <span class="type">int</span> depth)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root.left== <span class="literal">null</span> &amp;&amp; root .right ==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(depth&gt;maxDepth)&#123;</span><br><span class="line">            maxDepth=depth;</span><br><span class="line">            result=root.val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(root.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">        traversal(root.left,depth+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(root.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">        traversal(root.right,depth+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0e595ee9-d0e0-428a-b10c-1f89283cc4f9-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findBottomLeftValue</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    Deque&lt;TreeNode&gt; deque= <span class="keyword">new</span> <span class="title class_">ArrayDeque</span>&lt;&gt;();</span><br><span class="line">    deque.addFirst(root);</span><br><span class="line">    <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!deque.isEmpty())&#123;</span><br><span class="line">        ans = deque.peekFirst().val;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> deque.size();</span><br><span class="line">        <span class="keyword">while</span>(size-- &gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">poll</span> <span class="operator">=</span> deque.pollFirst();</span><br><span class="line">            <span class="keyword">if</span> (poll.left != <span class="literal">null</span>) deque.addLast(poll.left);</span><br><span class="line">            <span class="keyword">if</span> (poll.right != <span class="literal">null</span>) deque.addLast(poll.right);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="æ ¹æ®åºåˆ—æ„é€ äºŒå‰æ ‘">æ ¹æ®åºåˆ—æ„é€ äºŒå‰æ ‘</h2><div class="tag link"><a class="link-card" title="105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" href="https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</p><p class="url">https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/</p></div></a></div><div class="tag link"><a class="link-card" title="106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" href="https://leetcode.cn/problems/construct-binary-tree-from-inorder-and-postorder-traversal/submissions/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</p><p class="url">https://leetcode.cn/problems/construct-binary-tree-from-inorder-and-postorder-traversal/submissions/</p></div></a></div><p>ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ inorder å’Œ postorder ï¼Œå…¶ä¸­ inorder æ˜¯äºŒå‰æ ‘çš„ä¸­åºéå†ï¼Œ postorder æ˜¯åŒä¸€æ£µæ ‘çš„ååºéå†ï¼Œè¯·ä½ æ„é€ å¹¶è¿”å›è¿™é¢—äºŒå‰æ ‘ ã€‚</p><p>è¾“å…¥ï¼šinorder = [9,3,15,20,7], postorder = [9,15,7,20,3],preorder = [3,9,20,15,7]</p><img src="https://assets.leetcode.com/uploads/2021/02/19/tree.jpg" alt="img" style="zoom:67%;" /><p>å‰åºéå†ï¼š æ ¹  å·¦  å³</p><p>ä¸­åºéå†ï¼š å·¦  æ ¹   å³</p><p>ååºéå†ï¼š å·¦  å³   æ ¹</p><ul><li>ç¬¬ä¸€æ­¥ï¼šå¦‚æœæ•°ç»„å¤§å°ä¸ºé›¶çš„è¯ï¼Œè¯´æ˜æ˜¯ç©ºèŠ‚ç‚¹äº†ã€‚</li><li>ç¬¬äºŒæ­¥ï¼šå¦‚æœä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå–ååºæ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºèŠ‚ç‚¹å…ƒç´ ã€‚</li><li>ç¬¬ä¸‰æ­¥ï¼šæ‰¾åˆ°ååºæ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ åœ¨ä¸­åºæ•°ç»„çš„ä½ç½®ï¼Œä½œä¸ºåˆ‡å‰²ç‚¹</li><li>ç¬¬å››æ­¥ï¼šåˆ‡å‰²ä¸­åºæ•°ç»„ï¼Œåˆ‡æˆä¸­åºå·¦æ•°ç»„å’Œä¸­åºå³æ•°ç»„ ï¼ˆé¡ºåºåˆ«æåäº†ï¼Œä¸€å®šæ˜¯å…ˆåˆ‡ä¸­åºæ•°ç»„ï¼‰</li><li>ç¬¬äº”æ­¥ï¼šåˆ‡å‰²ååºæ•°ç»„ï¼Œåˆ‡æˆååºå·¦æ•°ç»„å’Œååºå³æ•°ç»„</li><li>ç¬¬å…­æ­¥ï¼šé€’å½’å¤„ç†å·¦åŒºé—´å’Œå³åŒºé—´</li></ul><p>ä¸­åºå’Œååº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();;</span><br><span class="line">    <span class="keyword">public</span> TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] inorder, <span class="type">int</span>[] postorder)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; inorder.length; i++) &#123; <span class="comment">// ç”¨mapä¿å­˜ä¸­åºåºåˆ—çš„æ•°å€¼å¯¹åº”ä½ç½®</span></span><br><span class="line">            map.put(inorder[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> findNode(inorder,  <span class="number">0</span>, inorder.length, postorder,<span class="number">0</span>, postorder.length);  <span class="comment">// å‰é—­åå¼€</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    TreeNode <span class="title function_">findNode</span><span class="params">(<span class="type">int</span>[] inorder, <span class="type">int</span> inBegin, <span class="type">int</span> inEnd, <span class="type">int</span>[] postorder, <span class="type">int</span> postBegin, <span class="type">int</span> postEnd)</span> &#123;</span><br><span class="line">        <span class="comment">// å‚æ•°é‡Œçš„èŒƒå›´éƒ½æ˜¯å‰é—­åå¼€</span></span><br><span class="line">        <span class="keyword">if</span> (inBegin &gt;= inEnd || postBegin &gt;= postEnd) &#123;  <span class="comment">// ä¸æ»¡è¶³å·¦é—­å³å¼€ï¼Œè¯´æ˜æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›ç©ºæ ‘</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rootIndex</span> <span class="operator">=</span> map.get(postorder[postEnd - <span class="number">1</span>]);  <span class="comment">// æ‰¾åˆ°ååºéå†çš„æœ€åä¸€ä¸ªå…ƒç´ åœ¨ä¸­åºéå†ä¸­çš„ä½ç½®</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(inorder[rootIndex]);  <span class="comment">// æ„é€ ç»“ç‚¹</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">lenOfLeft</span> <span class="operator">=</span> rootIndex - inBegin;  <span class="comment">// ä¿å­˜ä¸­åºå·¦å­æ ‘ä¸ªæ•°ï¼Œç”¨æ¥ç¡®å®šååºæ•°åˆ—çš„ä¸ªæ•°</span></span><br><span class="line">        root.left = findNode(inorder, inBegin, rootIndex,</span><br><span class="line">                postorder, postBegin, postBegin + lenOfLeft);</span><br><span class="line">        root.right = findNode(inorder, rootIndex + <span class="number">1</span>, inEnd,</span><br><span class="line">                postorder, postBegin + lenOfLeft, postEnd - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å‰åºå’Œä¸­åº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] preorder, <span class="type">int</span>[] inorder)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; inorder.length; i++) &#123; <span class="comment">// ç”¨mapä¿å­˜ä¸­åºåºåˆ—çš„æ•°å€¼å¯¹åº”ä½ç½®</span></span><br><span class="line">        map.put(inorder[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> findNode(inorder,  <span class="number">0</span>, inorder.length, preorder,<span class="number">0</span>, preorder.length);  <span class="comment">// å‰é—­åå¼€</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TreeNode <span class="title function_">findNode</span><span class="params">(<span class="type">int</span>[] inorder, <span class="type">int</span> inBegin, <span class="type">int</span> inEnd, <span class="type">int</span>[] preorder, <span class="type">int</span> preBegin, <span class="type">int</span> preEnd)</span> &#123;</span><br><span class="line">    <span class="comment">// å‚æ•°é‡Œçš„èŒƒå›´éƒ½æ˜¯å‰é—­åå¼€</span></span><br><span class="line">    <span class="keyword">if</span> (inBegin &gt;= inEnd || preBegin &gt;= preEnd) &#123;  <span class="comment">// ä¸æ»¡è¶³å·¦é—­å³å¼€ï¼Œè¯´æ˜æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›ç©ºæ ‘</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">rootIndex</span> <span class="operator">=</span> map.get(preorder[preBegin]);  <span class="comment">// æ‰¾åˆ°å‰åºéå†çš„æœ€åä¸€ä¸ªå…ƒç´ åœ¨ä¸­åºéå†ä¸­çš„ä½ç½®</span></span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(inorder[rootIndex]);  <span class="comment">// æ„é€ ç»“ç‚¹</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">lenOfLeft</span> <span class="operator">=</span> rootIndex - inBegin;  <span class="comment">// ä¿å­˜ä¸­åºå·¦å­æ ‘ä¸ªæ•°ï¼Œç”¨æ¥ç¡®å®šååºæ•°åˆ—çš„ä¸ªæ•°</span></span><br><span class="line">    root.left = findNode(inorder, inBegin, rootIndex,</span><br><span class="line">            preorder, preBegin+<span class="number">1</span>, preBegin +<span class="number">1</span> + lenOfLeft);</span><br><span class="line">    root.right = findNode(inorder, rootIndex + <span class="number">1</span>, inEnd,</span><br><span class="line">            preorder, preBegin +<span class="number">1</span> + lenOfLeft, preEnd);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="æœ€å¤§äºŒå‰æ ‘">æœ€å¤§äºŒå‰æ ‘</h2><div class="tag link"><a class="link-card" title="654. æœ€å¤§äºŒå‰æ ‘" href="https://leetcode.cn/problems/maximum-binary-tree/"><div class="left"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/leetcode.jpg"/></div><div class="right"><p class="text">654. æœ€å¤§äºŒå‰æ ‘</p><p class="url">https://leetcode.cn/problems/maximum-binary-tree/</p></div></a></div><p>ç»™å®šä¸€ä¸ªä¸é‡å¤çš„æ•´æ•°æ•°ç»„ nums ã€‚ æœ€å¤§äºŒå‰æ ‘ å¯ä»¥ç”¨ä¸‹é¢çš„ç®—æ³•ä» nums é€’å½’åœ°æ„å»º:</p><p>åˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå…¶å€¼ä¸º nums ä¸­çš„æœ€å¤§å€¼ã€‚<br>é€’å½’åœ°åœ¨æœ€å¤§å€¼ å·¦è¾¹ çš„ å­æ•°ç»„å‰ç¼€ä¸Š æ„å»ºå·¦å­æ ‘ã€‚<br>é€’å½’åœ°åœ¨æœ€å¤§å€¼ å³è¾¹ çš„ å­æ•°ç»„åç¼€ä¸Š æ„å»ºå³å­æ ‘ã€‚<br>è¿”å› nums æ„å»ºçš„ æœ€å¤§äºŒå‰æ ‘ ã€‚</p><p>è¾“å…¥ï¼šnums = [3,2,1,6,0,5]<br>è¾“å‡ºï¼š[6,3,5,null,2,0,null,null,1]<br>è§£é‡Šï¼šé€’å½’è°ƒç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>[3,2,1,6,0,5] ä¸­çš„æœ€å¤§å€¼æ˜¯ 6 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [3,2,1] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [0,5] ã€‚<ul><li>[3,2,1] ä¸­çš„æœ€å¤§å€¼æ˜¯ 3 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [2,1] ã€‚<ul><li>ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚</li><li>[2,1] ä¸­çš„æœ€å¤§å€¼æ˜¯ 2 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [1] ã€‚<ul><li>ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚</li><li>åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå€¼ä¸º 1 çš„èŠ‚ç‚¹ã€‚</li></ul></li></ul></li><li>[0,5] ä¸­çš„æœ€å¤§å€¼æ˜¯ 5 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [0] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [] ã€‚<ul><li>åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå€¼ä¸º 0 çš„èŠ‚ç‚¹ã€‚</li><li>ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚</li></ul></li></ul></li></ul><img src="https://assets.leetcode.com/uploads/2020/12/24/tree1.jpg" alt="img" style="zoom:67%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">constructMaximumBinaryTree</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> constructMaximumBinaryTree(nums,<span class="number">0</span>,nums.length); <span class="comment">// å‰é—­åå¼€</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">constructMaximumBinaryTree</span><span class="params">(<span class="type">int</span>[] nums,<span class="type">int</span> begin,<span class="type">int</span> end)</span> &#123;</span><br><span class="line">    <span class="comment">// å‚æ•°èŒƒå›´å‰é—­åå¼€</span></span><br><span class="line">    <span class="keyword">if</span>(begin&gt;=end)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¯»æ‰¾æœ€å¤§å€¼</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">maxIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">maxValue</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i= begin;i&lt;end;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&gt;=maxValue)&#123;</span><br><span class="line">            maxValue=nums[i];</span><br><span class="line">            maxIndex=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(nums[maxIndex]);  <span class="comment">// æ„é€ ç»“ç‚¹</span></span><br><span class="line">    <span class="comment">// æ„é€ å·¦å­æ ‘</span></span><br><span class="line">    root.left = constructMaximumBinaryTree(nums,begin,maxIndex);</span><br><span class="line">    <span class="comment">// æ„é€ å³å­æ ‘</span></span><br><span class="line">    root.right = constructMaximumBinaryTree(nums,maxIndex+<span class="number">1</span>,end);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="äºŒå‰æœç´¢æ ‘çš„æ’å…¥">äºŒå‰æœç´¢æ ‘çš„æ’å…¥</h2><p>ä¸€èˆ¬æ˜¯æ’å…¥åˆ°å¶å­èŠ‚ç‚¹ä¸Š</p><hr><h2 id="äºŒå‰æœç´¢æ ‘çš„åˆ é™¤">äºŒå‰æœç´¢æ ‘çš„åˆ é™¤</h2>]]></content>
    
    
    <summary type="html">äºŒå‰æ ‘ä¸“é¢˜</summary>
    
    
    
    <category term="ç®—æ³•" scheme="https://wuwawawa.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="é€’å½’" scheme="https://wuwawawa.github.io/tags/%E9%80%92%E5%BD%92/"/>
    
    <category term="å›æº¯" scheme="https://wuwawawa.github.io/tags/%E5%9B%9E%E6%BA%AF/"/>
    
  </entry>
  
  <entry>
    <title>æ³›å‹</title>
    <link href="https://wuwawawa.github.io/posts/7678a22a.html"/>
    <id>https://wuwawawa.github.io/posts/7678a22a.html</id>
    <published>2023-05-09T08:05:42.000Z</published>
    <updated>2023-05-19T08:08:16.246Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ä»€ä¹ˆæ˜¯æ³›å‹">1. ä»€ä¹ˆæ˜¯æ³›å‹</h2><div class="tabs" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-1"><i class="fas fa-cat"></i>èƒŒæ™¯</button></li><li class="tab"><button type="button" data-href="#ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-2"><i class="fas fa-horse"></i>å®šä¹‰</button></li><li class="tab"><button type="button" data-href="#ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-3"><i class="fas fa-dove"></i>è§„åˆ™</button></li><li class="tab"><button type="button" data-href="#ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-4"><i class="fas fa-dragon"></i>åˆ†ç±»</button></li><li class="tab"><button type="button" data-href="#ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-5"><i class="fas fa-heartbeat"></i>æ³¨æ„</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-1"><p>JAVAæ¨å‡ºæ³›å‹ä»¥å‰ï¼Œç¨‹åºå‘˜å¯ä»¥æ„å»ºä¸€ä¸ªå…ƒç´ ç±»å‹ä¸ºObjectçš„é›†åˆï¼Œè¯¥é›†åˆèƒ½å¤Ÿå­˜å‚¨ä»»æ„çš„æ•°æ®ç±»å‹å¯¹è±¡ï¼Œè€Œåœ¨ä½¿ç”¨è¯¥é›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç¨‹åºå‘˜æ˜ç¡®çŸ¥é“å­˜å‚¨æ¯ä¸ªå…ƒç´ çš„æ•°æ®ç±»å‹ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å¼•å‘ClassCastExceptionå¼‚å¸¸ã€‚</p><p>æ‰‹åŠ¨è¿›è¡Œç±»å‹å¼ºè½¬ï¼Œåœ¨ç¼–è¯‘æ—¶æ— æ³•è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œåªèƒ½åœ¨è¿è¡ŒæœŸæ‰èƒ½æ£€æŸ¥å‡ºæ¥ï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“é€ æˆç±»å‹è½¬æ¢å¼‚å¸¸ã€‚<br>Javaä¸­å¼•å…¥æ³›å‹æœ€ä¸»è¦çš„ç›®çš„æ˜¯å°†<code>ç±»å‹æ£€æŸ¥</code>å·¥ä½œæå‰åˆ°ç¼–è¯‘æ—¶æœŸï¼Œå°†<code>ç±»å‹å¼ºè½¬ï¼ˆcastï¼‰</code>å·¥ä½œäº¤ç»™ç¼–è¯‘å™¨ï¼Œä»è€Œè®©ä½ åœ¨ç¼–è¯‘æ—¶æœŸå°±è·å¾—ç±»å‹è½¬æ¢å¼‚å¸¸ä»¥åŠå»æ‰æºç ä¸­çš„ç±»å‹å¼ºè½¬ä»£ç ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-2"><p>Javaæ³›å‹ï¼ˆgenericsï¼‰æ˜¯JDK5ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œæ³›å‹æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨ç›‘æµ‹æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å…è®¸æˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶æ£€æµ‹åˆ°éæ³•çš„ç±»å‹æ•°æ®ç»“æ„ã€‚æ³›å‹çš„æœ¬è´¨å°±æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-3"><p>æ³›å‹å¯ä»¥éšä¾¿å†™ï¼Œä½†é»˜è®¤çš„è§„åˆ™ä¸ºï¼š</p><p>Eâ€”Elementï¼Œå¸¸ç”¨åœ¨Javaçš„é›†åˆä¸­</p><p>K,V-----key,value ä»£è¡¨Mapä¸­çš„é”®å€¼å¯¹</p><p>N-----Number ä»£è¡¨æ•°å­—</p><p>T----Type ç±»å‹ï¼Œå¦‚Stringï¼ŒIntegerç­‰ç­‰</p><p>ï¼Ÿï¼šè¡¨ç¤ºä¸ç¡®å®šçš„javaç±»å‹</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-4"><p>å‚æ•°ç±»å‹å¯ä»¥ç”¨åœ¨ç±»ã€æ¥å£å’Œæ–¹æ³•ä¸­ï¼Œåˆ†åˆ«è¢«ç§°ä¸º<strong>æ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³•</strong>ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ccbefa2a-4cf4-4189-bf4c-d5b96ea1f5e1-5"><p>åŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½ä½œä¸ºæ³›å‹</p><p>åœ¨é›†åˆä¸­ä¸ä½¿ç”¨æ³›å‹æ—¶ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„å¯¹è±¡ï¼Œé›†åˆä¸­çš„å…ƒç´ æ˜¯Objectã€‚</p><p>æ³›å‹åœ¨ç¼–è¯‘æœŸæœ‰æ•ˆï¼Œå¯ä»¥åŠ¨æ€ä¿®æ”¹å‚æ•°ç±»å‹ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="2-æ³›å‹ç±»å’Œæ³›å‹æ¥å£">2. æ³›å‹ç±»å’Œæ³›å‹æ¥å£</h2><p>æ³›å‹ç±»æ˜¯æŒ‡åœ¨ç±»çš„å®šä¹‰ä¸­ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹å‚æ•°ï¼Œæ¥è¡¨ç¤ºç±»ä¸­çš„æˆå‘˜å˜é‡ã€æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ã€‚ä½¿ç”¨æ³›å‹ç±»å¯ä»¥ä½¿ä»£ç æ›´åŠ é€šç”¨ï¼Œèƒ½å¤Ÿå¤„ç†å¤šç§æ•°æ®ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æé«˜ä»£ç çš„ç±»å‹å®‰å…¨æ€§ã€‚</p><h3 id="2-1-æ³›å‹ç±»è¯­æ³•">2.1 æ³›å‹ç±»è¯­æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class ç±»åç§° &lt;æ³›å‹æ ‡è¯†,æ³›å‹æ ‡è¯†,...&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> æ³›å‹æ ‡è¯† å˜é‡å;</span><br><span class="line"></span><br><span class="line">    ....</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨çš„æ³›å‹æ ‡è¯†ï¼šTã€Eã€Kã€V</p><mark class="hl-label green">ä½¿ç”¨è¯­æ³•</mark> <p><code>ç±»å&lt;å…·ä½“çš„æ•°æ®ç±»å‹&gt; å¯¹è±¡å = new ç±»å&lt;å…·ä½“çš„æ•°æ®ç±»å‹&gt;();</code></p><p>Java1.7ä»¥åï¼Œåé¢çš„&lt;&gt;ä¸­çš„å…·ä½“çš„æ•°æ®ç±»å‹å¯ä»¥çœç•¥ä¸å†™</p><p><code>sç±»å&lt;å…·ä½“çš„æ•°æ®ç±»å‹&gt; å¯¹è±¡å = new ç±»å&lt;&gt;(); </code></p><mark class="hl-label red">æ³¨æ„äº‹é¡¹</mark> <ul><li><p>æ³›å‹ç±»ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šå…·ä½“çš„æ•°æ®ç±»å‹ï¼Œæ­¤æ—¶ï¼Œæ“ä½œç±»å‹æ˜¯Object</p></li><li><p>æ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯ç±»ç±»å‹ï¼Œä¸èƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹</p></li><li><p>æ³›å‹ç±»å‹åœ¨é€»è¾‘ä¸Šå¯ä»¥çœ‹æˆæ˜¯å¤šä¸ªä¸åŒçš„ç±»å‹ï¼Œä½†å®é™…ä¸Šéƒ½æ˜¯ç›¸åŒç±»å‹</p></li></ul><hr><h3 id="2-2-æ³›å‹ç±»æ´¾ç”Ÿå­ç±»">2.2 æ³›å‹ç±»æ´¾ç”Ÿå­ç±»</h3><p>å­˜åœ¨ä¸¤ç§æƒ…å†µ</p><div class="tabs" id="01135cc1-be26-4bda-98b3-d383bc66c525"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#01135cc1-be26-4bda-98b3-d383bc66c525-1"><i class="fas fa-heartbeat"></i>æ³›å‹çˆ¶ç±»</button></li><li class="tab"><button type="button" data-href="#01135cc1-be26-4bda-98b3-d383bc66c525-2"><i class="fas fa-cat"></i>å­ç±»ä¹Ÿæ˜¯æ³›å‹ç±»</button></li><li class="tab"><button type="button" data-href="#01135cc1-be26-4bda-98b3-d383bc66c525-3"><i class="fas fa-horse"></i>å­ç±»ä¸æ˜¯æ³›å‹ç±»</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="01135cc1-be26-4bda-98b3-d383bc66c525-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//çˆ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Parent</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> E value;</span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(E value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="01135cc1-be26-4bda-98b3-d383bc66c525-2"><p>å­ç±»å’Œçˆ¶ç±»çš„æ³›å‹ç±»å‹è¦ä¸€è‡´<br><code>class ChildGeneric&lt;T&gt; extends Generic&lt;T&gt;</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³›å‹ç±»æ´¾ç”Ÿå­ç±»ï¼Œå­ç±»ä¹Ÿæ˜¯æ³›å‹ç±»ï¼Œé‚£ä¹ˆå­ç±»çš„æ³›å‹æ ‡è¯†è¦å’Œçˆ¶ç±»ä¸€è‡´ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChildFirst</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">Parent</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="01135cc1-be26-4bda-98b3-d383bc66c525-3"><p>çˆ¶ç±»è¦æ˜ç¡®æ³›å‹çš„æ•°æ®ç±»å‹<br><code>class ChildGeneric extends Generic&lt;String&gt;</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³›å‹ç±»æ´¾ç”Ÿå­ç±»ï¼Œå¦‚æœå­ç±»ä¸æ˜¯æ³›å‹ç±»ï¼Œé‚£ä¹ˆçˆ¶ç±»è¦æ˜ç¡®æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChildSecond</span> <span class="keyword">extends</span> <span class="title class_">Parent</span>&lt;Integer&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(Integer value)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.setValue(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><p>æ³›å‹æ¥å£æ˜¯æŒ‡åœ¨æ¥å£çš„å®šä¹‰ä¸­ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹å‚æ•°ï¼Œæ¥è¡¨ç¤ºæ¥å£ä¸­çš„æ–¹æ³•å‚æ•°ã€è¿”å›å€¼æˆ–è€…æ¥å£æœ¬èº«çš„ç±»å‹ã€‚</p><h3 id="2-3-æ³›å‹æ¥å£è¯­æ³•">2.3 æ³›å‹æ¥å£è¯­æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface æ¥å£åç§° &lt;æ³›å‹æ ‡è¯†ï¼Œæ³›å‹æ ‡è¯†ï¼Œâ€¦&gt; &#123;</span><br><span class="line">æ³›å‹æ ‡è¯† æ–¹æ³•å(); </span><br><span class="line">.....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-4-æ³›å‹æ¥å£å®ç°ç±»">2.4 æ³›å‹æ¥å£å®ç°ç±»</h3><p>ä¹ŸåŒæ ·åˆ†ä¸ºä¸¤ç§æƒ…å†µ</p><div class="tabs" id="ae6c27a2-48d6-426a-9865-8b0c5ec26f68"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ae6c27a2-48d6-426a-9865-8b0c5ec26f68-1"><i class="fas fa-atom"></i>æ³›å‹æ¥å£</button></li><li class="tab"><button type="button" data-href="#ae6c27a2-48d6-426a-9865-8b0c5ec26f68-2"><i class="far fa-sun"></i>å®ç°ç±»ä¹Ÿæ˜¯æ³›å‹ç±»</button></li><li class="tab"><button type="button" data-href="#ae6c27a2-48d6-426a-9865-8b0c5ec26f68-3"><i class="fas fa-wind"></i>å®ç°ç±»ä¸æ˜¯æ³›å‹ç±»</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ae6c27a2-48d6-426a-9865-8b0c5ec26f68-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³›å‹æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Generator</span>&lt;T&gt; &#123;</span><br><span class="line">    T <span class="title function_">getKey</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ae6c27a2-48d6-426a-9865-8b0c5ec26f68-2"><ul><li>å®ç°ç±»ä¹Ÿæ˜¯æ³›å‹ç±»ï¼Œå®ç°ç±»å’Œæ¥å£çš„æ³›å‹ç±»å‹è¦ä¸€è‡´</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³›å‹æ¥å£çš„å®ç°ç±»ï¼Œæ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œ</span></span><br><span class="line"><span class="comment"> * é‚£ä¹ˆè¦ä¿è¯å®ç°æ¥å£çš„æ³›å‹ç±»æ³›å‹æ ‡è¯†åŒ…å«æ³›å‹æ¥å£çš„æ³›å‹æ ‡è¯†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;E&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pair</span>&lt;T,E&gt; <span class="keyword">implements</span> <span class="title class_">Generator</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T key;</span><br><span class="line">    <span class="keyword">private</span> E value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(T key, E value)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> E <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ae6c27a2-48d6-426a-9865-8b0c5ec26f68-3"><p>å®ç°ç±»ä¸æ˜¯æ³›å‹ç±»ï¼Œæ¥å£è¦æ˜ç¡®æ•°æ®ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ç°æ³›å‹æ¥å£çš„ç±»ï¼Œä¸æ˜¯æ³›å‹ç±»ï¼Œéœ€è¦æ˜ç¡®å®ç°æ³›å‹æ¥å£çš„æ•°æ®ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Apple</span> <span class="keyword">implements</span> <span class="title class_">Generator</span>&lt;String&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello generic&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><hr><h2 id="3-æ³›å‹æ–¹æ³•ä¸å¯å˜å‚æ•°">3. æ³›å‹æ–¹æ³•ä¸å¯å˜å‚æ•°</h2><p>è™½ç„¶æ³›å‹ç±»å¯ä»¥ç”¨æ¥å®ç°å¤§å¤šæ•°æ³›å‹éœ€æ±‚ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æŸä¸ªæ–¹æ³•è¿›è¡Œæ³›å‹åŒ–ï¼Œè€Œä¸éœ€è¦å°†æ•´ä¸ªç±»æ³›å‹åŒ–ã€‚è¿™æ—¶ï¼Œæ³›å‹æ–¹æ³•å°±èƒ½å‘æŒ¥ä½œç”¨äº†ã€‚</p><div class="tabs" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#7a694214-ff8a-44f9-ba05-dcfdcd17cef3-1"><i class="fas fa-cat"></i>ç”¨æ³•</button></li><li class="tab"><button type="button" data-href="#7a694214-ff8a-44f9-ba05-dcfdcd17cef3-2"><i class="fas fa-horse"></i>è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#7a694214-ff8a-44f9-ba05-dcfdcd17cef3-3"><i class="fas fa-dove"></i>è¯´æ˜</button></li><li class="tab"><button type="button" data-href="#7a694214-ff8a-44f9-ba05-dcfdcd17cef3-4"><i class="fas fa-dragon"></i>å¯å˜å‚æ•°</button></li><li class="tab"><button type="button" data-href="#7a694214-ff8a-44f9-ba05-dcfdcd17cef3-5"><i class="fas fa-cookie-bite"></i>ä½¿ç”¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3-1"><p>æ³›å‹æ–¹æ³•æ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ã€‚</p><p>è°ƒç”¨æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦åƒæ³›å‹ç±»é‚£æ ·æ‰‹åŠ¨æŒ‡å®šå…·ä½“ç±»å‹ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šæ ¹æ®ä½ çš„è°ƒç”¨ï¼Œè‡ªåŠ¨æ¨å¯¼å‡ºå…·ä½“ç±»å‹ã€‚</p><p>æ¯”å¦‚ä½ æ“ä½œçš„æ˜¯Stringç±»å‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆç±»å‹å‚æ•°å‚æ•°å°±æ˜¯Stringç±»å‹ã€‚</p><p>ç±»å‹å‚æ•°åªèƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œä¸èƒ½æ˜¯åŸºæœ¬ç±»å‹ã€‚å³ä½¿ä½¿ç”¨åŸºæœ¬ç±»å‹ï¼Œä¹Ÿä¼šè‡ªåŠ¨è£…ç®±æˆåŒ…è£…ç±»å‹ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3-2"><p><code>ä¿®é¥°ç¬¦ &lt;Tï¼ŒE, ...&gt; è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚åˆ—è¡¨) { æ–¹æ³•ä½“... }</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3-3"><p>ä¿®é¥°ç¬¦ä¸è¿”å›å€¼ä¸­é—´çš„&lt; T &gt;éå¸¸é‡è¦ï¼Œå¯ä»¥ç†è§£ä¸ºå£°æ˜æ­¤æ–¹æ³•ä¸ºæ³›å‹æ–¹æ³•</p><p>åªæœ‰å£°æ˜äº†&lt; T &gt;çš„æ–¹æ³•æ‰æ˜¯æ³›å‹æ–¹æ³•ï¼Œæ³›å‹ç±»ä¸­ä½¿ç”¨äº†æ³›å‹æˆå‘˜çš„æ–¹æ³•å¹¶ä¸æ˜¯æ³›å‹æ–¹æ³•</p><p>&lt; T &gt;è¡¨ç¤ºè¯¥æ–¹æ³•å°†ä½¿ç”¨æ³›å‹ç±»å‹Tï¼Œæ­¤æ—¶æ‰å¯ä»¥åœ¨æ–¹æ³•ä¸­è¯•ç”¨è´´æ³›å‹ç±»å‹T</p><p>ä¸æ³›å‹ç±»çš„å®šä¹‰ä¸€æ ·ï¼Œæ­¤å¤„çš„Tå¯ä»¥ä¸ºä»»æ„æ ‡è¯†ï¼Œå¸¸è§çš„Tã€Eã€Kã€Vç­‰å½¢å¼å‚æ•°éƒ½å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åçœå¯å˜å‚æ•°çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">public</span> &lt;E&gt; <span class="keyword">void</span> <span class="title function_">print</span><span class="params">(E... e)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(E el : e)&#123;</span><br><span class="line">    System.out.println(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯å˜å‚æ•°æ³›å‹æ–¹æ³•çš„è°ƒç”¨</span></span><br><span class="line">ProductGetter.print(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7a694214-ff8a-44f9-ba05-dcfdcd17cef3-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;E&gt; E <span class="title function_">getProduct</span><span class="params">(ArrayList&lt;E&gt; list)</span>&#123;</span><br><span class="line">    <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">    <span class="keyword">return</span> list.get(random.nextInt(list.size()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    ArrayList&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(<span class="string">&quot;111&quot;</span>);</span><br><span class="line">    list.add(<span class="string">&quot;222&quot;</span>);</span><br><span class="line">    list.add(<span class="string">&quot;333&quot;</span>);</span><br><span class="line">    <span class="type">ArrayListTest</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayListTest</span>();</span><br><span class="line">    <span class="type">String</span> <span class="variable">product</span> <span class="operator">=</span> test.getProduct(list);</span><br><span class="line">    System.out.println(product);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>æ³¨æ„</p></blockquote><ul><li>æ³›å‹æ–¹æ³•èƒ½ä½¿æ–¹æ³•ç‹¬ç«‹äºç±»è€Œäº§ç”Ÿå˜åŒ–</li><li>å¦‚æœä¸€ä¸ªé™æ€æ–¹æ³•éœ€è¦ä½¿ç”¨æ³›å‹èƒ½åŠ›ï¼ˆå³éœ€è¦æ”¯æŒæ³›å‹ç±»å‹å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»å£°æ˜ä¸ºæ³›å‹æ–¹æ³•ã€‚åœ¨ Java ä¸­ï¼Œæ³›å‹ç±»å‹å‚æ•°åªèƒ½åœ¨æ–¹æ³•æˆ–ç±»ä¸­å£°æ˜ï¼Œå› æ­¤ä¸€ä¸ªé™æ€æ–¹æ³•å¦‚æœéœ€è¦ä½¿ç”¨æ³›å‹ç±»å‹å‚æ•°ï¼Œå°±å¿…é¡»åœ¨æ–¹æ³•ç­¾åä¸­å£°æ˜æ³›å‹ç±»å‹å‚æ•°ã€‚åœ¨é™æ€æ–¹æ³•ä¸­ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ç±»çš„ç±»å‹å‚æ•°ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æŒ‡å®šæ³›å‹å‚æ•°å…·ä½“ç±»å‹æ—¶ï¼Œæ˜¯åœ¨å®ä¾‹åŒ–è¯¥ç±»æ—¶æŒ‡å®šçš„ï¼Œè€Œé™æ€æ–¹æ³•ä¸å¯¹è±¡æ— å…³ã€‚å› æ­¤ï¼Œå¦‚æœè¦åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹ç±»å‹å‚æ•°ï¼Œå¿…é¡»åœ¨æ–¹æ³•ç­¾åä¸­è¿›è¡Œå£°æ˜ã€‚</li></ul><hr><hr><h2 id="4-ç±»å‹é€šé…ç¬¦">4. ç±»å‹é€šé…ç¬¦</h2><p>åœ¨Javaä¸­ï¼Œæ³›å‹ç±»å‹é€šé…ç¬¦ç”¨äºè¡¨ç¤ºä¸ç¡®å®šçš„ç±»å‹ã€‚å®ƒä»¬æ˜¯ä¸€ç§è¡¨ç¤ºèŒƒå›´çš„æ–¹æ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´çµæ´»åœ°å¤„ç†æ³›å‹é›†åˆã€‚æˆ‘ä»¬æ¥è¯¦ç»†äº†è§£ä¸€ä¸‹è¿™ä¸‰ç§é€šé…ç¬¦ï¼š</p><div class="tabs" id="44d38253-73a5-4f2b-a821-d8efe4126534"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#44d38253-73a5-4f2b-a821-d8efe4126534-1">?</button></li><li class="tab"><button type="button" data-href="#44d38253-73a5-4f2b-a821-d8efe4126534-2"><i class="fas fa-cookie-bite"></i>çˆ·å­å­™</button></li><li class="tab"><button type="button" data-href="#44d38253-73a5-4f2b-a821-d8efe4126534-3">? extends T</button></li><li class="tab"><button type="button" data-href="#44d38253-73a5-4f2b-a821-d8efe4126534-4">? super T</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="44d38253-73a5-4f2b-a821-d8efe4126534-1"><p>è¿™æ˜¯ä¸€ä¸ªæ— é™åˆ¶çš„é€šé…ç¬¦ï¼Œè¡¨ç¤ºä»»æ„ç±»å‹ã€‚å½“æˆ‘ä»¬ä¸å…³å¿ƒå‚æ•°åŒ–ç±»å‹çš„å…·ä½“ç±»å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé€šé…ç¬¦ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æƒ³è¦ç¼–å†™ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†<code>List&lt;?&gt;</code>æ—¶ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªæ–¹æ³•å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„åˆ—è¡¨ï¼Œæ— è®ºå®ƒæ˜¯<code>List&lt;String&gt;</code>ã€<code>List&lt;Integer&gt;</code>è¿˜æ˜¯å…¶ä»–ä»»ä½•ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printList</span><span class="params">(List&lt;?&gt; list)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (Object item : list) &#123;</span><br><span class="line">        System.out.println(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå½“ &lt; ? &gt;å­˜åœ¨æ—¶ï¼ŒListå¯¹è±¡ä¸§å¤±äº† add() æ–¹æ³•çš„åŠŸèƒ½ï¼Œç¼–è¯‘å™¨ä¸é€šè¿‡ã€‚</p><p>å› ä¸º&lt;?&gt;åŒ¹é…ä»»æ„ç±»å‹,æ‰€ä»¥æ— æ³•ç¡®å®šaddæ–¹æ³•åº”è¯¥æ·»åŠ ä»€ä¹ˆç±»å‹çš„å…ƒç´ ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="44d38253-73a5-4f2b-a821-d8efe4126534-2"><p>å®šä¹‰äº†ä¸‰ä¸ªç±»ï¼Œå®ç°çˆ·å­å­™çš„å…³ç³»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> <span class="keyword">extends</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dove</span> <span class="keyword">extends</span> <span class="title class_">Bird</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="44d38253-73a5-4f2b-a821-d8efe4126534-3"><p>ä¸Šç•Œçš„é€šé…ç¬¦ï¼Œè¡¨ç¤ºç±»å‹å‚æ•°å¿…é¡»æ˜¯Tï¼ˆæˆ–Tçš„å­ç±»ï¼‰ã€‚è¿™é€šå¸¸åœ¨æˆ‘ä»¬éœ€è¦é™åˆ¶ç±»å‹å‚æ•°çš„èŒƒå›´æ—¶ä½¿ç”¨ã€‚</p><p><mark class="hl-label blue">å®šä¹‰æ–¹æ³•</mark></p><p>ä¼ é€’çš„é›†åˆç±»å‹ï¼Œåªèƒ½æ˜¯Birdæˆ–Birdçš„å­ç±»ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showBirds</span><span class="params">(ArrayList&lt;? extends  Bird&gt; list)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i= <span class="number">0</span>; i&lt;list.size();i++)&#123;</span><br><span class="line">        <span class="type">Bird</span> <span class="variable">bird</span> <span class="operator">=</span> list.get(i);</span><br><span class="line">        System.out.println(bird);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><mark class="hl-label green">ä½¿ç”¨</mark></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Animal&gt; animals = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">ArrayList&lt;Bird&gt; birds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">ArrayList&lt;Dove&gt; doves = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//showBirds(animals); â</span></span><br><span class="line">showBirds(birds);  </span><br><span class="line">showBirds(doves);  </span><br></pre></td></tr></table></figure><p><mark class="hl-label red">æ³¨æ„</mark></p><p>ä¸èƒ½å¤Ÿå¡«å……å…ƒç´ ã€‚é‚£æ˜¯å› ä¸ºï¼ŒextendsTä¸­å­˜æ”¾çš„å…¶å®æ˜¯Tçš„ä¸€ç§å­ç±»ï¼Œå¦‚æœæˆ‘ä»¬å»æ·»åŠ å…ƒç´ ï¼Œå…¶å®ä¸çŸ¥é“åˆ°åº•åº”è¯¥æ·»åŠ Tçš„å“ªä¸ªå­ç±»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåœ¨è¿›è¡Œå¼ºè½¬çš„æ—¶å€™ï¼Œè‚¯å®šä¼šå‡ºé”™ã€‚ä½†æ˜¯å¦‚æœæ˜¯ä»é›†åˆä¸­å°†å…ƒç´ å–å‡ºæ¥ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥çŸ¥é“å–å‡ºæ¥çš„å…ƒç´ è‚¯å®šæ˜¯Tç±»å‹ï¼ˆå…¨æ˜¯å®ƒçš„å­ç±»ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showBirds</span><span class="params">(ArrayList&lt;? extends  Bird&gt; list)</span>&#123;</span><br><span class="line">    <span class="comment">//list.add(new Animal());â</span></span><br><span class="line">    <span class="comment">//list.add(new Bird());â</span></span><br><span class="line">    <span class="comment">//list.add(new Dove());â</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="44d38253-73a5-4f2b-a821-d8efe4126534-4"><p>ä¸‹ç•Œçš„é€šé…ç¬¦ï¼Œè¡¨ç¤ºç±»å‹å‚æ•°å¿…é¡»æ˜¯Tï¼ˆæˆ–Tçš„è¶…ç±»ï¼‰ã€‚è¿™é€šå¸¸åœ¨æˆ‘ä»¬éœ€è¦æ·»åŠ å…ƒç´ åˆ°é›†åˆä¸­æ—¶ä½¿ç”¨ã€‚</p><p><mark class="hl-label blue">å®šä¹‰æ–¹æ³•</mark></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showBirds</span><span class="params">(ArrayList&lt;? <span class="built_in">super</span> Bird&gt; list)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Object o : list) &#123;</span><br><span class="line">        System.out.println(o);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><mark class="hl-label green">ä½¿ç”¨</mark></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Animal&gt; animals <span class="operator">=</span> new ArrayList&lt;&gt;()<span class="comment">;</span></span><br><span class="line">ArrayList&lt;Bird&gt; birds <span class="operator">=</span> new ArrayList&lt;&gt;()<span class="comment">;</span></span><br><span class="line">ArrayList&lt;Dove&gt; doves <span class="operator">=</span> new ArrayList&lt;&gt;()<span class="comment">;</span></span><br><span class="line">showBirds(animals)<span class="comment">; </span></span><br><span class="line">showBirds(birds)<span class="comment">;  </span></span><br><span class="line">//showBirds(doves)<span class="comment">; â</span></span><br></pre></td></tr></table></figure><p><mark class="hl-label red">æ³¨æ„</mark></p><p>å’Œä¸Šé™é€šé…ç¬¦ä¸åŒï¼Œä¸‹é™é€šé…ç¬¦å¯ä»¥å¡«å……å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showBirds</span><span class="params">(ArrayList&lt;? <span class="built_in">super</span> Bird&gt; list)</span>&#123;</span><br><span class="line">    <span class="comment">//list.add(new Animal());// ä¸å¯ä»¥</span></span><br><span class="line">    list.add(<span class="keyword">new</span> <span class="title class_">Bird</span>()); <span class="comment">//å¯ä»¥</span></span><br><span class="line">    list.add(<span class="keyword">new</span> <span class="title class_">Dove</span>()); <span class="comment">//å¯ä»¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>superTä¸­ï¼Œå› ä¸º<code>å­˜</code>çš„éƒ½æ˜¯ç±»å‹Tçš„çˆ¶ç±»ï¼ˆå®¹å™¨ï¼‰ï¼Œæ‰€ä»¥å¦‚æœå»æ·»åŠ Tç±»æˆ–è€…Tçš„å­ç±»ï¼ˆæ“ä½œï¼‰ï¼Œè‚¯å®šæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯å¦‚æœå°†å…ƒç´ å–å‡ºæ¥ï¼Œåˆ™ä¸çŸ¥é“åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ‰€ä»¥superTå¯ä»¥æ·»åŠ å…ƒç´ ï¼Œä½†æ˜¯åªèƒ½ç”¨Objectæ¥æ”¶ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <blockquote><p>JDKæºç TreeSetä¸­ç±»å‹é€šé…ç¬¦çš„åº”ç”¨</p></blockquote><p>åœ¨<code>TreeSet</code>æœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œä¸€ä¸ªä½¿ç”¨åˆ°äº†ä¸Šé™é€šé…ç¬¦ï¼Œä¸€ä¸ªä½¿ç”¨äº†ä¸‹é™ç»Ÿé…ç¬¦</p><p><code>public TreeSet(Comparator&lt;? super E&gt; comparator)</code></p><p><code>public TreeSet(Collection&lt;? extends E&gt; c)</code></p><p>ä»¥ä¸‹é™é€šé…ç¬¦ä¸ºæ¡ˆä¾‹</p><div class="tabs" id="980249a4-bd6e-48f8-bf7a-c8c4181217c7"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#980249a4-bd6e-48f8-bf7a-c8c4181217c7-1"><i class="fas fa-cat"></i>å‡†å¤‡çˆ·å­å­™</button></li><li class="tab"><button type="button" data-href="#980249a4-bd6e-48f8-bf7a-c8c4181217c7-2"><i class="fas fa-horse"></i>å®šä¹‰æ¯”è¾ƒå™¨</button></li><li class="tab"><button type="button" data-href="#980249a4-bd6e-48f8-bf7a-c8c4181217c7-3"><i class="fas fa-dove"></i>ä¼ é€’æ¯”è¾ƒå™¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="980249a4-bd6e-48f8-bf7a-c8c4181217c7-1"><p>åœ¨å…¶ä¸­æ·»åŠ ä¸€äº›æˆå‘˜å˜é‡ï¼Œå¹¶å®ç°toStringæ–¹æ³•</p><div class="tabs" id="727f800b-6c4a-4517-9c6a-07a7da490435"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#727f800b-6c4a-4517-9c6a-07a7da490435-1"><i class="fas fa-cat"></i>Animal</button></li><li class="tab"><button type="button" data-href="#727f800b-6c4a-4517-9c6a-07a7da490435-2"><i class="fas fa-horse"></i>Bird</button></li><li class="tab"><button type="button" data-href="#727f800b-6c4a-4517-9c6a-07a7da490435-3"><i class="fas fa-dove"></i>Dove</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="727f800b-6c4a-4517-9c6a-07a7da490435-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Animal</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Animal&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="727f800b-6c4a-4517-9c6a-07a7da490435-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> <span class="keyword">extends</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Bird</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(name);</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Bird&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="727f800b-6c4a-4517-9c6a-07a7da490435-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dove</span> <span class="keyword">extends</span> <span class="title class_">Bird</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> level;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Dove</span><span class="params">(String name, <span class="type">int</span> age, <span class="type">int</span> level)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(name, age);</span><br><span class="line">        <span class="built_in">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Dove&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;level=&quot;</span> + level +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="980249a4-bd6e-48f8-bf7a-c8c4181217c7-2"><p>å®šä¹‰ä¸‰ä¸ªæ¯”è¾ƒå™¨</p><div class="tabs" id="a5441306-54f5-41b3-bb13-ede7d566bea9"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a5441306-54f5-41b3-bb13-ede7d566bea9-1"><i class="fas fa-award"></i>nameæ¯”è¾ƒ</button></li><li class="tab"><button type="button" data-href="#a5441306-54f5-41b3-bb13-ede7d566bea9-2"><i class="fas fa-baseball-ball"></i>ageæ¯”è¾ƒ</button></li><li class="tab"><button type="button" data-href="#a5441306-54f5-41b3-bb13-ede7d566bea9-3"><i class="fas fa-bone"></i>levelæ¯”è¾ƒ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a5441306-54f5-41b3-bb13-ede7d566bea9-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Comprator1</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Animal&gt;&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Animal o1, Animal o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.name.compareTo(o2.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a5441306-54f5-41b3-bb13-ede7d566bea9-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Comprator2</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Bird&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Bird o1, Bird o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.age- o2.age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a5441306-54f5-41b3-bb13-ede7d566bea9-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Comprator3</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;Dove&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Dove o1, Dove o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> o1.level-o2.level;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="980249a4-bd6e-48f8-bf7a-c8c4181217c7-3"><p>å®šä¹‰ä¸€ä¸ªæ³›å‹ä¸ºBirdçš„<code>TreeSet&lt;Bird&gt; treeSet</code></p><div class="tabs" id="5ac88f59-38e2-4e51-b355-8b0c2c0ec129"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#5ac88f59-38e2-4e51-b355-8b0c2c0ec129-1"><i class="fas fa-cat"></i>ä½¿ç”¨nameæ¯”è¾ƒå™¨</button></li><li class="tab"><button type="button" data-href="#5ac88f59-38e2-4e51-b355-8b0c2c0ec129-2"><i class="fas fa-horse"></i>ä½¿ç”¨ageæ¯”è¾ƒå™¨</button></li><li class="tab"><button type="button" data-href="#5ac88f59-38e2-4e51-b355-8b0c2c0ec129-3"><i class="fas fa-dove"></i>levelæ¯”è¾ƒå™¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="5ac88f59-38e2-4e51-b355-8b0c2c0ec129-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TreeSet&lt;Bird&gt; treeSet =<span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Comprator1</span>());</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;jerry&quot;</span>,<span class="number">20</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;amy&quot;</span>,<span class="number">22</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;frank&quot;</span>,<span class="number">35</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;jim&quot;</span>,<span class="number">15</span>));</span><br><span class="line">treeSet.forEach(System.out::println);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">22, name=&#x27;amy&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">35, name=&#x27;frank&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">20, name=&#x27;jerry&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">15, name=&#x27;jim&#x27;&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5ac88f59-38e2-4e51-b355-8b0c2c0ec129-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TreeSet&lt;Bird&gt; treeSet =<span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Comprator2</span>());</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;jerry&quot;</span>,<span class="number">20</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;amy&quot;</span>,<span class="number">22</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;frank&quot;</span>,<span class="number">35</span>));</span><br><span class="line">treeSet.add(<span class="keyword">new</span> <span class="title class_">Bird</span>(<span class="string">&quot;jim&quot;</span>,<span class="number">15</span>));</span><br><span class="line">treeSet.forEach(System.out::println);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">15, name=&#x27;jim&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">20, name=&#x27;jerry&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">22, name=&#x27;amy&#x27;&#125;</span></span><br><span class="line"><span class="attr">Bird&#123;age</span>=<span class="string">35, name=&#x27;frank&#x27;&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5ac88f59-38e2-4e51-b355-8b0c2c0ec129-3"><p>ä¸èƒ½ä¼ å…¥Comprator3ï¼Œæ ¹æœ¬åŸå› æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸‹é™é€šé…ç¬¦ã€‚</p><p><code>TreeSet&lt;Bird&gt; treeSet =new TreeSet&lt;&gt;(new Comprator3());</code></p><p>æˆ‘ä»¬åœ¨æ„å»ºå­ç±»å¯¹è±¡çš„æ—¶å€™ï¼Œå¿…ç„¶ä¼šå…ˆå»æ„å»ºçˆ¶ç±»å¯¹è±¡ã€‚è¿™ä¸ªæ—¶å€™çˆ¶ç±»æˆå‘˜å°±å·²ç»è¢«åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ çˆ¶ç±»å®ç°æ¯”è¾ƒå™¨ï¼Œé‚£ä¹ˆæ˜¯èƒ½å¤Ÿæˆç«‹çš„ã€‚</p><p>åˆ›å»ºBirdæ—¶ï¼Œå¹¶ä¸èƒ½åˆ›å»ºå­ç±»å¯¹è±¡Doveï¼Œæ‰€ä»¥ä¼ é€’å­ç±»å®ç°æ¯”è¾ƒå™¨ï¼Œæ˜¯ä¼šäº§ç”Ÿç©ºå¼•ç”¨çš„ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="5-ç±»å‹æ“¦é™¤">5. ç±»å‹æ“¦é™¤</h2><p>æ³›å‹æ˜¯Java 1.5ç‰ˆæœ¬æ‰å¼•è¿›çš„æ¦‚å¿µï¼Œåœ¨è¿™ä¹‹å‰æ˜¯æ²¡æœ‰æ³›å‹çš„ï¼Œä½†æ˜¯æ³›å‹ä»£ç èƒ½å¤Ÿå¾ˆå¥½åœ°å’Œä¹‹å‰ç‰ˆæœ¬çš„ä»£ç å…¼å®¹ã€‚é‚£æ˜¯å› ä¸ºï¼Œæ³›å‹ä¿¡æ¯åªå­˜åœ¨äºä»£ç ç¼–è¯‘é˜¶æ®µï¼Œåœ¨è¿›å…¥JVMä¹‹å‰ï¼Œä¸æ³›å‹ç›¸å…³çš„ä¿¡æ¯ä¼šè¢«æ“¦é™¤æ‰ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€“<code>ç±»å‹æ“¦é™¤</code>ã€‚</p><p>å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘å£°æ˜äº†ä¸¤ä¸ªé›†åˆï¼Œä¸€ä¸ªç±»å‹å‚æ•°ä¸º<code>Integer</code>,ä¸€ä¸ªç±»å‹å‚æ•°ä¸º<code>String</code>,é‚£æˆ‘ä»¬ä¼šä¸‹æ„è¯†è®¤ä¸ºè¿™ä¸¤ä¸ªé›†åˆæ˜¯ä¸åŒçš„ç±»å‹ã€‚å¯äº‹å®å´éå¸¸åç›´è§‰ï¼Œåˆ¤æ–­ä¸¤ä¸ªé›†åˆçš„Classæ˜¯å¦ç›¸ç­‰ï¼Œç»“æœç«Ÿç„¶ä¸ºtrueï¼Œä»¿ä½›é›†åˆçš„ç±»å‹å‚æ•°ä¸å­˜åœ¨ä¸€èˆ¬ï¼Œè¿™å°±æ˜¯ç±»å‹æ“¦é™¤çš„ä¸€ç§ä½“ç°ã€‚åœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šè¿›è¡Œç±»å‹æ£€æµ‹ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªé”™è¯¯çš„ç±»å‹ï¼Œé‚£å°±ä¼šç¼–è¯‘å¤±è´¥ï¼Œå¯ä¸€ä½†é€šè¿‡äº†ç¼–è¯‘ï¼Œç¼–è¯‘å™¨å°±ä¼šå°†æ³›å‹ç»™æ“¦é™¤æ‰ã€‚åˆ°äº†è¿è¡Œé˜¶æ®µï¼Œå¯¹äºJVMæ¥è¯´ï¼Œä¾¿æ²¡æœ‰äº†æ³›å‹ç±»å‹çš„å¯¹è±¡ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½å±äºæ™®é€šç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; intList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    ArrayList&lt;String&gt; strList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    System.out.println(intList.getClass().getSimpleName());  <span class="comment">// ArrayList</span></span><br><span class="line">    System.out.println(strList.getClass().getSimpleName());  <span class="comment">// ArrayList</span></span><br><span class="line">    System.out.println(intList.getClass() == strList.getClass()); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ³›å‹ç±»æˆ–ä¸€ä¸ªæ³›å‹æ–¹æ³• ï¼Œç»è¿‡ç±»å‹æ“¦é™¤åï¼Œå…¶ä¸­çš„æ³›å‹å‚æ•°éƒ½ä¼šè¢«æ›¿æ¢æˆå®ƒçš„ç¬¬ä¸€ä¸ªä¸Šç•Œï¼Œæ²¡æœ‰è¾¹ç•Œæ—¶è‡ªç„¶å°±æ˜¯æ›¿æ¢æˆé¡¶å±‚çˆ¶ç±» Objectã€‚</p><p>è¿™ç§æ“¦æ‰æ³›å‹å‚æ•°åçš„ç±»å‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<code>åŸå§‹ç±»å‹</code>ã€‚</p><p>ç±»å‹æ“¦é™¤åçš„ä»£ç å’Œ Java 1.5 ä¹‹å‰è¿˜æ²¡æœ‰æ³›å‹æ—¶çš„ä»£ç æ˜¯ä¸€è‡´çš„ï¼Œæ²¡é”™ï¼Œè¿™å°±æ˜¯ç±»å‹æ“¦é™¤çš„ç›®çš„ï¼šå‘ä½ç‰ˆæœ¬å…¼å®¹ï¼Œä¸ºäº†ä¿è¯å·²æœ‰çš„ä»£ç å’Œç±»æ–‡ä»¶ä¾ç„¶åˆæ³•ï¼Œä¸”èƒ½ç»§ç»­ä¿æŒåŸæœ‰çš„å«ä¹‰ï¼ŒJava å°±é€‰æ‹©äº†ç±»å‹æ“¦é™¤è¿™ä¸€ç§ç®€å•ç²—æš´çš„æ–¹å¼ã€‚</p><p>å¦‚æ­¤å®ç°æ³›å‹æ˜¯ç®€å•äº†ï¼Œå¯ç”¨çš„äººå°±ä¸çˆ½äº†ã€‚ç±»å‹æ“¦é™¤ç»™æˆ‘ä»¬ä½¿ç”¨è€…å¸¦æ¥äº†è®¸å¤šå±€é™å’Œéº»çƒ¦ä¹‹å¤„ï¼Œå…¶ä¸­å‡ ä¸ªæœ€ç›´è§‚çš„å¼Šç«¯å°±æ˜¯ï¼š</p><ul><li>æ³›å‹å‚æ•°ä¸æ”¯æŒåŸºæœ¬ç±»å‹ï¼Œåªæ”¯æŒå¼•ç”¨ç±»å‹ã€‚å› ä¸ºæ³›å‹æœ€ç»ˆä¼šè¢«æ“¦é™¤æˆå…·ä½“ç±»å‹ï¼Œè€ŒObjectåˆä¸èƒ½å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼</li><li>è¿è¡Œæ—¶ä½ åªèƒ½å¯¹<code>åŸå§‹ç±»å‹</code>è¿›è¡Œç±»å‹æ£€æµ‹ï¼Œæ— æ³•åˆ¤æ–­å¸¦æ³›å‹çš„ç±»å‹ï¼Œå…¶åŸå› å°±æ˜¯æœ€å¼€å§‹ä¸¾çš„é‚£ä¸ªä¾‹å­ï¼Œå‹æ ¹å°±æ²¡æœ‰ä»€ä¹ˆ<code>ArrayList&lt;String&gt;</code>ç±»,ä¹Ÿå°±ä¸å­˜åœ¨æœ‰ä»€ä¹ˆ <code>ArrayList&lt;String&gt;.class</code>è¿™ç§ä¸œè¥¿,å°±åªæœ‰ä¸€ä¸ªåŸå§‹ç±»å‹ArrayList</li><li>ä¸èƒ½å®ä¾‹åŒ–ç±»å‹å‚æ•°<code>T t =new T()</code>ã€‚å› ä¸ºåœ¨è¿è¡Œæ—¶æ— æ³•ç¡®å®šå…·ä½“ç±»å‹ï¼Œä¹Ÿæ— æ³•çŸ¥é“Tæ˜¯ä¸æ˜¯å­˜åœ¨æ— å‚æ„é€ å™¨</li><li>ä¸èƒ½å®ä¾‹åŒ–æ³›å‹æ•°ç»„ï¼Œå› ä¸ºæ•°ç»„æœ¬èº«ä¹Ÿæ˜¯æœ‰ç±»å‹çš„</li></ul><mark class="hl-label blue">åˆ†ç±»</mark> <div class="tabs" id="50716709-218f-40ad-af05-34274cb5c368"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#50716709-218f-40ad-af05-34274cb5c368-1"><i class="fas fa-cat"></i>æ— é™åˆ¶ç±»å‹æ“¦é™¤</button></li><li class="tab"><button type="button" data-href="#50716709-218f-40ad-af05-34274cb5c368-2"><i class="fas fa-horse"></i>æœ‰é™åˆ¶ç±»å‹æ“¦é™¤</button></li><li class="tab"><button type="button" data-href="#50716709-218f-40ad-af05-34274cb5c368-3"><i class="fas fa-dove"></i>æ“¦é™¤æ–¹æ³•ä¸­ç±»å‹å®šä¹‰çš„å‚æ•°</button></li><li class="tab"><button type="button" data-href="#50716709-218f-40ad-af05-34274cb5c368-4"><i class="fas fa-dragon"></i>æ¡¥æ¥æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="50716709-218f-40ad-af05-34274cb5c368-1"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518124935934.png" alt="image-20230518124935934" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="50716709-218f-40ad-af05-34274cb5c368-2"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518125256566.png" alt="image-20230518125256566" style="zoom:67%;" /><p>T extends Number è¡¨ç¤ºå£°æ˜ä¸€ä¸ªç±»å‹å˜é‡ Tï¼Œå®ƒæ˜¯ Number çš„ä¸€ä¸ªå…·ä½“å­ç±»ã€‚ä¸èƒ½å†™ T super Numberï¼Œå› ä¸ºè¿™æ ·æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ã€‚åŸå› æ˜¯æ‰€æœ‰æ³›å‹åœ¨ç¼–è¯‘æ—¶éƒ½ä¼šè¢«æ“¦é™¤ï¼ŒT æ‰€ä»£è¡¨çš„æ˜¯ä¸€ä¸ª Number çš„è¶…ç±»ï¼Œä½†æ˜¯å…·ä½“æ˜¯å“ªä¸ªç±»å´æ˜¯åœ¨è¿è¡Œæ—¶è¢«å†³å®šçš„ï¼Œç¼–è¯‘å™¨ä¸ºäº†ç±»å‹å®‰å…¨ï¼Œåªèƒ½åšæœ€å¤§é™åº¦çš„åŒ…å®¹ï¼Œå› æ­¤æ‰€æœ‰çš„ T ç±»å‹éƒ½ä¼šåœ¨ç¼–è¯‘å™¨å˜ä¸º Objectã€‚æ‰€ä»¥ï¼Œå†™ T super Number ç­‰åŒäºå†™ Objectï¼Œå› æ­¤ä¸æ”¯æŒ T super ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="50716709-218f-40ad-af05-34274cb5c368-3"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518125234914.png" alt="image-20230518125234914" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="50716709-218f-40ad-af05-34274cb5c368-4"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518125220904.png" alt="image-20230518125220904" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><mark class="hl-label green">éªŒè¯</mark> <div class="tabs" id="8c7242df-5baa-4789-af6f-502f23d3fe57"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#8c7242df-5baa-4789-af6f-502f23d3fe57-1"><i class="fas fa-cat"></i>æ³›å‹ç±»</button></li><li class="tab"><button type="button" data-href="#8c7242df-5baa-4789-af6f-502f23d3fe57-2"><i class="fas fa-horse"></i>åå°„éªŒè¯</button></li><li class="tab"><button type="button" data-href="#8c7242df-5baa-4789-af6f-502f23d3fe57-3"><i class="fas fa-cookie-bite"></i>å­—èŠ‚ç éªŒè¯</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="8c7242df-5baa-4789-af6f-502f23d3fe57-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Erasure</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> T key;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getKey</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setKey</span><span class="params">(T key)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c7242df-5baa-4789-af6f-502f23d3fe57-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Erasure&lt;Integer&gt; erasure =<span class="keyword">new</span> <span class="title class_">Erasure</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// åˆ©ç”¨åå°„ï¼Œè·å–Erasureç±»çš„å­—èŠ‚ç çš„Classç±»å¯¹è±¡</span></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Erasure</span>&gt; clz = erasure.getClass();</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡</span></span><br><span class="line">    Field[] declaredFields = clz.getDeclaredFields();</span><br><span class="line">    <span class="keyword">for</span> (Field declaredField : declaredFields) &#123;</span><br><span class="line">        <span class="comment">// æ‰“å°æˆå‘˜å˜é‡çš„åç§°å’Œç±»å‹</span></span><br><span class="line">        System.out.println( declaredField.getName()+<span class="string">&quot;:&quot;</span>+declaredField.getType().getSimpleName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><p>key:Object<br>name:String</p><p>å°†<code>Erasure&lt;T&gt;</code>æ›´æ”¹ä¸º<code>Erasure&lt;T extends Number&gt;</code>åï¼Œå†æ¬¡è¿è¡Œï¼Œè¾“å‡º</p><p>key:Integer<br>name:String</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c7242df-5baa-4789-af6f-502f23d3fe57-3"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518151159812.png" alt="image-20230518151159812" style="zoom:50%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518151204374.png" alt="image-20230518151204374" style="zoom:50%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>æ³¨æ„</p></blockquote><p>æ³›å‹ä¸­çš„ç±»å‹åœ¨ç¼–è¯‘æ—¶è¢«æ“¦é™¤ï¼Œè¿è¡Œæ—¶ä¼šè¢«æ›¿æ¢ä¸ºåŸç”Ÿç±»å‹ï¼Œæ‰€ä»¥<code>List&lt; Integer &gt;</code>ã€<code>List&lt; String &gt;</code>åœ¨è¿è¡ŒæœŸå°±æ˜¯åŒä¸€ä¸ªç±»å‹ï¼Œç¼–è¯‘å™¨å°±ç†æ‰€å½“ç„¶åœ°é˜»æ­¢ç¼–è¯‘äº†ã€‚</p><p>æ‰€ä»¥ä¸å…è®¸é‡è½½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">(List&lt;Integer&gt; list)</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><hr><h2 id="6-å˜å‹">6. å˜å‹</h2><h3 id="6-1-ä»€ä¹ˆæ˜¯å˜å‹">6.1 ä»€ä¹ˆæ˜¯å˜å‹</h3><p>å˜å‹ä¸»è¦æœ‰ä¸‰ä¸ªè§„åˆ™ï¼šåå˜ã€é€†å˜å’Œä¸å˜ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518204014970.png" alt="image-20230518204014970" style="zoom: 50%;" /><p>è¿™äº›è§„åˆ™æè¿°äº†<code>ç±»å‹æ„é€ å™¨</code>å¦‚ä½•å½±å“çˆ¶å­ç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚</p><p>ä¸¾ä¸ªğŸŒ°ï¼š</p><div class="tabs" id="738969c1-172d-4d1d-87ec-e7b7474469d5"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#738969c1-172d-4d1d-87ec-e7b7474469d5-1"><i class="fas fa-cat"></i>1</button></li><li class="tab"><button type="button" data-href="#738969c1-172d-4d1d-87ec-e7b7474469d5-2"><i class="fas fa-horse"></i>2</button></li><li class="tab"><button type="button" data-href="#738969c1-172d-4d1d-87ec-e7b7474469d5-3"><i class="fas fa-dove"></i>3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="738969c1-172d-4d1d-87ec-e7b7474469d5-1"><p><code>Dog</code>ç±»ç»§æ‰¿äº†<code>Animal</code>ç±»ï¼Œé‚£<code>Dog</code>å°±æ˜¯<code>Animal</code>çš„å­ç±»ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<code>â‰¤</code>æ¥è¡¨ç¤ºä¸¤ä¸ªç±»å‹çš„åŸºç¡€å…³ç³»ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518205129886.png" alt="image-20230518205129886" style="zoom: 40%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="738969c1-172d-4d1d-87ec-e7b7474469d5-2"><p>ç”¨fæ¥è¡¨ç¤º<code>ç±»å‹æ„é€ å™¨</code>ï¼Œä¸€ä¸ªå·²çŸ¥çš„ç±»å‹è¢«ç±»å‹æ„é€ å™¨få¤„ç†åï¼Œå°±æ˜¯ä¸€ä¸ªå´­æ–°çš„ç±»å‹ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518205638268.png" alt="image-20230518205638268" style="zoom:40%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="738969c1-172d-4d1d-87ec-e7b7474469d5-3"><p>åå˜ï¼Œå°±æ˜¯æŒ‡f(Dog)æ˜¯f(Animal) çš„å­ç±»</p><p>é€†å˜ï¼Œå°±æ˜¯æŒ‡f(Animal)æ˜¯f(Dog) çš„å­ç±»</p><p>ä¸å˜ï¼Œå°±æ˜¯æŒ‡f(Dog)å’Œf(Animal)ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œæ—¢ä¸æ˜¯åå˜ä¹Ÿä¸æ˜¯é€†å˜ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518205835727.png" alt="image-20230518205835727" style="zoom:40%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>è¿™ä¸ª<code>ç±»å‹æ„é€ å™¨</code>fï¼Œå®ƒå¯ä»¥æ˜¯æ³›å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ã€‚</p><p>é‚£æ³›å‹æ¼”ç¤º</p><p>å¦‚æœ<code>List&lt;Animal&gt;</code>èƒ½æ¥æ”¶<code>List&lt;Dog&gt;</code>,é‚£å°±æ˜¯åå˜ã€‚</p><p>å¦‚æœ<code>List&lt;Dog&gt;</code>èƒ½æ¥æ”¶<code>List&lt;Animal&gt;</code>,é‚£å°±æ˜¯é€†å˜ã€‚</p><p>å¦‚æœä¸¤è€…éƒ½ä¸è¡Œï¼Œé‚£å°±æ˜¯ä¸å˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Animal&gt; animals = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Dog&gt;(); <span class="comment">//åå˜</span></span><br><span class="line">List&lt;Dog&gt; dogs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Animal&gt;()    <span class="comment">//é€†å˜</span></span><br></pre></td></tr></table></figure><p>å¾ˆå¤šäººä¼šè®¤ä¸º<code>List&lt;Animal&gt; animals = new ArrayList&lt;Dog&gt;();</code> ï¼Œ<code>List&lt;Dog&gt;</code>èµ‹å€¼ç»™<code>List&lt;Animal&gt;</code>æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç„¶è€Œäº‹å®å´æ°æ°ç›¸åï¼Œè¿™è¡Œä»£ç ä¼šç¼–è¯‘å¤±è´¥ã€‚å› ä¸ºJAVAæ³›å‹æ˜¯é»˜è®¤æ˜¯ç¦æ­¢åå˜çš„ã€‚</p><p>å…¶å®å¾ˆå¥½ç†è§£ï¼š</p><p>å¦‚æœæ”¯æŒåå˜ï¼Œé‚£æˆ‘åé¢å†æ”¾å…¥ä¸€ä¸ªå…¶å®ƒç±»å‹çš„å¯¹è±¡ï¼Œæ¯”å¦‚Catï¼Œé‚£<code>List&lt;Dog&gt;</code>ä¸­çš„å…ƒç´ ä¸å°±é”™äº†,æ‰€ä»¥ä¸ºäº†ç±»å‹å®‰å…¨è€ƒè™‘ï¼Œ<span class='p red'>æ³›å‹é»˜è®¤æ˜¯ä¸å˜çš„</span>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Animal&gt; animals = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Dog&gt;(); <span class="comment">// å‡å¦‚æ”¯æŒåå˜</span></span><br><span class="line">animals.add(<span class="keyword">new</span> <span class="title class_">Dog</span>());</span><br><span class="line">animals.add(<span class="keyword">new</span> <span class="title class_">Cat</span>()); <span class="comment">// ç±»å‹é”™è¯¯</span></span><br></pre></td></tr></table></figure><p>é‚£ Java ä¸ºäº†å®‰å…¨ï¼Œä¸ºå•¥æ•°ç»„å´æ”¯æŒåå˜å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dog[] dogs = <span class="keyword">new</span> <span class="title class_">Dog</span>[<span class="number">5</span>];</span><br><span class="line">Animal[] animals = dogs;</span><br><span class="line"><span class="comment">// dogç±»&lt;=animalç±» å¯¹åº”çš„ dog[] &lt;= animal[] æ•°ç»„æ˜¯åå˜ç±»å‹</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºåœ¨ Java 1.0 ç‰ˆæœ¬æ—¶è¿˜æ²¡æœ‰æ³›å‹,è€Œ Java è®¾è®¡è€…åˆå¸Œæœ›èƒ½æ•°ç»„è¿›è¡Œé€šç”¨å¤„ç†ï¼Œå¦‚æœæ•°ç»„ä¸æ”¯æŒåå˜çš„è¯ï¼Œé‚£å¾ˆå¤šæ–¹æ³•å°±å¾—ä¸ºæ¯ä¸€ç§ç±»å‹ç¼–å†™é€»è¾‘äº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518211458591.png" alt="image-20230518211458591" style="zoom:33%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518211510435.png" alt="image-20230518211510435" style="zoom:33%;" /><p>ä½†æ˜¯æ”¯æŒåå˜å°±å¸¦æ¥äº†å®‰å…¨éšæ‚£ï¼Œå¦‚æœå°†ä¸€ä¸ªæ•°ç»„åå˜åï¼Œé‚£åœ¨èµ‹å€¼å…ƒç´ æ—¶å°±å¯èƒ½ä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Animal[] animals = <span class="keyword">new</span> <span class="title class_">Dog</span>[<span class="number">5</span>];</span><br><span class="line">animals[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">animals[<span class="number">1</span>] = <span class="keyword">new</span> <span class="title class_">Cat</span>(); <span class="comment">//ArrayStoreException</span></span><br></pre></td></tr></table></figure><blockquote><p>é¢è¯•é¢˜</p></blockquote><p>è¿™ä¸€æ®µä»£ç ï¼Œå“ªé‡Œé”™äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] a = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">2</span>];</span><br><span class="line">Object[] b = a;</span><br><span class="line">a[<span class="number">0</span>] = <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">b[<span class="number">1</span>] = Integer.valueOf(<span class="number">42</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬å››è¡Œä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå› ä¸ºå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªStringæ•°ç»„ï¼Œæ— æ³•å­˜å‚¨ä¸åŒç±»å‹çš„æ•°æ®ã€‚</p><p>å¦‚æœç¦æ­¢æ•°ç»„åå˜ï¼Œåœ¨ç¬¬äºŒè¡Œå°±æŠ¥ç¼–è¯‘é”™è¯¯äº†ã€‚</p><hr><h3 id="6-2-æ³›å‹ä¹‹åå˜-ä¸Šç•Œ">6.2 æ³›å‹ä¹‹åå˜-ä¸Šç•Œ</h3><blockquote><p>ä¸ºä»€ä¹ˆè¦è®©æ³›å‹æ”¯æŒåå˜ï¼Œæ³›å‹æ”¯æŒåå˜åæœ‰ä»€ä¹ˆå¥½å¤„</p></blockquote><p>æœ€ç›´è§‚çš„å¥½å¤„å½“ç„¶å°±æ˜¯å¤šæ€ï¼Œæ‹¿é›†åˆè¿™ä¸ªæœ€å¸¸ç”¨çš„æ³›å‹ç±»æ¥è¯´ï¼Œæˆ‘æƒ³æ¥æ”¶å„ç§å­ç±»çš„é›†åˆè¿›è¡Œç»Ÿä¸€çš„å¤„ç†ï¼Œè¿™ç§éœ€æ±‚å†å¸¸è§ä¸è¿‡äº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518225214861.png" alt="image-20230518225214861" style="zoom:33%;" /><p>å¦‚æœæ³›å‹åªèƒ½åƒç°åœ¨è¿™æ ·ç¦æ­¢åå˜ï¼Œé‚£æˆ‘ä»¬å°±å¾—ä¸ºæ‰€æœ‰ç±»å‹çš„é›†åˆå•ç‹¬ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç°å®çš„ï¼Œæ‰€ä»¥ï¼Œå¿…é¡»å¾—è®©æ³›å‹æ”¯æŒåå˜ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518225325165.png" alt="image-20230518225325165" style="zoom: 33%;" /><p>åœ¨Javaä¸­ï¼Œåªéœ€åœ¨ç±»å‹å‚æ•°å‰åŠ ä¸Šï¼Ÿextends å…³é”®å­—ï¼Œå³å¯è®©æ³›å‹æ”¯æŒåå˜ï¼Œè¿™æ ·ä¸€æ¥å°±èƒ½æ¥æ”¶å„ç§å­ç±»çš„é›†åˆäº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518225649735.png" alt="image-20230518225649735" style="zoom:33%;" /><p>è¿™ä¸ªï¼Ÿæˆ‘ä»¬ç§°ä¹‹ä¸ºé€šé…ç¬¦ï¼Œç”¨æ¥è¡¨ç¤ºä¸ç¡®å®šçš„ç±»å‹ï¼Œextendså…³é”®å­—å’Œé€šé…ç¬¦ç»“åˆèµ·æ¥ï¼Œå°±å£°æ˜äº†ç±»å‹çš„ä¸Šé™ï¼ˆä¸Šç•Œï¼‰ï¼Œè¡¨ç¤ºæ³›å‹å¯æ¥æ”¶çš„ç±»å‹åªèƒ½æ˜¯æŒ‡å®šçš„ç±»å‹ï¼Œæˆ–è€…æ˜¯è¯¥ç±»å‹çš„å­ç±»ã€‚</p><p>åœ¨ä¸Šé¢æåˆ°è¿‡åå˜ä¼šæœ‰ç±»å‹å®‰å…¨éšæ‚£ï¼Œå°±åƒæ•°ç»„åœ¨åå˜åï¼Œæ·»åŠ å…¶å®ƒç±»å‹å°±ä¼šå¼•å‘è¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ³›å‹ä¸ºäº†æœç»è¿™ç§éšæ‚£é€‰æ‹©äº†ä¸€åˆ€åˆ‡çš„æ–¹å¼ã€‚å³ï¼Œåªè¦å£°æ˜äº†ä¸Šç•Œï¼Œé™¤äº† null ä¹‹å¤–ï¼Œæ— è®ºä½ æ˜¯å®‰å…¨çš„ç±»å‹è¿˜æ˜¯ä¸å®‰å…¨ç±»å‹ï¼Œä¸€å¾‹ä¸å‡†ä¼ å…¥ç»™æ³›å‹ï¼Œå¦åˆ™å°±ä¼šç¼–è¯‘å¤±è´¥ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯åªå‡†ä½ è¯»å–ï¼Œä¸å‡†ä½ å†™å…¥ã€‚åªè¯»ä¸å†™ï¼Œå½“ç„¶å°±å®‰å…¨äº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518225932843.png" alt="image-20230518225932843" style="zoom:33%;" /><blockquote><p>Javaé›†åˆæ¥å£ä¸­çš„addæ–¹æ³•ï¼Œå‚æ•°æ˜¯é›†åˆçš„æ³›å‹å‚æ•°E,è€Œcontainså’Œremoveæ–¹æ³•çš„å‚æ•°ç¡®å®Objectï¼Œä¸ºå•¥è¿™ä¸¤ä¸ªæ–¹æ³•ä¸å£°æ˜ä¸ºEå‘¢</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Collection</span>&lt;E&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object o)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·è®¾è®¡çš„åŸå› å°±æ˜¯åˆšæ‰è¯´çš„å®‰å…¨é™åˆ¶ï¼Œä¸€ä½†å‚æ•°æ˜¯Eï¼Œé‚£å£°æ˜äº†ä¸Šç•Œä¹‹åï¼Œåˆ«äººè°ƒç”¨å‚æ•°ä¸ºEçš„æ–¹æ³•å°±ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ï¼Œåƒcontainså’Œremoveè¿™ç§ä¸ä¼šç ´åç±»å‹å®‰å…¨çš„æ–¹æ³•ï¼Œè‡ªç„¶å°±ä¸èƒ½å£°æ˜ä¸ºEï¼Œå¦åˆ™é›†åˆåå˜åï¼Œè¿™äº›æ–¹æ³•å°±åºŸäº†ï¼Œé›†åˆä¹Ÿè·Ÿç€åºŸäº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;? <span class="keyword">extends</span> <span class="title class_">Animal</span>&gt; animals = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Dog&gt;();</span><br><span class="line"><span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line"></span><br><span class="line">animals.add(dog); <span class="comment">//ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">animals.contains(dog); <span class="comment">//ç¼–è¯‘æ­£ç¡®ï¼Œå¦‚æœå‚æ•°å£°æ˜ä¸ºEï¼Œåˆ™è¯¥è¡Œå°±ä¼šç¼–è¯‘é”™è¯¯</span></span><br><span class="line">animals.contains(dog); <span class="comment">//ç¼–è¯‘æ­£ç¡®ï¼Œå¦‚æœå‚æ•°å£°æ˜ä¸ºEï¼Œåˆ™è¯¥è¡Œå°±ä¼šç¼–è¯‘é”™è¯¯</span></span><br></pre></td></tr></table></figure><blockquote><p>å¥½å¤„</p></blockquote><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å®šä¹‰æ³›å‹ç±»æˆ–æ³›å‹æ–¹æ³•æ—¶ï¼Œé€šè¿‡ extends å…³é”®å­—æ¥é™å®šç±»å‹å‚æ•°ï¼Œé™å®šä¹‹åï¼Œåˆ«äººè¦ä½¿ç”¨ä½ çš„æ³›å‹ç±»æ—¶å°±åªèƒ½å£°æ˜æŒ‡å®šçš„ç±»å‹ï¼Œå¦‚æœæ˜¯å…¶å®ƒç±»å‹çš„è¯åˆ™ä¼šå‘ç”Ÿç¼–è¯‘é”™è¯¯ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519093741428.png" alt="image-20230519093741428" style="zoom: 33%;" /><p>é™¤äº†é™å®šç±»å‹è¿™ä¸€å¥½å¤„å¤–ï¼Œè¿˜ä¸€ä¸ªå¥½å¤„å°±æ˜¯æˆ‘ä»¬èƒ½å¤Ÿåœ¨æ³›å‹ç±»ä¸­ï¼Œè®¿é—®ä¸Šç•Œç±»å‹çš„æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºä¸å£°æ˜ä¸Šç•Œçš„è¯ï¼Œæ‰€æœ‰ç±»å‹å‚æ•°éƒ½å¾ˆè¢«æ“¦é™¤æˆObjectï¼Œè‡ªç„¶å°±åªèƒ½è®¿é—®Objectæ–¹æ³•ã€‚å£°æ˜äº†ä¸Šç•Œåï¼Œæ“¦é™¤å°±åªä¼šæ“¦é™¤åˆ°ç¬¬ä¸€ä¸ªä¸Šç•Œï¼Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå°±èƒ½å¤Ÿå®‰å…¨è®¿é—®ä¸Šç•Œç±»å‹çš„æ–¹æ³•ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519093900825.png" alt="image-20230519093900825" style="zoom:40%;" /><hr><h3 id="6-3-æ³›å‹ä¹‹é€†å˜-ä¸‹ç•Œ">6.3 æ³›å‹ä¹‹é€†å˜-ä¸‹ç•Œ</h3><p>æˆ‘ä»¬å·²ç»çŸ¥é“äº†æ³›å‹åå˜ååªå‡†è¯»ä¸å‡†å†™ï¼Œæˆ‘ä»¬ä¸ç¦ä¼šäº§ç”Ÿç–‘é—®ï¼šæ¯”å¦‚ä¸€ä¸ªé›†åˆéƒ½ä¸èƒ½æ·»åŠ å…ƒç´ äº†ï¼Œé‚£è¿™ä¸ªé›†åˆè¿˜æœ‰ä»€ä¹ˆç”¨ï¼Ÿè¿˜æœ‰æ²¡æœ‰åŠæ³•æ·»åŠ å…ƒç´ å‘¢ï¼Ÿè¿™äº›é—®é¢˜ç”¨ä¸€ä¸ªåº”ç”¨åœºæ™¯å°±å¯ä»¥å¾—åˆ°å›ç­”ã€‚</p><p>è¿˜æ˜¯æ‹¿ç»å…¸çš„çŒ«å«ç‹—å«åŠ¨ç‰©å«æ¥ä¸¾ä¾‹:</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519094950884.png" alt="image-20230519094950884" style="zoom:40%;" /><p>Dogå’ŒCatç±»éƒ½ç»§æ‰¿äº†Animalç±»ï¼Œå¹¶ä¸”æœ‰ä¸€äº›ç‹—ç‹—ç»§æ‰¿äº†Dogï¼ŒDogç±»ä¸­æœ‰ä¸€ä¸ªisHappyæ–¹æ³•ï¼Œæ¥è¡¨ç¤ºç‹—ç‹—æ˜¯å¦å¼€å¿ƒã€‚</p><blockquote><p>éœ€æ±‚æ¥äº†ï¼šå‡è®¾æˆ‘éœ€è¦ä¸€ä¸ªå·¥å…·æ–¹æ³•ï¼Œèƒ½å¤Ÿå°†ä¸€ä¸ª Dog é›†åˆä¸­å¼€å¿ƒçš„ç‹—ç‹—ï¼Œå¤åˆ¶åˆ°å¦ä¸€ä¸ªé›†åˆä¸­,é‚£è¿™ä¸ªæ–¹æ³•è¯¥æ€ä¹ˆå®šä¹‰å’Œå®ç°å‘¢?</p></blockquote><p>æˆ‘åœ¨æ–¹æ³•ä¸Šå®šä¹‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª dest ç”¨æ¥è¡¨ç¤ºç›®æ ‡é›†åˆï¼Œä¸€ä¸ª src ç”¨æ¥è¡¨ç¤ºæºé›†åˆï¼Œç„¶åéå† src å°†ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œæ·»åŠ åˆ° dest ä¸­ä¸å°±æå®šäº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519095143653.png" alt="image-20230519095143653" style="zoom:67%;" /><p>è¿™æ ·å½“ç„¶èƒ½å®Œæˆéœ€æ±‚ï¼Œä¸è¿‡ç›®å‰è¿™ä¸ªæ–¹æ³•åªèƒ½æ¥ Dog ç±»å‹çš„é›†åˆã€‚å¦‚æœå°† Dog å­ç±»çš„é›†åˆä¼ å…¥åˆ° src ä¸­å°±ä¼šç¼–è¯‘å¤±è´¥ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºå°†å­ç±»å‹èµ‹å€¼ç»™çˆ¶ç±»å‹æ˜¯å†æ­£å¸¸ä¸è¿‡çš„æ“ä½œã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519095427527.png" alt="image-20230519095427527" style="zoom:67%;" /><p>ä¸ºäº†è®©æ–¹æ³•æ›´çµæ´»ï¼Œæˆ‘ä»¬å¯ä»¥å°† src å£°æ˜ä¸Šç•Œè®©å…¶æ”¯æŒåå˜ï¼Œè¿™æ · src å°±èƒ½æ¥æ”¶Dog çš„å­ç±»é›†åˆäº†ã€‚å› ä¸ºæˆ‘ä»¬åªä¼šå¯¹src åšè·å–å…ƒç´ çš„æ“ä½œï¼Œæ‰€ä»¥åå˜ä¸èƒ½æ–°å¢å…ƒç´ è¿™ä¸€é™åˆ¶ï¼Œä¸ä¼šå¯¹æˆ‘ä»¬é€ æˆå›°æ‰°ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519095759650.png" alt="image-20230519095759650" style="zoom:67%;" /><p>ç°åœ¨ src å‚æ•°æ‰©å±•æ€§æ˜¯å¾ˆå¥½äº†ï¼Œå¯ dest å‚æ•°çš„é—®é¢˜è¿˜æ²¡æœ‰è§£å†³ï¼Œdest å‚æ•°ç›®å‰åªèƒ½æ¥æ”¶ Dog ç±»å‹çš„é›†åˆï¼Œå¦‚æœä¼ é€’ Dogçˆ¶ç±»çš„é›†åˆå°±ä¼šç¼–è¯‘å¤±è´¥ã€‚è¿™æ ·ä¹Ÿæ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºå°†å¯¹è±¡æ”¾å…¥çˆ¶ç±»é›†åˆä¸­åŒæ ·æ˜¯å¾ˆå¸¸è§çš„æ“ä½œï¼Œé‚£è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519100222442.png" alt="image-20230519100222442" style="zoom: 67%;" /><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼Ÿé€šé…ç¬¦åŠ  super å…³é”®å­—ï¼Œæ¥å£°æ˜æ³›å‹çš„ä¸‹ç•Œï¼Œè¿™æ ·å°†æ³›å‹é€†å˜åï¼Œå°±å¯ä»¥æ¥æ”¶æœ¬ç±»å‹æˆ–è€…çˆ¶ç±»å‹çš„æ³›å‹ç±»ï¼Œä¹‹å‰çš„ç¼–è¯‘é”™è¯¯è‡ªç„¶ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519100406281.png" alt="image-20230519100406281" style="zoom:67%;" /><p>æ­£æ˜¯ç”±äºæœ€å¤šåªèƒ½æ¥æ”¶çˆ¶ç±»å‹æ³›å‹ï¼Œæ‰€ä»¥é€†å˜å¯ä»¥æ·»åŠ å…ƒç´ ï¼Œå› ä¸ºå®ƒä¸ä¼šæœ‰ç±»å‹è½¬æ¢å¤±è´¥çš„é£é™©ã€‚ è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œè™½ç„¶æ³›å‹ç±»å¯ä»¥æ¥æ”¶çˆ¶ç±»å‹çš„æ³›å‹ï¼Œä½†ç»™é€†å˜æ³›å‹æ·»åŠ å…ƒç´ æ—¶ï¼Œè¿˜æ˜¯åªèƒ½æ·»åŠ æŒ‡å®šç±»å‹æˆ–æŒ‡å®šç±»å‹çš„å­ç±»ï¼Œä¸è¦å°†æ¥æ”¶æ³›å‹ç±»å’Œæ·»åŠ å…ƒç´ ç»™å¼„æ··äº†ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519100623271.png" alt="image-20230519100623271" style="zoom:67%;" /><p>é€†å˜è™½ç„¶æ²¡æœ‰åå˜åªè¯»ä¸å†™çš„é™åˆ¶ï¼Œä½†æœ‰åˆ©åˆ™æœ‰å¼Šï¼Œæ­£æ˜¯ç”±äºé€†å˜æ˜¯æ¥æ”¶çˆ¶ç±»å‹çš„æ³›å‹ç±»ï¼Œæ‰€ä»¥åœ¨è¯»å–å…ƒç´ æ—¶ä¸èƒ½ä¿è¯å…ƒç´ å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåªèƒ½ç”¨ Object æ¥è·å–å¯¹è±¡ï¼Œä»¿ä½›æ³›å‹å¤±æ•ˆäº†ä¸€èˆ¬ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519100814028.png" alt="image-20230519100814028" style="zoom:67%;" /><blockquote><p>æ€»ç»“</p></blockquote><p>å¯ä»¥å‘ç°ï¼Œé€†å˜å’Œåå˜æ­£å¥½ç›¸åï¼Œåå˜æ˜¯åªè¯»ä¸å†™ï¼Œé€†å˜æ˜¯åªå†™ä¸è¯»ï¼Œä¸¤è€…ä¸€å¯¹æ¯”ï¼Œå„è‡ªçš„åº”ç”¨åœºæ™¯å…¶å®ä¹Ÿå°±å‘¼ä¹‹æ¬²å‡ºäº†ï¼Œå½“æˆ‘æƒ³å¯¹æ³›å‹åªè¯»ä¸å†™æ—¶ï¼Œæˆ‘å°±ç”¨åå˜å˜›ï¼Œå½“æˆ‘æƒ³å¯¹æ³›å‹åªå†™ä¸è¯»æ—¶ï¼Œæˆ‘å°±ç”¨é€†å˜å˜›ã€‚æœ‰äººæ­¤æ—¶å¯èƒ½ä¼šé—®ï¼Œé‚£æˆ‘åˆæƒ³è¯»åˆæƒ³å†™å‘¢ï¼Œé‚£æ­¤æ—¶ä½ è¦çš„å°±ä¸è¯¥æ˜¯åå˜é€†å˜ï¼Œè€Œæ˜¯å‡†ç¡®çš„æ³›å‹ç±»å‹ã€‚</p><p>æ³›å‹çš„åå˜é€†å˜ä¸€èˆ¬åªç”¨äºåœ¨æ–¹æ³•ä¸Šï¼Œå£°æ˜å½¢å‚æ¥æ¥æ”¶è°ƒç”¨è€…ä¼ é€’çš„å®å‚ï¼Œä¹‹å‰æˆ‘ç›´æ¥å£°æ˜å˜é‡æ¥æ¥æ”¶å„ç§æ³›å‹ç±»ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºå®é™…ä¸­æ²¡å¿…è¦è¿™ä¹ˆåšã€‚</p><hr><h3 id="6-4-PECSæ³•åˆ™">6.4 PECSæ³•åˆ™</h3><p>PECSåŸåˆ™çš„å…¨æ‹¼æ˜¯&quot;Producer Extends Consumer Super&quot;ã€‚</p><ul><li>å¦‚æœä½ æƒ³ä»ä¸€ä¸ªæ•°æ®ç±»å‹é‡Œè·å–æ•°æ®ï¼Œä½¿ç”¨ ? extends é€šé…ç¬¦</li><li>å¦‚æœä½ æƒ³æŠŠå¯¹è±¡å†™å…¥ä¸€ä¸ªæ•°æ®ç»“æ„é‡Œï¼Œä½¿ç”¨ ? super é€šé…ç¬¦</li><li>å¦‚æœä½ æ—¢æƒ³å­˜ï¼Œåˆæƒ³å–ï¼Œé‚£å°±åˆ«ç”¨é€šé…ç¬¦ã€‚</li></ul><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230519101250671.png" alt="image-20230519101250671" style="zoom:67%;" /><blockquote><p>Javaè¯­è¨€è§„èŒƒå®šä¹‰ï¼š</p></blockquote><p>jls7: 4.5.1: unlike ordinary type varables declared in a method signature, no type inference is required when using a wildcard.</p><p>&lt;ä¸åŒäºæ™®é€šçš„ç±»å‹å˜é‡å£°æ˜ï¼Œé€šé…ç¬¦æ–¹å¼å¹¶ä¸ä¼šè¿›è¡Œç±»å‹æ¨æ–­&gt;</p><p>è¯´æ˜ï¼šä¸è¿›è¡Œç±»å‹æ¨æ–­çš„è¯å®é™…ä¸Šå°±é™åˆ¶äº†æ•°æ®çš„æ”¾å…¥å’Œå–å‡ºã€‚ç®€è€Œè¨€ä¹‹ï¼Œéœ€è¦æ˜ç¡®çš„å‘Šè¯‰ç¼–è¯‘å™¨æ­¤æ•°æ®çš„ä¸Šç•Œå’Œä¸‹ç•Œï¼Œå¦åˆ™ç¼–è¯‘æ—¶æŠ¥é”™ã€‚</p><p>jls7:The null reference can always be assigned or cast to any reference type</p><p>ä»ä¸Šé¢çš„Javaè¯­è¨€è§„èŒƒä¸­å¯ä»¥å¾—å‡ºï¼š</p><p>Javaä¸­æ‰€æœ‰ç±»çš„é¡¶çº§çˆ¶ç±»æ˜¯Objectï¼Œå¯ä»¥è®¤ä¸ºNullæ˜¯æ‰€æœ‰ç±»çš„å­ç±»ã€‚</p><p><code>? extends T</code>ï¼šé€šé…ç¬¦ï¼Ÿçš„ç±»å‹åœ¨Nullå’ŒTä¹‹é—´ã€‚ <code>? extends </code>åªèƒ½ä½œä¸ºæ¶ˆè´¹è€…ï¼Œè€Œä¸èƒ½æ”¾å…¥ç±»å‹çš„åŸå› å°±åœ¨è¿™é‡Œï¼Œç¼–è¯‘å™¨ä¸èƒ½ç¡®å®šæ”¾å…¥çš„æ˜¯ä»€ä¹ˆç±»å‹ï¼ŒNullå¯ä»¥è½¬åŒ–ä¸ºä»»æ„ç±»å‹ï¼›æ¢ä¸€ç§è¯´æ³•ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“ç±»å‹çš„ä¸Šç•Œï¼Œåªæ¸…æ¥šç±»å‹çš„ä¸‹ç•Œã€‚å¦‚ä¸‹å›¾</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230518092225731.png" alt="image-20230518092225731" style="zoom:67%;" /><p>æ€ä¹ˆçœ‹å¾…è¿™ä¸ªä¸Šé™å’Œä¸‹é™å‘¢</p><p>å¯¹äº<code>? extends T</code> æ¥è¯´ï¼Œé›†åˆé‡Œçš„å…ƒç´ åº”è¯¥æ˜¯ä»€ä¹ˆç±»å‹å‘¢ï¼Ÿåº”è¯¥æ˜¯Tç±»å‹ï¼Œå› ä¸ºä½ æ·»åŠ çš„æ˜¯Tæˆ–è€…Tçš„å­ç±»ï¼Œè®¾ç½®ä¸ºTå°±å¯ä»¥æ¿€å‘å¤šæ€äº†ã€‚æ˜¯äº†ï¼Œæ‰€ä»¥ä½ ä¹Ÿåªèƒ½ä»è¿™ä¸ªé›†åˆä¸­å–å‡ºTç±»å‹ï¼Œå› ä¸ºå®ƒé‡Œé¢çš„å…ƒç´ æœ¬æ¥è®¾ç½®çš„å°±æ˜¯Tç±»å‹ï¼Œä½ èµ‹å€¼è¿›å»åªä¸è¿‡æ˜¯å°†Tçš„å­ç±»èµ‹å€¼ç»™äº†Tï¼Œå¤šæ€ã€‚ä½†æ˜¯å‘¢ï¼Œä½ å°±ä¸èƒ½ç»™è¿™ä¸ªé›†åˆé‡Œæ·»åŠ å…ƒç´ äº†ï¼Œå› ä¸ºè¿™ä¸ªé›†åˆé‡Œå…ƒç´ çš„ç±»å‹æ˜¯Tï¼Œå‡å¦‚å¯ä»¥æ·»åŠ å…ƒç´ ï¼Œä½ åˆå§‹åŒ–çš„æ—¶å€™åˆå§‹åŒ–æˆTçš„ä¸€ä¸ªå­ç±»ï¼Œç„¶åæ·»åŠ å€¼çš„æ—¶å€™ï¼Œå´æ·»åŠ çš„å¦ä¸€ä¸ªå­ç±»ï¼Œäº‹å®ä¸Šæ˜¯å¯ä»¥æ·»åŠ çš„ï¼Œå› ä¸ºé›†åˆå…ƒç´ ç±»å‹æ˜¯Tï¼Œä½†é‡Œé¢å°±æœ‰äº†å¤šç§Tçš„å­ç±»ï¼Œå¥½äº†ï¼Œä½ åˆå§‹åŒ–çš„æ—¶å€™æ˜¯è¿™ä¸ªå­ç±»ï¼Œä½ å–å‡ºå…ƒç´ çš„æ—¶å€™è‚¯å®šä¹Ÿæƒ³ç€å–å‡ºçš„æ˜¯å¯ä»¥ç»™è¿™ä¸ªå­ç±»èµ‹å€¼çš„ç±»å‹ï¼Œä½†å¾ˆæœ‰å¯èƒ½å–å‡ºæ¥çš„æ˜¯Tçš„å¦ä¸€ä¸ªå­ç±»ï¼Œä½ æ²¡æ³•èµ‹å€¼ï¼Œå› ä¸ºä½ å…è®¸æ·»åŠ å¦ä¸€ä¸ªå­ç±»ã€‚æ‰€ä»¥ä¸€å¼€å§‹å°±ç¦æ­¢æ·»åŠ å…ƒç´ æ˜¯å¯¹çš„ã€‚</p><p><code>? super T</code>é‡Œé¢çš„å…ƒç´ ï¼Œåº”è¯¥è®¾ç½®ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ˜¾ç„¶åº”è¯¥æ˜¯objectï¼Œå› ä¸ºç³»ç»Ÿä¸çŸ¥é“ä½ ä¼šæŠŠ?å½“æˆä»€ä¹ˆï¼Œä¸çŸ¥é“å…·ä½“æ˜¯å“ªä¸ªçˆ¶ç±»å‹ï¼Œæ‰€ä»¥åªèƒ½è®¾ç½®æˆobjectï¼Œæ‰€ä»¥ä½ å–å‡ºå…ƒç´ çš„æ—¶å€™ï¼Œå–å‡ºçš„æ˜¯objectç±»ã€‚å¯ä¸å¯ä»¥æ·»åŠ å…ƒç´ å‘¢ï¼Ÿå¯ä»¥ï¼Œå› ä¸ºä¸‹é™æœ‰ä¿è¯ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ Tå’ŒTçš„å­ç±»ã€‚ä½ åˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆå§‹åŒ–çš„æ˜¯Tçš„æŸä¸ªçˆ¶ç±»ï¼Œå¥½äº†ï¼Œä½ ç°åœ¨å–å…ƒç´ ï¼Œä½ å¸Œæœ›å–å‡ºçš„æ˜¯ä½ åˆå§‹åŒ–çš„é‚£ä¸ªçˆ¶ç±»ï¼Œå› ä¸ºä½ åªèƒ½æ·»åŠ Tå’ŒTçš„å­ç±»ï¼Œæ‰€ä»¥ä½ å–å‡ºçš„å…ƒç´ ï¼Œè‚¯å®šå¯ä»¥èµ‹å€¼ç»™é‚£ä¸ªçˆ¶ç±»ã€‚</p><p>ç»¼ä¸Šï¼Œ<code>? extends T</code>ä¸å¯ä»¥æ·»åŠ å…ƒç´ ï¼Œä½†å¯ä»¥å–å‡ºç±»å‹ä¸ºTçš„å…ƒç´ ã€‚<code>? super T</code>å¯ä»¥æ·»åŠ Tæˆ–è€…Tçš„å­ç±»ï¼Œå–å‡ºçš„ä¸€å®šæ˜¯objectç±»ã€‚</p><p>extendsTåªå‡ºä¸è¿›ï¼Œå±äºç”Ÿäº§è€…ä¸€ç±»ã€‚</p><p>superTåªè¿›ä¸å‡ºï¼Œå±äºæ¶ˆè´¹è€…ã€‚</p><p>è¿™ä¹Ÿå°±æœ‰äº†æˆ‘ä»¬ä¸Šé¢æ‰€æåˆ°çš„â€œProducer Extends Consumer Superâ€ï¼Œä¹Ÿå°±æ˜¯PECSåŸåˆ™ã€‚</p><h2 id="7-è¯¾åé—®é¢˜">7. è¯¾åé—®é¢˜</h2><p>1ã€ä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼ˆType Erasureï¼‰ï¼Ÿ</p><p>2ã€ä»€ä¹ˆæ˜¯ç±»å‹å‚æ•°ï¼ˆType Parameterï¼‰ï¼Ÿ  T K V ç­‰ç¬¦å·</p><p>3ã€ä»€ä¹ˆæ˜¯æ³›å‹çš„ä¸Šä¸‹ç•Œï¼Ÿ</p><p>4ã€<code>List</code>ã€<code>List&lt; Object &gt;</code> ã€<code>List&lt; ? &gt;</code>æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><blockquote><p>5ã€ï¼Ÿå’ŒT çš„åŒºåˆ«</p></blockquote><p><code>?</code> æ˜¯é€šé…ç¬¦</p><p><code>T</code> æ˜¯ç±»å‹å˜é‡</p><p><code>?</code>é€šå¸¸ç”¨äºæ–¹æ³•å‚æ•°ç±»å‹ã€é›†åˆç±»å‹ç­‰éœ€è¦çµæ´»å¤„ç†ç±»å‹çš„åœºæ™¯ã€‚</p><p><code>T</code>é€šå¸¸ç”¨äºæ³›å‹ç±»æˆ–æ³›å‹æ–¹æ³•ä¸­ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ç¼–å†™æ³›å‹ä»£ç æ—¶æŒ‡å®šç±»å‹ã€‚</p><p>T åˆ™ä¸é—®å·ä¸åŒï¼Œå®ƒåªèƒ½ç”¨äºå£°æ˜å¤„ã€‚</p>]]></content>
    
    
    <summary type="html">æ³›å‹ç±»ã€æ³›å‹æ–¹æ³•ã€æ³›å‹æ¥å£ã€æ³›å‹æ“¦é™¤ã€PECSæ³•åˆ™</summary>
    
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/categories/Java/"/>
    
    
    <category term="Java" scheme="https://wuwawawa.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootWebå¼€å‘</title>
    <link href="https://wuwawawa.github.io/posts/3fc60a15.html"/>
    <id>https://wuwawawa.github.io/posts/3fc60a15.html</id>
    <published>2023-05-04T07:21:40.000Z</published>
    <updated>2023-05-16T05:28:21.175Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-åŠŸèƒ½æ”¯æŒ">1. åŠŸèƒ½æ”¯æŒ</h2><p>Spring Bootä¸ºSpring MVCæä¾›äº†è‡ªåŠ¨é…ç½®ï¼Œå¤§å¤šåœºæ™¯éƒ½æ— éœ€è‡ªå®šä¹‰é…ç½®</p><ul><li>å†…å®¹åå•†è§†å›¾è§£æå™¨ ContentNegotiatingViewResolver å’Œ BeanName è§†å›¾è§£æå™¨ BeanNameViewResolver</li><li>æ”¯æŒé™æ€èµ„æºï¼ˆåŒ…æ‹¬ webjarsï¼‰å’Œé™æ€ index.html é¡µæ”¯æŒ</li><li>è‡ªåŠ¨æ³¨å†Œç›¸å…³ç±»ï¼šConverterã€GenericConverterã€Formatter</li><li>å†…å®¹åå•†å¤„ç†å™¨ï¼šHttpMessageConverters</li><li>å›½é™…åŒ–ï¼šMessageCodesResolver</li></ul><p>å¼€å‘è§„èŒƒï¼š</p><ul><li>ä½¿ç”¨ <code>@Configuration</code> + <code>WebMvcConfigurer</code> è‡ªå®šä¹‰è§„åˆ™ï¼Œä¸ä½¿ç”¨ <code>@EnableWebMvc</code> æ³¨è§£</li><li>å£°æ˜ <code>WebMvcRegistrations</code> çš„å®ç°ç±»æ”¹å˜é»˜è®¤åº•å±‚ç»„ä»¶</li><li>ä½¿ç”¨ <code>@EnableWebMvc</code> + <code>@Configuration</code> + <code>DelegatingWebMvcConfiguration</code> å…¨é¢æ¥ç®¡ SpringMVC</li></ul><hr><h2 id="2-é™æ€èµ„æº">2. é™æ€èµ„æº</h2><h3 id="2-1-è®¿é—®è§„åˆ™">2.1 è®¿é—®è§„åˆ™</h3><p>ä½¿ç”¨äº†Spring MVCä¸­çš„<code>ResourceHttpRequestHandler</code></p><p>é»˜è®¤çš„é™æ€èµ„æºè·¯å¾„æ˜¯ classpath ä¸‹çš„ï¼Œä¼˜å…ˆçº§ç”±é«˜åˆ°ä½ä¸ºï¼š</p><ul><li><code>/META-INF/resources</code></li><li><code>/resources</code></li><li><code>/static</code></li><li><code>/public</code></li></ul><p>çš„åŒ…å†…ï¼Œ<code>/</code> è¡¨ç¤ºå½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230502154538517.png" alt="image-20230502154538517" style="zoom:50%;" /><p>è¯·æ±‚æ–¹å¼ï¼š <code>/ + é™æ€èµ„æºå</code></p><p>å¤„ç†åŸç†ï¼šè¯·æ±‚å…ˆå»å¯»æ‰¾ Controller å¤„ç†ï¼Œä¸èƒ½å¤„ç†çš„è¯·æ±‚å°±ä¼šäº¤ç»™é™æ€èµ„æºå¤„ç†å™¨ï¼Œé™æ€èµ„æºä¹Ÿæ‰¾ä¸åˆ°å°±å“åº” 404 é¡µé¢</p><div class="tabs" id="8c8c2f44-af52-4ecf-b88d-770f470b8a9e"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#8c8c2f44-af52-4ecf-b88d-770f470b8a9e-1"><i class="fas fa-cat"></i>ä¿®æ”¹é»˜è®¤èµ„æºè·¯å¾„</button></li><li class="tab"><button type="button" data-href="#8c8c2f44-af52-4ecf-b88d-770f470b8a9e-2"><i class="fas fa-horse"></i>ä¿®æ”¹é™æ€èµ„æºè®¿é—®å‰ç¼€</button></li><li class="tab"><button type="button" data-href="#8c8c2f44-af52-4ecf-b88d-770f470b8a9e-3"><i class="fas fa-dove"></i>webjarè®¿é—®èµ„æº</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="8c8c2f44-af52-4ecf-b88d-770f470b8a9e-1"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">static-locations::</span> [<span class="string">classpath:/haha/</span>]</span><br></pre></td></tr></table></figure><p>é»˜è®¤çš„é™æ€èµ„æºè·¯å¾„å°†æ‰¾ä¸åˆ°äº†</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c8c2f44-af52-4ecf-b88d-770f470b8a9e-2"><p>é»˜è®¤æ˜¯ <code>/**</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">static-path-pattern:</span> <span class="string">/resources/**</span></span><br></pre></td></tr></table></figure><p>è®¿é—® URLï¼š<a href="http://localhost:8080/resources/">http://localhost:8080/resources/</a> + é™æ€èµ„æºå</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c8c2f44-af52-4ecf-b88d-770f470b8a9e-3"><p>æŠŠä¸€äº›é™æ€èµ„æºåšæˆjaråŒ…ï¼Œè®¿é—®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®åœ°å€ï¼š<a href="http://localhost:8080/webjars/jquery/3.5.1/jquery.js%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%9C%B0%E5%9D%80%E8%A6%81%E6%8C%89%E7%85%A7%E4%BE%9D%E8%B5%96%E9%87%8C%E9%9D%A2%E7%9A%84%E5%8C%85%E8%B7%AF%E5%BE%84">http://localhost:8080/webjars/jquery/3.5.1/jquery.jsï¼Œåé¢åœ°å€è¦æŒ‰ç…§ä¾èµ–é‡Œé¢çš„åŒ…è·¯å¾„</a></p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230502155735696.png" alt="image-20230502155735696" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="2-2-æ¬¢è¿é¡µé¢">2.2 æ¬¢è¿é¡µé¢</h3><ul><li><p>é™æ€èµ„æºè·¯å¾„ä¸‹  index.htmlã€‚</p><ul><li>å¯ä»¥é…ç½®é™æ€èµ„æºè·¯å¾„</li><li>ä½†æ˜¯ä¸å¯ä»¥é…ç½®é™æ€èµ„æºçš„è®¿é—®å‰ç¼€ã€‚å¦åˆ™å¯¼è‡´ index.htmlä¸èƒ½è¢«é»˜è®¤è®¿é—®</li></ul></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="comment">#  mvc:</span></span><br><span class="line"><span class="comment">#    static-path-pattern: /res/**   è¿™ä¸ªä¼šå¯¼è‡´welcome pageåŠŸèƒ½å¤±æ•ˆ</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">static-locations:</span> [<span class="string">classpath:/haha/</span>]</span><br></pre></td></tr></table></figure><ul><li>controllerèƒ½å¤„ç†/indexã€‚</li></ul><p>ç½‘é¡µæ ‡ç­¾ä¸Šçš„å°å›¾æ ‡å¯ä»¥è‡ªå®šä¹‰è§„åˆ™ï¼ŒæŠŠèµ„æºé‡å‘½åä¸º favicon.ico æ”¾åœ¨é™æ€èµ„æºç›®å½•ä¸‹å³å¯</p><hr><h3 id="2-3-æºç åˆ†æ">2.3 æºç åˆ†æ</h3><ul><li>SpringBootå¯åŠ¨é»˜è®¤åŠ è½½ xxxAutoConfigurationç±»ï¼ˆè‡ªåŠ¨é…ç½®ç±»ï¼‰</li><li>SpringMVCåŠŸèƒ½çš„è‡ªåŠ¨é…ç½®ç±»<code>WebMvcAutoConfiguration</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="comment">//å½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SERVLET_LOCATION</span> <span class="operator">=</span> <span class="string">&quot;/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="3b8ad86e-8e1b-4e01-a278-58bd0497dd4a"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-1"><i class="fas fa-award"></i>å†…éƒ¨ç±»</button></li><li class="tab"><button type="button" data-href="#3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-2"><i class="fas fa-baseball-ball"></i>é™æ€èµ„æºæ˜ å°„è§„åˆ™</button></li><li class="tab"><button type="button" data-href="#3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-3"><i class="fas fa-bone"></i>æ¬¢è¿é¡µ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-1"><p>å†…éƒ¨ç±» WebMvcAutoConfigurationAdapteræ„é€ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(EnableWebMvcConfiguration.class)</span></span><br><span class="line"><span class="comment">// ç»‘å®š spring.mvcã€spring.webã€spring.resources ç›¸å…³çš„é…ç½®å±æ€§</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(&#123; WebMvcProperties.class,ResourceProperties.class, WebProperties.class &#125;)</span></span><br><span class="line"><span class="meta">@Order(0)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfigurationAdapter</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span>, ServletContextAware &#123;</span><br><span class="line"><span class="comment">//æœ‰å‚æ„é€ å™¨æ‰€æœ‰å‚æ•°çš„å€¼éƒ½ä¼šä»å®¹å™¨ä¸­ç¡®å®š</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">WebMvcAutoConfigurationAdapter</span><span class="params">(<span class="comment">/*å‚æ•°*/</span>)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.resourceProperties = resourceProperties.hasBeenCustomized() ? resourceProperties</span><br><span class="line">: webProperties.getResources();</span><br><span class="line"><span class="built_in">this</span>.mvcProperties = mvcProperties;</span><br><span class="line"><span class="built_in">this</span>.beanFactory = beanFactory;</span><br><span class="line"><span class="built_in">this</span>.messageConvertersProvider = messageConvertersProvider;</span><br><span class="line"><span class="built_in">this</span>.resourceHandlerRegistrationCustomizer = resourceHandlerRegistrationCustomizerProvider.getIfAvailable();</span><br><span class="line"><span class="built_in">this</span>.dispatcherServletPath = dispatcherServletPath;</span><br><span class="line"><span class="built_in">this</span>.servletRegistrations = servletRegistrations;</span><br><span class="line"><span class="built_in">this</span>.mvcProperties.checkConfiguration();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦çš„å‚æ•°ï¼š</p><ul><li>ResourceProperties resourcePropertiesï¼šè·å–å’Œ spring.resources ç»‘å®šçš„æ‰€æœ‰çš„å€¼çš„å¯¹è±¡</li><li>WebMvcProperties mvcPropertiesï¼šè·å–å’Œ spring.mvc ç»‘å®šçš„æ‰€æœ‰çš„å€¼çš„å¯¹è±¡</li><li>ListableBeanFactory beanFactoryï¼šSpring çš„ beanFactory</li><li>HttpMessageConvertersï¼šæ‰¾åˆ°æ‰€æœ‰çš„ HttpMessageConverters</li><li>ResourceHandlerRegistrationCustomizerï¼šæ‰¾åˆ° èµ„æºå¤„ç†å™¨çš„è‡ªå®šä¹‰å™¨ã€‚</li><li>DispatcherServletPathï¼šé¡¹ç›®è·¯å¾„</li><li>ServletRegistrationBeanï¼šç»™åº”ç”¨æ³¨å†Œ Servletã€Filter</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-2"><p>ä¸¤ç§é™æ€èµ„æºæ˜ å°„è§„åˆ™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">    <span class="comment">//é…ç½®æ–‡ä»¶è®¾ç½® spring.resources.add-mappings: falseï¼Œç¦ç”¨æ‰€æœ‰é™æ€èµ„æº</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">        logger.debug(<span class="string">&quot;Default resource handling disabled&quot;</span>);<span class="comment">//è¢«ç¦ç”¨</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ³¨å†Œwebjarsé™æ€èµ„æºçš„æ˜ å°„è§„åˆ™æ˜ å°„è·¯å¾„</span></span><br><span class="line">    addResourceHandler(registry, <span class="string">&quot;/webjars/**&quot;</span>, <span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    <span class="comment">//æ³¨å†Œé™æ€èµ„æºè·¯å¾„çš„æ˜ å°„è§„åˆ™ é»˜è®¤æ˜ å°„ staticPathPattern = &quot;/**&quot; </span></span><br><span class="line">    addResourceHandler(registry, <span class="built_in">this</span>.mvcProperties.getStaticPathPattern(), (registration) -&gt; &#123;</span><br><span class="line">        <span class="comment">//staticLocations = CLASSPATH_RESOURCE_LOCATIONS</span></span><br><span class="line">        registration.addResourceLocations(<span class="built_in">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.servletContext != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ServletContextResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextResource</span>(<span class="built_in">this</span>.servletContext, SERVLET_LOCATION);</span><br><span class="line">            registration.addResourceLocations(resource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(&quot;spring.web&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebProperties</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Resources</span> &#123;</span><br><span class="line">    <span class="comment">//é»˜è®¤èµ„æºè·¯å¾„ï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = &#123; <span class="string">&quot;classpath:/META-INF/resources/&quot;</span>,</span><br><span class="line">                                                 <span class="string">&quot;classpath:/resources/&quot;</span>, </span><br><span class="line">                                                 <span class="string">&quot;classpath:/static/&quot;</span>, <span class="string">&quot;classpath:/public/&quot;</span> &#125;</span><br><span class="line">        <span class="keyword">private</span> String[] staticLocations = CLASSPATH_RESOURCE_LOCATIONS;</span><br><span class="line">        <span class="comment">//å¯ä»¥è¿›è¡Œè§„åˆ™é‡å†™</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStaticLocations</span><span class="params">(String[] staticLocations)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.staticLocations = appendSlashIfNecessary(staticLocations);</span><br><span class="line"><span class="built_in">this</span>.customized = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="3b8ad86e-8e1b-4e01-a278-58bd0497dd4a-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//spring.web å±æ€§</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(WebProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EnableWebMvcConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WelcomePageHandlerMapping <span class="title function_">welcomePageHandlerMapping</span><span class="params">(<span class="comment">/*å‚æ•°*/</span>)</span> &#123;</span><br><span class="line">        <span class="type">WelcomePageHandlerMapping</span> <span class="variable">welcomePageHandlerMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WelcomePageHandlerMapping</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">TemplateAvailabilityProviders</span>(applicationContext), </span><br><span class="line">            applicationContext, getWelcomePage(),</span><br><span class="line">            <span class="comment">//staticPathPattern = &quot;/**&quot;</span></span><br><span class="line">            <span class="built_in">this</span>.mvcProperties.getStaticPathPattern());</span><br><span class="line">        <span class="keyword">return</span> welcomePageHandlerMapping;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">WelcomePageHandlerMapping(<span class="comment">/*å‚æ•°*/</span>) &#123;</span><br><span class="line">    <span class="comment">//æ‰€ä»¥é™åˆ¶ staticPathPattern å¿…é¡»ä¸º /** æ‰èƒ½å¯ç”¨è¯¥åŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">if</span> (welcomePage != <span class="literal">null</span> &amp;&amp; <span class="string">&quot;/**&quot;</span>.equals(staticPathPattern)) &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;Adding welcome page: &quot;</span> + welcomePage);</span><br><span class="line">        <span class="comment">//é‡å®šå‘</span></span><br><span class="line">        setRootViewName(<span class="string">&quot;forward:index.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (welcomeTemplateExists(templateAvailabilityProviders, applicationContext)) &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;Adding welcome page template: index&quot;</span>);</span><br><span class="line">        setRootViewName(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>WelcomePageHandlerMappingï¼Œè®¿é—® / èƒ½è®¿é—®åˆ° index.html</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><hr><h2 id="3-Restæ˜ å°„">3. Restæ˜ å°„</h2><p>å¼€å¯ Rest åŠŸèƒ½</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">hiddenmethod:</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span>   <span class="comment">#å¼€å¯é¡µé¢è¡¨å•çš„ReståŠŸèƒ½</span></span><br></pre></td></tr></table></figure><p>æºç åˆ†æï¼Œæ³¨å…¥äº† HiddenHttpMethodFilte è§£æ Rest é£æ ¼çš„è®¿é—®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(HiddenHttpMethodFilter.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(prefix = &quot;spring.mvc.hiddenmethod.filter&quot;, name = &quot;enabled&quot;)</span></span><br><span class="line"><span class="keyword">public</span> OrderedHiddenHttpMethodFilter <span class="title function_">hiddenHttpMethodFilter</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OrderedHiddenHttpMethodFilter</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="4-å†…åµŒå®¹å™¨">4. å†…åµŒå®¹å™¨</h2><p>SpringBoot åµŒå…¥å¼ Servlet å®¹å™¨ï¼Œé»˜è®¤æ”¯æŒçš„ WebServeï¼šTomcatã€Jettyã€Undertow</p><p>é…ç½®æ–¹å¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span> <span class="comment">&lt;!--å¿…é¡»è¦æŠŠå†…åµŒçš„ Tomcat å®¹å™¨--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Web åº”ç”¨å¯åŠ¨ï¼ŒSpringBoot å¯¼å…¥ Web åœºæ™¯åŒ… tomcatï¼Œåˆ›å»ºä¸€ä¸ª Web ç‰ˆçš„ IOC å®¹å™¨ï¼š</p><ul><li><p><code>SpringApplication.run(BootApplication.class, args)</code>ï¼šåº”ç”¨å¯åŠ¨</p></li><li><p><code>ConfigurableApplicationContext.run()</code>ï¼š</p><ul><li><p><code>context = createApplicationContext()</code>ï¼š<strong>åˆ›å»ºå®¹å™¨</strong></p><ul><li><p><code>applicationContextFactory = ApplicationContextFactory.DEFAULT</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContextFactory</span> <span class="variable">DEFAULT</span> <span class="operator">=</span> (webApplicationType) -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (webApplicationType) &#123;</span><br><span class="line">            <span class="keyword">case</span> SERVLET:</span><br><span class="line">                <span class="comment">// Servlet å®¹å™¨ï¼Œç»§æ‰¿è‡ª ServletWebServerApplicationContext</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigServletWebServerApplicationContext</span>();</span><br><span class="line">            <span class="keyword">case</span> REACTIVE:</span><br><span class="line">                <span class="comment">// å“åº”å¼ç¼–ç¨‹</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigReactiveWebServerApplicationContext</span>();</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="comment">// æ™®é€š Spring å®¹å™¨</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>applicationContextFactory.create(this.webApplicationType)</code>ï¼šæ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºå®¹å™¨</p></li></ul></li><li><p><code>refreshContext(context)</code>ï¼šå®¹å™¨å¯åŠ¨åˆ·æ–°</p></li></ul></li></ul><p>å†…åµŒå®¹å™¨å·¥ä½œæµç¨‹ï¼š</p><ul><li><p>Spring å®¹å™¨å¯åŠ¨é€»è¾‘ä¸­ï¼Œåœ¨å®ä¾‹åŒ–éæ‡’åŠ è½½çš„å•ä¾‹ Bean ä¹‹å‰æœ‰ä¸€ä¸ªæ–¹æ³• <strong>onRefresh()</strong>ï¼Œç•™ç»™å­ç±»å»æ‰©å±•ï¼ŒWeb å®¹å™¨å°±æ˜¯é‡å†™è¿™ä¸ªæ–¹æ³•åˆ›å»º WebServer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onRefresh</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//çœç•¥....</span></span><br><span class="line">createWebServer();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createWebServer</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ServletWebServerFactory</span> <span class="variable">factory</span> <span class="operator">=</span> getWebServerFactory();</span><br><span class="line">    <span class="built_in">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class="line">    createWebServer.end();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å– WebServer å·¥å‚ ServletWebServerFactoryï¼Œå¹¶ä¸”è·å–çš„æ•°é‡ä¸ç­‰äº 1 ä¼šæŠ¥é”™ï¼ŒSpring åº•å±‚æœ‰ä¸‰ç§ï¼š</p><p><code>TomcatServletWebServerFactory</code>ã€<code>JettyServletWebServerFactory</code>ã€<code>UndertowServletWebServerFactory</code></p></li><li><p><strong>è‡ªåŠ¨é…ç½®ç±» ServletWebServerFactoryAutoConfiguration</strong> å¯¼å…¥äº† ServletWebServerFactoryConfigurationï¼ˆé…ç½®ç±»ï¼‰ï¼Œæ ¹æ®æ¡ä»¶è£…é…åˆ¤æ–­ç³»ç»Ÿä¸­åˆ°åº•å¯¼å…¥äº†å“ªä¸ª Web æœåŠ¡å™¨çš„åŒ…ï¼Œåˆ›å»ºå‡ºæœåŠ¡å™¨å¹¶å¯åŠ¨</p></li><li><p>é»˜è®¤æ˜¯ web-starter å¯¼å…¥ tomcat åŒ…ï¼Œå®¹å™¨ä¸­å°±æœ‰ TomcatServletWebServerFactoryï¼Œåˆ›å»ºå‡º Tomcat æœåŠ¡å™¨å¹¶å¯åŠ¨ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TomcatWebServer</span><span class="params">(Tomcat tomcat, <span class="type">boolean</span> autoStart, Shutdown shutdown)</span> &#123;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">   initialize();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–æ–¹æ³• initialize ä¸­æœ‰å¯åŠ¨æ–¹æ³•ï¼š<code>this.tomcat.start()</code></p></li></ul><hr><hr><h2 id="5-è‡ªå®šä¹‰">5. è‡ªå®šä¹‰</h2><h4 id="å®šåˆ¶è§„åˆ™">å®šåˆ¶è§„åˆ™</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebMvcConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> WebMvcConfigurer <span class="title function_">webMvcConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurer</span>() &#123;</span><br><span class="line">            <span class="comment">//è¿›è¡Œä¸€äº›æ–¹æ³•é‡å†™ï¼Œæ¥å®ç°è‡ªå®šä¹‰çš„è§„åˆ™</span></span><br><span class="line">            <span class="comment">//æ¯”å¦‚æ·»åŠ ä¸€äº›è§£æå™¨å’Œæ‹¦æˆªå™¨ï¼Œå°±æ˜¯å¯¹åŸå§‹å®¹å™¨åŠŸèƒ½çš„å¢åŠ </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä¹Ÿå¯ä»¥ä¸åŠ  @Beanï¼Œç›´æ¥ä»è¿™é‡Œé‡å†™æ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢åŠ </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="å®šåˆ¶å®¹å™¨">å®šåˆ¶å®¹å™¨</h4><p>@EnableWebMvcï¼šå…¨é¢æ¥ç®¡ SpringMVCï¼Œæ‰€æœ‰è§„åˆ™å…¨éƒ¨è‡ªå·±é‡æ–°é…ç½®</p><ul><li><p>@EnableWebMvc + WebMvcConfigurer + @Bean  å…¨é¢æ¥ç®¡SpringMVC</p></li><li><p>@Import(DelegatingWebMvcConfiguration.<strong>class</strong>)ï¼Œè¯¥ç±»ç»§æ‰¿ WebMvcConfigurationSupportï¼Œè‡ªåŠ¨é…ç½®äº†ä¸€äº›éå¸¸åº•å±‚çš„ç»„ä»¶ï¼Œåªèƒ½ä¿è¯ SpringMVC æœ€åŸºæœ¬çš„ä½¿ç”¨</p></li></ul><p>åŸç†ï¼šè‡ªåŠ¨é…ç½®ç±» <strong>WebMvcAutoConfiguration</strong> é‡Œé¢çš„é…ç½®è¦èƒ½ç”Ÿæ•ˆï¼ŒWebMvcConfigurationSupport ç±»ä¸èƒ½è¢«åŠ è½½ï¼Œæ‰€ä»¥ @EnableWebMvc å¯¼è‡´é…ç½®ç±»å¤±æ•ˆï¼Œä»è€Œæ¥ç®¡äº† SpringMVC</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcAutoConfiguration</span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸€èˆ¬ä¸é€‚ç”¨æ­¤æ³¨è§£</p>]]></content>
    
    
    <summary type="html">SpringBoot webå¼€å‘åœºæ™¯</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
    <category term="SpringMVC" scheme="https://wuwawawa.github.io/tags/SpringMVC/"/>
    
    <category term="SpringBoot" scheme="https://wuwawawa.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootè‡ªåŠ¨é…ç½®åŸç†</title>
    <link href="https://wuwawawa.github.io/posts/ec6e45b4.html"/>
    <id>https://wuwawawa.github.io/posts/ec6e45b4.html</id>
    <published>2023-05-03T14:26:54.000Z</published>
    <updated>2023-05-16T05:27:42.777Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-åº•å±‚æ³¨è§£">1. åº•å±‚æ³¨è§£</h2><h3 id="1-1-ç»„ä»¶æ·»åŠ ">1.1 ç»„ä»¶æ·»åŠ </h3><div class="tabs" id="ded05754-ee65-4d86-9ba1-c4e945edc966"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ded05754-ee65-4d86-9ba1-c4e945edc966-1"><i class="fas fa-atom"></i>Configuration</button></li><li class="tab"><button type="button" data-href="#ded05754-ee65-4d86-9ba1-c4e945edc966-2"><i class="far fa-sun"></i>Condition</button></li><li class="tab"><button type="button" data-href="#ded05754-ee65-4d86-9ba1-c4e945edc966-3"><i class="fas fa-wind"></i>å…¶ä»–</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ded05754-ee65-4d86-9ba1-c4e945edc966-1"><p>@Configurationï¼šè®¾ç½®å½“å‰ç±»ä¸ºé…ç½®ç±»</p><ul><li>proxyBeanMethods = trueï¼šFull å…¨æ¨¡å¼ï¼Œæ¯ä¸ª @Bean æ–¹æ³•è¢«è°ƒç”¨å¤šå°‘æ¬¡è¿”å›çš„ç»„ä»¶éƒ½æ˜¯å•å®ä¾‹çš„ï¼Œé»˜è®¤å€¼ï¼Œç±»ç»„ä»¶ä¹‹é—´<span class='p green'>æœ‰ä¾èµ–å…³ç³»</span>ï¼Œæ–¹æ³•ä¼šè¢«è°ƒç”¨å¾—åˆ°ä¹‹å‰å•å®ä¾‹ç»„ä»¶</li><li>proxyBeanMethods = falseï¼šLite è½»é‡çº§æ¨¡å¼ï¼Œæ¯ä¸ª @Bean æ–¹æ³•è¢«è°ƒç”¨å¤šå°‘æ¬¡è¿”å›çš„ç»„ä»¶éƒ½æ˜¯æ–°åˆ›å»ºçš„ï¼Œç±»ç»„ä»¶ä¹‹é—´<span class='p blue'>æ— ä¾èµ–å…³ç³»</span>ç”¨ Lite æ¨¡å¼åŠ é€Ÿå®¹å™¨å¯åŠ¨è¿‡ç¨‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">//ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ã€‚ä»¥æ–¹æ³•åä½œä¸ºç»„ä»¶çš„ idã€‚è¿”å›ç±»å‹å°±æ˜¯ç»„ä»¶ç±»å‹ã€‚è¿”å›çš„å€¼ï¼Œå°±æ˜¯ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å®ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ded05754-ee65-4d86-9ba1-c4e945edc966-2"><p>æ¡ä»¶è£…é…ï¼šæ»¡è¶³ConditionalæŒ‡å®šçš„æ¡ä»¶ï¼Œåˆ™è¿›è¡Œç»„ä»¶æ³¨å…¥</p><table><thead><tr><th style="text-align:left">æ³¨è§£</th><th style="text-align:left">åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">@ConditionalOnBean</td><td style="text-align:left">ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ªbeanæ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@ConditionalOnClass</td><td style="text-align:left">æŸä¸ªclassä½äºç±»è·¯å¾„ä¸Šï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@ConditionalOnExpression</td><td style="text-align:left">å½“è¡¨è¾¾å¼ä¸ºtrueçš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@ConditionalOnMissingBean</td><td style="text-align:left">ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ä¸å­˜åœ¨æŸä¸ªbeanæ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@ConditionalOnMissingClass</td><td style="text-align:left">æŸä¸ªclassåœ¨ç±»è·¯å¾„ä¸Šä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@ConditionalOnNotWebApplication</td><td style="text-align:left">ä¸æ˜¯webåº”ç”¨æ—¶æ‰ä¼šå®ä¾‹åŒ–è¿™ä¸ªBean</td></tr><tr><td style="text-align:left">@AutoConfigureAfter</td><td style="text-align:left">åœ¨æŸä¸ªbeanå®Œæˆè‡ªåŠ¨é…ç½®åå®ä¾‹åŒ–è¿™ä¸ªbean</td></tr><tr><td style="text-align:left">@AutoConfigureBefore</td><td style="text-align:left">åœ¨æŸä¸ªbeanå®Œæˆè‡ªåŠ¨é…ç½®å‰å®ä¾‹åŒ–è¿™ä¸ªbean</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ded05754-ee65-4d86-9ba1-c4e945edc966-3"><p>@Beanã€@Componentã€@Controllerã€@Serviceã€@Repositoryå’ŒSpringä¸­ç›¸åŒå°±ä¸åœ¨ä»‹ç»</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="1-2-åŸç”Ÿé…ç½®æ–‡ä»¶å¼•å…¥">1.2 åŸç”Ÿé…ç½®æ–‡ä»¶å¼•å…¥</h3><p>æ¯”å¦‚ï¼Œå…¬å¸ä½¿ç”¨bean.xmlæ–‡ä»¶ç”Ÿæˆé…ç½®beanï¼Œç„¶è€Œä½ ä¸ºäº†çœäº‹ï¼Œæƒ³ç»§ç»­å¤ç”¨bean.xmlï¼Œ@ImportResourceç²‰å¢¨ç™»åœºã€‚</p><div class="tabs" id="b86eff17-ac9c-4c8c-86af-bc6296b6457e"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#b86eff17-ac9c-4c8c-86af-bc6296b6457e-1"><i class="fas fa-seedling"></i>bean.xml</button></li><li class="tab"><button type="button" data-href="#b86eff17-ac9c-4c8c-86af-bc6296b6457e-2"><i class="fas fa-leaf"></i>ä½¿ç”¨æ–¹æ³•</button></li><li class="tab"><button type="button" data-href="#b86eff17-ac9c-4c8c-86af-bc6296b6457e-3"><i class="fab fa-apple"></i>æµ‹è¯•ç±»</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="b86eff17-ac9c-4c8c-86af-bc6296b6457e-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">...</span>&quot;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;haha&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.boot.bean.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hehe&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.boot.bean.Pet&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tomcat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b86eff17-ac9c-4c8c-86af-bc6296b6457e-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ImportResource(&quot;classpath:beans.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b86eff17-ac9c-4c8c-86af-bc6296b6457e-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">//1ã€è¿”å›æˆ‘ä»¬IOCå®¹å™¨</span></span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">run</span> <span class="operator">=</span> SpringApplication.run(MainApplication.class, args);</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">haha</span> <span class="operator">=</span> run.containsBean(<span class="string">&quot;haha&quot;</span>);</span><br><span class="line"><span class="type">boolean</span> <span class="variable">hehe</span> <span class="operator">=</span> run.containsBean(<span class="string">&quot;hehe&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;hahaï¼š&quot;</span>+haha);<span class="comment">//true</span></span><br><span class="line">System.out.println(<span class="string">&quot;heheï¼š&quot;</span>+hehe);<span class="comment">//true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="1-3-é…ç½®ç»‘å®š">1.3 é…ç½®ç»‘å®š</h3><p>æˆ‘ä»¬ä¹ æƒ¯äºæŠŠç»å¸¸å˜åŒ–çš„ä¸€ä¸ªä¸œè¥¿é…åˆ°é…ç½®æ–‡ä»¶é‡Œé¢ã€‚æ¯”å¦‚æŠŠæ•°æ®åº“çš„ä¸€äº›é“¾æ¥åœ°å€ã€è´¦å·ã€å¯†ç åŒ…æ‹¬æ•°æ®åº“è¿æ¥æ± çš„å¤§å°ç­‰ç­‰è¿™äº›å±æ€§é…åˆ°propertiesé…ç½®æ–‡ä»¶é‡Œé¢ï¼Œç„¶åä¸ºäº†æ–¹ä¾¿ , å› ä¸ºæˆ‘ä»¬æœªæ¥å¯èƒ½è¦åˆ›å»ºæ•°æ®åº“è¿æ¥æ± ï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹åˆä¸€ä¸€è§£æåˆ°æˆ‘ä»¬æ•°æ®åº“è¿æ¥æ± (æ¯”å¦‚javaBeanæˆ‘ä»¬è¿™ä¸ªå¯¹è±¡é‡Œé¢)ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™ä¸ªå®ç°åœºæ™¯å°±æ˜¯æŠŠpropertiesé‡Œé¢çš„æ‰€æœ‰é…ç½®ç»‘å®šJavaBeané‡Œé¢ã€‚</p><div class="tabs" id="a3219530-2c0b-448a-a9a1-4dc2982e356b"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a3219530-2c0b-448a-a9a1-4dc2982e356b-1"><i class="fas fa-cat"></i>JavaBean</button></li><li class="tab"><button type="button" data-href="#a3219530-2c0b-448a-a9a1-4dc2982e356b-2"><i class="fas fa-horse"></i>properties</button></li><li class="tab"><button type="button" data-href="#a3219530-2c0b-448a-a9a1-4dc2982e356b-3"><i class="fas fa-dove"></i>æ–¹å¼ä¸€</button></li><li class="tab"><button type="button" data-href="#a3219530-2c0b-448a-a9a1-4dc2982e356b-4"><i class="fas fa-dragon"></i>æ–¹å¼äºŒ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a3219530-2c0b-448a-a9a1-4dc2982e356b-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String brand;</span><br><span class="line">    <span class="keyword">private</span> Integer price;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getBrand</span><span class="params">()</span>&#123;<span class="keyword">return</span> brand;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBrand</span><span class="params">(String brand)</span>&#123;<span class="built_in">this</span>.brand = brand;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getPrice</span><span class="params">()</span>&#123;<span class="keyword">return</span> price;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPrice</span><span class="params">(Integer price)</span>&#123;<span class="built_in">this</span>.price = price;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Car&#123;&quot;</span> + </span><br><span class="line">                <span class="string">&quot;brand = &quot;</span> + brand + <span class="string">&#x27;\&#x27;&#x27;</span> + </span><br><span class="line">                <span class="string">&quot;, price = &quot;</span> + price + </span><br><span class="line">                <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a3219530-2c0b-448a-a9a1-4dc2982e356b-2"><p>å‡è®¾æœ‰é…ç½®æ–‡ä»¶<code>application.properties</code></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mycar.brand</span>=<span class="string">BYD</span></span><br><span class="line"><span class="attr">mycar.price</span>=<span class="string">100000</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a3219530-2c0b-448a-a9a1-4dc2982e356b-3"><p><mark class="hl-label green">@ConfigurationProperties+@Component</mark></p><p>è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚ç”¨äºä¸€äº›è‡ªå®šä¹‰çš„é…ç½®</p><p>ç¼–å†™ä¸€ä¸ªéœ€è¦ç»‘å®šå±æ€§çš„Carç±»,ç„¶ååœ¨Carä¸Šä½¿ç”¨è¿™ä¸¤ä¸ªæ³¨è§£ï¼Œprefixçš„å€¼ä¸é…ç½®æ–‡ä»¶ä¸­çš„é¦–ä¸ªå€¼å¯¹åº”ï¼ˆå¯éšæ„å‘½åï¼‰ï¼›åªæœ‰å°†beanæ”¾å…¥åˆ°Springå®¹å™¨ä¸­ï¼Œæ‰èƒ½ä½¿ç”¨SpringBootçš„å¼ºå¤§å·¥ç¨‹ï¼Œå› ä¸ºå¿…é¡»è¦ä½¿ç”¨@Componentå°†å…¶æ³¨å…¥åˆ°å®¹å™¨ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;mycar&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a3219530-2c0b-448a-a9a1-4dc2982e356b-4"><p><mark class="hl-label blue">@ConfigurationProperties+@EnableConfigurationProperties</mark></p><p>è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚ç”¨äºå¼•å…¥ç¬¬ä¸‰æ–¹ç»„ä»¶çš„æ—¶å€™ï¼Œå¦‚æœå¼•å…¥è¿™ä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶å¹¶æ²¡æœ‰ä½¿ç”¨@Componentæ³¨è§£å°†å…¶æ³¨å…¥åˆ°å®¹å™¨ä¸­</p><p>è¿™ç§æ–¹å¼é€šå¸¸æ˜¯å€ŸåŠ©ä¸ä¸€ä¸ªé…ç½®ç±»æ¥å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableConfigurationProperties(Car.class)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;mycar&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="2-è£…é…åŸç†">2. è£…é…åŸç†</h2><p>è‡ªåŠ¨è£…é…ï¼Œç®€å•æ¥è¯´å°±æ˜¯è‡ªåŠ¨æŠŠç¬¬ä¸‰æ–¹ç»„ä»¶çš„Beanè£…è½½åˆ°Spring IOCå™¨é‡Œé¢ï¼Œä¸éœ€è¦å¼€å‘äººå‘˜å†å»å†™Beançš„è£…é…é…ç½®ã€‚</p><p>åœ¨Spring Bootåº”ç”¨é‡Œé¢ï¼Œåªéœ€è¦åœ¨å¯åŠ¨ç±»åŠ ä¸Š<code>@SpringBootApplication</code>æ³¨è§£å°±å¯ä»¥å®ç°è‡ªåŠ¨è£…é…ã€‚<span class='p green'>@SpringBootApplicationæ˜¯ä¸€ä¸ªå¤åˆæ³¨è§£ï¼ŒçœŸæ­£å®ç°è‡ªåŠ¨è£…é…çš„æ³¨è§£æ˜¯ @EnableAutoConfigurationã€‚</span>è‡ªåŠ¨è£…é…çš„å®ç°ä¸»è¦ä¾é ä¸‰ä¸ªæ ¸å¿ƒå…³é”®æŠ€æœ¯ã€‚</p><ol><li><p>å¼•å…¥Starterå¯åŠ¨ä¾èµ–ç»„ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªç»„ä»¶é‡Œé¢å¿…é¡»è¦åŒ…å«<code>@Configurationé…ç½®ç±»</code>ï¼Œåœ¨è¿™ä¸ªé…ç½®ç±»é‡Œé¢é€šè¿‡@Beanæ³¨è§£å£°æ˜éœ€è¦è£…é…åˆ°IOCå®¹å™¨çš„Beanå¯¹è±¡ã€‚</p></li><li><p>è¿™ä¸ªé…ç½®ç±»æ˜¯æ”¾åœ¨ç¬¬ä¸‰æ–¹çš„jaråŒ…é‡Œé¢ï¼Œç„¶åé€šè¿‡SpringBootä¸­çš„<code>çº¦å®šä¼˜äºé…ç½®æ€æƒ³</code>ï¼ŒæŠŠè¿™ä¸ªé…ç½®ç±»çš„å…¨è·¯å¾„æ”¾åœ¨<code>classpath:/META-INF/spring.factories</code>æ–‡ä»¶ä¸­ã€‚è¿™æ ·SpringBootå°±å¯ä»¥çŸ¥é“ç¬¬ä¸‰æ–¹jaråŒ…é‡Œé¢çš„é…ç½®ç±»çš„ä½ç½®ï¼Œè¿™ä¸ªæ­¥éª¤ä¸»è¦æ˜¯ç”¨åˆ°äº†Springé‡Œé¢çš„SpringFactoriesLoaderæ¥å®Œæˆçš„ã€‚</p></li><li><p>SpringBootæ‹¿åˆ°æ‰€ç¬¬ä¸‰æ–¹jaråŒ…é‡Œé¢å£°æ˜çš„é…ç½®ç±»ä»¥åï¼Œå†é€šè¿‡Springæä¾›çš„<code>ImportSelector</code>æ¥å£ï¼Œå®ç°å¯¹è¿™äº›é…ç½®ç±»çš„åŠ¨æ€åŠ è½½ã€‚</p></li></ol><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501155237141.png" alt="image-20230501155237141" style="zoom:67%;" /><p><code>@SpringBootApplication</code>æ³¨è§£æ˜¯ <code>@SpringBootConfiguration</code>ã€<code>@EnableAutoConfiguration</code>ã€<code>@ComponentScan</code> æ³¨è§£çš„é›†åˆ</p><h3 id="2-1-SpringBootConfiguration">2.1 @SpringBootConfiguration</h3><p>ä»£è¡¨æ˜¯ä¸€ä¸ªé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringBootConfiguration &#123;</span><br><span class="line"><span class="meta">@AliasFor(annotation = Configuration.class)</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">proxyBeanMethods</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-2-ComponentScan">2.2 @ComponentScan</h3><p>é»˜è®¤æ‰«æå½“å‰ç±»æ‰€åœ¨åŒ…åŠå…¶å­çº§åŒ…ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><p>åœ¨<code>ConfigurationClassParser#doProcessConfigurationClass</code>å¼€å§‹ComponentScan</p><p><code>Set&lt;BeanDefinitionHolder&gt; scannedBeanDefinitions =        this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());</code></p><div class="tabs" id="657de342-5735-44c4-a46e-14abe8543c80"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#657de342-5735-44c4-a46e-14abe8543c80-1"><i class="fas fa-cat"></i>basePackagesè®¾ç½®</button></li><li class="tab"><button type="button" data-href="#657de342-5735-44c4-a46e-14abe8543c80-2"><i class="fas fa-horse"></i>æ‰«æä½ç½®</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="657de342-5735-44c4-a46e-14abe8543c80-1"><p>æŸ¥çœ‹æºç <code>ComponentScanAnnotationParser#parse</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (basePackages.isEmpty()) &#123;</span><br><span class="line">basePackages.add(ClassUtils.getPackageName(declaringClass));</span><br><span class="line">&#125;</span><br><span class="line">  scanner.doScan(StringUtils.toStringArray(basePackages));</span><br></pre></td></tr></table></figure><p>basePackagesè®¾ç½®çš„æ­£æ˜¯å¯åŠ¨ç±»</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501184021671.png" alt="image-20230501184021671" style="zoom:50%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="657de342-5735-44c4-a46e-14abe8543c80-2"><p>æŸ¥çœ‹æºç <code>ClassPathScanningCandidateComponentProvider#scanCandidateComponents</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">packageSearchPath</span> <span class="operator">=</span> ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX +</span><br><span class="line">resolveBasePackage(basePackage) + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">this</span>.resourcePattern;</span><br><span class="line">Resource[] resources = getResourcePatternResolver().getResources(packageSearchPath);</span><br></pre></td></tr></table></figure><p>packageSearchPathè¢«è®¾å®šä¸º<code>&quot;classpath*:com/atguigu/boot/**/*.class&quot;</code>ï¼Œå¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>@ComponentScanå’Œ@EnableAutoConfigurationæ¯”è¾ƒ</p></blockquote><div class="tabs" id="7d3c7868-8dd3-400f-908b-d10e2e8e170b"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#7d3c7868-8dd3-400f-908b-d10e2e8e170b-1"><i class="fas fa-cat"></i>ä½œç”¨ä¸åŒ</button></li><li class="tab"><button type="button" data-href="#7d3c7868-8dd3-400f-908b-d10e2e8e170b-2"><i class="fas fa-horse"></i>æ‰«æèŒƒå›´ä¸åŒ</button></li><li class="tab"><button type="button" data-href="#7d3c7868-8dd3-400f-908b-d10e2e8e170b-3"><i class="fas fa-dove"></i>æ‰«æç›®çš„ä¸åŒ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="7d3c7868-8dd3-400f-908b-d10e2e8e170b-1"><ul><li>@ComponentScanæ³¨è§£ç”¨äºæŒ‡å®šè¦æ‰«æçš„åŒ…åŠå…¶å­åŒ…ä¸­å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„ç±»(@Controller,@Service,@Respority,@Component)ï¼Œå¹¶å°†è¿™äº›ç±»æ³¨å†Œåˆ°Springçš„IOCå®¹å™¨ä¸­ã€‚</li><li>@EnableAutoConfigurationæ³¨è§£ç”¨äºå¯ç”¨Spring Bootçš„è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œæ ¹æ®classpathä¸‹çš„jaråŒ…ã€é…ç½®æ–‡ä»¶ç­‰ä¿¡æ¯ï¼Œè‡ªåŠ¨é…ç½®åº”ç”¨ç¨‹åºæ‰€éœ€çš„beanå’Œå…¶ä»–ç»„ä»¶ã€‚è€Œspring.factoriesæ–‡ä»¶ï¼Œåˆ™æ˜¯ç”¨æ¥è®°å½•é¡¹ç›®åŒ…å¤–éœ€è¦æ³¨å†Œçš„beanç±»åã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7d3c7868-8dd3-400f-908b-d10e2e8e170b-2"><ul><li>@ComponentScanæ³¨è§£åªæ‰«ææŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸­å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„ç±»ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ã€‚</li><li>@EnableAutoConfigurationæ³¨è§£ä¼šæ‰«æclasspathä¸‹çš„æ‰€æœ‰jaråŒ…ï¼Œå¹¶è‡ªåŠ¨é…ç½®åº”ç”¨ç¨‹åºæ‰€éœ€çš„beanå’Œå…¶ä»–ç»„ä»¶ã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7d3c7868-8dd3-400f-908b-d10e2e8e170b-3"><ul><li>@ComponentScanæ³¨è§£çš„ç›®çš„æ˜¯å°†æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸­å¸¦æœ‰ç‰¹å®šæ³¨è§£çš„ç±»æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ã€‚</li><li>@EnableAutoConfigurationæ³¨è§£çš„ç›®çš„æ˜¯æ ¹æ®åº”ç”¨ç¨‹åºçš„classpathã€jaråŒ…å’Œé…ç½®æ–‡ä»¶ç­‰ä¿¡æ¯ï¼Œè‡ªåŠ¨é…ç½®åº”ç”¨ç¨‹åºæ‰€éœ€çš„beanå’Œå…¶ä»–ç»„ä»¶ã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="2-3-SPIæœºåˆ¶">2.3 SPIæœºåˆ¶</h3><p>SPIï¼šService Provider Interface</p><p>æœåŠ¡æä¾›è€…æ¥å£ï¼Œå­¦åä¸ºæœåŠ¡å‘ç°æœºåˆ¶ï¼Œå®ƒé€šè¿‡åœ¨ClassPathè·¯å¾„ä¸‹çš„<code>META-INF/services</code>æ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨åŠ è½½æ–‡ä»¶é‡Œæ‰€å®šä¹‰çš„ç±»ã€‚</p><blockquote><p>æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä¸ç”¨è¡Œä¸è¡Œï¼Ÿåˆ°åº•ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä½•è¢«å¹æ§çš„å¦‚æ­¤å‰å®³ï¼Ÿ</p></blockquote><mark class="hl-label blue">åˆ—ä¸¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šJavaä¸­è¿æ¥æ•°æ®åº“</mark> <div class="tabs" id="43c90029-eada-4f12-a525-da2ed38ed50b"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#43c90029-eada-4f12-a525-da2ed38ed50b-1"><i class="fas fa-cat"></i>å­˜åœ¨é—®é¢˜</button></li><li class="tab"><button type="button" data-href="#43c90029-eada-4f12-a525-da2ed38ed50b-2"><i class="fas fa-horse"></i>è§£å†³æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="43c90029-eada-4f12-a525-da2ed38ed50b-1"><p>åœ¨é¡¹ç›®ä¸­æˆ‘ä»¬é€šè¿‡JDBCï¼Œå‘æ•°æ®åº“å‘é€å‘½ä»¤å»æ‰§è¡Œï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯ï¼Œå…ˆåŠ è½½æ•°æ®åº“é©±åŠ¨ï¼Œç„¶åé€šè¿‡driverManagerå¯¹è±¡è·å–connectionè¿æ¥å¯¹è±¡ï¼Œå†åˆ›å»ºStatementæ‰§è¡ŒSQLè¯­å¥ï¼Œæœ€åå†å¤„ç†ç»“æœé›†ã€‚è€Œä¸åŒçš„æ•°æ®åº“é©±åŠ¨ç”±ä¸åŒçš„æ•°æ®åº“å‚å•†æä¾›ï¼Œæ¯”å¦‚ MySQLé©±åŠ¨ï¼ŒOracleé©±åŠ¨ï¼Œ SQL Serveré©±åŠ¨æˆ–è€…ä¸€äº›å…¶å®ƒé©±åŠ¨ã€‚ä½†ç°åœ¨æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œjavaä¸­æä¾›çš„é©±åŠ¨æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œå…·ä½“çš„å®ç°ç±»æ˜¯ç”±å„ä¸ªæ•°æ®åº“å‚å•†æä¾›çš„ï¼Œè€Œæ¥å£æ˜¯ä¸å¯ä»¥è¿›è¡Œå®ä¾‹åŒ–çš„ï¼Œå½“ä½ è¦å®ä¾‹åŒ–ä¸€ä¸ªæ¥å£æ—¶å¿…é¡»å¾—çŸ¥é“è¿™ä¸ªæ¥å£çš„å…¨é™å®šåã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501150254996.png" alt="image-20230501150254996" style="zoom: 60%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="43c90029-eada-4f12-a525-da2ed38ed50b-2"><p>å…¶å®éœ€è¦è§£å†³çš„æ ¹æœ¬é—®é¢˜æ˜¯ï¼šä½ å¾—å‘Šè¯‰æˆ‘è¿™ä¸ªæ¥å£å®ç°ç±»çš„å…¨é™å®šåï¼Œç„¶åå°±å¯ä»¥é€šè¿‡åå°„æˆ–è€…å…¶å®ƒçš„æ–¹å¼ï¼Œæ„é€ å‡ºè¿™ä¸ªæ¥å£çš„å®ä¾‹è¿›è€Œå°±å¯ä»¥è°ƒç”¨å…·ä½“çš„æ–¹æ³•ã€‚</p><p>äºæ˜¯ java å¼€å‘è€…ä»¬æƒ³äº†è¿™æ ·ä¸€ç§æ–¹æ³•ï¼Œåœ¨é¡¹ç›®ä¸‹çš„ ClassPathç›®å½•ä¸­åˆ›å»º<code>META-INF/services</code>æ–‡ä»¶,å¹¶åœ¨è¿™ä¸ªé‡Œé¢åˆ›å»ºä»¥æ¥å£åä¸ºæ–‡ä»¶åä»¥å®ç°ç±»å…¨é™å®šåä¸ºæ–‡ä»¶å†…å®¹çš„æ–‡ä»¶,ç„¶åå°±å¯ä»¥é€šè¿‡IOè·å–åˆ°æ‰€æœ‰çš„å…¨é™å®šåã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡IOè·å–åˆ°æ‰€æœ‰çš„å…¨é™å®šå</span></span><br><span class="line">List&lt;String&gt; calssNameList = IoUtil.spiLoad(Driver.class)ï¼›</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªå®¹å™¨å­˜å‚¨å®ä¾‹</span></span><br><span class="line">List&lt;Driver&gt; providers = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//å¾ªç¯éå†ï¼Œå°†classå®ä¾‹åŒ–ï¼Œå¹¶æ·»åŠ åˆ°å®¹å™¨ä¸­</span></span><br><span class="line"><span class="keyword">for</span> (String className : calssNameList) &#123;</span><br><span class="line">    Class&lt;?&gt; c = Class.forName(className);</span><br><span class="line">    providers.add(c.newInstance());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501151440654.png" alt="image-20230501151440654" style="zoom: 60%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>SPIè¿™ç§æ–¹å¼å°±å¯ä»¥å¾ˆå¥½çš„è§£å†³ä¸åŒæ¡†æ¶ä¹‹é—´çš„æ‰©å±•é—®é¢˜ã€‚åœ¨<code>java.util.ServiceLoader#load(Class clazz)</code>å®Œæˆäº†spiçš„å®ç°ï¼Œå…·ä½“çš„æ€è·¯è·Ÿä¸Šè¿°æµç¨‹ç±»ä¼¼ã€‚</p><mark class="hl-label green">SPIçš„å˜ç§ï¼šSpringBootè‡ªåŠ¨è£…é…åŸç†</mark> <div class="tabs" id="d2bb1a0b-4b17-4fe7-a714-daafc0259d37"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#d2bb1a0b-4b17-4fe7-a714-daafc0259d37-1"><i class="fas fa-bug"></i>å­˜åœ¨é—®é¢˜</button></li><li class="tab"><button type="button" data-href="#d2bb1a0b-4b17-4fe7-a714-daafc0259d37-2"><i class="fas fa-cannabis"></i>è§£å†³æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="d2bb1a0b-4b17-4fe7-a714-daafc0259d37-1"><p>åœ¨ä¸€ä¸ªSpringBooté¡¹ç›®ä¸­è‚¯å®šä¼šä¾èµ–ä¸€äº›å…¶å®ƒæ¡†æ¶ï¼Œæ¯”å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„mybatis-plusæ¡†æ¶è€ŒStringBooté»˜è®¤ä¼šå°†å½“å‰åŒ…åŠå…¶å­åŒ…ä¸‹çš„beanæ³¨å…¥åˆ°iocä¸­ã€‚ä½†æ­¤æ—¶å¦‚æœå…¶å®ƒæ¡†æ¶éœ€è¦å°†beanæ³¨å…¥åˆ°iocä¸­ã€‚å› ä¸ºåŒ…åæ˜¯ä¸æƒ³åŒçš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ‰«ææ³¨å…¥ã€‚è€Œä¸”åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­ï¼Œè¦å’Œé¡¹ç›®å°½å¯èƒ½çš„è§£è€¦ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501153354655.png" alt="image-20230501153354655" style="zoom: 67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d2bb1a0b-4b17-4fe7-a714-daafc0259d37-2"><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSpringBoot å‚è€ƒäº†spiæœºåˆ¶çš„è®¾è®¡æ€æƒ³ï¼šè§„å®šäº†åœ¨ classPathç›®å½•ä¸‹<code>META-INF</code>æ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰<code>spring.factories</code>çš„æ–‡ä»¶,åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ä¼šéå†æ‰€æœ‰jaråŒ…ä¸‹çš„<code>spring.factories</code>æ–‡ä»¶,è¿™æ ·å°±å¯ä»¥å°†spring.factoriesæ–‡ä»¶ä¸­å®šä¹‰çš„ç±»,åŠ è½½åˆ° ioc ä¸­ã€‚</p><div class="fj-gallery"><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501154019068.png" alt="image-20230501154019068" style="zoom:45%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230501154035913.png" alt="image-20230501154035913" style="zoom:45%;" />          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>æ€»ç»“</p><ol><li><p>SPIæœºåˆ¶èƒ½å¤Ÿä½¿æ¥å£ä¸å…·ä½“çš„å®ç°ç±»è§£è€¦ï¼Œå¯ä»¥æ ¹æ®å®é™…çš„ä¸šåŠ¡æƒ…å†µå¯ç”¨æˆ–æ›¿æ¢å…·ä½“ç»„ä»¶ã€‚</p></li><li><p>SPIæœºåˆ¶ä¸ºå¾ˆå¤šæ¡†æ¶çš„æ‰©å±•æä¾›äº†å¯èƒ½ã€‚</p></li><li><p>SPIæœºåˆ¶æ›´å¤šçš„æ˜¯ä¸€ç§æ€æƒ³ã€‚</p></li></ol><hr><h3 id="2-4-EnableAutoConfiguration">2.4 @EnableAutoConfiguration</h3><p>å¯ç”¨ SpringBoot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfigurationPackage</span></span><br><span class="line"><span class="meta">@Import(&#123;AutoConfigurationImportSelector.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableAutoConfiguration &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">ENABLED_OVERRIDE_PROPERTY</span> <span class="operator">=</span> <span class="string">&quot;spring.boot.enableautoconfiguration&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt;[] exclude() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    String[] excludeName() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@EnableAutoConfiguration</code>æ³¨è§£æ˜¯ <code>@AutoConfigurationPackage</code>ã€<code>@Import(&#123;AutoConfigurationImportSelector.class&#125;)</code> æ³¨è§£çš„é›†åˆ</p><p><code>@AutoConfigurationPackage</code>æ³¨è§£çš„ä½œç”¨æ˜¯å°†ä½¿ç”¨äº†@SpringBootApplicationæ³¨è§£çš„ç±»æ‰€åœ¨çš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ä½¿ç”¨äº†@Configurationæ³¨è§£çš„ç±»éƒ½çº³å…¥åˆ°Spring Bootè‡ªåŠ¨é…ç½®çš„æ‰«æèŒƒå›´å†…ï¼Œä»è€Œè®©è¿™äº›ç±»çš„Beanå®šä¹‰èƒ½å¤Ÿè¢«è‡ªåŠ¨è£…é…ã€‚</p><p>è€Œ<code>@Import(AutoConfigurationImportSelector.class)</code>æ³¨è§£çš„ä½œç”¨åˆ™æ˜¯å°†Spring Booté»˜è®¤çš„è‡ªåŠ¨é…ç½®ç±»å¼•å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œè¿™äº›è‡ªåŠ¨é…ç½®ç±»éƒ½æ˜¯ä½¿ç”¨@Configurationæ³¨è§£æ ‡æ³¨çš„ï¼Œé€šè¿‡è‡ªåŠ¨æ‰«æå’Œæ¡ä»¶åŒ–é…ç½®çš„æ–¹å¼ï¼Œæ ¹æ®ç”¨æˆ·çš„é…ç½®å’Œç¯å¢ƒæ¥é€‰æ‹©æ€§åœ°å°†ç‰¹å®šçš„Beanå®šä¹‰æ³¨å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œä»¥æ»¡è¶³åº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚</p><div class="tabs" id="a10aab32-5823-4cb0-a142-4f021b92d486"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a10aab32-5823-4cb0-a142-4f021b92d486-1"><i class="fas fa-bug"></i>AutoConfigurationPackage</button></li><li class="tab"><button type="button" data-href="#a10aab32-5823-4cb0-a142-4f021b92d486-2"><i class="fas fa-cannabis"></i>â­ï¸Import({AutoConfigurationImportSelector.class})</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a10aab32-5823-4cb0-a142-4f021b92d486-1"><p>æ ‡ç­¾åç›´è¯‘ä¸ºï¼šè‡ªåŠ¨é…ç½®åŒ…ï¼ŒæŒ‡å®šäº†é»˜è®¤çš„åŒ…è§„åˆ™ã€‚å°†æŒ‡å®šçš„åŒ…åæ³¨å†Œä¸ºSpring Bootè‡ªåŠ¨é…ç½®çš„åŸºæœ¬åŒ…ï¼Œä»è€Œä½¿Spring Bootè‡ªåŠ¨é…ç½®åŠŸèƒ½èƒ½å¤Ÿæ‰«æåˆ°è¿™ä¸ªåŒ…ä¸­çš„æ‰€æœ‰é…ç½®ç±»ã€‚</p><p>ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨é…ç½®åŒ…å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºSpring Bootè‡ªåŠ¨é…ç½®æœºåˆ¶æ˜¯é€šè¿‡åœ¨è‡ªåŠ¨é…ç½®åŒ…åŠå…¶å­åŒ…ä¸­æŸ¥æ‰¾æ ‡æ³¨äº†@Configurationæ³¨è§£çš„ç±»ï¼Œå¹¶è§£æå…¶ä¸­çš„@Beanæ³¨è§£æ¥å®ç°çš„ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šè‡ªåŠ¨é…ç½®åŒ…ï¼ŒSpring Bootå°±æ— æ³•ç¡®å®šåº”è¯¥åœ¨å“ªäº›åŒ…ä¸­æŸ¥æ‰¾è‡ªåŠ¨é…ç½®ç±»ã€‚è€ŒæŒ‡å®šè‡ªåŠ¨é…ç½®åŒ…ï¼Œå°±å¯ä»¥è®©Spring Bootè‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…åŠå…¶å­åŒ…ä¸­çš„æ‰€æœ‰é…ç½®ç±»ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œæ¡ä»¶åŒ–è£…é…ï¼Œä»è€Œå®ç°è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(AutoConfigurationPackages.Registrar.class)</span><span class="comment">// åˆ©ç”¨ Registrar ç»™å®¹å™¨ä¸­å¯¼å…¥ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AutoConfigurationPackage &#123; </span><br><span class="line">String[] basePackages() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    Class&lt;?&gt;[] basePackageClasses() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Registrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span>, DeterminableImports &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata metadata, BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">register(registry, <span class="keyword">new</span> <span class="title class_">PackageImports</span>(metadata).getPackageNames().toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Set&lt;Object&gt; <span class="title function_">determineImports</span><span class="params">(AnnotationMetadata metadata)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> Collections.singleton(<span class="keyword">new</span> <span class="title class_">PackageImports</span>(metadata));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430162512630.png" alt="image-20230430162512630" style="zoom: 50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(BeanDefinitionRegistry registry, String... packageNames)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">BEAN</span> <span class="operator">=</span> AutoConfigurationPackages.class.getName();</span><br><span class="line">    <span class="keyword">if</span> (registry.containsBeanDefinition(BEAN)) &#123;</span><br><span class="line">        <span class="type">BeanDefinition</span> <span class="variable">beanDefinition</span> <span class="operator">=</span> registry.getBeanDefinition(BEAN);</span><br><span class="line">        <span class="type">ConstructorArgumentValues</span> <span class="variable">constructorArguments</span> <span class="operator">=</span> beanDefinition.getConstructorArgumentValues();</span><br><span class="line">        constructorArguments.addIndexedArgumentValue(<span class="number">0</span>, addBasePackages(constructorArguments, packageNames));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">GenericBeanDefinition</span> <span class="variable">beanDefinition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericBeanDefinition</span>();</span><br><span class="line">        beanDefinition.setBeanClass(AutoConfigurationPackages.BasePackages.class);</span><br><span class="line">        beanDefinition.getConstructorArgumentValues().addIndexedArgumentValue(<span class="number">0</span>, packageNames);</span><br><span class="line">        beanDefinition.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);</span><br><span class="line">        registry.registerBeanDefinition(BEAN, beanDefinition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰“æ–­ç‚¹å¾—çŸ¥ï¼Œ<code>packageNames</code>ä¼ çš„å°±æ˜¯å¯åŠ¨ç±»æ‰€åœ¨çš„åŒ…åï¼Œç„¶åè¿™ä¸ªæ–¹æ³•å°±æ˜¯åˆ¤æ–­å®¹å™¨æ˜¯å¦æ³¨å…¥äº†<code>BasePackagesBeanDefinition</code>ã€‚å¦‚æœæ³¨å…¥äº†å°±ä»å®¹å™¨è·å–ï¼Œå¹¶å°†åŒ…åèµ‹å€¼ç»™ä»–çš„<code>basePackages</code>å±æ€§ï¼Œç„¶åæ‰§è¡Œè¿™å—çš„æ—¶å€™å…¶å®æ˜¯å¹¶æ²¡æœ‰æ³¨å†Œçš„ï¼Œæ‰€ä»¥ç›´æ¥æ‰§è¡Œelseã€‚elseå°±æ˜¯ç›´æ¥åˆ›å»ºä¸€ä¸ª<code>BasePackagesBeanDefinition</code>å¯¹è±¡ï¼Œç„¶åå°†åŒ…åèµ‹å€¼ç»™ä»–çš„<code>basePackages</code>å±æ€§ã€‚</p><p><code>basePackages</code>æ˜¯ä¸ªseté›†åˆï¼Œä½†æ˜¯å®¹å™¨å½“ä¸­å§‹ç»ˆåªæœ‰ä¸€ä¸ª<code>BasePackagesBeanDefinition</code>å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åªè¦ä»£ç å½“ä¸­æ·»åŠ <code>@AutoConfigurationPackage</code>æ³¨è§£ï¼Œå°±ä¼šå°†æ³¨è§£æ‰€åœ¨çš„åŒ…åæ·»åŠ åˆ°<code>basePackages</code>é›†åˆå½“ä¸­ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a10aab32-5823-4cb0-a142-4f021b92d486-2"><p>AutoConfigurationImportSelectorç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isEnabled(annotationMetadata)) &#123;</span><br><span class="line">        <span class="keyword">return</span> NO_IMPORTS;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç»™å®¹å™¨ä¸­å¯¼å…¥ç»„ä»¶</span></span><br><span class="line">    <span class="type">AutoConfigurationEntry</span> <span class="variable">autoConfigurationEntry</span> <span class="operator">=</span> getAutoConfigurationEntry(annotationMetadata);</span><br><span class="line">    <span class="keyword">return</span> StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> AutoConfigurationEntry <span class="title function_">getAutoConfigurationEntry</span><span class="params">(AnnotationMetadata annotationMetadata)</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœè‡ªåŠ¨é…ç½®æ²¡æœ‰å¯ç”¨ï¼Œåˆ™è¿”å›ç©ºçš„AutoConfigurationEntryå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">if</span> (!isEnabled(annotationMetadata)) &#123;</span><br><span class="line">        <span class="keyword">return</span> EMPTY_ENTRY;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è·å–æ³¨è§£å±æ€§</span></span><br><span class="line">    <span class="type">AnnotationAttributes</span> <span class="variable">attributes</span> <span class="operator">=</span> getAttributes(annotationMetadata);</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå¹¶å»é™¤é‡å¤</span></span><br><span class="line">    List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);</span><br><span class="line">    configurations = removeDuplicates(configurations);</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰æ’é™¤çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨é‡å¤</span></span><br><span class="line">    Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);</span><br><span class="line">    checkExcludedClasses(configurations, exclusions);</span><br><span class="line">    <span class="comment">// ä»å€™é€‰çš„è‡ªåŠ¨é…ç½®ç±»ä¸­ç§»é™¤æ‰€æœ‰æ’é™¤çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå¹¶è¿‡æ»¤æ‰ä¸ç¬¦åˆæ¡ä»¶çš„è‡ªåŠ¨é…ç½®ç±»</span></span><br><span class="line">    configurations.removeAll(exclusions);</span><br><span class="line">    configurations = getConfigurationClassFilter().filter(configurations);</span><br><span class="line">    <span class="comment">// è§¦å‘è‡ªåŠ¨é…ç½®å¯¼å…¥äº‹ä»¶ï¼Œé€šçŸ¥æ‰€æœ‰è‡ªåŠ¨é…ç½®å¯¼å…¥ç›‘å¬å™¨è‡ªåŠ¨é…ç½®çš„æƒ…å†µ</span></span><br><span class="line">    fireAutoConfigurationImportEvents(configurations, exclusions);</span><br><span class="line">    <span class="comment">// åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªAutoConfigurationEntryå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«åº”ç”¨çš„è‡ªåŠ¨é…ç½®ç±»å’Œæ’é™¤çš„è‡ªåŠ¨é…ç½®ç±»</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AutoConfigurationEntry</span>(configurations, exclusions);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€åˆ©ç”¨<code>getAutoConfigurationEntry(annotationMetadata);</code>ç»™å®¹å™¨ä¸­æ‰¹é‡å¯¼å…¥ä¸€äº›ç»„ä»¶<br>2ã€è°ƒç”¨<code>List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes)</code>è·å–åˆ°æ‰€æœ‰éœ€è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„é…ç½®ç±»<br>3ã€åˆ©ç”¨å·¥å‚åŠ è½½ <code>Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(@Nullable ClassLoader classLoader)ï¼›</code>å¾—åˆ°æ‰€æœ‰çš„ç»„ä»¶<br>4ã€ä»<code>META-INF/spring.factories</code>ä½ç½®æ¥åŠ è½½ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p>é»˜è®¤æ‰«æjaråŒ…é‡Œé¢æ‰€æœ‰META-INF/spring.factoriesä½ç½®çš„æ–‡ä»¶</p><p>spring-boot-autoconfigure-2.3.4.RELEASE.jaråŒ…é‡Œé¢ä¹Ÿæœ‰META-INF/spring.factoriesï¼Œæ–‡ä»¶é‡Œé¢å†™æ­»äº†spring-bootä¸€å¯åŠ¨å°±è¦ç»™å®¹å™¨ä¸­åŠ è½½çš„æ‰€æœ‰é…ç½®ç±»</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/SpringBoot-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png" style="zoom:50%;" /><blockquote><p>ç­›é€‰å‰size=130 vsç­›é€‰åsize=26</p></blockquote><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430172712413.png" alt="image-20230430172712413" style="zoom: 25%;" /><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430172756327.png" alt="image-20230430172756327" style="zoom: 25%;" /><p>è™½ç„¶æˆ‘ä»¬127ä¸ªåœºæ™¯çš„æ‰€æœ‰è‡ªåŠ¨é…ç½®å¯åŠ¨çš„æ—¶å€™é»˜è®¤å…¨éƒ¨åŠ è½½ã€‚xxxxAutoConfiguration<br>æŒ‰ç…§æ¡ä»¶è£…é…è§„åˆ™ï¼ˆ@Conditionalï¼‰ï¼Œæœ€ç»ˆä¼šæŒ‰éœ€é…ç½®ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430174625456.png" alt="image-20230430174625456" style="zoom:50%;" /><ul><li></li></ul><p>ä»¥DispatcherServletAutoConfigurationä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)</span> <span class="comment">// æŒ‡å®šè¯¥è‡ªåŠ¨é…ç½®ç±»çš„é¡ºåºï¼Œä¼˜å…ˆçº§æœ€é«˜</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span> <span class="comment">// å£°æ˜è¯¥ç±»æ˜¯ä¸€ä¸ªSpringé…ç½®ç±»ï¼Œä¸ä½¿ç”¨ä»£ç†beançš„æ–¹å¼</span></span><br><span class="line"><span class="meta">@ConditionalOnWebApplication(type = ConditionalOnWebApplication.Type.SERVLET)</span> <span class="comment">// ä»…åœ¨Webåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(DispatcherServlet.class)</span> <span class="comment">// ä»…å½“ç±»è·¯å¾„ä¸­å­˜åœ¨æŒ‡å®šçš„ç±»DispatcherServletæ—¶æ‰åº”ç”¨æ­¤é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter(ServletWebServerFactoryAutoConfiguration.class)</span> <span class="comment">// åœ¨ServletWebServerFactoryAutoConfigurationè‡ªåŠ¨é…ç½®ä¹‹ååº”ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServletAutoConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line">    <span class="meta">@Conditional(org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration.DefaultDispatcherServletCondition.class)</span></span><br><span class="line">    <span class="meta">@ConditionalOnClass(ServletRegistration.class)</span></span><br><span class="line">    <span class="meta">@EnableConfigurationProperties(WebMvcProperties.class)</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DispatcherServletConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean(name = &quot;dispatcherServlet&quot;)</span></span><br><span class="line">        <span class="keyword">public</span> DispatcherServlet <span class="title function_">dispatcherServlet</span><span class="params">(WebMvcProperties webMvcProperties)</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªDispatcherServletå¯¹è±¡</span></span><br><span class="line">            <span class="type">DispatcherServlet</span> <span class="variable">dispatcherServlet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DispatcherServlet</span>();</span><br><span class="line">            <span class="comment">// é…ç½®DispatcherServletå±æ€§</span></span><br><span class="line">            dispatcherServlet.setDispatchOptionsRequest(webMvcProperties.isDispatchOptionsRequest());</span><br><span class="line">            dispatcherServlet.setDispatchTraceRequest(webMvcProperties.isDispatchTraceRequest());</span><br><span class="line">            dispatcherServlet.setThrowExceptionIfNoHandlerFound(webMvcProperties.isThrowExceptionIfNoHandlerFound());</span><br><span class="line">            dispatcherServlet.setPublishEvents(webMvcProperties.isPublishRequestHandledEvents());</span><br><span class="line">            dispatcherServlet.setEnableLoggingRequestDetails(webMvcProperties.isLogRequestDetails());</span><br><span class="line">            <span class="keyword">return</span> dispatcherServlet; <span class="comment">// è¿”å›DispatcherServletå¯¹è±¡</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="meta">@ConditionalOnBean(MultipartResolver.class)</span> <span class="comment">// å®¹å™¨ä¸­æœ‰è¿™ä¸ªç±»å‹çš„ç»„ä»¶</span></span><br><span class="line">        <span class="meta">@ConditionalOnMissingBean(name = &quot;multipartResolver&quot;)</span> <span class="comment">//å®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªåå­—multipartResolverçš„ç»„ä»¶  </span></span><br><span class="line">        <span class="keyword">public</span> MultipartResolver <span class="title function_">multipartResolver</span><span class="params">(MultipartResolver resolver)</span> &#123;</span><br><span class="line">            <span class="comment">// å½“å®¹å™¨ä¸­å­˜åœ¨MultipartResolverå¯¹è±¡ä¸”æ²¡æœ‰æŒ‡å®šåå­—ä¸ºDispatcherServlet.MULTIPART_RESOLVER_BEAN_NAMEæ—¶ï¼Œè¿”å›è¯¥å¯¹è±¡</span></span><br><span class="line">            <span class="comment">// ä¸»è¦ç”¨äºæ£€æµ‹ç”¨æˆ·æ˜¯å¦å·²åˆ›å»ºä¸€ä¸ªMultipartResolverä½†åç§°ä¸æ­£ç¡®</span></span><br><span class="line">            <span class="keyword">return</span> resolver;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>SpringBooté»˜è®¤ä¼šåœ¨åº•å±‚é…å¥½æ‰€æœ‰çš„ç»„ä»¶ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·è‡ªå·±é…ç½®äº†ä»¥ç”¨æˆ·çš„ä¼˜å…ˆ</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>Spring Boot é€šè¿‡ <code>@EnableAutoConfiguration</code> å¼€å¯è‡ªåŠ¨è£…é…ï¼Œé€šè¿‡ SpringFactoriesLoader åŠ è½½ <code>META-INF/spring.factories</code> ä¸­çš„è‡ªåŠ¨é…ç½®ç±»å®ç°è‡ªåŠ¨è£…é…ï¼Œè‡ªåŠ¨é…ç½®ç±»å…¶å®å°±æ˜¯é€šè¿‡ <code>@Conditional</code> æ³¨è§£æŒ‰éœ€åŠ è½½çš„é…ç½®ç±»ï¼Œæƒ³è¦å…¶ç”Ÿæ•ˆå¿…é¡»å¼•å…¥ <code>spring-boot-starter-xxx</code> åŒ…å®ç°èµ·æ­¥ä¾èµ–</p><ul><li>SpringBoot å…ˆåŠ è½½æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ç±» xxxxxAutoConfiguration</li><li>æ¯ä¸ªè‡ªåŠ¨é…ç½®ç±»è¿›è¡Œæ¡ä»¶è£…é…ï¼Œé»˜è®¤éƒ½ä¼šç»‘å®šé…ç½®æ–‡ä»¶æŒ‡å®šçš„å€¼ï¼ˆxxxProperties å’Œé…ç½®æ–‡ä»¶è¿›è¡Œäº†ç»‘å®šï¼‰</li><li>SpringBoot é»˜è®¤ä¼šåœ¨åº•å±‚é…å¥½æ‰€æœ‰çš„ç»„ä»¶ï¼Œå¦‚æœç”¨æˆ·è‡ªå·±é…ç½®äº†ä»¥ç”¨æˆ·çš„ä¼˜å…ˆ</li><li>å®šåˆ¶åŒ–é…ç½®ï¼š<ul><li>ç”¨æˆ·å¯ä»¥ä½¿ç”¨ @Bean æ–°å»ºè‡ªå·±çš„ç»„ä»¶æ¥æ›¿æ¢åº•å±‚çš„ç»„ä»¶</li><li>ç”¨æˆ·å¯ä»¥å»çœ‹è¿™ä¸ªç»„ä»¶æ˜¯è·å–çš„é…ç½®æ–‡ä»¶å‰ç¼€å€¼ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹</li></ul></li></ul><blockquote><p>å¦‚ä½•æŸ¥çœ‹è‡ªåŠ¨é…ç½®äº†å“ªäº›</p></blockquote><p>application.propertiesä¸­debug=trueå¼€å¯è‡ªåŠ¨é…ç½®æŠ¥å‘Šã€‚å¯ä»¥æ˜¾ç¤ºå“ªäº›ç”Ÿæ•ˆå“ªäº›æ²¡ç”Ÿæ•ˆ Negativeä¸ç”Ÿæ•ˆ\Positiveç”Ÿæ•ˆ</p><hr><hr><h2 id="3-å¯åŠ¨æµç¨‹">3. å¯åŠ¨æµç¨‹</h2><p>å¦‚æœæƒ³debugæŸ¥çœ‹SpringBootè‡ªåŠ¨è£…é…çš„æµç¨‹ï¼Œå¯ä»¥åœ¨ä¸‹é¢æ–¹æ³•æ‰“ä¸Šæ–­ç‚¹</p><blockquote><ul><li><p>SpringApplication#refreshContext(context);</p></li><li><p>AbstractApplicationContext#invokeBeanFactoryPostProcessors(beanFactory);</p></li><li><p>PostProcessorRegistrationDelegate#invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</p></li><li><p>ConfigurationClassPostProcessor#processConfigBeanDefinitions(BeanDefinitionRegistry registry);</p><ul><li>parser.parse(candidates);<ul><li>this.deferredImportSelectorHandler.process();<ul><li>handler.processGroupImports(); è§£æAutoConfigurationImportSelector.class</li></ul></li></ul></li><li>this.reader.loadBeanDefinitions(configClasses);</li></ul></li></ul></blockquote><p>åº”ç”¨å¯åŠ¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// å¯åŠ¨ä»£ç </span></span><br><span class="line">        SpringApplication.run(BootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SpringApplication æ„é€ æ–¹æ³•</code></p><ul><li><p><code>this.resourceLoader = resourceLoader</code>ï¼šèµ„æºåŠ è½½å™¨ï¼Œåˆå§‹ä¸º null</p></li><li><p><code>this.webApplicationType = WebApplicationType.deduceFromClasspath()</code>ï¼šåˆ¤æ–­å½“å‰åº”ç”¨çš„ç±»å‹ï¼Œæ˜¯å“åº”å¼è¿˜æ˜¯ Web ç±»</p></li><li><p><code>setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</code></p><ul><li><p><code>Set&lt;String&gt; names = new LinkedHashSet&lt;&gt;(SpringFactoriesLoader.loadFactoryNames(type, classLoader));</code></p></li><li><p>å¯¼å…¥<code>META-INF/spring.factories</code> ï¼Œå¹¶å­˜å…¥ç¼“å­˜ï¼Œä¸‹é¢ä¼šç”¨åˆ°</p></li></ul></li></ul><p><code>(new SpringApplication(primarySources)).run(args)</code></p><div class="tabs" id="9e15277e-9f6e-4253-b9c1-05e40b94a476"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#9e15277e-9f6e-4253-b9c1-05e40b94a476-1"><i class="fas fa-cannabis"></i>1</button></li><li class="tab"><button type="button" data-href="#9e15277e-9f6e-4253-b9c1-05e40b94a476-2"><i class="fas fa-leaf"></i>2</button></li><li class="tab"><button type="button" data-href="#9e15277e-9f6e-4253-b9c1-05e40b94a476-3"><i class="fas fa-tree"></i>4</button></li><li class="tab"><button type="button" data-href="#9e15277e-9f6e-4253-b9c1-05e40b94a476-4"><i class="fas fa-cookie-bite"></i>5â­ï¸</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="9e15277e-9f6e-4253-b9c1-05e40b94a476-1"><p><mark class="hl-label blue">SpringApplication#runæ–¹æ³•</mark></p><p>åˆ›å»º IOC å®¹å™¨å¹¶å®ç°äº†è‡ªåŠ¨è£…é…</p><ul><li><p><code>StopWatch stopWatch = new StopWatch()</code>ï¼šåœæ­¢ç›‘å¬å™¨ï¼Œ<span class='p green'>ç›‘æ§æ•´ä¸ªåº”ç”¨çš„å¯åœ</span></p></li><li><p><code>stopWatch.start()</code>ï¼šè®°å½•åº”ç”¨çš„å¯åŠ¨æ—¶é—´</p></li><li><p><code>printedBanner = printBanner(environment)</code>ï¼šæ‰“å° SpringBoot æ ‡å¿—</p></li><li><p><code>context = createApplicationContext()</code>ï¼š<span class='p red'>åˆ›å»º IOC å®¹å™¨</span></p><p><code>switch (this.webApplicationType)</code>ï¼šæ ¹æ®å½“å‰åº”ç”¨çš„ç±»å‹åˆ›å»º IOC å®¹å™¨</p><ul><li><code>case SERVLET</code>ï¼šWeb åº”ç”¨ç¯å¢ƒå¯¹åº” AnnotationConfigServletWebServerApplicationContext</li><li><code>case REACTIVE</code>ï¼šå“åº”å¼ç¼–ç¨‹å¯¹åº” AnnotationConfigReactiveWebServerApplicationContext</li><li><code>default</code>ï¼šé»˜è®¤ä¸º Spring ç¯å¢ƒ AnnotationConfigApplicationContext</li></ul></li><li><p><code>context.setApplicationStartup(this.applicationStartup)</code>ï¼šè®¾ç½®ä¸€ä¸ªå¯åŠ¨å™¨</p></li><li><p><code>prepareContext()</code>ï¼š<span class='p green'>é…ç½® IOC å®¹å™¨çš„åŸºæœ¬ä¿¡æ¯</span></p><ul><li><code>beanFactory.registerSingleton(&quot;springBootBanner&quot;, printedBanner);</code>ï¼šå‘å•ä¾‹æ± ä¸­æ·»åŠ springBootBanner</li><li><code>load(context, sources.toArray(new Object[0]));</code>ï¼šå‘beanDefinitionMapæ·»åŠ å¯åŠ¨ç±»</li></ul></li><li><p><code>refreshContext(context)</code>ï¼š<span class='p green'>åˆ·æ–° IOC å®¹å™¨ï¼ŒSpring çš„å®¹å™¨å¯åŠ¨æµç¨‹</span></p><ul><li><p><code>refresh(context);</code></p><ul><li><p><code>prepareRefresh();</code>ï¼šå‡†å¤‡åˆ·æ–°åº”ç”¨ä¸Šä¸‹æ–‡</p></li><li><p><code>prepareBeanFactory(beanFactory);</code>ï¼šè®¾ç½®ä¸€äº›BeanClassLoaderå’ŒBeanPostProcessor</p></li><li><p><code>invokeBeanFactoryPostProcessors(beanFactory)</code>ï¼šå®ä¾‹åŒ–å¹¶è°ƒç”¨æ‰€æœ‰æ³¨å†Œçš„BeanFactoryPostProcessor beanï¼Œå¦‚æœç»™å®šï¼Œåˆ™éµå¾ªæ˜¾å¼é¡ºåºã€‚<span class='p red'>åœ¨æ­¤å¤„å®ç°äº†è‡ªåŠ¨è£…é…</span>  <mark class="hl-label green">è¯¦è§2</mark></p></li><li><p><code>registerBeanPostProcessors(beanFactory);</code>ï¼šå‘å®¹å™¨ä¸­æ·»åŠ BeanPostProcessor</p></li><li><p>â€¦</p></li></ul></li></ul></li><li><p><code>afterRefresh(context, applicationArguments)</code>ï¼šç•™ç»™ç”¨æˆ·è‡ªå®šä¹‰å®¹å™¨åˆ·æ–°å®Œæˆåçš„å¤„ç†é€»è¾‘</p></li><li><p><code>stopWatch.stop()</code>ï¼šè®°å½•åº”ç”¨å¯åŠ¨å®Œæˆçš„æ—¶é—´</p></li><li><p><code>listeners.started(context)</code>ï¼šæ‰€æœ‰çš„è¿è¡Œç›‘å¬å™¨è°ƒç”¨ started() æ–¹æ³•</p></li><li><p><code>listeners.running(context)</code>ï¼šæ‰€æœ‰çš„è¿è¡Œç›‘å¬å™¨è°ƒç”¨ running() æ–¹æ³•</p><ul><li>è·å–å®¹å™¨ä¸­çš„ ApplicationRunnerã€CommandLineRunner</li><li><code>AnnotationAwareOrderComparator.sort(runners)</code>ï¼šåˆå¹¶æ‰€æœ‰ runner å¹¶ä¸”æŒ‰ç…§ @Order è¿›è¡Œæ’åº</li><li><code>callRunner()</code>ï¼šéå†æ‰€æœ‰çš„ runnerï¼Œè°ƒç”¨ run æ–¹æ³•</li></ul></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9e15277e-9f6e-4253-b9c1-05e40b94a476-2"><p><mark class="hl-label blue">PostProcessorRegistrationDelegate#invokeBeanFactoryPostProcessorsæ–¹æ³•</mark></p><p>//åˆ†ä¸ºä¸¤ç±»</p><ul><li><code>List&lt;BeanFactoryPostProcessor&gt; regularPostProcessors = new ArrayList&lt;&gt;();</code></li><li><code>List&lt;BeanDefinitionRegistryPostProcessor&gt; registryProcessors = new ArrayList&lt;&gt;();</code></li></ul><br/><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éå†æ‰€æœ‰çš„ BeanFactoryPostProcessor</span></span><br><span class="line"><span class="keyword">for</span> (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸º BeanDefinitionRegistryPostProcessor ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> (postProcessor <span class="keyword">instanceof</span> BeanDefinitionRegistryPostProcessor) &#123;</span><br><span class="line">        <span class="comment">// å°†å½“å‰çš„ BeanFactoryPostProcessor è½¬æ¢ä¸º BeanDefinitionRegistryPostProcessor</span></span><br><span class="line">        <span class="type">BeanDefinitionRegistryPostProcessor</span> <span class="variable">registryProcessor</span> <span class="operator">=</span></span><br><span class="line">            (BeanDefinitionRegistryPostProcessor) postProcessor;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ BeanDefinitionRegistryPostProcessor çš„æ–¹æ³•å¯¹ BeanDefinitionRegistry è¿›è¡Œå¤„ç†</span></span><br><span class="line">        registryProcessor.postProcessBeanDefinitionRegistry(registry);</span><br><span class="line">        <span class="comment">// å°†å¤„ç†åçš„ BeanDefinitionRegistryPostProcessor æ·»åŠ åˆ° registryProcessors é›†åˆä¸­</span></span><br><span class="line">        registryProcessors.add(registryProcessor);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å°†æ™®é€šçš„ BeanFactoryPostProcessor æ·»åŠ åˆ° regularPostProcessors é›†åˆä¸­</span></span><br><span class="line">        regularPostProcessors.add(postProcessor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>// First, invoke the BeanDefinitionRegistryPostProcessors that implement PriorityOrdered.</p><ul><li><p><code>invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</code></p><ul><li><p><code>currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));</code><span class='p red'>getBeanæ–¹æ³•å®ä¾‹åŒ–BeanDefinitionRegistryPostProcessor</span></p></li><li><p><code>invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);</code></p><ul><li><span class='p red'>ConfigurationClassPostProcessoræ‰§è¡Œ</span> <mark class="hl-label green">è·³è½¬åˆ°4</mark></li></ul></li></ul></li></ul><p>// Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.</p><p>// Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9e15277e-9f6e-4253-b9c1-05e40b94a476-3"><p><mark class="hl-label blue">ConfigurationClassPostProcessor</mark></p><p>ç”¨æ¥è§£æé…ç½®ç±»ï¼Œå¦‚æœç±»ä¸Šé¢åŠ å…¥äº†@Configurationï¼Œ@CompentScanç­‰ï¼Œå®ƒå°±ä¼šä½ çš„è¿™äº›é…ç½®è§£æå‡ºæ¥</p><p>è§£æå¤„ç†@PropertySource æ³¨è§£<br>è§£æ@ComponentScanæ³¨è§£,æ‰«æ@Configurationã€@Serviceã€@Controllerã€@Repositoryå’Œ@Componentæ³¨è§£å¹¶æ³¨å†ŒBeanDefinition<br>è§£æ@Importæ³¨è§£,ç„¶åè¿›è¡Œå®ä¾‹åŒ–,å¹¶æ‰§è¡ŒImportBeanDefinitionRegistrarçš„registerBeanDefinitionsé€»è¾‘,æˆ–è€…ImportSelectorçš„selectImportsé€»è¾‘<br>è§£æ@ImportResourceæ³¨è§£,å¹¶åŠ è½½ç›¸å…³é…ç½®ä¿¡æ¯<br>è§£ææ–¹æ³•çº§åˆ«@Beanæ³¨è§£å¹¶å°†è¿”å›å€¼æ³¨å†ŒæˆBeanDefinition<br>æ³¨å†ŒImportRegistryåˆ°å®¹å™¨ä¸­,ç”¨äºå¤„ç†ImportAware</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;BeanDefinitionHolder&gt; configCandidates = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//è·å–bdmapæ‰€æœ‰çš„beanName</span></span><br><span class="line">String[] candidateNames = registry.getBeanDefinitionNames();</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†æ‰€æœ‰å€™é€‰çš„ bean åç§°</span></span><br><span class="line"><span class="keyword">for</span> (String beanName : candidateNames) &#123;</span><br><span class="line">    <span class="comment">// è·å–è¯¥ bean çš„ BeanDefinition å¯¹è±¡</span></span><br><span class="line">    <span class="type">BeanDefinition</span> <span class="variable">beanDef</span> <span class="operator">=</span> registry.getBeanDefinition(beanName);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ¤æ–­è¯¥ bean æ˜¯å¦å·²è¢«æ ‡è®°ä¸ºé…ç½®ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (beanDef.getAttribute(ConfigurationClassUtils.CONFIGURATION_CLASS_ATTRIBUTE) != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå·²è¢«æ ‡è®°ï¼Œåˆ™åœ¨è°ƒè¯•æ¨¡å¼ä¸‹è®°å½•æ—¥å¿—ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;Bean definition has already been processed as a configuration class: &quot;</span> + beanDef);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, <span class="built_in">this</span>.metadataReaderFactory)) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœè¯¥ bean æ»¡è¶³é…ç½®ç±»çš„å€™é€‰æ¡ä»¶ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ°é…ç½®ç±»çš„å€™é€‰é›†åˆä¸­</span></span><br><span class="line">        configCandidates.add(<span class="keyword">new</span> <span class="title class_">BeanDefinitionHolder</span>(beanDef, beanName));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­é€»è¾‘ï¼šcheckConfigurationClassCandidateï¼Œåˆ¤æ–­å®Œæˆååªæœ‰å¯åŠ¨ç±»è¢«åŠ å…¥åˆ°äº†configCandidatesé›†åˆä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»metadataä¸­è·å–Confugurationæ³¨è§£</span></span><br><span class="line">Map&lt;String, Object&gt; config = metadata.getAnnotationAttributes(Configuration.class.getName());</span><br><span class="line"><span class="comment">// æ ¹æ®metadataä¸­çš„æ³¨è§£åˆ¤æ–­æ˜¯fullåŒ¹é…è¿˜æ˜¯liteåŒ¹é…ã€‚</span></span><br><span class="line"><span class="keyword">if</span> (config != <span class="literal">null</span> &amp;&amp; !Boolean.FALSE.equals(config.get(<span class="string">&quot;proxyBeanMethods&quot;</span>))) &#123;</span><br><span class="line">    beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (config != <span class="literal">null</span> || isConfigurationCandidate(metadata)) &#123;</span><br><span class="line">    beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®ç±»è§£æçš„æ ¸å¿ƒä»£ç ï¼šéå†å€™é€‰çš„ <code>BeanDefinition</code> å¯¹è±¡æ¥è§£æ <code>@Configuration</code> ç±»ï¼Œä»è€Œç”Ÿæˆå¯¹åº”çš„ <code>BeanDefinition</code> å¯¹è±¡ã€‚åœ¨è§£æå®Œä¸€æ‰¹å€™é€‰çš„ <code>@Configuration</code> ç±»ä¹‹åï¼Œä¼šæ£€æŸ¥å®¹å™¨ä¸­æ˜¯å¦è¿˜æœ‰æ–°çš„å€™é€‰ <code>@Configuration</code> ç±»éœ€è¦è§£æï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¼šç»§ç»­å¯¹æ–°çš„å€™é€‰ <code>@Configuration</code> ç±»è¿›è¡Œè§£æï¼Œç›´åˆ°å®¹å™¨ä¸­æ²¡æœ‰æ–°çš„å€™é€‰ <code>@Configuration</code> ç±»ä¸ºæ­¢ã€‚æœ€ç»ˆï¼Œå®¹å™¨ä¸­çš„æ‰€æœ‰ <code>@Configuration</code> ç±»éƒ½ä¼šè¢«è§£æå¹¶è½¬æ¢ä¸ºå¯¹åº”çš„ <code>BeanDefinition</code> å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å€™é€‰BeanDefinitionçš„è§£æå™¨</span></span><br><span class="line"><span class="type">ConfigurationClassParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConfigurationClassParser</span>(</span><br><span class="line">        <span class="built_in">this</span>.metadataReaderFactory, <span class="built_in">this</span>.problemReporter, <span class="built_in">this</span>.environment,</span><br><span class="line">        <span class="built_in">this</span>.resourceLoader, <span class="built_in">this</span>.componentScanBeanNameGenerator, registry);</span><br><span class="line"><span class="comment">// éœ€è¦è§£æçš„BeanDefinitionHolderå®¹å™¨ï¼Œåˆå§‹å€¼ä¸ºconfigCandidates</span></span><br><span class="line">Set&lt;BeanDefinitionHolder&gt; candidates = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;&gt;(configCandidates);</span><br><span class="line"><span class="comment">// å·²ç»è§£æè¿‡çš„ConfigurationClasså®¹å™¨</span></span><br><span class="line">Set&lt;ConfigurationClass&gt; alreadyParsed = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(configCandidates.size());</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment">// è§£æå€™é€‰BeanDefinitionä¸­çš„@Configurationç±»</span></span><br><span class="line">    parser.parse(candidates);</span><br><span class="line">    <span class="comment">// éªŒè¯@Configurationç±»çš„ä¾èµ–å…³ç³»å’Œé‡å¤å¯¼å…¥</span></span><br><span class="line">    parser.validate();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰è¢«è§£æçš„@Configurationç±»</span></span><br><span class="line">    Set&lt;ConfigurationClass&gt; configClasses = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;&gt;(parser.getConfigurationClasses());</span><br><span class="line">    <span class="comment">// ä»è§£æè¿‡çš„@Configurationç±»ä¸­å‰”é™¤å·²ç»è¢«å¤„ç†è¿‡çš„</span></span><br><span class="line">    configClasses.removeAll(alreadyParsed);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®@Configurationç±»çš„ä¿¡æ¯ï¼Œè¯»å–å…¶å†…å®¹å¹¶åˆ›å»ºBeanDefinition</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.reader == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.reader = <span class="keyword">new</span> <span class="title class_">ConfigurationClassBeanDefinitionReader</span>(</span><br><span class="line">                registry, <span class="built_in">this</span>.sourceExtractor, <span class="built_in">this</span>.resourceLoader, <span class="built_in">this</span>.environment,</span><br><span class="line">                <span class="built_in">this</span>.importBeanNameGenerator, parser.getImportRegistry());</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// â­ï¸â­ï¸â­ï¸ â‘¢å¯¼å…¥æ ¹æ®importè§£æå‡ºæ¥çš„AutoConfigurationç±»ä¸­é‡Œé¢çš„bean</span></span><br><span class="line">    <span class="built_in">this</span>.reader.loadBeanDefinitions(configClasses);</span><br><span class="line">    <span class="comment">// å°†å·²ç»è§£æè¿‡çš„@Configurationç±»åŠ å…¥å·²å¤„ç†é›†åˆ</span></span><br><span class="line">    alreadyParsed.addAll(configClasses);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç©ºå½“å‰çš„å€™é€‰é›†åˆ</span></span><br><span class="line">    candidates.clear();</span><br><span class="line">    <span class="comment">// å¦‚æœå½“å‰BeanDefinitionæ•°é‡å¤§äºå€™é€‰é›†åˆä¸­çš„æ•°é‡ï¼Œåˆ™éœ€è¦é‡æ–°æ‰«ææ–°çš„BeanDefinition</span></span><br><span class="line">    <span class="keyword">if</span> (registry.getBeanDefinitionCount() &gt; candidateNames.length) &#123;</span><br><span class="line">        <span class="comment">// æ›´æ–°å€™é€‰BeanDefinitionçš„åç§°é›†åˆ</span></span><br><span class="line">        String[] newCandidateNames = registry.getBeanDefinitionNames();</span><br><span class="line">        <span class="comment">// å°†æ—§çš„å€™é€‰åç§°é›†åˆè½¬æ¢ä¸ºHashSetï¼Œä¾¿äºæŸ¥è¯¢</span></span><br><span class="line">        Set&lt;String&gt; oldCandidateNames = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(Arrays.asList(candidateNames));</span><br><span class="line">        <span class="comment">// å°†å·²ç»è§£æè¿‡çš„@Configurationç±»çš„åç§°åŠ å…¥Seté›†åˆ</span></span><br><span class="line">        Set&lt;String&gt; alreadyParsedClasses = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (ConfigurationClass configurationClass : alreadyParsed) &#123;</span><br><span class="line">            alreadyParsedClasses.add(configurationClass.getMetadata().getClassName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰æ–°çš„å€™é€‰åç§°</span></span><br><span class="line">        <span class="keyword">for</span> (String candidateName : newCandidateNames) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè¯¥åç§°ä¸åœ¨æ—§çš„å€™é€‰åç§°ä¸­ï¼Œåˆ™åŠ å…¥å€™é€‰é›†åˆ</span></span><br><span class="line">            <span class="keyword">if</span> (!oldCandidateNames.contains(candidateName)) &#123;</span><br><span class="line">                <span class="comment">// è·å–è¯¥BeanDefinitionå¯¹è±¡</span></span><br><span class="line">                <span class="type">BeanDefinition</span> <span class="variable">bd</span> <span class="operator">=</span> registry.getBeanDefinition(candidateName);</span><br><span class="line">                <span class="comment">// å¦‚æœè¯¥BeanDefinitionç¬¦åˆ@Configurationç±»çš„æ¡ä»¶ï¼Œå¹¶ä¸”æ²¡æœ‰è¢«è§£æè¿‡ï¼Œåˆ™åŠ å…¥å€™é€‰é›†åˆ</span></span><br><span class="line">                <span class="keyword">if</span> (ConfigurationClassUtils.checkConfigurationClassCandidate(bd, <span class="built_in">this</span>.metadataReaderFactory) &amp;&amp;</span><br><span class="line">                        !alreadyParsedClasses.contains(bd.getBeanClassName())) &#123;</span><br><span class="line">                    candidates.add(<span class="keyword">new</span> <span class="title class_">BeanDefinitionHolder</span>(bd, candidateName));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ›´æ–°å€™é€‰åç§°é›†åˆ</span></span><br><span class="line">        candidateNames = newCandidateNames;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (!candidates.isEmpty());</span><br></pre></td></tr></table></figure><p><code>parser.parse(candidates);</code>å…·ä½“çš„è§£æè¿‡ç¨‹æ ¸å¿ƒé€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">parse</span><span class="params">(Set&lt;BeanDefinitionHolder&gt; configCandidates)</span> &#123;</span><br><span class="line">    <span class="comment">// éå†æ¯ä¸€ä¸ªå€™é€‰çš„ BeanDefinitionHolderï¼Œå¯¹å…¶è¿›è¡Œè§£æ</span></span><br><span class="line">    <span class="keyword">for</span> (BeanDefinitionHolder holder : configCandidates) &#123;</span><br><span class="line">        <span class="type">BeanDefinition</span> <span class="variable">bd</span> <span class="operator">=</span> holder.getBeanDefinition();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯ AnnotatedBeanDefinition ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™è§£ææ³¨è§£å…ƒæ•°æ®</span></span><br><span class="line">            <span class="keyword">if</span> (bd <span class="keyword">instanceof</span> AnnotatedBeanDefinition) &#123;</span><br><span class="line">                parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯ AbstractBeanDefinition ç±»å‹ä¸”å·²ç»è®¾ç½® BeanClassï¼Œå¦‚æœæ˜¯åˆ™è§£ææ³¨è§£å…ƒæ•°æ®</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (bd <span class="keyword">instanceof</span> AbstractBeanDefinition &amp;&amp; ((AbstractBeanDefinition) bd).hasBeanClass()) &#123;</span><br><span class="line">                parse(((AbstractBeanDefinition) bd).getBeanClass(), holder.getBeanName());</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="comment">// å¦åˆ™è§£æ BeanClassName å¯¹åº”çš„ç±»çš„æ³¨è§£å…ƒæ•°æ®</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                parse(bd.getBeanClassName(), holder.getBeanName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (BeanDefinitionStoreException ex) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè§£æå¼‚å¸¸åˆ™ç›´æ¥æŠ›å‡º BeanDefinitionStoreException</span></span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè§£æå¼‚å¸¸åˆ™æŠ›å‡º BeanDefinitionStoreExceptionï¼Œç»™å‡ºå¤±è´¥çš„ç±»å</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BeanDefinitionStoreException</span>(</span><br><span class="line">                    <span class="string">&quot;Failed to parse configuration class [&quot;</span> + bd.getBeanClassName() + <span class="string">&quot;]&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â­ï¸â­ï¸â­ï¸â‘¡å¯¼å…¥äº†éœ€è¦è§£æçš„é…ç½®ç±» æ­¤å¤„æ‰§è¡Œäº†AutoConfigurationImportSelector#processæ–¹æ³•</span></span><br><span class="line">    <span class="built_in">this</span>.deferredImportSelectorHandler.process();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>doProcessConfigurationClass  <mark class="hl-label green">è¯¦è§5</mark>   é‡ç‚¹</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9e15277e-9f6e-4253-b9c1-05e40b94a476-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœ ConfigurationClass ä½¿ç”¨äº† @Component æ³¨è§£ï¼Œåˆ™å…ˆé€’å½’å¤„ç†æ‰€æœ‰åµŒå¥—ç±»</span></span><br><span class="line"><span class="keyword">if</span> (configClass.getMetadata().isAnnotated(Component.class.getName())) &#123;</span><br><span class="line">    processMemberClasses(configClass, sourceClass);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† @PropertySource æ³¨è§£</span></span><br><span class="line"><span class="keyword">for</span> (AnnotationAttributes propertySource : AnnotationConfigUtils.attributesForRepeatable(</span><br><span class="line">        sourceClass.getMetadata(), PropertySources.class,</span><br><span class="line">        org.springframework.context.annotation.PropertySource.class)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.environment <span class="keyword">instanceof</span> ConfigurableEnvironment) &#123;</span><br><span class="line">        processPropertySource(propertySource);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;Ignoring @PropertySource annotation on [&quot;</span> + sourceClass.getMetadata().getClassName() +</span><br><span class="line">                <span class="string">&quot;]. Reason: Environment must implement ConfigurableEnvironment&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† @ComponentScan æ³¨è§£  basePackagesè®¾ç½®çš„æ­£æ˜¯å¯åŠ¨ç±»</span></span><br><span class="line">Set&lt;AnnotationAttributes&gt; componentScans = AnnotationConfigUtils.attributesForRepeatable(</span><br><span class="line">        sourceClass.getMetadata(), ComponentScans.class, ComponentScan.class);</span><br><span class="line"><span class="keyword">if</span> (!componentScans.isEmpty() &amp;&amp;</span><br><span class="line">        !<span class="built_in">this</span>.conditionEvaluator.shouldSkip(sourceClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (AnnotationAttributes componentScan : componentScans) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰é…ç½®ç±»è¢« @ComponentScan æ³¨è§£ï¼Œåˆ™ç«‹å³æ‰§è¡Œæ‰«æ</span></span><br><span class="line">        Set&lt;BeanDefinitionHolder&gt; scannedBeanDefinitions =</span><br><span class="line">                <span class="built_in">this</span>.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());</span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ‰«æåˆ°çš„ BeanDefinition é›†åˆä¸­æ˜¯å¦æœ‰é…ç½®ç±»ï¼Œå¦‚æœæœ‰åˆ™é€’å½’è§£æ</span></span><br><span class="line">        <span class="keyword">for</span> (BeanDefinitionHolder holder : scannedBeanDefinitions) &#123;</span><br><span class="line">            <span class="type">BeanDefinition</span> <span class="variable">bdCand</span> <span class="operator">=</span> holder.getBeanDefinition().getOriginatingBeanDefinition();</span><br><span class="line">            <span class="keyword">if</span> (bdCand == <span class="literal">null</span>) &#123;</span><br><span class="line">                bdCand = holder.getBeanDefinition();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ConfigurationClassUtils.checkConfigurationClassCandidate(bdCand, <span class="built_in">this</span>.metadataReaderFactory)) &#123;</span><br><span class="line">                parse(bdCand.getBeanClassName(), holder.getBeanName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯åŠ¨ç±»ä¸Šä¸¤ä¸ªimport</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230502104957759.png" alt="image-20230502104957759"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// â‘ å¤„ç† @Import æ³¨è§£</span></span><br><span class="line">processImports(configClass, sourceClass, getImports(sourceClass), <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† @ImportResource æ³¨è§£</span></span><br><span class="line"><span class="type">AnnotationAttributes</span> <span class="variable">importResource</span> <span class="operator">=</span></span><br><span class="line">        AnnotationConfigUtils.attributesFor(sourceClass.getMetadata(), ImportResource.class);</span><br><span class="line"><span class="keyword">if</span> (importResource != <span class="literal">null</span>) &#123;</span><br><span class="line">    String[] resources = importResource.getStringArray(<span class="string">&quot;locations&quot;</span>);</span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">BeanDefinitionReader</span>&gt; readerClass = importResource.getClass(<span class="string">&quot;reader&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (String resource : resources) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resolvedResource</span> <span class="operator">=</span> <span class="built_in">this</span>.environment.resolveRequiredPlaceholders(resource);</span><br><span class="line">        configClass.addImportedResource(resolvedResource, readerClass);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† @Bean æ–¹æ³•</span></span><br><span class="line">Set&lt;MethodMetadata&gt; beanMethods = retrieveBeanMethodMetadata(sourceClass);</span><br><span class="line"><span class="keyword">for</span> (MethodMetadata methodMetadata : beanMethods) &#123;</span><br><span class="line">    configClass.addBeanMethod(<span class="keyword">new</span> <span class="title class_">BeanMethod</span>(methodMetadata, configClass));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•</span></span><br><span class="line">processInterfaces(configClass, sourceClass);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="4-äº‹ä»¶ç›‘å¬">4. äº‹ä»¶ç›‘å¬</h2><p>SpringBoot åœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šå¯¹å‡ ä¸ªç›‘å¬å™¨è¿›è¡Œå›è°ƒï¼Œå¯ä»¥å®ç°ç›‘å¬å™¨æ¥å£ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶å®Œæˆä¸€äº›æ“ä½œ</p><p><code>ApplicationContextInitializer</code>ã€<code>SpringApplicationRunListener</code>ã€<code>CommandLineRunner</code>ã€<code>ApplicationRunner</code></p><div class="tabs" id="bf7c81bb-1e37-4601-af56-417721997df7"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#bf7c81bb-1e37-4601-af56-417721997df7-1"><i class="fas fa-cat"></i>1</button></li><li class="tab"><button type="button" data-href="#bf7c81bb-1e37-4601-af56-417721997df7-2"><i class="fas fa-horse"></i>2</button></li><li class="tab"><button type="button" data-href="#bf7c81bb-1e37-4601-af56-417721997df7-3"><i class="fas fa-dove"></i>3</button></li><li class="tab"><button type="button" data-href="#bf7c81bb-1e37-4601-af56-417721997df7-4"><i class="fas fa-dragon"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="bf7c81bb-1e37-4601-af56-417721997df7-1"><p>MyApplicationRunner</p><p>è‡ªå®šä¹‰ç›‘å¬å™¨çš„å¯åŠ¨æ—¶æœºï¼šMyApplicationRunner å’Œ MyCommandLineRunner éƒ½æ˜¯å½“é¡¹ç›®å¯åŠ¨åæ‰§è¡Œï¼Œä½¿ç”¨ @Component æ”¾å…¥å®¹å™¨å³å¯ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å½“é¡¹ç›®å¯åŠ¨åæ‰§è¡Œrunæ–¹æ³•</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyApplicationRunner</span> <span class="keyword">implements</span> <span class="title class_">ApplicationRunner</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ApplicationRunner...run&quot;</span>);</span><br><span class="line">        System.out.println(Arrays.asList(args.getSourceArgs()));<span class="comment">//propertiesé…ç½®ä¿¡æ¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bf7c81bb-1e37-4601-af56-417721997df7-2"><p>MyCommandLineRunner</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCommandLineRunner</span> <span class="keyword">implements</span> <span class="title class_">CommandLineRunner</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;CommandLineRunner...run&quot;</span>);</span><br><span class="line">        System.out.println(Arrays.asList(args));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bf7c81bb-1e37-4601-af56-417721997df7-3"><p>MyApplicationContextInitializer çš„å¯ç”¨è¦åœ¨ resource æ–‡ä»¶å¤¹ä¸‹æ·»åŠ  META-INF/spring.factories</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">org.springframework.context.ApplicationContextInitializer</span>=<span class="string">\</span></span><br><span class="line"><span class="string">com.example.springbootlistener.listener.MyApplicationContextInitializer</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyApplicationContextInitializer</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextInitializer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(ConfigurableApplicationContext applicationContext)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ApplicationContextInitializer....initialize&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bf7c81bb-1e37-4601-af56-417721997df7-4"><p>MySpringApplicationRunListener çš„ä½¿ç”¨è¦æ·»åŠ æ„é€ å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySpringApplicationRunListener</span> <span class="keyword">implements</span> <span class="title class_">SpringApplicationRunListener</span> &#123;</span><br><span class="line"><span class="comment">//æ„é€ å™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MySpringApplicationRunListener</span><span class="params">(SpringApplication sa, String[] args)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">starting</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;starting...é¡¹ç›®å¯åŠ¨ä¸­&quot;</span>);<span class="comment">//è¾“å‡ºSPRINGä¹‹å‰</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;environmentPrepared...ç¯å¢ƒå¯¹è±¡å¼€å§‹å‡†å¤‡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextPrepared...ä¸Šä¸‹æ–‡å¯¹è±¡å¼€å§‹å‡†å¤‡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;contextLoaded...ä¸Šä¸‹æ–‡å¯¹è±¡å¼€å§‹åŠ è½½&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">started</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;started...ä¸Šä¸‹æ–‡å¯¹è±¡åŠ è½½å®Œæˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">running</span><span class="params">(ConfigurableApplicationContext context)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;running...é¡¹ç›®å¯åŠ¨å®Œæˆï¼Œå¼€å§‹è¿è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;failed...é¡¹ç›®å¯åŠ¨å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h2 id="5-é…ç½®æ–‡ä»¶">5. é…ç½®æ–‡ä»¶</h2><p>SpringBoot æ˜¯åŸºäºçº¦å®šçš„ï¼Œå¾ˆå¤šé…ç½®éƒ½æœ‰é»˜è®¤å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨è‡ªå·±çš„é…ç½®æ›¿æ¢é»˜è®¤é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨application.propertiesæˆ–è€… application.ymlï¼ˆapplication.yamlï¼‰è¿›è¡Œé…ç½®</p><ul><li>é»˜è®¤é…ç½®æ–‡ä»¶åç§°ï¼šapplication</li><li>åœ¨åŒä¸€çº§ç›®å½•ä¸‹ä¼˜å…ˆçº§ä¸ºï¼šproperties &gt; yml &gt; yaml</li></ul><h3 id="4-1-yamlè¯­æ³•">4.1 yamlè¯­æ³•</h3><p>åŸºæœ¬è¯­æ³•ï¼š</p><ul><li><p>å¤§å°å†™æ•æ„Ÿ</p></li><li><p>æ•°æ®å€¼å‰è¾¹å¿…é¡»æœ‰ç©ºæ ¼ï¼Œä½œä¸ºåˆ†éš”ç¬¦</p></li><li><p>ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»</p></li><li><p>ç¼©è¿›æ—¶ä¸å…è®¸ä½¿ç”¨Tabé”®ï¼Œåªå…è®¸ä½¿ç”¨ç©ºæ ¼ï¼ˆå„ä¸ªç³»ç»Ÿ Tabå¯¹åº”ç©ºæ ¼æ•°ç›®å¯èƒ½ä¸åŒï¼Œå¯¼è‡´å±‚æ¬¡æ··ä¹±ï¼‰</p></li><li><p>ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯</p></li><li><p>â€˜â€™#&quot; è¡¨ç¤ºæ³¨é‡Šï¼Œä»è¿™ä¸ªå­—ç¬¦ä¸€ç›´åˆ°è¡Œå°¾ï¼Œéƒ½ä¼šè¢«è§£æå™¨å¿½ç•¥</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span> </span><br><span class="line"><span class="attr">port:</span> <span class="number">8080</span>  </span><br><span class="line">    <span class="attr">address:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure></li></ul><p>æ•°æ®æ ¼å¼ï¼š</p><div class="tabs" id="8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-1"><i class="fas fa-award"></i>çº¯é‡</button></li><li class="tab"><button type="button" data-href="#8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-2"><i class="fas fa-baseball-ball"></i>å¯¹è±¡</button></li><li class="tab"><button type="button" data-href="#8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-3"><i class="fas fa-bone"></i>æ•°ç»„</button></li><li class="tab"><button type="button" data-href="#8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-4"><i class="fas fa-anchor"></i>å‚æ•°å¼•ç”¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-1"><p>å•ä¸ªçš„ã€ä¸å¯å†åˆ†çš„å€¼</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">msg1:</span> <span class="string">&#x27;hello \n world&#x27;</span>  <span class="comment"># å•å¼•å¿½ç•¥è½¬ä¹‰å­—ç¬¦</span></span><br><span class="line"><span class="attr">msg2:</span> <span class="string">&quot;hello \n world&quot;</span>  <span class="comment"># åŒå¼•è¯†åˆ«è½¬ä¹‰å­—ç¬¦</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-2"><p>é”®å€¼å¯¹é›†åˆï¼ŒMapã€Hash</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span>  </span><br><span class="line">   <span class="attr">name:</span> <span class="string">zhangsan</span></span><br><span class="line">   <span class="attr">age:</span> <span class="number">20</span></span><br><span class="line"><span class="comment"># è¡Œå†…å†™æ³•</span></span><br><span class="line"><span class="attr">person:</span> &#123;<span class="attr">name:</span> <span class="string">zhangsan</span>&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸å»ºè®®ä½¿ç”¨ JSONï¼Œåº”è¯¥ä½¿ç”¨ yaml è¯­æ³•</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-3"><p>ä¸€ç»„æŒ‰æ¬¡åºæ’åˆ—çš„å€¼ï¼ŒListã€Array</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">address:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">beijing</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">shanghai</span></span><br><span class="line"><span class="comment"># è¡Œå†…å†™æ³•</span></span><br><span class="line"><span class="attr">address:</span> [<span class="string">beijing</span>,<span class="string">shanghai</span>]</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">allPerson</span><span class="comment">#List&lt;Person&gt;</span></span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="string">name:lisi</span>, <span class="string">age:18</span>&#125;</span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="string">name:wangwu</span>, <span class="string">age:20</span>&#125;</span><br><span class="line"><span class="comment"># è¡Œå†…å†™æ³•</span></span><br><span class="line"><span class="attr">allPerson:</span> [&#123;<span class="string">name:lisi</span>, <span class="string">age:18</span>&#125;, &#123;<span class="string">name:wangwu</span>, <span class="string">age:20</span>&#125;]</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8c706fa9-4b8b-4bfb-aac6-92a8c17c7be7-4"><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">lisi</span> </span><br><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">$&#123;name&#125;</span> <span class="comment"># å¼•ç”¨ä¸Šè¾¹å®šä¹‰çš„nameå€¼</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h3 id="4-2-è·å–é…ç½®">4.2 è·å–é…ç½®</h3><p>ä¸‰ç§è·å–é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼š</p><div class="tabs" id="2db43a24-e20c-4b2a-aa39-fd15c4f39ae0"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-1"><i class="fas fa-seedling"></i>1</button></li><li class="tab"><button type="button" data-href="#2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-2"><i class="fas fa-leaf"></i>2</button></li><li class="tab"><button type="button" data-href="#2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-3"><i class="fab fa-apple"></i>3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-1"><p>æ³¨è§£ @Value</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;person.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;address[0]&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String address1;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;msg1&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String msg1;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;msg2&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String msg2;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰€æœ‰çš„æ•°æ®&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot; hello Spring Boot !&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-2"><p>Evironment å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Environment env;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">&quot;person.name&quot;</span>));</span><br><span class="line">    System.out.println(env.getProperty(<span class="string">&quot;address[0]&quot;</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot; hello Spring Boot !&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2db43a24-e20c-4b2a-aa39-fd15c4f39ae0-3"><p>æ³¨è§£ @ConfigurationProperties é…åˆ @Component ä½¿ç”¨</p><p>æ³¨æ„ï¼šå‚æ•° prefix ä¸€å®šè¦æŒ‡å®š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span><span class="comment">//ä¸æ‰«æè¯¥ç»„ä»¶åˆ°å®¹å™¨å†…ï¼Œæ— æ³•å®Œæˆè‡ªåŠ¨è£…é…</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String[] address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Person person;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.println(person);</span><br><span class="line">    <span class="comment">//Person&#123;name=&#x27;zhangsan&#x27;, age=20, address=[beijing, shanghai]&#125;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot; hello Spring Boot !&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="6-è‡ªå®šä¹‰Starter">6. è‡ªå®šä¹‰Starter</h2><p>spring boot åœ¨é…ç½®ä¸Šç›¸æ¯”springè¦ç®€å•è®¸å¤š, å…¶æ ¸å¿ƒåœ¨äºspring-boot-starter, åœ¨ä½¿ç”¨spring bootæ¥æ­å»ºä¸€ä¸ªé¡¹ç›®æ—¶, åªéœ€è¦å¼•å…¥å®˜æ–¹æä¾›çš„starter, å°±å¯ä»¥ç›´æ¥ä½¿ç”¨, å…å»äº†å„ç§é…ç½®ã€‚starterç®€å•æ¥è®²å°±æ˜¯å¼•å…¥äº†ä¸€äº›ç›¸å…³ä¾èµ–å’Œä¸€äº›åˆå§‹åŒ–çš„é…ç½®ã€‚</p><h3 id="6-1-æ¡ˆä¾‹ä¸€">6.1 æ¡ˆä¾‹ä¸€</h3><mark class="hl-label blue">å¼€å‘starter</mark> <div class="tabs" id="f449984b-9e18-4b00-b258-d815a8483b62"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#f449984b-9e18-4b00-b258-d815a8483b62-1"><i class="fas fa-seedling"></i>ç¬¬ä¸€æ­¥</button></li><li class="tab"><button type="button" data-href="#f449984b-9e18-4b00-b258-d815a8483b62-2"><i class="fas fa-leaf"></i>ç¬¬äºŒæ­¥</button></li><li class="tab"><button type="button" data-href="#f449984b-9e18-4b00-b258-d815a8483b62-3"><i class="fab fa-apple"></i>ç¬¬ä¸‰æ­¥</button></li><li class="tab"><button type="button" data-href="#f449984b-9e18-4b00-b258-d815a8483b62-4"><i class="fas fa-tree"></i>ç¬¬å››æ­¥</button></li><li class="tab"><button type="button" data-href="#f449984b-9e18-4b00-b258-d815a8483b62-5"><i class="fas fa-heartbeat"></i>ç¬¬äº”æ­¥</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="f449984b-9e18-4b00-b258-d815a8483b62-1"><p>åˆ›å»ºstarterå·¥ç¨‹hello-spring-boot-starterå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 </span></span></span><br><span class="line"><span class="string"><span class="tag">                             http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.itcast<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f449984b-9e18-4b00-b258-d815a8483b62-2"><p>åˆ›å»ºé…ç½®å±æ€§ç±»HelloProperties</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *è¯»å–é…ç½®æ–‡ä»¶è½¬æ¢ä¸ºbean</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;HelloProperties&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f449984b-9e18-4b00-b258-d815a8483b62-3"><p>åˆ›å»ºæœåŠ¡ç±»HelloService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloService</span><span class="params">(String name, String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ä½ å¥½ï¼æˆ‘çš„åå­—å« &quot;</span> + name + <span class="string">&quot;ï¼Œæˆ‘æ¥è‡ª &quot;</span> + address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f449984b-9e18-4b00-b258-d815a8483b62-4"><p>åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»HelloServiceAutoConfiguration</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.service.HelloService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.EnableConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é…ç½®ç±»ï¼ŒåŸºäºJavaä»£ç çš„beané…ç½®</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(HelloProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServiceAutoConfiguration</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥é…ç½®å±æ€§å¯¹è±¡HelloProperties</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HelloServiceAutoConfiguration</span><span class="params">(HelloProperties helloProperties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.helloProperties = helloProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–HelloServiceå¹¶è½½å…¥Spring IoCå®¹å™¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="keyword">public</span> HelloService <span class="title function_">helloService</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HelloService</span>(helloProperties.getName(),helloProperties.getAddress());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="f449984b-9e18-4b00-b258-d815a8483b62-5"><p>åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºMETA-INF/spring.factories</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="string">cn.itcast.config.HelloServiceAutoConfiguration</span></span><br></pre></td></tr></table></figure><p>è‡³æ­¤starterå·²ç»å¼€å‘å®Œæˆäº†ï¼Œå¯ä»¥å°†å½“å‰starterå®‰è£…åˆ°æœ¬åœ°mavenä»“åº“ä¾›å…¶ä»–åº”ç”¨æ¥ä½¿ç”¨ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><mark class="hl-label green">ä½¿ç”¨starter</mark> <div class="tabs" id="dd433e8a-b1b4-46a3-8443-6088615e447a"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#dd433e8a-b1b4-46a3-8443-6088615e447a-1"><i class="fas fa-cat"></i>ç¬¬ä¸€æ­¥</button></li><li class="tab"><button type="button" data-href="#dd433e8a-b1b4-46a3-8443-6088615e447a-2"><i class="fas fa-horse"></i>ç¬¬äºŒæ­¥</button></li><li class="tab"><button type="button" data-href="#dd433e8a-b1b4-46a3-8443-6088615e447a-3"><i class="fas fa-dove"></i>ç¬¬ä¸‰æ­¥</button></li><li class="tab"><button type="button" data-href="#dd433e8a-b1b4-46a3-8443-6088615e447a-4"><i class="fas fa-dragon"></i>ç¬¬å››æ­¥</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="dd433e8a-b1b4-46a3-8443-6088615e447a-1"><p>åˆ›å»ºmavenå·¥ç¨‹myappå¹¶é…ç½®pom.xmlæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.itcast<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>myapp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¯¼å…¥è‡ªå®šä¹‰starter--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.itcast<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="dd433e8a-b1b4-46a3-8443-6088615e447a-2"><p>åˆ›å»ºapplication.ymlæ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">hello:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">xiaoming</span></span><br><span class="line">  <span class="attr">address:</span> <span class="string">beijing</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="dd433e8a-b1b4-46a3-8443-6088615e447a-3"><p>åˆ›å»ºHelloController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.service.HelloService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="comment">//HelloServiceåœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„starterä¸­å·²ç»å®Œæˆäº†è‡ªåŠ¨é…ç½®ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥ç›´æ¥æ³¨å…¥</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloService helloService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/say&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloService.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="dd433e8a-b1b4-46a3-8443-6088615e447a-4"><p>åˆ›å»ºå¯åŠ¨ç±»HelloApplication</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(HelloApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¯åŠ¨ç±»mainæ–¹æ³•ï¼Œè®¿é—®åœ°å€http://localhost:8080/hello/say</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20200310103528648.png" alt="image-20200310103528648"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="6-2-æ¡ˆä¾‹äºŒ">6.2 æ¡ˆä¾‹äºŒ</h3><p>åœ¨å‰é¢çš„æ¡ˆä¾‹ä¸€ä¸­æˆ‘ä»¬é€šè¿‡å®šä¹‰starterï¼Œè‡ªåŠ¨é…ç½®äº†ä¸€ä¸ªHelloServiceå®ä¾‹ã€‚æœ¬æ¡ˆä¾‹æˆ‘ä»¬éœ€è¦é€šè¿‡è‡ªåŠ¨é…ç½®æ¥åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨å¯¹è±¡ï¼Œé€šè¿‡æ­¤æ‹¦æˆªå™¨å¯¹è±¡æ¥å®ç°è®°å½•æ—¥å¿—åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ¡ˆä¾‹ä¸€çš„åŸºç¡€ä¸Šç»§ç»­å¼€å‘æ¡ˆä¾‹äºŒã€‚</p><mark class="hl-label blue">å¼€å‘starter</mark> <div class="tabs" id="421b7b5d-e977-4116-b671-5a181d0ca04c"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#421b7b5d-e977-4116-b671-5a181d0ca04c-1"><i class="fas fa-atom"></i>ç¬¬ä¸€æ­¥</button></li><li class="tab"><button type="button" data-href="#421b7b5d-e977-4116-b671-5a181d0ca04c-2"><i class="far fa-sun"></i>ç¬¬äºŒæ­¥</button></li><li class="tab"><button type="button" data-href="#421b7b5d-e977-4116-b671-5a181d0ca04c-3"><i class="fas fa-wind"></i>ç¬¬ä¸‰æ­¥</button></li><li class="tab"><button type="button" data-href="#421b7b5d-e977-4116-b671-5a181d0ca04c-4"><i class="fas fa-fire-alt"></i>ç¬¬å››æ­¥</button></li><li class="tab"><button type="button" data-href="#421b7b5d-e977-4116-b671-5a181d0ca04c-5"><i class="fas fa-cookie-bite"></i>ç¬¬äº”æ­¥</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="421b7b5d-e977-4116-b671-5a181d0ca04c-1"><p>åœ¨hello-spring-boot-starterçš„pom.xmlæ–‡ä»¶ä¸­è¿½åŠ å¦‚ä¸‹mavenåæ ‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="421b7b5d-e977-4116-b671-5a181d0ca04c-2"><p>è‡ªå®šä¹‰MyLogæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyLog &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•æè¿°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">desc</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="421b7b5d-e977-4116-b671-5a181d0ca04c-3"><p>è‡ªå®šä¹‰æ—¥å¿—æ‹¦æˆªå™¨MyLogInterceptor</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.HandlerMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.handler.HandlerInterceptorAdapter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ—¥å¿—æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLogInterceptor</span> <span class="keyword">extends</span> <span class="title class_">HandlerInterceptorAdapter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;Long&gt; startTimeThreadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, </span></span><br><span class="line"><span class="params">                             Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> (HandlerMethod)handler;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> handlerMethod.getMethod();<span class="comment">//è·å¾—è¢«æ‹¦æˆªçš„æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">MyLog</span> <span class="variable">myLog</span> <span class="operator">=</span> method.getAnnotation(MyLog.class);<span class="comment">//è·å¾—æ–¹æ³•ä¸Šçš„æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span>(myLog != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//æ–¹æ³•ä¸ŠåŠ äº†MyLogæ³¨è§£ï¼Œéœ€è¦è¿›è¡Œæ—¥å¿—è®°å½•</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">            startTimeThreadLocal.set(startTime);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, </span></span><br><span class="line"><span class="params">                           Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> (HandlerMethod)handler;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> handlerMethod.getMethod();<span class="comment">//è·å¾—è¢«æ‹¦æˆªçš„æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">MyLog</span> <span class="variable">myLog</span> <span class="operator">=</span> method.getAnnotation(MyLog.class);<span class="comment">//è·å¾—æ–¹æ³•ä¸Šçš„æ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span>(myLog != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//æ–¹æ³•ä¸ŠåŠ äº†MyLogæ³¨è§£ï¼Œéœ€è¦è¿›è¡Œæ—¥å¿—è®°å½•</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">            <span class="type">Long</span> <span class="variable">startTime</span> <span class="operator">=</span> startTimeThreadLocal.get();</span><br><span class="line">            <span class="type">long</span> <span class="variable">optTime</span> <span class="operator">=</span> endTime - startTime;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">requestUri</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">            <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> method.getDeclaringClass().getName() + <span class="string">&quot;.&quot;</span> + </span><br><span class="line">                method.getName();</span><br><span class="line">            <span class="type">String</span> <span class="variable">methodDesc</span> <span class="operator">=</span> myLog.desc();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;è¯·æ±‚uriï¼š&quot;</span> + requestUri);</span><br><span class="line">            System.out.println(<span class="string">&quot;è¯·æ±‚æ–¹æ³•åï¼š&quot;</span> + methodName);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–¹æ³•æè¿°ï¼š&quot;</span> + methodDesc);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ–¹æ³•æ‰§è¡Œæ—¶é—´ï¼š&quot;</span> + optTime + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="421b7b5d-e977-4116-b671-5a181d0ca04c-4"><p>åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»MyLogAutoConfigurationï¼Œç”¨äºè‡ªåŠ¨é…ç½®æ‹¦æˆªå™¨ã€å‚æ•°è§£æå™¨ç­‰webç»„ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.log.MyLogInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»ï¼Œç”¨äºè‡ªåŠ¨é…ç½®æ‹¦æˆªå™¨ã€å‚æ•°è§£æå™¨ç­‰webç»„ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyLogAutoConfiguration</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span>&#123;</span><br><span class="line">    <span class="comment">//æ³¨å†Œè‡ªå®šä¹‰æ—¥å¿—æ‹¦æˆªå™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyLogInterceptor</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="421b7b5d-e977-4116-b671-5a181d0ca04c-5"><p>åœ¨spring.factoriesä¸­è¿½åŠ MyLogAutoConfigurationé…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>=<span class="string">\</span></span><br><span class="line"><span class="string">cn.itcast.config.HelloServiceAutoConfiguration,\</span></span><br><span class="line"><span class="string">cn.itcast.config.MyLogAutoConfiguration</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæˆ‘ä»¬åœ¨hello-spring-boot-starterä¸­è¿½åŠ äº†æ–°çš„å†…å®¹ï¼Œéœ€è¦é‡æ–°æ‰“åŒ…å®‰è£…åˆ°mavenä»“åº“ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <mark class="hl-label green">ä½¿ç”¨starter</mark> <p>åœ¨myappå·¥ç¨‹çš„Controlleræ–¹æ³•ä¸ŠåŠ å…¥@MyLogæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.log.MyLog;</span><br><span class="line"><span class="keyword">import</span> cn.itcast.service.HelloService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="comment">//HelloServiceåœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„starterä¸­å·²ç»å®Œæˆäº†è‡ªåŠ¨é…ç½®ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥ç›´æ¥æ³¨å…¥</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloService helloService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@MyLog(desc = &quot;sayHelloæ–¹æ³•&quot;)</span> <span class="comment">//æ—¥å¿—è®°å½•æ³¨è§£</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/say&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helloService.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®åœ°å€ï¼š<a href="http://localhost:8080/hello/say%EF%BC%8C%E6%9F%A5%E7%9C%8B%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%EF%BC%9A">http://localhost:8080/hello/sayï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼š</a></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">è¯·æ±‚uriï¼š/hello/say</span></span><br><span class="line"><span class="attr">è¯·æ±‚æ–¹æ³•åï¼šcn.itcast.controller.HelloController.sayHello</span></span><br><span class="line"><span class="attr">æ–¹æ³•æè¿°ï¼šsayHelloæ–¹æ³•</span></span><br><span class="line"><span class="attr">æ–¹æ³•æ‰§è¡Œæ—¶é—´ï¼š36ms</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è‡ªåŠ¨è£…é…æµç¨‹è¯¦è§£ã€è‡ªå®šä¹‰Starter</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
    <category term="SpringBoot" scheme="https://wuwawawa.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootæ¦‚è¿°</title>
    <link href="https://wuwawawa.github.io/posts/4e03c5a1.html"/>
    <id>https://wuwawawa.github.io/posts/4e03c5a1.html</id>
    <published>2023-05-02T10:30:30.000Z</published>
    <updated>2023-05-16T05:27:32.791Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Spring-Bootæ¦‚è¿°">1. Spring Bootæ¦‚è¿°</h2><p>Spring Bootæ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ–Springåº”ç”¨çš„åˆ›å»ºã€è¿è¡Œã€è°ƒè¯•ã€éƒ¨ç½²ç­‰ã€‚ä½¿ç”¨Spring Bootå¯ä»¥åšåˆ°ä¸“æ³¨äºSpringåº”ç”¨çš„å¼€å‘ï¼Œè€Œæ— éœ€è¿‡å¤šå…³æ³¨XMLçš„é…ç½®ã€‚Spring Bootä½¿ç”¨â€œçº¦å®šå¤§äºé…ç½®â€çš„ç†å¿µï¼Œç®€å•æ¥è¯´ï¼Œå®ƒæä¾›äº†ä¸€å †ä¾èµ–æ‰“åŒ…ï¼Œå¹¶å·²ç»æŒ‰ç…§ä½¿ç”¨ä¹ æƒ¯è§£å†³äº†ä¾èµ–é—®é¢˜ã€‚ä½¿ç”¨Spring Bootå¯ä»¥ä¸ç”¨æˆ–è€…åªéœ€è¦å¾ˆå°‘çš„Springé…ç½®å°±å¯ä»¥è®©ä¼ä¸šé¡¹ç›®å¿«é€Ÿè¿è¡Œèµ·æ¥ã€‚</p><p>Spring Bootæ˜¯å¼€å‘è€…å’ŒSpring æœ¬èº«æ¡†æ¶çš„ä¸­é—´å±‚ï¼Œå¸®åŠ©å¼€å‘è€…ç»Ÿç­¹ç®¡ç†åº”ç”¨çš„é…ç½®ï¼Œæä¾›åŸºäºå®é™…å¼€å‘ä¸­å¸¸è§é…ç½®çš„é»˜è®¤å¤„ç†ï¼ˆ<span class='p red'>çº¦å®šå¤§äºé…ç½®</span>ï¼‰ï¼Œç®€åŒ–åº”ç”¨çš„å¼€å‘ï¼Œç®€åŒ–åº”ç”¨çš„è¿ç»´ï¼›æ€»çš„æ¥è¯´ï¼Œå…¶ç›®çš„Spring Bootå°±æ˜¯ä¸ºäº†å¯¹Java web çš„å¼€å‘è¿›è¡Œâ€œç®€åŒ–â€å’ŒåŠ â€œå¿«â€é€Ÿåº¦ï¼Œç®€åŒ–å¼€å‘è¿‡ç¨‹ä¸­å¼•å…¥æˆ–å¯åŠ¨ç›¸å…³Spring åŠŸèƒ½çš„é…ç½®ã€‚è¿™æ ·å¸¦æ¥çš„å¥½å¤„å°±æ˜¯é™ä½å¼€å‘äººå‘˜å¯¹äºæ¡†æ¶çš„å…³æ³¨ç‚¹ï¼Œå¯ä»¥æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨è‡ªå·±çš„ä¸šåŠ¡ä»£ç ä¸Šã€‚</p><hr><hr><h2 id="2-ä¸ºä»€ä¹ˆä½¿ç”¨SpringBoot">2. ä¸ºä»€ä¹ˆä½¿ç”¨SpringBoot</h2><blockquote><p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can â€œjust runâ€.</p><p>èƒ½å¿«é€Ÿåˆ›å»ºå‡ºç”Ÿäº§çº§åˆ«çš„Springåº”ç”¨</p></blockquote><h3 id="2-1-SpringBootä¼˜ç‚¹">2.1. SpringBootä¼˜ç‚¹</h3><ol><li>ç‹¬ç«‹è¿è¡Œçš„ Spring é¡¹ç›®</li></ol><p>Spring Boot å¯ä»¥ä»¥ jar åŒ…çš„å½¢å¼ç‹¬ç«‹è¿è¡Œï¼ŒSpring Boot é¡¹ç›®åªéœ€é€šè¿‡å‘½ä»¤â€œ javaâ€“jar xx.jarâ€ å³å¯è¿è¡Œã€‚</p><ol start="2"><li>å†…åµŒ Servlet å®¹å™¨</li></ol><p>Spring Boot ä½¿ç”¨åµŒå…¥å¼çš„ Servlet å®¹å™¨ï¼ˆä¾‹å¦‚ Tomcatã€Jetty æˆ–è€… Undertow ç­‰ï¼‰ï¼Œåº”ç”¨æ— éœ€æ‰“æˆ WAR åŒ… ã€‚</p><ol start="3"><li>æä¾› starter ç®€åŒ– Maven é…ç½®</li></ol><p>Spring Boot æä¾›äº†ä¸€ç³»åˆ—çš„â€œstarterâ€é¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼ˆPOMSï¼‰æ¥ç®€åŒ– Maven é…ç½®ã€‚</p><ol start="4"><li>æä¾›äº†å¤§é‡çš„è‡ªåŠ¨é…ç½®</li></ol><p>Spring Boot æä¾›äº†å¤§é‡çš„é»˜è®¤è‡ªåŠ¨é…ç½®ï¼Œæ¥ç®€åŒ–é¡¹ç›®çš„å¼€å‘ï¼Œå¼€å‘äººå‘˜ä¹Ÿé€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹é»˜è®¤é…ç½®ã€‚</p><ol start="5"><li>è‡ªå¸¦åº”ç”¨ç›‘æ§</li></ol><p>Spring Boot å¯ä»¥å¯¹æ­£åœ¨è¿è¡Œçš„é¡¹ç›®æä¾›ç›‘æ§ã€‚</p><ol start="6"><li>æ— ä»£ç ç”Ÿæˆå’Œ xml é…ç½®</li></ol><p>Spring Boot ä¸éœ€è¦ä»»ä½• xml é…ç½®å³å¯å®ç° Spring çš„æ‰€æœ‰é…ç½®ã€‚</p><blockquote><p>SpringBootæ˜¯æ•´åˆSpringæŠ€æœ¯æ ˆçš„ä¸€ç«™å¼æ¡†æ¶ã€‚SpringBootæ˜¯ç®€åŒ–SpringæŠ€æœ¯æ ˆçš„å¿«é€Ÿå¼€å‘è„šæ‰‹æ¶</p></blockquote><h3 id="2-2-SpringBootç¼ºç‚¹">2.2. SpringBootç¼ºç‚¹</h3><ul><li>äººç§°ç‰ˆæœ¬å¸ï¼Œè¿­ä»£å¿«ï¼Œéœ€è¦æ—¶åˆ»å…³æ³¨å˜åŒ–</li><li>å°è£…å¤ªæ·±ï¼Œå†…éƒ¨åŸç†å¤æ‚ï¼Œä¸å®¹æ˜“ç²¾é€š</li></ul><hr><hr><h2 id="3-SpringBootå…¥é—¨æ¡ˆä¾‹">3. SpringBootå…¥é—¨æ¡ˆä¾‹</h2><div class="tabs" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-1"><i class="fas fa-seedling"></i>å¯¼å…¥ä¾èµ–</button></li><li class="tab"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-2"><i class="fas fa-leaf"></i>åˆ›å»ºä¸»ç¨‹åº</button></li><li class="tab"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-3"><i class="fab fa-apple"></i>ç¼–å†™ä¸šåŠ¡</button></li><li class="tab"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-4"><i class="fas fa-tree"></i>è®¾ç½®é…ç½®</button></li><li class="tab"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-5"><i class="fas fa-heartbeat"></i>è¿è¡Œ&æµ‹è¯•</button></li><li class="tab"><button type="button" data-href="#af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-6"><i class="fas fa-cookie-bite"></i>æ‰“åŒ…éƒ¨ç½²</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handle01</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Spring Boot!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-4"><p>mavenå·¥ç¨‹çš„resourceæ–‡ä»¶å¤¹ä¸­åˆ›å»ºapplication.propertiesæ–‡ä»¶ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ç«¯å£å·</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8888</span></span><br></pre></td></tr></table></figure><p><a href="https://docs.spring.io/spring-boot/docs/2.3.7.RELEASE/reference/html/appendix-application-properties.html#common-application-properties-server">æ›´å¤šé…ç½®ä¿¡æ¯</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-5"><ul><li>è¿è¡Œ<code>MainApplication</code>ç±»</li><li>æµè§ˆå™¨è¾“å…¥<code>http://localhost:8888/hello</code>ï¼Œå°†ä¼šè¾“å‡º<code>Hello, Spring Boot!</code>ã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="af6bffe9-6ec7-427e-ab96-5aa3b94e35fb-6"><p>åœ¨pom.xmlæ·»åŠ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨IDEAçš„Mavenæ’ä»¶ä¸Šç‚¹å‡»è¿è¡Œ clean ã€packageï¼ŒæŠŠhelloworldå·¥ç¨‹é¡¹ç›®çš„æ‰“åŒ…æˆjaråŒ…ï¼Œ</p><p>æ‰“åŒ…å¥½çš„jaråŒ…è¢«ç”Ÿæˆåœ¨helloworldå·¥ç¨‹é¡¹ç›®çš„targetæ–‡ä»¶å¤¹å†…ã€‚</p><p>ç”¨cmdè¿è¡Œ<code>java -jar boot-01-helloworld-1.0-SNAPSHOT.jar</code>ï¼Œæ—¢å¯ä»¥è¿è¡Œhelloworldå·¥ç¨‹é¡¹ç›®ã€‚</p><p>å°†jaråŒ…ç›´æ¥åœ¨ç›®æ ‡æœåŠ¡å™¨æ‰§è¡Œå³å¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="4-SpringBootä¾èµ–ç®¡ç†ç‰¹æ€§">4. SpringBootä¾èµ–ç®¡ç†ç‰¹æ€§</h2><blockquote><p>çˆ¶é¡¹ç›®åšä¾èµ–ç®¡ç†</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢é¡¹ç›®çš„çˆ¶é¡¹ç›®å¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å®ƒå‡ ä¹å£°æ˜äº†æ‰€æœ‰å¼€å‘ä¸­å¸¸ç”¨çš„ä¾èµ–çš„ç‰ˆæœ¬å·ï¼Œè‡ªåŠ¨ç‰ˆæœ¬ä»²è£æœºåˆ¶</p><blockquote><p>å¼€å‘å¯¼å…¥starteråœºæ™¯å¯åŠ¨å™¨</p></blockquote><ol><li>è§åˆ°å¾ˆå¤š spring-boot-starter-* ï¼š *å°±æŸç§åœºæ™¯</li><li>åªè¦å¼•å…¥starterï¼Œè¿™ä¸ªåœºæ™¯çš„æ‰€æœ‰å¸¸è§„éœ€è¦çš„ä¾èµ–æˆ‘ä»¬éƒ½è‡ªåŠ¨å¼•å…¥</li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/using-spring-boot.html#using-boot-starter">æ›´å¤šSpringBootæ‰€æœ‰æ”¯æŒçš„åœºæ™¯</a></li><li>è§åˆ°çš„  *-spring-boot-starterï¼š ç¬¬ä¸‰æ–¹ä¸ºæˆ‘ä»¬æä¾›çš„ç®€åŒ–å¼€å‘çš„åœºæ™¯å¯åŠ¨å™¨ã€‚</li></ol><mark class="hl-label blue">æ‰€æœ‰åœºæ™¯å¯åŠ¨å™¨æœ€åº•å±‚çš„ä¾èµ–</mark> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>æ— éœ€å…³æ³¨ç‰ˆæœ¬å·ï¼Œè‡ªåŠ¨ç‰ˆæœ¬ä»²è£</p><ol><li>å¼•å…¥ä¾èµ–é»˜è®¤éƒ½å¯ä»¥ä¸å†™ç‰ˆæœ¬</li><li>å¼•å…¥éç‰ˆæœ¬ä»²è£çš„jarï¼Œè¦å†™ç‰ˆæœ¬å·ã€‚</li></ol></li><li><p>å¯ä»¥ä¿®æ”¹é»˜è®¤ç‰ˆæœ¬å·</p><ol><li>æŸ¥çœ‹spring-boot-dependenciesé‡Œé¢è§„å®šå½“å‰ä¾èµ–çš„ç‰ˆæœ¬ ç”¨çš„ keyã€‚</li><li>åœ¨å½“å‰é¡¹ç›®é‡Œé¢é‡å†™é…ç½®ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ã€‚</li></ol></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.43<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><hr><h2 id="5-SpringBootè‡ªåŠ¨é…ç½®ç‰¹æ€§">5. SpringBootè‡ªåŠ¨é…ç½®ç‰¹æ€§</h2><p>é€šè¿‡ä¸Šé¢çš„å…¥é—¨æ¡ˆä¾‹</p><ul><li>è‡ªåŠ¨é…å¥½Tomcat<ul><li>å¼•å…¥Tomcatä¾èµ–ã€‚</li><li>é…ç½®Tomcat</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>è‡ªåŠ¨é…å¥½SpringMVC</p><ul><li>å¼•å…¥SpringMVCå…¨å¥—ç»„ä»¶</li><li>è‡ªåŠ¨é…å¥½SpringMVCå¸¸ç”¨ç»„ä»¶ï¼ˆåŠŸèƒ½ï¼‰</li></ul></li><li><p>è‡ªåŠ¨é…å¥½Webå¸¸è§åŠŸèƒ½ï¼Œå¦‚ï¼šå­—ç¬¦ç¼–ç é—®é¢˜</p><ul><li>SpringBootå¸®æˆ‘ä»¬é…ç½®å¥½äº†æ‰€æœ‰webå¼€å‘çš„å¸¸è§åœºæ™¯</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">//1ã€è¿”å›æˆ‘ä»¬IOCå®¹å™¨</span></span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">run</span> <span class="operator">=</span> SpringApplication.run(MainApplication.class, args);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2ã€æŸ¥çœ‹å®¹å™¨é‡Œé¢çš„ç»„ä»¶</span></span><br><span class="line">    String[] names = run.getBeanDefinitionNames();</span><br><span class="line">    <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é»˜è®¤çš„åŒ…ç»“æ„<ul><li>ä¸»ç¨‹åºæ‰€åœ¨åŒ…åŠå…¶ä¸‹é¢çš„æ‰€æœ‰å­åŒ…é‡Œé¢çš„ç»„ä»¶éƒ½ä¼šè¢«é»˜è®¤æ‰«æè¿›æ¥</li><li>æ— éœ€ä»¥å‰çš„åŒ…æ‰«æé…ç½®</li><li>æƒ³è¦æ”¹å˜æ‰«æè·¯å¾„<ul><li>@SpringBootApplication(scanBasePackages=â€œcom.atguigu.bootâ€)</li><li>@ComponentScan æŒ‡å®šæ‰«æè·¯å¾„</li></ul></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.atguigu.boot&quot;)</span></span><br></pre></td></tr></table></figure><ul><li>å„ç§é…ç½®æ‹¥æœ‰é»˜è®¤å€¼<ul><li>é»˜è®¤é…ç½®æœ€ç»ˆéƒ½æ˜¯æ˜ å°„åˆ°æŸä¸ªç±»ä¸Šï¼Œå¦‚ï¼š<code>MultipartProperties</code></li><li>é…ç½®æ–‡ä»¶çš„å€¼æœ€ç»ˆä¼šç»‘å®šæ¯ä¸ªç±»ä¸Šï¼Œè¿™ä¸ªç±»ä¼šåœ¨å®¹å™¨ä¸­åˆ›å»ºå¯¹è±¡</li></ul></li><li>æŒ‰éœ€åŠ è½½æ‰€æœ‰è‡ªåŠ¨é…ç½®é¡¹<ul><li>éå¸¸å¤šçš„starter</li><li>å¼•å…¥äº†å“ªäº›åœºæ™¯è¿™ä¸ªåœºæ™¯çš„è‡ªåŠ¨é…ç½®æ‰ä¼šå¼€å¯</li><li>SpringBootæ‰€æœ‰çš„è‡ªåŠ¨é…ç½®åŠŸèƒ½éƒ½åœ¨ spring-boot-autoconfigure åŒ…é‡Œé¢</li></ul></li><li>â€¦</li></ul>]]></content>
    
    
    <summary type="html">ä¸ºä»€ä¹ˆä½¿ç”¨SpringBootã€SpringBootå…¥é—¨æ¡ˆä¾‹</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
    <category term="SpringBoot" scheme="https://wuwawawa.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringMVC</title>
    <link href="https://wuwawawa.github.io/posts/ae0f95e0.html"/>
    <id>https://wuwawawa.github.io/posts/ae0f95e0.html</id>
    <published>2023-05-01T01:32:14.000Z</published>
    <updated>2023-05-16T05:27:22.092Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-SpringMVCç®€ä»‹">1. SpringMVCç®€ä»‹</h2><h3 id="1-1-SpringMVCæ¦‚è¿°">1.1 SpringMVCæ¦‚è¿°</h3><p>SpringMVCæ˜¯ä¸€ä¸ªåŸºäºSpringå¼€å‘çš„MVCè½»é‡çº§æ¡†æ¶ï¼ŒSpring3.0åå‘å¸ƒçš„ç»„ä»¶ï¼ŒSpringMVCå’ŒSpringå¯ä»¥æ— ç¼æ•´åˆï¼Œä½¿ç”¨<code>DispatcherServlet</code>ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œä¸”å†…éƒ¨æä¾›äº†<code>å¤„ç†å™¨æ˜ å°„å™¨</code>ã€<code>å¤„ç†å™¨é€‚é…å™¨</code>ã€<code>è§†å›¾è§£æå™¨</code>ç­‰ç»„ä»¶ï¼Œå¯ä»¥ç®€åŒ–JavaBeanå°è£…ï¼ŒJsonè½¬åŒ–ã€æ–‡ä»¶ä¸Šä¼ ç­‰æ“ä½œã€‚</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427101142279.png" alt="image-20230427101142279"></p><hr><h3 id="1-2-SpringMVCå¿«é€Ÿå…¥é—¨">1.2 SpringMVCå¿«é€Ÿå…¥é—¨</h3><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427101429465.png" alt="image-20230427101429465" style="zoom: 50%;" /><div class="tabs" id="7d28f7cb-0e19-432e-b68e-e2756885d4e9"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#7d28f7cb-0e19-432e-b68e-e2756885d4e9-1"><i class="fas fa-seedling"></i>å¯¼å…¥åæ ‡</button></li><li class="tab"><button type="button" data-href="#7d28f7cb-0e19-432e-b68e-e2756885d4e9-2"><i class="fas fa-leaf"></i>é…ç½®å‰ç«¯æ§åˆ¶å™¨</button></li><li class="tab"><button type="button" data-href="#7d28f7cb-0e19-432e-b68e-e2756885d4e9-3"><i class="fas fa-tree"></i>é…ç½®spring-mvc.xml</button></li><li class="tab"><button type="button" data-href="#7d28f7cb-0e19-432e-b68e-e2756885d4e9-4"><i class="fab fa-apple"></i>ç¼–å†™æ§åˆ¶å™¨</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="7d28f7cb-0e19-432e-b68e-e2756885d4e9-1"><p>å¯¼å…¥Springæ•´åˆSpringMVCçš„åæ ‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7d28f7cb-0e19-432e-b68e-e2756885d4e9-2"><p>åœ¨web.xmlä¸­é…ç½®SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ServletDispatcher</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŒ‡å®šspringMVCé…ç½®æ–‡ä»¶ä½ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æœåŠ¡å™¨å¯åŠ¨å°±åˆ›å»º--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7d28f7cb-0e19-432e-b68e-e2756885d4e9-3"><p>åˆ›å»ºspringMVCçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ spring-mvc.xmlï¼Œå¹¶é…ç½®ç»„ä»¶æ‰«æwebå±‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.itheima.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7d28f7cb-0e19-432e-b68e-e2756885d4e9-4"><p>ç¼–å†™ä¸€ä¸ªæ§åˆ¶å™¨Controllerï¼Œé…ç½®æ˜ å°„ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/show&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;show æ‰§è¡Œ....&quot;</span>);</span><br><span class="line">        <span class="comment">//è§†å›¾è·³è½¬åˆ°index.jsp</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="1-3-Controllerè®¿é—®å®¹å™¨Bean">1.3 Controllerè®¿é—®å®¹å™¨Bean</h3><p><code>DispatcherServlet</code>åœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼ŒåŠ è½½çš„spring-mvc.xmlé…ç½®æ–‡ä»¶åˆ›å»ºçš„SpringMVCå®¹å™¨ï¼Œé‚£ä¹ˆwebå±‚Controllerè¢«æ‰«æè¿›å…¥åˆ°äº†å®¹å™¨ä¸­ï¼Œè€Œä¹‹å‰Springå®¹å™¨ä¸­çš„Serviceæ˜¯å¦å¯ä»¥è·å–åˆ°å‘¢ï¼Ÿä¸‹é¢æ­å»ºSpringçš„webç¯å¢ƒè¿›è¡ŒéªŒè¯</p><div class="tabs" id="35c07813-7047-4374-96bb-22a4522e4cea"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#35c07813-7047-4374-96bb-22a4522e4cea-1"><i class="fas fa-cat"></i>1</button></li><li class="tab"><button type="button" data-href="#35c07813-7047-4374-96bb-22a4522e4cea-2"><i class="fas fa-horse"></i>2</button></li><li class="tab"><button type="button" data-href="#35c07813-7047-4374-96bb-22a4522e4cea-3"><i class="fas fa-dove"></i>3</button></li><li class="tab"><button type="button" data-href="#35c07813-7047-4374-96bb-22a4522e4cea-4"><i class="fas fa-dragon"></i>4</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="35c07813-7047-4374-96bb-22a4522e4cea-1"><p>åˆ›å»ºä¸€ä¸ªapplicationContext.xmlæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç»„ä»¶æ‰«æéwebå±‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.itheima&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ’é™¤com.itheimaåŒ…ä¸‹ä½¿ç”¨@Controlleræ³¨è§£çš„ç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="35c07813-7047-4374-96bb-22a4522e4cea-2"><p>åœ¨web.xmlä¸­é…ç½®ContextLoaderListener</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®ContextLoaderListener--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applictionContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="35c07813-7047-4374-96bb-22a4522e4cea-3"><p>ç¼–å†™UserServiceå’ŒUserServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserServiceImpl show running ... ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="35c07813-7047-4374-96bb-22a4522e4cea-4"><p>ä¿®æ”¹UserControllerï¼Œä»Springå®¹å™¨ä¸­åŒ¹é…Serviceè¿›è¡Œæ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/show&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;show æ‰§è¡Œ....&quot;</span>);</span><br><span class="line">        <span class="comment">//è°ƒç”¨userServiceçš„showæ–¹æ³•</span></span><br><span class="line">        userService.show();</span><br><span class="line">        <span class="comment">//è§†å›¾è·³è½¬åˆ°index.jsp</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="1-4-SpringMVCå…³é”®ç»„ä»¶æµ…æ">1.4 SpringMVCå…³é”®ç»„ä»¶æµ…æ</h3><p>ä¸Šé¢å·²ç»å®Œæˆçš„å¿«é€Ÿå…¥é—¨çš„æ“ä½œï¼Œä¹Ÿåœ¨ä¸çŸ¥ä¸è§‰ä¸­å®Œæˆçš„Springå’ŒSpringMVCçš„æ•´åˆï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§è§„åˆ™å»å®šä¹‰Controllerå’Œä¸šåŠ¡æ–¹æ³•å°±å¯ä»¥ã€‚ä½†æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè‚¯å®šæ˜¯å¾ˆå¤šæ ¸å¿ƒåŠŸèƒ½ç±»å‚ä¸åˆ°å…¶ä¸­ï¼Œè¿™äº›æ ¸å¿ƒåŠŸèƒ½ç±»ï¼Œä¸€èˆ¬ç§°ä¸ºç»„ä»¶ã€‚å½“è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œæ˜¯å“ªä¸ªç»„ä»¶æ¥æ”¶çš„è¯·æ±‚ï¼Œæ˜¯å“ªä¸ªç»„ä»¶å¸®æˆ‘ä»¬æ‰¾åˆ°çš„Controllerï¼Œæ˜¯å“ªä¸ªç»„ä»¶å¸®æˆ‘ä»¬è°ƒç”¨çš„æ–¹æ³•ï¼Œåˆæ˜¯å“ªä¸ªç»„ä»¶æœ€ç»ˆè§£æçš„è§†å›¾ï¼Ÿ</p><p><span id="jump1"></span></p><table><thead><tr><th style="text-align:left">ç»„ä»¶</th><th style="text-align:left">æè¿°</th><th style="text-align:left">å¸¸ç”¨ç»„</th></tr></thead><tbody><tr><td style="text-align:left">å¤„ç†å™¨æ˜ å°„å™¨ï¼šHandlerMapping</td><td style="text-align:left">åŒ¹é…æ˜ å°„è·¯å¾„å¯¹åº”çš„Handlerï¼Œè¿”å›å¯æ‰§è¡Œçš„å¤„ç†å™¨é“¾å¯¹è±¡HandlerExecutionChainå¯¹è±¡</td><td style="text-align:left">RequestMappingHandlerMapping</td></tr><tr><td style="text-align:left">å¤„ç†å™¨é€‚é…å™¨ï¼šHandlerAdapter</td><td style="text-align:left">åŒ¹é…HandlerExecutionChainå¯¹åº”çš„é€‚é…å™¨è¿›è¡Œå¤„ç†å™¨è°ƒç”¨ï¼Œè¿”å›è§†å›¾æ¨¡å‹å¯¹è±¡</td><td style="text-align:left">RequestMappingHandlerAdapter</td></tr><tr><td style="text-align:left">è§†å›¾è§£æå™¨ï¼šViewResolver</td><td style="text-align:left">å¯¹è§†å›¾æ¨¡å‹å¯¹è±¡è¿›è¡Œè§£æ</td><td style="text-align:left">InternalResourceViewResolver</td></tr></tbody></table><p>å…ˆç®€å•äº†è§£ä¸€ä¸‹ä»¥ä¸Šä¸‰ä¸ªé‡è¦ç»„ä»¶çš„å…³ç³»<a href="#jump2">ç‚¹å‡»è·³è½¬â†“â†“â†“â†“</a></p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427103049084.png" alt="image-20230427103049084" style="zoom:80%;" /><p>SpringMVCçš„é»˜è®¤ç»„ä»¶ï¼ŒSpringMVCåœ¨å‰ç«¯æ§åˆ¶å™¨DispatcherServletåŠ è½½æ—¶ï¼Œå°±ä¼šè¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œåœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œå°±ä¼šåŠ è½½SpringMVCé»˜è®¤æŒ‡å®šçš„ä¸€äº›ç»„ä»¶ï¼Œè¿™äº›é»˜è®¤ç»„ä»¶é…ç½®åœ¨<code>DispatcherServlet.properties</code>æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å­˜åœ¨ä¸spring-webmvc-5.3.7.jaråŒ…ä¸‹çš„org\springframework\web\servlet\DispatcherServlet.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">org.springframework.web.servlet.HandlerMapping</span>=<span class="string">org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,\</span></span><br><span class="line"><span class="string">org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping,\</span></span><br><span class="line"><span class="string">org.springframework.web.servlet.function.support.RouterFunctionMapping</span></span><br><span class="line"></span><br><span class="line"><span class="attr">org.springframework.web.servlet.HandlerAdapter</span>=<span class="string">org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,\</span></span><br><span class="line"><span class="string">org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,\</span></span><br><span class="line"><span class="string">org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter,\</span></span><br><span class="line"><span class="string">org.springframework.web.servlet.function.support.HandlerFunctionAdapter</span></span><br><span class="line"></span><br><span class="line"><span class="attr">org.springframework.web.servlet.ViewResolver</span>=<span class="string">org.springframework.web.servlet.view.InternalResourceViewResolver</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#çœç•¥å…¶ä»–ä»£ç </span></span><br></pre></td></tr></table></figure><blockquote><ol><li>BeanNameUrlHandlerMappingï¼š</li></ol><p><code>BeanNameUrlHandlerMapping</code> æ˜¯ Spring MVC æ¡†æ¶ä¸­æœ€ç®€å•çš„å¤„ç†å™¨æ˜ å°„å™¨ä¹‹ä¸€ï¼Œå®ƒæ˜¯å°†è¯·æ±‚çš„ URL æ˜ å°„åˆ° Spring å®¹å™¨ä¸­çš„ Bean åç§°ä¸Šã€‚å½“ç”¨æˆ·å‘é€ä¸€ä¸ªè¯·æ±‚åˆ° Spring MVC æ¡†æ¶æ—¶ï¼Œ<code>BeanNameUrlHandlerMapping</code> ä¼šæ ¹æ®è¯·æ±‚çš„ URL æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨ Beanã€‚</p><ol start="2"><li>RequestMappingHandlerMappingï¼š</li></ol><p><code>RequestMappingHandlerMapping</code> æ˜¯ Spring MVC æ¡†æ¶ä¸­å¸¸ç”¨çš„å¤„ç†å™¨æ˜ å°„å™¨ï¼Œå®ƒé€šè¿‡æ³¨è§£ <code>@RequestMapping</code> å’Œå¤„ç†å™¨æ–¹æ³•çš„å‚æ•°æ¥ç¡®å®šè¯·æ±‚çš„å¤„ç†å™¨ã€‚å®ƒå¯ä»¥å°†ä¸€ä¸ªæˆ–å¤šä¸ª <code>@RequestMapping</code> æ³¨è§£å’Œä¸€ä¸ªå¤„ç†å™¨æ–¹æ³•æ˜ å°„åœ¨ä¸€èµ·ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ Ant é£æ ¼å’Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…è¯·æ±‚è·¯å¾„ã€‚</p><ol start="3"><li>RouterFunctionMappingï¼š</li></ol><p><code>RouterFunctionMapping</code> æ˜¯ Spring WebFlux æ¡†æ¶ä¸­çš„å¤„ç†å™¨æ˜ å°„å™¨ï¼Œå®ƒåŸºäºå‡½æ•°å¼ç¼–ç¨‹æ¨¡å‹æ¥å®šä¹‰è¯·æ±‚å¤„ç†å™¨çš„è·¯ç”±ï¼Œæ”¯æŒ Reactive Streams è§„èŒƒï¼Œå¯ä»¥å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€‚åœ¨ Spring WebFlux ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>RouterFunction</code> æ¥å®šä¹‰è¯·æ±‚çš„å¤„ç†è·¯ç”±ï¼Œ<code>RouterFunctionMapping</code> ä¼šæ ¹æ®è¯·æ±‚çš„è·¯å¾„å’Œ HTTP æ–¹æ³•æ¥åŒ¹é…å¯¹åº”çš„ <code>RouterFunction</code>ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªåŒ¹é…çš„å¤„ç†å™¨å‡½æ•°ã€‚ä¸ Spring MVC ä¸åŒï¼ŒSpring WebFlux ä¸éœ€è¦å°†è¯·æ±‚å¤„ç†å™¨æ˜ å°„åˆ°å…·ä½“çš„ Java æ–¹æ³•ä¸Šï¼Œè€Œæ˜¯å¯ä»¥åŸºäºå‡½æ•°å¼ç¼–ç¨‹é£æ ¼æ¥å®ç°ä¸šåŠ¡é€»è¾‘ã€‚</p></blockquote><p>è¿™äº›é»˜è®¤çš„ç»„ä»¶æ˜¯åœ¨<code>DispatcherServlet</code>ä¸­è¿›è¡Œåˆå§‹åŒ–åŠ è½½çš„ï¼Œåœ¨DispatcherServletä¸­å­˜åœ¨é›†åˆå­˜å‚¨ç€è¿™äº›ç»„ä»¶ï¼Œ SpringMVCçš„é»˜è®¤ç»„ä»¶ä¼šåœ¨<code>DispatcherServlet</code>ä¸­è¿›è¡Œç»´æŠ¤ï¼Œ<span class='p red'>ä½†æ˜¯å¹¶æ²¡æœ‰å­˜å‚¨åœ¨ä¸SpringMVCçš„å®¹å™¨ä¸­</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">FrameworkServlet</span> &#123;</span><br><span class="line">    <span class="comment">//å­˜å‚¨å¤„ç†å™¨æ˜ å°„å™¨</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;HandlerMapping&gt; handlerMappings;</span><br><span class="line">    <span class="comment">//å­˜å‚¨å¤„ç†å™¨é€‚é…å™¨</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;HandlerAdapter&gt; handlerAdapters;</span><br><span class="line">    <span class="comment">//å­˜å‚¨è§†å›¾è§£æå™¨</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;ViewResolver&gt; viewResolvers;</span><br><span class="line">    <span class="comment">// ... çœç•¥å…¶ä»–ä»£ç  ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®ç»„ä»¶ä»£æ›¿é»˜è®¤ç»„ä»¶ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨é»˜è®¤ç»„ä»¶ï¼Œå¯ä»¥å°†æ›¿ä»£æ–¹æ¡ˆä½¿ç”¨Spring Beançš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä¾‹å¦‚ï¼Œåœ¨spring-mvc.xmlä¸­é…ç½®<code>RequestMappingHandlerMapping</code></p><p><code>&lt;bean class=&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&quot;/&gt;</code></p><p>å½“æˆ‘ä»¬åœ¨Springå®¹å™¨ä¸­é…ç½®äº†HandlerMappingï¼Œåˆ™å°±ä¸ä¼šåœ¨åŠ è½½é»˜è®¤çš„HandlerMappingç­–ç•¥äº†ï¼ŒåŸç†æ¯”è¾ƒç®€å•ï¼Œ DispatcherServlet åœ¨è¿›è¡ŒHandlerMappingåˆå§‹åŒ–æ—¶ï¼Œå…ˆä»SpringMVCå®¹å™¨ä¸­æ‰¾æ˜¯å¦å­˜åœ¨HandlerMappingï¼Œå¦‚æœå­˜åœ¨ç›´æ¥å–å‡ºå®¹å™¨ä¸­çš„HandlerMappingï¼Œåœ¨å­˜å‚¨åˆ° DispatcherServlet ä¸­çš„handlerMappingsé›†åˆä¸­å»ã€‚</p><hr><hr><h2 id="2-SpringMVCçš„è¯·æ±‚å¤„ç†">2. SpringMVCçš„è¯·æ±‚å¤„ç†</h2><h3 id="2-1-è¯·æ±‚æ˜ å°„è·¯å¾„çš„é…ç½®">2.1 è¯·æ±‚æ˜ å°„è·¯å¾„çš„é…ç½®</h3><p>é…ç½®æ˜ å°„è·¯å¾„ï¼Œæ˜ å°„å™¨å¤„ç†å™¨æ‰èƒ½æ‰¾åˆ°Controllerçš„æ–¹æ³•èµ„æºï¼Œç›®å‰ä¸»æµæ˜ å°„è·¯å¾„é…ç½®æ–¹å¼å°±æ˜¯@RequestMapping</p><table><thead><tr><th style="text-align:left">ç›¸å…³æ³¨è§£</th><th style="text-align:left">ä½œç”¨</th><th style="text-align:left">ä½¿ç”¨ä½ç½®</th></tr></thead><tbody><tr><td style="text-align:left">@RequestMapping</td><td style="text-align:left">è®¾ç½®æ§åˆ¶å™¨æ–¹æ³•çš„è®¿é—®èµ„æºè·¯å¾„ï¼Œå¯ä»¥æ¥æ”¶ä»»ä½•è¯·æ±‚</td><td style="text-align:left">æ–¹æ³•å’Œç±»ä¸Š</td></tr><tr><td style="text-align:left">@GetMapping</td><td style="text-align:left">è®¾ç½®æ§åˆ¶å™¨æ–¹æ³•çš„è®¿é—®èµ„æºè·¯å¾„ï¼Œå¯ä»¥æ¥æ”¶GETè¯·æ±‚</td><td style="text-align:left">æ–¹æ³•å’Œç±»ä¸Š</td></tr><tr><td style="text-align:left">@PostMapping</td><td style="text-align:left">è®¾ç½®æ§åˆ¶å™¨æ–¹æ³•çš„è®¿é—®èµ„æºè·¯å¾„ï¼Œå¯ä»¥æ¥æ”¶POSTè¯·æ±‚</td><td style="text-align:left">æ–¹æ³•å’Œç±»ä¸Š</td></tr></tbody></table><p>@RequestMappingæ³¨è§£ï¼Œä¸»è¦ä½¿ç”¨åœ¨æ§åˆ¶å™¨çš„æ–¹æ³•ä¸Šï¼Œç”¨äºæ ‡è¯†å®¢æˆ·ç«¯è®¿é—®èµ„æºè·¯å¾„ï¼Œå¸¸ç”¨çš„å±æ€§æœ‰valueã€path ã€methodã€headersã€paramsç­‰ã€‚å½“@RequestMappingåªæœ‰ä¸€ä¸ªè®¿é—®è·¯å¾„éœ€è¦æŒ‡å®šæ—¶ï¼Œä½¿ç”¨valueå±æ€§ã€pathå±æ€§æˆ–çœç•¥valueå’Œpathï¼Œå½“æœ‰å¤šä¸ªå±æ€§æ—¶ï¼Œvalueå’Œpathä¸èƒ½çœç•¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/show&quot;)</span><span class="comment">//ä½¿ç”¨valueå±æ€§æŒ‡å®šä¸€ä¸ªè®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="meta">@RequestMapping(value = &#123;&quot;/show&quot;,&quot;/haohao&quot;,&quot;/abc&quot;&#125;)</span><span class="comment">//ä½¿ç”¨valueå±æ€§æŒ‡å®šå¤šä¸ªè®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="meta">@RequestMapping(path = &quot;/show&quot;)</span><span class="comment">//ä½¿ç”¨pathå±æ€§æŒ‡å®šä¸€ä¸ªè®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="meta">@RequestMapping(path = &#123;&quot;/show&quot;,&quot;/haohao&quot;,&quot;/abc&quot;&#125;)</span><span class="comment">//ä½¿ç”¨pathå±æ€§æŒ‡å®šå¤šä¸ªè®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/show&quot;)</span><span class="comment">//å¦‚æœåªè®¾ç½®è®¿é—®è·¯å¾„æ—¶ï¼Œvalueå’Œpathå¯ä»¥çœç•¥</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"><span class="meta">@RequestMapping(&#123;&quot;/show&quot;,&quot;/haohao&quot;,&quot;/abc&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>å½“@RequestMapping éœ€è¦é™å®šè®¿é—®æ–¹å¼æ—¶ï¼Œå¯ä»¥é€šè¿‡methodå±æ€§è®¾ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯·æ±‚åœ°å€æ˜¯/show,ä¸”è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯POSTæ‰èƒ½åŒ¹é…æˆåŠŸ</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/show&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>methodçš„å±æ€§å€¼æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">RequestMethod</span> &#123;</span><br><span class="line">    GET,</span><br><span class="line">    HEAD,</span><br><span class="line">    POST,</span><br><span class="line">    PUT,</span><br><span class="line">    PATCH,</span><br><span class="line">    DELETE,</span><br><span class="line">    OPTIONS,</span><br><span class="line">    TRACE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">RequestMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@GetMappingï¼Œå½“è¯·æ±‚æ–¹å¼æ˜¯GETæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@GetMappingæ›¿ä»£@RequestMapping</p><p>@PostMappingï¼Œå½“è¯·æ±‚æ–¹å¼æ˜¯POSTæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@PostMappingæ›¿ä»£@RequestMapping</p><p>@RequestMapping åœ¨ç±»ä¸Šä½¿ç”¨ï¼Œ@RequestMapping ã€@GetMappingã€@PostMappingè¿˜å¯ä»¥ä½¿ç”¨åœ¨Controllerç±»ä¸Šï¼Œä½¿ç”¨åœ¨ç±»ä¸Šåï¼Œè¯¥ç±»æ‰€æœ‰æ–¹æ³•éƒ½å…¬ç”¨è¯¥@RequestMappingè®¾ç½®çš„å±æ€§ï¼Œè®¿é—®è·¯å¾„åˆ™ä¸ºç±»ä¸Šçš„æ˜ å°„åœ°å€+æ–¹æ³•ä¸Šçš„æ˜ å°„åœ°å€ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/xxx&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContextAware</span>, ServletContextAware &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/aaa&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">aaa</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ModelAndViewDefiningException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶çš„è®¿é—®è·¯å¾„ä¸ºï¼š/xxx/aaa</p><hr><h3 id="2-2-è¯·æ±‚æ•°æ®çš„æ¥æ”¶">2.2 è¯·æ±‚æ•°æ®çš„æ¥æ”¶</h3><h4 id="2-2-1-æ™®é€šæ•°æ®æ¥æ”¶">2.2.1 æ™®é€šæ•°æ®æ¥æ”¶</h4><div class="tabs" id="ecb55e13-9f27-42be-bc95-be55bab0db3e"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ecb55e13-9f27-42be-bc95-be55bab0db3e-1"><i class="fas fa-award"></i>æ™®é€šè¯·æ±‚æ•°æ®</button></li><li class="tab"><button type="button" data-href="#ecb55e13-9f27-42be-bc95-be55bab0db3e-2"><i class="fas fa-baseball-ball"></i>æ•°ç»„æˆ–é›†åˆæ•°æ®</button></li><li class="tab"><button type="button" data-href="#ecb55e13-9f27-42be-bc95-be55bab0db3e-3"><i class="fas fa-bone"></i>å®ä½“JavaBeanå±æ€§æ•°æ®</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ecb55e13-9f27-42be-bc95-be55bab0db3e-1"><blockquote><p>æ¥æ”¶æ™®é€šè¯·æ±‚æ•°æ®ï¼Œå½“å®¢æˆ·ç«¯æäº¤çš„æ•°æ®æ˜¯æ™®é€šé”®å€¼å¯¹å½¢å¼æ—¶ï¼Œç›´æ¥ä½¿ç”¨åŒåå½¢å‚æ¥æ”¶å³å¯</p></blockquote><p><code>username=haohao&amp;age=35</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(String username, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">    System.out.println(username+<span class="string">&quot;==&quot;</span>+age); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¥æ”¶æ™®é€šè¯·æ±‚æ•°æ®ï¼Œå½“è¯·æ±‚å‚æ•°çš„åç§°ä¸æ–¹æ³•å‚æ•°åä¸ä¸€è‡´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨@RequestParamæ³¨è§£è¿›è¡Œæ ‡æ³¨</p></blockquote><p><code>username=haohao&amp;age=35</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestParam(name = &quot;username&quot;,required = true)</span> String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">    System.out.println(name+<span class="string">&quot;==&quot;</span>+age); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ecb55e13-9f27-42be-bc95-be55bab0db3e-2"><blockquote><p>æ¥æ”¶æ•°ç»„æˆ–é›†åˆæ•°æ®ï¼Œå®¢æˆ·ç«¯ä¼ é€’å¤šä¸ªåŒåå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ¥æ”¶</p></blockquote><p><code>hobbies=eat&amp;hobbies=sleep</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(String[] hobbies)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (String hobby : hobbies) &#123;</span><br><span class="line">        System.out.println(hobby);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä¼ é€’å¤šä¸ªåŒåå‚æ•°æ—¶ï¼Œ<span class='p blue'>ä¹Ÿå¯ä»¥ä½¿ç”¨å•åˆ—é›†åˆæ¥æ”¶ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨@RequestParam</span>ï¼Œå‘ŠçŸ¥æ¡†æ¶ä¼ é€’çš„å‚æ•°æ˜¯è¦åŒåè®¾ç½®çš„ï¼Œä¸æ˜¯å¯¹è±¡å±æ€§è®¾ç½®çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;String&gt; hobbies)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (String hobby : hobbies) &#123;</span><br><span class="line">        System.out.println(hobby);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¥æ”¶æ•°ç»„æˆ–é›†åˆæ•°æ®ï¼Œå®¢æˆ·ç«¯ä¼ é€’å¤šä¸ªä¸åŒå‘½å‚æ•°æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Map&lt;String,Object&gt; è¿›è¡Œæ¥æ”¶ï¼ŒåŒæ ·éœ€è¦ç”¨@RequestParam è¿›è¡Œä¿®é¥°</p></blockquote><p><code>username=haohao&amp;age=18</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestParam</span> Map&lt;String,Object&gt; params)</span>&#123;</span><br><span class="line">    params.forEach((key,value)-&gt;&#123;</span><br><span class="line">        System.out.println(key+<span class="string">&quot;==&quot;</span>+value);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ecb55e13-9f27-42be-bc95-be55bab0db3e-3"><blockquote><p>æ¥æ”¶å®ä½“JavaBeanå±æ€§æ•°æ®ï¼Œå•ä¸ªJavaBeanæ•°æ®ï¼šæäº¤çš„å‚æ•°åç§°åªè¦ä¸Javaçš„å±æ€§åä¸€è‡´ï¼Œå°±å¯ä»¥è¿›è¡Œè‡ªåŠ¨å°è£…</p></blockquote><p><code>username=haohao&amp;age=35&amp;hobbies=eat&amp;hobbies=sleep</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String[] hobbies;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">    <span class="comment">//... çœç•¥getå’Œsetæ–¹æ³• ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    System.out.println(user); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ”¶å®ä½“JavaBeanå±æ€§æ•°æ®ï¼ŒåµŒå¥—JavaBeanæ•°æ®ï¼šæäº¤çš„å‚æ•°åç§°ç”¨<code>.</code>å»æè¿°åµŒå¥—å¯¹è±¡çš„å±æ€§å…³ç³»å³å¯</p><p><code>username=haohao&amp;address.city=tianjin&amp;address.area=jinghai</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h4 id="2-2-2-Jsonæ•°æ®æ¥æ”¶">2.2.2 Jsonæ•°æ®æ¥æ”¶</h4><blockquote><p>è¯·æ±‚æ•°æ®çš„æ¥æ”¶æ¥æ”¶Jsonæ•°æ®æ ¼å¼æ•°æ®ï¼Œ<span class='p blue'>Jsonæ•°æ®éƒ½æ˜¯ä»¥è¯·æ±‚ä½“çš„æ–¹å¼æäº¤çš„</span>ï¼Œä¸”ä¸æ˜¯åŸå§‹çš„é”®å€¼å¯¹æ ¼å¼çš„ï¼Œ<span class='p green'>æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨@RequestBodyæ³¨è§£æ•´ä½“æ¥æ”¶è¯¥æ•°æ®ã€‚</span></p></blockquote><p>å¼€å‘æµ‹è¯•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Postmanè¿›è¡Œæµ‹è¯•</p><div class="tabs" id="0630c36b-b8e8-4a06-a39d-4af3b9da3164"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#0630c36b-b8e8-4a06-a39d-4af3b9da3164-1"><i class="fas fa-atom"></i>æ¥æ”¶Jsonæ•°æ®</button></li><li class="tab"><button type="button" data-href="#0630c36b-b8e8-4a06-a39d-4af3b9da3164-2"><i class="far fa-sun"></i>ä½¿ç”¨Jsonå·¥å…·è¿›è¡Œè½¬æ¢</button></li><li class="tab"><button type="button" data-href="#0630c36b-b8e8-4a06-a39d-4af3b9da3164-3"><i class="fas fa-wind"></i>é…ç½®RequestMappingHandlerAdapter</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="0630c36b-b8e8-4a06-a39d-4af3b9da3164-1"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;haohao&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;hobbies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;eat&quot;</span><span class="punctuation">,</span><span class="string">&quot;sleep&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;birthday&quot;</span><span class="punctuation">:</span><span class="string">&quot;1986-01-01&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span><span class="string">&quot;tj&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;area&quot;</span><span class="punctuation">:</span><span class="string">&quot;binhai&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/show6&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show6</span><span class="params">(<span class="meta">@RequestBody</span> String body)</span>&#123;</span><br><span class="line">    System.out.println(body); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0630c36b-b8e8-4a06-a39d-4af3b9da3164-2"><p>ä½¿ç”¨Jsonå·¥å…·ï¼ˆ jackson ï¼‰å°†Jsonæ ¼å¼çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºJavaBeanè¿›è¡Œæ“ä½œ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestBody</span> String body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    System.out.println(body);</span><br><span class="line">    <span class="comment">//è·å¾—ObjectMapper</span></span><br><span class="line">    <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">    <span class="comment">//å°†jsonæ ¼å¼å­—ç¬¦ä¸²è½¬åŒ–æˆæŒ‡å®šçš„User</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> objectMapper.readValue(body, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="0630c36b-b8e8-4a06-a39d-4af3b9da3164-3"><p>é…ç½®<code>RequestMappingHandlerAdapter</code>ï¼ŒæŒ‡å®šæ¶ˆæ¯è½¬æ¢å™¨ï¼Œå°±ä¸ç”¨æ‰‹åŠ¨è½¬æ¢jsonæ ¼å¼å­—ç¬¦ä¸²äº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;messageConverters&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ”¶Jsonæ•°æ®æ ¼å¼æ•°æ®ï¼Œä½¿ç”¨Mapæ¥æ”¶jsonæ ¼å¼å­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/show&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show</span><span class="params">(<span class="meta">@RequestBody</span> Map map)</span>&#123;</span><br><span class="line">    System.out.println(map); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><h4 id="2-2-3-æ¥æ”¶Restfulé£æ ¼æ•°æ®">2.2.3 æ¥æ”¶Restfulé£æ ¼æ•°æ®</h4><p>ä»€ä¹ˆæ˜¯Resté£æ ¼ï¼Ÿ<br>Restï¼ˆRepresentational State Transferï¼‰è¡¨è±¡åŒ–çŠ¶æ€è½¬å˜ï¼ˆè¡¨è¿°æ€§çŠ¶æ€è½¬å˜ï¼‰ï¼Œåœ¨2000å¹´è¢«æå‡ºï¼ŒåŸºäºHTTPã€URI ã€xmlã€JSONç­‰æ ‡å‡†å’Œåè®®ï¼Œæ”¯æŒè½»é‡çº§ã€è·¨å¹³å°ã€è·¨è¯­è¨€çš„æ¶æ„è®¾è®¡ã€‚æ˜¯WebæœåŠ¡çš„ä¸€ç§æ–°ç½‘ç»œåº”ç”¨ç¨‹åºçš„è®¾è®¡é£æ ¼å’Œå¼€å‘æ–¹å¼ã€‚</p><p>Restfulé£æ ¼çš„è¯·æ±‚ï¼Œå¸¸è§çš„è§„åˆ™æœ‰å¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><p>ç”¨URIè¡¨ç¤ºæŸä¸ªæ¨¡å—èµ„æºï¼Œèµ„æºåç§°ä¸ºåè¯ï¼›</p><table><thead><tr><th style="text-align:left">æ¨¡å—</th><th style="text-align:left">URIèµ„æº</th></tr></thead><tbody><tr><td style="text-align:left">ç”¨æˆ·æ¨¡å—user</td><td style="text-align:left"><code>http://localhost/user</code></td></tr><tr><td style="text-align:left">å•†å“æ¨¡å—product</td><td style="text-align:left"><code>http://localhost/product</code></td></tr><tr><td style="text-align:left">è´¦æˆ·æ¨¡å—account</td><td style="text-align:left"><code>http://localhost/account</code></td></tr><tr><td style="text-align:left">æ—¥å¿—æ¨¡å—log</td><td style="text-align:left"><code>http://localhost/log</code></td></tr></tbody></table><p>ç”¨è¯·æ±‚æ–¹å¼è¡¨ç¤ºæ¨¡å—å…·ä½“ä¸šåŠ¡åŠ¨ä½œï¼Œä¾‹å¦‚ï¼šGETè¡¨ç¤ºæŸ¥è¯¢ã€POSTè¡¨ç¤ºæ’å…¥ã€PUTè¡¨ç¤ºæ›´æ–°ã€DELETEè¡¨ç¤ºåˆ é™¤</p><table><thead><tr><th style="text-align:left">URIèµ„æº</th><th style="text-align:left">è¯·æ±‚æ–¹å¼</th><th style="text-align:left">å‚æ•°</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>http://localhost/user/100</code></td><td style="text-align:left">GET</td><td style="text-align:left">å­˜åœ¨URLåœ°å€ä¸­ï¼š100</td><td style="text-align:left">æŸ¥è¯¢id=100çš„Useræ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/user</code></td><td style="text-align:left">POST</td><td style="text-align:left">å­˜åœ¨è¯·æ±‚ä½“ä¸­Jsonï¼š{â€œusernameâ€:â€œhaohaoâ€,â€œageâ€:18}</td><td style="text-align:left">æ’å…¥Useræ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/user</code></td><td style="text-align:left">PUT</td><td style="text-align:left">å­˜åœ¨è¯·æ±‚ä½“ä¸­Jsonï¼š{â€œidâ€:100,â€œusernameâ€:â€œhaohaoâ€,â€œageâ€:18}</td><td style="text-align:left">ä¿®æ”¹id=100çš„Useræ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/user/100</code></td><td style="text-align:left">DELETE</td><td style="text-align:left">å­˜åœ¨URLåœ°å€ä¸­ï¼š100</td><td style="text-align:left">åˆ é™¤id=100çš„Useræ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/product/5</code></td><td style="text-align:left">GET</td><td style="text-align:left">å­˜åœ¨URLåœ°å€ä¸­ï¼š5</td><td style="text-align:left">æŸ¥è¯¢id=5çš„Productæ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/product</code></td><td style="text-align:left">POST</td><td style="text-align:left">å­˜åœ¨è¯·æ±‚ä½“ä¸­Jsonï¼š{â€œproNameâ€:â€œå°ç±³æ‰‹æœºâ€,â€œpriceâ€:1299}</td><td style="text-align:left">æ’å…¥Productæ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/product</code></td><td style="text-align:left">PUT</td><td style="text-align:left">å­˜åœ¨è¯·æ±‚ä½“ä¸­Jsonï¼š{â€œidâ€:5,â€œproNameâ€:â€œå°ç±³æ‰‹æœºâ€,â€œpriceâ€:1299}</td><td style="text-align:left">ä¿®æ”¹id=5çš„Productæ•°æ®</td></tr><tr><td style="text-align:left"><code>http://localhost/product/5</code></td><td style="text-align:left">DELETE</td><td style="text-align:left">å­˜åœ¨URLåœ°å€ä¸­ï¼š5</td><td style="text-align:left">åˆ é™¤id=5çš„Productæ•°æ®</td></tr></tbody></table><p>ç”¨HTTPå“åº”çŠ¶æ€ç è¡¨ç¤ºç»“æœï¼Œå›½å†…å¸¸ç”¨çš„å“åº”åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼šçŠ¶æ€ç ã€çŠ¶æ€ä¿¡æ¯ã€å“åº”æ•°æ®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">200</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;haohao&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="number">18</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">300</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ‰§è¡Œé”™è¯¯&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ¥æ”¶Restfulé£æ ¼æ•°æ®ï¼ŒRestfulè¯·æ±‚æ•°æ®ä¸€èˆ¬ä¼šåœ¨URLåœ°å€ä¸Šæºå¸¦ï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£ @PathVariable(å ä½ç¬¦å‚æ•°åç§°)</p><p>ä¸åŠ æ³¨è§£ä¼šä»¥ä¸ºæ˜¯å‰é¢é”®å€¼å¯¹çš„å½¢å¼ã€‚</p><p><code>http://localhost/user/100</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">findUserById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line">    System.out.println(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ±‚URLèµ„æºåœ°å€åŒ…å«å¤šä¸ªå‚æ•°æƒ…å†µ</p><p><code>http://localhost/user/haohao/18</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/user/&#123;username&#125;/&#123;age&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">findUserByUsernameAndAge</span><span class="params">(<span class="meta">@PathVariable(&quot;username&quot;)</span> String username,<span class="meta">@PathVariable(&quot;age&quot;)</span> Integer age)</span>&#123;</span><br><span class="line">    System.out.println(username+<span class="string">&quot;==&quot;</span>+age); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="2-2-4-æ¥æ”¶æ–‡ä»¶æ•°æ®">2.2.4 æ¥æ”¶æ–‡ä»¶æ•°æ®</h4><p>æ¥æ”¶æ–‡ä»¶ä¸Šä¼ çš„æ•°æ®ï¼Œæ–‡ä»¶ä¸Šä¼ çš„è¡¨å•éœ€è¦ä¸€å®šçš„è¦æ±‚ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>è¡¨å•çš„æäº¤æ–¹å¼å¿…é¡»æ˜¯POST</li><li>è¡¨å•çš„enctypeå±æ€§å¿…é¡»æ˜¯multipart/form-data</li><li>æ–‡ä»¶ä¸Šä¼ é¡¹éœ€è¦æœ‰nameå±æ€§</li></ul><div class="tabs" id="337f457c-7cf8-407b-9d5b-2b5e3ba1d172"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#337f457c-7cf8-407b-9d5b-2b5e3ba1d172-1"><i class="fas fa-bug"></i>å‰ç«¯</button></li><li class="tab"><button type="button" data-href="#337f457c-7cf8-407b-9d5b-2b5e3ba1d172-2"><i class="fas fa-cannabis"></i>æœåŠ¡å™¨ç«¯é…ç½®</button></li><li class="tab"><button type="button" data-href="#337f457c-7cf8-407b-9d5b-2b5e3ba1d172-3"><i class="fas fa-candy-cane"></i>æ¥æ”¶ä»£ç </button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="337f457c-7cf8-407b-9d5b-2b5e3ba1d172-1"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;myFile&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="337f457c-7cf8-407b-9d5b-2b5e3ba1d172-2"><p>æœåŠ¡å™¨ç«¯ï¼Œç”±äºæ˜ å°„å™¨é€‚é…å™¨éœ€è¦æ–‡ä»¶ä¸Šä¼ è§£æå™¨ï¼Œè€Œè¯¥è§£æå™¨é»˜è®¤æœªè¢«æ³¨å†Œï¼Œæ‰€ä»¥æ‰‹åŠ¨æ³¨å†Œ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨ï¼Œæ³¨æ„ï¼šidçš„åå­—æ˜¯å›ºå®šå†™æ³•--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span><span class="comment">&lt;!--æ–‡ä»¶çš„ç¼–ç æ ¼å¼ é»˜è®¤æ˜¯ISO8859-1--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSizePerFile&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1048576&quot;</span>/&gt;</span><span class="comment">&lt;!--ä¸Šä¼ çš„æ¯ä¸ªæ–‡ä»¶é™åˆ¶çš„å¤§å° å•ä½å­—èŠ‚--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3145728&quot;</span>/&gt;</span><span class="comment">&lt;!--ä¸Šä¼ æ–‡ä»¶çš„æ€»å¤§å°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxInMemorySize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1048576&quot;</span>/&gt;</span><span class="comment">&lt;!--ä¸Šä¼ æ–‡ä»¶çš„ç¼“å­˜å¤§å°--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è€ŒCommonsMultipartResolveråº•å±‚ä½¿ç”¨çš„Apacheçš„æ˜¯Common-fileupladç­‰å·¥å…·APIè¿›è¡Œçš„æ–‡ä»¶ä¸Šä¼ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="337f457c-7cf8-407b-9d5b-2b5e3ba1d172-3"><p>ä½¿ç”¨MultipartFileç±»å‹æ¥æ”¶ä¸Šä¼ æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/fileUpload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">fileUpload</span><span class="params">(<span class="meta">@RequestBody</span> MultipartFile myFile)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    System.out.println(myFile);</span><br><span class="line">    <span class="comment">//è·å¾—ä¸Šä¼ çš„æ–‡ä»¶çš„æµå¯¹è±¡</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> myFile.getInputStream(); <span class="comment">//ä½¿ç”¨commons-ioå­˜å‚¨åˆ°C:\haohao\abc.txtä½ç½®</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;C:\\Users\\haohao\\&quot;</span>+myFile.getOriginalFilename());</span><br><span class="line">    IOUtils.copy(inputStream,outputStream);</span><br><span class="line">    <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">    inputStream.close();</span><br><span class="line">    outputStream.close();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h4 id="2-2-5-æ¥æ”¶è¯·æ±‚å¤´æ•°æ®">2.2.5 æ¥æ”¶è¯·æ±‚å¤´æ•°æ®</h4><p>æ¥æ”¶Httpè¯·æ±‚å¤´æ•°æ®ï¼Œæ¥æ”¶æŒ‡å®šåç§°çš„è¯·æ±‚å¤´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/headers&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">headers</span><span class="params">(<span class="meta">@RequestHeader(&quot;Accept-Encoding&quot;)</span> String acceptEncoding)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Accept-Encoding:&quot;</span>+acceptEncoding); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ”¶æ‰€æœ‰çš„è¯·æ±‚å¤´ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/headersMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">headersMap</span><span class="params">(<span class="meta">@RequestHeader</span> Map&lt;String,String&gt; map)</span>&#123;</span><br><span class="line">    map.forEach((k,v)-&gt;&#123;</span><br><span class="line">        System.out.println(k+<span class="string">&quot;:&quot;</span>+v);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="2-2-6-æ¥æ”¶Cookieä¿¡æ¯">2.2.6 æ¥æ”¶Cookieä¿¡æ¯</h4><p>è·å¾—å®¢æˆ·ç«¯æºå¸¦çš„Cookieæ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/cookies&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">cookies</span><span class="params">(<span class="meta">@CookieValue(value = &quot;JSESSIONID&quot;,defaultValue = &quot;&quot;)</span> String jsessionid)</span>&#123;</span><br><span class="line">    System.out.println(jsessionid); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="2-2-7-æ¥æ”¶RequeståŸŸä¿¡æ¯">2.2.7 æ¥æ”¶RequeståŸŸä¿¡æ¯</h4><p>è·å¾—è½¬å‘RequeståŸŸä¸­æ•°æ®ï¼Œåœ¨è¿›è¡Œèµ„æºä¹‹é—´è½¬å‘æ—¶ï¼Œæœ‰æ—¶éœ€è¦å°†ä¸€äº›å‚æ•°å­˜å‚¨åˆ°requeståŸŸä¸­æºå¸¦ç»™ä¸‹ä¸€ä¸ªèµ„æº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/request1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">request1</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    <span class="comment">//å­˜å‚¨æ•°æ®</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;haohao&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/request2&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/request2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">request2</span><span class="params">(<span class="meta">@RequestAttribute(&quot;username&quot;)</span> String username)</span>&#123;</span><br><span class="line">    System.out.println(username); </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="2-2-8-è¯·æ±‚å‚æ•°ä¹±ç çš„è§£å†³æ–¹æ¡ˆ">2.2.8 è¯·æ±‚å‚æ•°ä¹±ç çš„è§£å†³æ–¹æ¡ˆ</h4><p>è¯·æ±‚å‚æ•°ä¹±ç çš„è§£å†³æ–¹æ¡ˆï¼ŒSpringå·²ç»æä¾›å¥½çš„CharacterEncodingFilteræ¥è¿›è¡Œç¼–ç è¿‡æ»¤</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å…¨å±€çš„ç¼–ç è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-3-Javawebå¸¸ç”¨å¯¹è±¡è·å–">2.3 Javawebå¸¸ç”¨å¯¹è±¡è·å–</h3><p>è·å¾—Javawebå¸¸è§åŸç”Ÿå¯¹è±¡ï¼Œæœ‰æ—¶åœ¨æˆ‘ä»¬çš„Controlleræ–¹æ³•ä¸­éœ€è¦ç”¨åˆ°Javawebçš„åŸç”Ÿå¯¹è±¡ï¼Œä¾‹å¦‚ï¼šRequestã€ Responseç­‰ï¼Œæˆ‘ä»¬åªéœ€è¦å°†éœ€è¦çš„å¯¹è±¡ä»¥å½¢å‚çš„å½¢å¼å†™åœ¨æ–¹æ³•ä¸Šï¼ŒSpringMVCæ¡†æ¶åœ¨è°ƒç”¨Controlleræ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨ä¼ é€’å®å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/javawebObject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">javawebObject</span><span class="params">(HttpServletRequest request, HttpServletResponse response, HttpSession session)</span>&#123;</span><br><span class="line">    System.out.println(request);</span><br><span class="line">    System.out.println(response);</span><br><span class="line">    System.out.println(session);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/index.jsp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-4-è¯·æ±‚é™æ€èµ„æº">2.4 è¯·æ±‚é™æ€èµ„æº</h3><p>é™æ€èµ„æºè¯·æ±‚å¤±æ•ˆçš„åŸå› ï¼Œå½“DispatcherServletçš„æ˜ å°„è·¯å¾„é…ç½®ä¸º / çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±è¦†ç›–çš„Tomcatå®¹å™¨é»˜è®¤çš„ç¼ºçœServletï¼Œåœ¨Tomcatçš„configç›®å½•ä¸‹æœ‰ä¸€ä¸ªweb.xml æ˜¯å¯¹æ‰€æœ‰çš„webé¡¹ç›®çš„å…¨å±€é…ç½®ï¼Œå…¶ä¸­æœ‰å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>url-patterné…ç½®ä¸º / çš„Servletæˆ‘ä»¬ç§°å…¶ä¸ºç¼ºçœçš„Servletï¼Œä½œç”¨æ˜¯å½“å…¶ä»–Servletéƒ½åŒ¹é…ä¸æˆåŠŸæ—¶ï¼Œå°±æ‰¾ç¼ºçœçš„Servlet ï¼Œé™æ€èµ„æºç”±äºæ²¡æœ‰åŒ¹é…æˆåŠŸçš„Servletï¼Œæ‰€ä»¥ä¼šæ‰¾ç¼ºçœçš„DefaultServletï¼Œè¯¥DefaultServletå…·å¤‡äºŒæ¬¡å»åŒ¹é…é™æ€èµ„æºçš„åŠŸèƒ½ã€‚ä½†æ˜¯æˆ‘ä»¬é…ç½®DispatcherServletåå°±å°†å…¶è¦†ç›–æ‰äº†ï¼Œè€ŒDispatcherServletä¼šå°†è¯·æ±‚çš„é™æ€èµ„æºçš„åç§°å½“æˆControllerçš„æ˜ å°„è·¯å¾„å»åŒ¹é…ï¼Œå³é™æ€èµ„æºè®¿é—®ä¸æˆåŠŸäº†ï¼</p><mark class="hl-label blue">é™æ€èµ„æºè¯·æ±‚çš„ä¸‰ç§è§£å†³æ–¹æ¡ˆ</mark> <div class="tabs" id="d96bf84b-004a-4603-b9eb-da53a7fe2732"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#d96bf84b-004a-4603-b9eb-da53a7fe2732-1"><i class="fas fa-candy-cane"></i>1</button></li><li class="tab"><button type="button" data-href="#d96bf84b-004a-4603-b9eb-da53a7fe2732-2"><i class="fas fa-child"></i>2</button></li><li class="tab"><button type="button" data-href="#d96bf84b-004a-4603-b9eb-da53a7fe2732-3"><i class="fas fa-cookie-bite"></i>3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="d96bf84b-004a-4603-b9eb-da53a7fe2732-1"><p>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œå¯ä»¥å†æ¬¡æ¿€æ´»Tomcatçš„DefaultServletï¼ŒServletçš„url-patternçš„åŒ¹é…ä¼˜å…ˆçº§æ˜¯ï¼šç²¾ç¡®åŒ¹é…&gt;ç›®å½•åŒ¹é…&gt;æ‰©å±•ååŒ¹é…&gt;ç¼ºçœåŒ¹é…ï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šæŸä¸ªç›®å½•ä¸‹æˆ–æŸä¸ªæ‰©å±•åçš„èµ„æºä½¿ç”¨DefaultServletè¿›è¡Œè§£æï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/img/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.html<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d96bf84b-004a-4603-b9eb-da53a7fe2732-2"><p>ç¬¬äºŒç§æ–¹å¼ï¼Œåœ¨spring-mvc.xmlä¸­å»é…ç½®é™æ€èµ„æºæ˜ å°„ï¼ŒåŒ¹é…æ˜ å°„è·¯å¾„çš„è¯·æ±‚åˆ°æŒ‡å®šçš„ä½ç½®å»åŒ¹é…èµ„æº</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mappingæ˜¯æ˜ å°„èµ„æºè·¯å¾„ï¼Œlocationæ˜¯å¯¹åº”èµ„æºæ‰€åœ¨çš„ä½ç½® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/img/*&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/img/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/*&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/css/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/*&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/js/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/html/*&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/html/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="d96bf84b-004a-4603-b9eb-da53a7fe2732-3"><p>ç¬¬ä¸‰ç§æ–¹å¼ï¼Œåœ¨spring-mvc.xmlä¸­å»é…ç½®&lt; mvc:default-servlet-handler &gt;ï¼Œè¯¥æ–¹å¼æ˜¯æ³¨å†Œäº†ä¸€ä¸ªDefaultServletHttpRequestHandler å¤„ç†å™¨ï¼Œé™æ€èµ„æºçš„è®¿é—®éƒ½ç”±è¯¥å¤„ç†å™¨å»å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯å¼€å‘ä¸­ä½¿ç”¨æœ€å¤šçš„</p><p><code>&lt;mvc:default-servlet-handler/&gt;</code></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="2-5-æ³¨è§£é©±åŠ¨æ ‡ç­¾">2.5 æ³¨è§£é©±åŠ¨æ ‡ç­¾</h3><p>é™æ€èµ„æºé…ç½®çš„ç¬¬äºŒç¬¬ä¸‰ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥æ­£å¸¸è®¿é—®é™æ€èµ„æºäº†ï¼Œä½†æ˜¯Controlleråˆæ— æ³•è®¿é—®äº†ï¼ŒæŠ¥é”™404ï¼Œå³æ‰¾ä¸åˆ°å¯¹åº”çš„èµ„æº</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427115829513.png" alt="image-20230427115829513"></p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡SpringMVCå»è§£æmvcå‘½åç©ºé—´ä¸‹çš„resourcesæ ‡ç­¾å®Œæˆçš„é™æ€èµ„æºè§£æã€‚</p><p>ç¬¬ä¸‰ç§æ–¹å¼å¼é€šè¿‡SpringMVCå»è§£æmvcå‘½åç©ºé—´ä¸‹çš„default-servlet-handleræ ‡ç­¾å®Œæˆçš„é™æ€èµ„æºè§£æï¼Œæ ¹æ®å‰é¢æ‰€å­¦ä¹ çš„è‡ªå®šä¹‰å‘½åç©ºé—´çš„è§£æçš„çŸ¥è¯†ï¼Œå¯ä»¥å‘ç°ä¸ç®¡æ˜¯ä»¥ä¸Šå“ªç§æ–¹å¼ï¼Œæœ€ç»ˆéƒ½ä¼šæ³¨å†ŒSimpleUrlHandlerMapping</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> BeanDefinition <span class="title function_">parse</span><span class="params">(Element element, ParserContext context)</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºSimpleUrlHandlerMappingç±»å‹çš„BeanDefinition</span></span><br><span class="line">    <span class="type">RootBeanDefinition</span> <span class="variable">handlerMappingDef</span> <span class="operator">=</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">RootBeanDefinition</span>(SimpleUrlHandlerMapping.class);</span><br><span class="line">    <span class="comment">//æ³¨å†ŒSimpleUrlHandlerMappingçš„BeanDefinition</span></span><br><span class="line">    context.getRegistry().registerBeanDefinition(beanName, handlerMappingDef);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆç»“åˆç»„ä»¶æµ…æçŸ¥è¯†ç‚¹ï¼Œä¸€æ—¦SpringMVCå®¹å™¨ä¸­å­˜åœ¨ HandlerMapping ç±»å‹çš„ç»„ä»¶æ—¶ï¼Œå‰ç«¯æ§åˆ¶å™¨DispatcherServletåœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œå°±ä¼šä»å®¹å™¨ä¸­è·å¾—HandlerMapping ï¼Œä¸åœ¨åŠ è½½ dispatcherServlet.propertiesä¸­é»˜è®¤å¤„ç†å™¨æ˜ å°„å™¨ç­–ç•¥ï¼Œé‚£ä¹Ÿå°±æ„å‘³ç€RequestMappingHandlerMappingä¸ä¼šè¢«åŠ è½½åˆ°äº†ã€‚</p><mark class="hl-label green">è§£å†³æ–¹æ³•</mark> <p>æ‰‹åŠ¨å°†RequestMappingHandlerMappingä¹Ÿæ³¨å†Œåˆ°SpringMVCå®¹å™¨ä¸­å°±å¯ä»¥äº†ï¼Œè¿™æ ·DispatcherServletåœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œå°±ä¼šä»å®¹å™¨ä¸­åŒæ—¶è·å¾—RequestMappingHandlerMappingå­˜å‚¨åˆ°DispatcherServletä¸­åä¸ºhandlerMappingsçš„Listé›†åˆä¸­ï¼Œå¯¹@RequestMapping æ³¨è§£è¿›è¡Œè§£æã€‚</p><p><code>&lt;bean class=&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&quot;/&gt;</code></p><p>æ ¹æ®ä¸Šé¢çš„è®²è§£ï¼Œå¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼Œè¦æƒ³ä½¿ç”¨@RequestMappingæ­£å¸¸æ˜ å°„åˆ°èµ„æºæ–¹æ³•ï¼ŒåŒæ—¶é™æ€èµ„æºè¿˜èƒ½æ­£å¸¸è®¿é—®ï¼Œè¿˜å¯ä»¥å°†è¯·æ±‚jsonæ ¼å¼å­—ç¬¦ä¸²å’ŒJavaBeanä¹‹é—´è‡ªç”±è½¬æ¢ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨spring-mvc.xmlä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ˜¾ç¤ºé…ç½®RequestMappingHandlerMapping --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ˜¾ç¤ºé…ç½®RequestMappingHandlerAdapter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;messageConverters&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®DefaultServletHttpRequestHandler--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¹ˆå¤æ‚ç¹ççš„é…ç½®ï¼Œæ˜¯ä¸æ˜¯çœ‹ä¸Šå»æœ‰ç‚¹å¤´å¤§ï¼ŸSpringæ˜¯ä¸ª&quot;æš–ç”·&quot;ï¼Œå°†ä¸Šè¿°é…ç½®æµ“ç¼©æˆäº†ä¸€ä¸ªç®€å•çš„é…ç½®æ ‡ç­¾ï¼Œé‚£å°±æ˜¯mvcçš„æ³¨è§£é©±åŠ¨ï¼Œè¯¥æ ‡ç­¾å†…éƒ¨ä¼šå¸®æˆ‘ä»¬æ³¨å†ŒRequestMappingHandlerMappingã€æ³¨å†ŒRequestMappingHandlerAdapterå¹¶æ³¨å…¥Jsonæ¶ˆæ¯è½¬æ¢å™¨ç­‰ï¼Œä¸Šè¿°é…ç½®å°±å¯ä»¥ç®€åŒ–æˆå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mvcæ³¨è§£é©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®DefaultServletHttpRequestHandler--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>PSï¼š<code>&lt;mvc:annotation-driven&gt;</code>æ ‡ç­¾åœ¨ä¸åŒçš„ç‰ˆæœ¬ä¸­ï¼Œå¸®æˆ‘ä»¬æ³¨å†Œçš„ç»„ä»¶ä¸åŒï¼ŒSpring 3.0.X ç‰ˆæœ¬æ³¨å†Œæ˜¯DefaultAnnotationHandlerMapping å’Œ AnnotationMethodHandlerAdapterï¼Œç”±äºæ¡†æ¶çš„å‘å±•ï¼Œä»Spring 3.1.X å¼€å§‹æ³¨å†Œç»„ä»¶å˜ä¸º RequestMappingHandlerMappingå’ŒRequestMappingHandlerAdapter</p><hr><hr><h2 id="3-SpringMVCçš„å“åº”å¤„ç†">3. SpringMVCçš„å“åº”å¤„ç†</h2><p>Springçš„æ¥æ”¶è¯·æ±‚çš„éƒ¨åˆ†æˆ‘ä»¬è®²å®Œäº†ï¼Œä¸‹é¢åœ¨çœ‹ä¸€ä¸‹Springæ€ä¹ˆç»™å®¢æˆ·ç«¯å“åº”æ•°æ®ï¼Œå“åº”æ•°æ®ä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</p><ul><li>ä¼ ç»ŸåŒæ­¥æ–¹å¼ï¼šå‡†å¤‡å¥½æ¨¡å‹æ•°æ®ï¼Œåœ¨è·³è½¬åˆ°æ‰§è¡Œé¡µé¢è¿›è¡Œå±•ç¤ºï¼Œæ­¤æ–¹å¼ä½¿ç”¨è¶Šæ¥è¶Šå°‘äº†ï¼ŒåŸºäºå†å²åŸå› ï¼Œä¸€äº›æ—§é¡¹ç›®è¿˜åœ¨ä½¿ç”¨ï¼›</li><li>å‰åç«¯åˆ†ç¦»å¼‚æ­¥æ–¹å¼ï¼šå‰ç«¯ä½¿ç”¨AjaxæŠ€æœ¯+Restfulé£æ ¼ä¸æœåŠ¡ç«¯è¿›è¡ŒJsonæ ¼å¼ä¸ºä¸»çš„æ•°æ®äº¤äº’ï¼Œç›®å‰å¸‚åœºä¸Šå‡ ä¹éƒ½æ˜¯æ­¤ç§æ–¹å¼äº†ã€‚</li></ul><hr><h3 id="3-1-ä¼ ç»ŸåŒæ­¥ä¸šåŠ¡æ•°æ®å“åº”">3.1 ä¼ ç»ŸåŒæ­¥ä¸šåŠ¡æ•°æ®å“åº”</h3><p>ä¼ ç»ŸåŒæ­¥ä¸šåŠ¡åœ¨æ•°æ®å“åº”æ—¶ï¼ŒSpringMVCåˆæ¶‰åŠå¦‚ä¸‹å››ç§å½¢å¼ï¼š</p><ul><li>è¯·æ±‚èµ„æºè½¬å‘ï¼›</li><li>è¯·æ±‚èµ„æºé‡å®šå‘ï¼›</li><li>å“åº”æ¨¡å‹æ•°æ®ï¼›</li><li>ç›´æ¥å›å†™æ•°æ®ç»™å®¢æˆ·ç«¯ï¼›</li></ul><div class="tabs" id="1b606fda-ba79-4ab2-a97d-bf3bdc7032b8"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-1"><i class="fas fa-seedling"></i>è¯·æ±‚èµ„æºè½¬å‘</button></li><li class="tab"><button type="button" data-href="#1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-2"><i class="fas fa-leaf"></i>è¯·æ±‚èµ„æºé‡å®šå‘</button></li><li class="tab"><button type="button" data-href="#1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-3"><i class="fab fa-apple"></i>å“åº”æ¨¡å‹æ•°æ®</button></li><li class="tab"><button type="button" data-href="#1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-4"><i class="fas fa-tree"></i>ç›´æ¥å›å†™æ•°æ®ç»™å®¢æˆ·ç«¯</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-1"><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427130024927.png" alt="image-20230427130024927"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-2"><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427130126669.png" alt="image-20230427130126669"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-3"><p>å“åº”æ¨¡å‹æ•°æ®ï¼Œå“åº”æ¨¡å‹æ•°æ®æœ¬è´¨ä¹Ÿæ˜¯è½¬å‘ï¼Œåœ¨è½¬å‘æ—¶å¯ä»¥å‡†å¤‡æ¨¡å‹æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/forward5&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">forward5</span><span class="params">(ModelAndView modelAndView)</span>&#123;</span><br><span class="line">    <span class="comment">//å‡†å¤‡JavaBeanæ¨¡å‹æ•°æ®</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setUsername(<span class="string">&quot;haohao&quot;</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®æ¨¡å‹</span></span><br><span class="line">    modelAndView.addObject(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">    <span class="comment">//è®¾ç½®è§†å›¾</span></span><br><span class="line">    modelAndView.setViewName(<span class="string">&quot;/index.jsp&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> modelAndView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="1b606fda-ba79-4ab2-a97d-bf3bdc7032b8-4"><p>ç›´æ¥å›å†™æ•°æ®ï¼Œç›´æ¥é€šè¿‡æ–¹æ³•çš„è¿”å›å€¼è¿”å›ç»™å®¢æˆ·ç«¯çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯SpringMVCé»˜è®¤çš„æ–¹æ³•è¿”å›å€¼æ˜¯è§†å›¾ï¼Œå¯ä»¥é€šè¿‡@ResponseBody æ³¨è§£æ˜¾ç¤ºçš„å‘ŠçŸ¥æ­¤å¤„çš„è¿”å›å€¼ä¸è¦è¿›è¡Œè§†å›¾å¤„ç†ï¼Œæ˜¯è¦ä»¥å“åº”ä½“çš„æ–¹å¼å¤„ç†çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/response2&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">response2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello haohao!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="3-2-å‰åç«¯åˆ†ç¦»å¼‚æ­¥ä¸šåŠ¡æ•°æ®å“åº”">3.2 å‰åç«¯åˆ†ç¦»å¼‚æ­¥ä¸šåŠ¡æ•°æ®å“åº”</h3><p>å…¶å®æ­¤å¤„çš„å›å†™æ•°æ®ï¼Œè·Ÿä¸Šé¢å›å†™æ•°æ®ç»™å®¢æˆ·ç«¯çš„è¯­æ³•æ–¹å¼ä¸€æ ·ï¼Œåªä¸è¿‡æœ‰å¦‚ä¸‹ä¸€äº›åŒºåˆ«ï¼š</p><ul><li>åŒæ­¥æ–¹å¼å›å†™æ•°æ®ï¼Œæ˜¯å°†æ•°æ®å“åº”ç»™æµè§ˆå™¨è¿›è¡Œé¡µé¢å±•ç¤ºçš„ï¼Œè€Œå¼‚æ­¥æ–¹å¼å›å†™æ•°æ®ä¸€èˆ¬æ˜¯å›å†™ç»™Ajaxå¼•æ“çš„ï¼Œå³è°è®¿é—®æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯å°±å°†æ•°æ®å“åº”ç»™è°</li><li>åŒæ­¥æ–¹å¼å›å†™çš„æ•°æ®ï¼Œä¸€èˆ¬å°±æ˜¯ä¸€äº›æ— ç‰¹å®šæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè€Œå¼‚æ­¥æ–¹å¼å›å†™çš„æ•°æ®å¤§å¤šæ˜¯Jsonæ ¼å¼å­—ç¬¦ä¸²</li></ul><p>å›å†™æ™®é€šæ•°æ®ä½¿ç”¨@ResponseBodyæ ‡æ³¨æ–¹æ³•ï¼Œç›´æ¥è¿”å›å­—ç¬¦ä¸²å³å¯ï¼Œæ­¤å¤„ä¸åœ¨è¯´æ˜ï¼›</p><div class="tabs" id="ab67edd5-269d-496f-bff8-15db18faca6b"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ab67edd5-269d-496f-bff8-15db18faca6b-1"><i class="fas fa-cat"></i>å›å†™Jsonæ ¼å¼çš„å­—ç¬¦ä¸²</button></li><li class="tab"><button type="button" data-href="#ab67edd5-269d-496f-bff8-15db18faca6b-2"><i class="fas fa-horse"></i>å›å†™JavaBean</button></li><li class="tab"><button type="button" data-href="#ab67edd5-269d-496f-bff8-15db18faca6b-3"><i class="fas fa-dove"></i>ResponseBodyæ³¨è§£ä½¿ç”¨ä¼˜åŒ–</button></li><li class="tab"><button type="button" data-href="#ab67edd5-269d-496f-bff8-15db18faca6b-4"><i class="fas fa-dragon"></i>RestControlleræ³¨è§£è¿›ä¸€æ­¥ä¼˜åŒ–</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ab67edd5-269d-496f-bff8-15db18faca6b-1"><p>å›å†™Jsonæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå³å°†ç›´æ¥æ‹¼æ¥Jsonæ ¼å¼çš„å­—ç¬¦ä¸²æˆ–ä½¿ç”¨å·¥å…·å°†JavaBeanè½¬æ¢æˆJsonæ ¼å¼çš„å­—ç¬¦ä¸²å›å†™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/response3&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">response3</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;username\&quot;:\&quot;haohao\&quot;,\&quot;age\&quot;:18&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/response4&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">response4</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºJavaBean</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setUsername(<span class="string">&quot;haohao&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="comment">//ä½¿ç”¨Jacksonè½¬æ¢æˆjsonæ ¼å¼çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(user); </span><br><span class="line">    <span class="keyword">return</span> json;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ab67edd5-269d-496f-bff8-15db18faca6b-2"><p>åœ¨è®²è§£SringMVCæ¥æ”¶è¯·æ±‚æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯æäº¤çš„Jsonæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿæ˜¯ä½¿ç”¨Jacksonè¿›è¡Œçš„æ‰‹åŠ¨è½¬æ¢æˆJavaBean ï¼Œå¯ä»¥å½“æˆ‘ä»¬ä½¿ç”¨äº†@RequestBodyæ—¶ï¼Œç›´æ¥ç”¨JavaBeanå°±æ¥æ”¶äº†Jsonæ ¼å¼çš„æ•°æ®ï¼ŒåŸç†å…¶å®å°±æ˜¯SpringMVCåº•å±‚å¸®æˆ‘ä»¬åšäº†è½¬æ¢ï¼Œæ­¤å¤„@ResponseBodyä¹Ÿå¯ä»¥å°†JavaBeanè‡ªåŠ¨ç»™æˆ‘ä»¬è½¬æ¢æˆJsonæ ¼å¼å­—ç¬¦ä¸²å›å“åº”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/response5&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">response5</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºJavaBean</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(); user.setUsername(<span class="string">&quot;haohao&quot;</span>); </span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="comment">//ç›´æ¥è¿”å›Userå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ab67edd5-269d-496f-bff8-15db18faca6b-3"><p>@ResponseBodyæ³¨è§£ä½¿ç”¨ä¼˜åŒ–ï¼Œåœ¨è¿›è¡Œå‰åç«¯åˆ†ç¦»å¼€å‘æ—¶ï¼ŒControllerçš„æ¯ä¸ªæ–¹æ³•éƒ½æ˜¯ç›´æ¥å›å†™æ•°æ®çš„ï¼Œæ‰€ä»¥æ¯ä¸ªæ–¹æ³•ä¸Šéƒ½å¾—å†™@ResponseBodyï¼Œ<span class='p blue'>å¯ä»¥å°†@ResponseBodyå†™åˆ°Controllerä¸Š</span>ï¼Œé‚£ä¹ˆè¯¥Controllerä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½å…·å¤‡äº†è¿”å›å“åº”ä½“æ•°æ®çš„åŠŸèƒ½äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/response7&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultInfo <span class="title function_">response7</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/response5&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">response5</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... çœç•¥å…¶ä»–æ–¹æ³• ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ab67edd5-269d-496f-bff8-15db18faca6b-4"><p><span class='p green'>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¯ä»¥ä½¿ç”¨@RestControlleræ›¿ä»£@Controllerå’Œ@ResponseBodyï¼Œ@RestControllerå†…éƒ¨å…·å¤‡çš„è¿™ä¸¤ä¸ªæ³¨è§£çš„åŠŸèƒ½</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/response7&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultInfo <span class="title function_">response7</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/response5&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">response5</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... çœç•¥å…¶ä»–æ–¹æ³• ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><hr><h2 id="4-SpringMVCçš„æ‹¦æˆªå™¨">4. SpringMVCçš„æ‹¦æˆªå™¨</h2><h3 id="4-1-æ‹¦æˆªå™¨-Interceptor-ç®€ä»‹">4.1 æ‹¦æˆªå™¨ Interceptor ç®€ä»‹</h3><p>SpringMVCçš„æ‹¦æˆªå™¨Interceptorè§„èŒƒï¼Œä¸»è¦æ˜¯å¯¹Controllerèµ„æºè®¿é—®æ—¶è¿›è¡Œæ‹¦æˆªæ“ä½œçš„æŠ€æœ¯ï¼Œå½“ç„¶æ‹¦æˆªåå¯ä»¥è¿›è¡Œæƒé™æ§åˆ¶ï¼ŒåŠŸèƒ½å¢å¼ºç­‰éƒ½æ˜¯å¯ä»¥çš„ã€‚æ‹¦æˆªå™¨æœ‰ç‚¹ç±»ä¼¼ Javaweb å¼€å‘ä¸­çš„Filterï¼ŒInterceptorä¸Filterçš„åŒºåˆ«å¦‚ä¸‹å›¾ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230428215535084.png" alt="image-20230428215535084" style="zoom:67%;" /><p>ç”±ä¸Šå›¾ï¼Œå¯¹<code>Filter</code>å’Œ<code>Interceptor</code>åšä¸ªå¯¹æ¯”ï¼š</p><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">FilteræŠ€æœ¯</th><th style="text-align:left">InterceptoræŠ€æœ¯</th></tr></thead><tbody><tr><td style="text-align:left">æŠ€æœ¯èŒƒç•´</td><td style="text-align:left">JavawebåŸç”ŸæŠ€æœ¯</td><td style="text-align:left">SpringMVCæ¡†æ¶æŠ€æœ¯</td></tr><tr><td style="text-align:left">æ‹¦æˆª/è¿‡æ»¤èµ„æº</td><td style="text-align:left">å¯ä»¥å¯¹æ‰€æœ‰è¯·æ±‚éƒ½è¿‡æ»¤ï¼ŒåŒ…æ‹¬ä»»ä½•Servletã€Jspã€å…¶ä»–èµ„æºç­‰</td><td style="text-align:left">åªå¯¹è¿›å…¥äº†SpringMVCç®¡è¾–èŒƒå›´çš„æ‰æ‹¦æˆªï¼Œä¸»è¦æ‹¦æˆªControllerè¯·æ±‚</td></tr><tr><td style="text-align:left">æ‰§è¡Œæ—¶æœº</td><td style="text-align:left">æ—©äºä»»ä½•Servletæ‰§è¡Œ</td><td style="text-align:left">æ™šäºDispatcherServletæ‰§è¡Œ</td></tr></tbody></table><span class='p blue'>å®ç°äº†HandlerInterceptoræ¥å£ï¼Œä¸”è¢«Springç®¡ç†çš„Beanéƒ½æ˜¯æ‹¦æˆªå™¨</span><p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">default</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span><br><span class="line"><span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class="line"><span class="params"><span class="meta">@Nullable</span> ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class="line"><span class="params"><span class="meta">@Nullable</span> Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HandlerInterceptoræ¥å£æ–¹æ³•çš„ä½œç”¨åŠå…¶å‚æ•°ã€è¿”å›å€¼è¯¦è§£å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">ä½œç”¨</th><th style="text-align:left">å‚æ•°</th><th style="text-align:left">è¿”å›å€¼</th></tr></thead><tbody><tr><td style="text-align:left">preHandle</td><td style="text-align:left">å¯¹æ‹¦æˆªåˆ°çš„è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œè¿”å›trueæ”¾è¡Œæ‰§è¡Œå¤„ç†å™¨æ–¹æ³•ï¼Œfalseä¸æ”¾è¡Œ</td><td style="text-align:left">Handleræ˜¯æ‹¦æˆªåˆ°çš„Controlleræ–¹æ³•å¤„ç†å™¨</td><td style="text-align:left">ä¸€æ—¦è¿”å›falseï¼Œä»£è¡¨ç»ˆæ­¢å‘åæ‰§è¡Œï¼Œæ‰€æœ‰åç½®æ–¹æ³•éƒ½ä¸æ‰§è¡Œï¼Œæœ€ç»ˆæ–¹æ³•åªæ‰§è¡Œå¯¹åº”preHandleè¿”å›äº†trueçš„</td></tr><tr><td style="text-align:left">postHandle</td><td style="text-align:left">åœ¨å¤„ç†å™¨çš„æ–¹æ³•æ‰§è¡Œåï¼Œå¯¹æ‹¦æˆªåˆ°çš„è¯·æ±‚è¿›è¡Œåå¤„ç†ï¼Œå¯ä»¥åœ¨æ–¹æ³•ä¸­å¯¹æ¨¡å‹æ•°æ®å’Œè§†å›¾è¿›è¡Œä¿®æ”¹</td><td style="text-align:left">Handleræ˜¯æ‹¦æˆªåˆ°çš„Controlleræ–¹æ³•å¤„ç†å™¨ï¼›modelAndViewæ˜¯è¿”å›çš„æ¨¡å‹è§†å›¾å¯¹è±¡</td><td style="text-align:left">æ— </td></tr><tr><td style="text-align:left">afterCompletion</td><td style="text-align:left">è§†å›¾æ¸²æŸ“å®Œæˆå(æ•´ä¸ªæµç¨‹ç»“æŸä¹‹å)ï¼Œè¿›è¡Œæœ€åçš„å¤„ç†ï¼Œå¦‚æœè¯·æ±‚æµç¨‹ä¸­æœ‰å¼‚å¸¸ï¼Œå¯ä»¥å¤„ç†å¼‚å¸¸å¯¹è±¡</td><td style="text-align:left">Handleræ˜¯æ‹¦æˆªåˆ°çš„Controlleræ–¹æ³•å¤„ç†å™¨ï¼›exæ˜¯å¼‚å¸¸å¯¹è±¡</td><td style="text-align:left">æ— </td></tr></tbody></table><hr><h3 id="4-2-æ‹¦æˆªå™¨å¿«é€Ÿå…¥é—¨">4.2 æ‹¦æˆªå™¨å¿«é€Ÿå…¥é—¨</h3><div class="tabs" id="177b295e-598d-472a-ab76-335a04e1c870"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#177b295e-598d-472a-ab76-335a04e1c870-1"><i class="fas fa-heartbeat"></i>ç¼–å†™MyInterceptor01å®ç°HandlerInterceptoræ¥å£</button></li><li class="tab"><button type="button" data-href="#177b295e-598d-472a-ab76-335a04e1c870-2"><i class="fas fa-cookie-bite"></i>é…ç½®Interceptor</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="177b295e-598d-472a-ab76-335a04e1c870-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor01</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Controlleræ–¹æ³•æ‰§è¡Œä¹‹å‰...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//æ”¾è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Controlleræ–¹æ³•æ‰§è¡Œä¹‹å...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¸²æŸ“è§†å›¾ç»“æŸï¼Œæ•´ä¸ªæµç¨‹å®Œæ¯•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="177b295e-598d-472a-ab76-335a04e1c870-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.interceptors.MyInterceptor1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="4-3-æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº">4.3 æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº</h3><p>æ‹¦æˆªå™¨ä¸‰ä¸ªæ–¹æ³•çš„æ‰§è¡Œé¡ºåº<br>å½“æ¯ä¸ªæ‹¦æˆªå™¨éƒ½æ˜¯æ”¾è¡ŒçŠ¶æ€æ—¶ï¼Œä¸‰ä¸ªæ–¹æ³•çš„æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230428221116031.png" alt="image-20230428221116031" style="zoom:67%;" /><p>å½“Interceptor1å’ŒInterceptor2å¤„äºæ”¾è¡Œï¼ŒInterceptor3å¤„äºä¸æ”¾è¡Œæ—¶ï¼Œä¸‰ä¸ªæ–¹æ³•çš„æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230428221434011.png" alt="image-20230428221434011" style="zoom:67%;" /><p>æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåºå–å†³äº interceptor çš„é…ç½®é¡ºåº</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/target&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.interceptor.MyInterceptor02&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.interceptor.MyInterceptor01&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure><p><span id="jump2"></span></p><hr><h3 id="4-4-æ‹¦æˆªå™¨æ‰§è¡ŒåŸç†">4.4 æ‹¦æˆªå™¨æ‰§è¡ŒåŸç†</h3><p><a href="#jump1">ç‚¹å‡»è·³è½¬â†‘â†‘â†‘â†‘</a></p><div class="tabs" id="73c56bbf-a064-4950-b013-efd9d1f432e7"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#73c56bbf-a064-4950-b013-efd9d1f432e7-1"><i class="fas fa-atom"></i>1</button></li><li class="tab"><button type="button" data-href="#73c56bbf-a064-4950-b013-efd9d1f432e7-2"><i class="far fa-sun"></i>2</button></li><li class="tab"><button type="button" data-href="#73c56bbf-a064-4950-b013-efd9d1f432e7-3"><i class="fas fa-wind"></i>3</button></li><li class="tab"><button type="button" data-href="#73c56bbf-a064-4950-b013-efd9d1f432e7-4"><i class="fas fa-fire-alt"></i>4</button></li><li class="tab"><button type="button" data-href="#73c56bbf-a064-4950-b013-efd9d1f432e7-5"><i class="fas fa-cookie-bite"></i>5</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="73c56bbf-a064-4950-b013-efd9d1f432e7-1"><p>è¯·æ±‚åˆ°æ¥æ—¶å…ˆä¼šä½¿ç”¨ç»„ä»¶<code>HandlerMapping</code>å»åŒ¹é…Controllerçš„æ–¹æ³•ï¼ˆHandlerï¼‰å’Œç¬¦åˆæ‹¦æˆªè·¯å¾„çš„Interceptorï¼Œ Handlerå’Œå¤šä¸ªInterceptorè¢«å°è£…æˆä¸€ä¸ª<code>HandlerExecutionChain</code>çš„å¯¹è±¡<code>HandlerExecutionChain</code>å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerExecutionChain</span> &#123;</span><br><span class="line">    <span class="comment">//æ˜ å°„çš„Controllerçš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object handler;</span><br><span class="line">    <span class="comment">//å½“å‰HandleråŒ¹é…çš„æ‹¦æˆªå™¨é›†åˆ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;HandlerInterceptor&gt; interceptorList;</span><br><span class="line">    <span class="comment">// ... çœç•¥å…¶ä»–ä»£ç  ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="73c56bbf-a064-4950-b013-efd9d1f432e7-2"><p>åœ¨DispatcherServletçš„doDispatchæ–¹æ³•ä¸­æ‰§è¡Œæ‹¦æˆªå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span>&#123;</span><br><span class="line">    <span class="comment">//æ ¹æ®è¯·æ±‚ä¿¡æ¯è·å¾—HandlerExecutionChain</span></span><br><span class="line">    <span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> <span class="built_in">this</span>.getHandler(request);</span><br><span class="line">    <span class="comment">//è·å¾—å¤„ç†å™¨é€‚é…å™¨</span></span><br><span class="line">    <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> <span class="built_in">this</span>.getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line">    <span class="comment">//æ‰§è¡ŒInterceptorçš„å‰ç½®æ–¹æ³•ï¼Œå‰ç½®æ–¹æ³•å¦‚æœè¿”å›falseï¼Œåˆ™è¯¥æµç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span> (!mappedHandler.applyPreHandle(request, response)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œhandlerï¼Œä¸€èˆ¬æ˜¯HandlerMethod</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line">    <span class="comment">//æ‰§è¡Œåç½®æ–¹æ³•</span></span><br><span class="line">    mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">    <span class="comment">//æ‰§è¡Œæœ€ç»ˆæ–¹æ³•</span></span><br><span class="line">    <span class="built_in">this</span>.triggerAfterCompletion(processedRequest, response, mappedHandler, e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="73c56bbf-a064-4950-b013-efd9d1f432e7-3"><p>è·Ÿè¸ª HandlerExecutionChainçš„applyPreHandleæ–¹æ³•æºç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">applyPreHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//å¯¹interceptorListè¿›è¡Œéå†,æ­£å‘éå†,ä¸æ­¤åŒæ—¶ä½¿ç”¨interceptorIndexè¿›è¡Œè®¡æ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.interceptorList.size(); <span class="built_in">this</span>.interceptorIndex = i++) &#123;</span><br><span class="line">        <span class="comment">//å–å‡ºæ¯ä¸€ä¸ªInterceptorå¯¹è±¡</span></span><br><span class="line">        <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> (HandlerInterceptor)<span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">        <span class="comment">//è°ƒç”¨Interceptorçš„preHandleæ–¹æ³•ï¼Œå¦‚æœè¿”å›falseï¼Œåˆ™ç›´æ¥æ‰§è¡ŒInterceptorçš„æœ€ç»ˆæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (!interceptor.preHandle(request, response, <span class="built_in">this</span>.handler)) &#123;</span><br><span class="line">            <span class="comment">//æ‰§è¡ŒInterceptorçš„æœ€ç»ˆæ–¹æ³•</span></span><br><span class="line">            <span class="built_in">this</span>.triggerAfterCompletion(request, response, (Exception)<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="73c56bbf-a064-4950-b013-efd9d1f432e7-4"><p>è·Ÿè¸ª HandlerExecutionChainçš„applyPostHandleæ–¹æ³•æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">applyPostHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> ModelAndView mv)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//å¯¹interceptorListè¿›è¡Œéå†ï¼Œé€†å‘éå†</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorList.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="comment">//å–å‡ºæ¯ä¸€ä¸ªInterceptor</span></span><br><span class="line">        <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> (HandlerInterceptor)<span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">        <span class="comment">//æ‰§è¡ŒInterceptorçš„postHandleæ–¹æ³•</span></span><br><span class="line">        interceptor.postHandle(request, response, <span class="built_in">this</span>.handler, mv);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="73c56bbf-a064-4950-b013-efd9d1f432e7-5"><p>è·Ÿè¸ªHandlerExecutionChainçš„triggerAfterCompletionæ–¹æ³•æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">triggerAfterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, <span class="meta">@Nullable</span> Exception ex)</span> &#123;</span><br><span class="line">    <span class="comment">//é€†å‘éå†interceptorListï¼Œéå†çš„ä¸ªæ•°ä¸ºæ‰§è¡Œçš„applyPreHandleæ¬¡æ•°-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.interceptorIndex; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="comment">//å–å‡ºæ¯ä¸€ä¸ªInterceptor</span></span><br><span class="line">        <span class="type">HandlerInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> (HandlerInterceptor)<span class="built_in">this</span>.interceptorList.get(i);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//æ‰§è¡ŒInterceptorçš„afterCompletionæ–¹æ³•</span></span><br><span class="line">            interceptor.afterCompletion(request, response, <span class="built_in">this</span>.handler, ex);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var7) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;HandlerInterceptor.afterCompletion threw exception&quot;</span>, var7);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230428221714196.png" alt="image-20230428221714196" style="zoom:67%;" /><hr><hr><h2 id="5-SpringMVCçš„å…¨æ³¨è§£å¼€å‘">5. SpringMVCçš„å…¨æ³¨è§£å¼€å‘</h2><h3 id="5-1-æ¶ˆé™¤spring-mvc-xmlç»„ä»¶">5.1 æ¶ˆé™¤spring-mvc.xmlç»„ä»¶</h3><div class="tabs" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-1"><i class="fas fa-cat"></i>1</button></li><li class="tab"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-2"><i class="fas fa-horse"></i>2</button></li><li class="tab"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-3"><i class="fas fa-dove"></i>3</button></li><li class="tab"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-4"><i class="fas fa-dragon"></i>4</button></li><li class="tab"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-5"><i class="fas fa-heartbeat"></i>5</button></li><li class="tab"><button type="button" data-href="#15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-6"><i class="fas fa-cookie-bite"></i>6</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-1"><p>è·Ÿä¹‹å‰å…¨æ³¨è§£å¼€å‘æ€è·¯ä¸€è‡´ï¼Œ xmlé…ç½®æ–‡ä»¶ä½¿ç”¨æ ¸å¿ƒé…ç½®ç±»æ›¿ä»£ï¼Œxmlä¸­çš„æ ‡ç­¾ä½¿ç”¨å¯¹åº”çš„æ³¨è§£æ›¿ä»£</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç»„ä»¶æ‰«æwebå±‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.itheima.controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ³¨è§£é©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.interceptor.MyInterceptor01&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®DefaultServletHttpRequestHandler--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-2"><ul><li>ç»„ä»¶æ‰«æï¼Œå¯ä»¥é€šè¿‡@ComponentScanæ³¨è§£å®Œæˆï¼›</li><li>æ–‡ä»¶ä¸Šä¼ è§£æå™¨multipartResolverå¯ä»¥é€šè¿‡éè‡ªå®šä¹‰Beançš„æ³¨è§£é…ç½®æ–¹å¼ï¼Œå³@Beanæ³¨è§£å®Œæˆ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CommonsMultipartResolver <span class="title function_">multipartResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">CommonsMultipartResolver</span> <span class="variable">multipartResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CommonsMultipartResolver</span>();</span><br><span class="line">        multipartResolver.setDefaultEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        multipartResolver.setMaxUploadSize(<span class="number">5000000</span>);</span><br><span class="line">        <span class="keyword">return</span> multipartResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-3"><p><code>&lt;mvc:annotation-driven&gt;</code>ã€<code>&lt;mvc:default-servlet-handler /&gt;</code> å’Œ <code>&lt;mvc:interceptor &gt; </code>æ€ä¹ˆåŠå‘¢ï¼ŸSpringMVC æä¾›äº†ä¸€ä¸ªæ³¨è§£<code>@EnableWebMvc</code>ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æºç ï¼Œå†…éƒ¨é€šè¿‡@Import å¯¼å…¥äº†<code>DelegatingWebMvcConfiguration</code>ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(&#123;DelegatingWebMvcConfiguration.class&#125;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableWebMvc &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelegatingWebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">WebMvcConfigurerComposite</span> <span class="variable">configurers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebMvcConfigurerComposite</span>();</span><br><span class="line">    <span class="comment">//ä»å®¹å™¨ä¸­æ³¨å…¥WebMvcConfigurerç±»å‹çš„Bean</span></span><br><span class="line">    <span class="meta">@Autowired(required = false)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setConfigurers</span><span class="params">(List&lt;WebMvcConfigurer&gt; configurers)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!CollectionUtils.isEmpty(configurers)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.configurers.addWebMvcConfigurers(configurers);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>WebMvcConfigurerç±»å‹çš„Beanä¼šè¢«æ³¨å…¥è¿›æ¥ï¼Œç„¶åè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-4"><p>æ‰€ä»¥å¯ä»¥å®ç°WebMvcConfigureræ¥å£ï¼Œå®Œæˆä¸€äº›è§£æå™¨ã€é»˜è®¤Servletç­‰çš„æŒ‡å®šï¼ŒWebMvcConfigureræ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="comment">//é…ç½®é»˜è®¤Servetå¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//æ·»åŠ æ‹¦æˆªå™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//æ·»åŠ èµ„æºå¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//æ·»åŠ è§†å›¾æ§åˆ¶å™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//é…ç½®è§†å›¾è§£æå™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">configureViewResolvers</span><span class="params">(ViewResolverRegistry registry)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//æ·»åŠ å‚æ•°è§£æå™¨</span></span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">addArgumentResolvers</span><span class="params">(List&lt;HandlerMethodArgumentResolver&gt; resolvers)</span> &#123; &#125;</span><br><span class="line">    <span class="comment">//... çœç•¥å…¶ä»–ä»£ç  ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-5"><p>åˆ›å»ºMyWebMvcConfigurerå®ç°WebMvcConfigureræ¥å£ï¼Œå®ç°addInterceptors å’ŒconfigureDefaultServletHandlingæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyWebMvcConfigurer</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">        <span class="comment">//å¼€å¯é»˜è®¤çš„Servletå¤„ç†å™¨ï¼Œå¯ä»¥å¤„ç†é™æ€èµ„æºäº†</span></span><br><span class="line">        configurer.enable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¹¶é…ç½®æ‹¦æˆªè·¯å¾„</span></span><br><span class="line">        <span class="comment">//Interceptorçš„æ‰§è¡Œé¡ºåºä¹Ÿå–å†³äºæ·»åŠ é¡ºåº</span></span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInterceptor1</span>()).addPathPatterns(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="15e4bd8b-7d33-4da6-bec9-4983cdcf9b98-6"><p>æœ€åï¼Œåœ¨SpringMVCæ ¸å¿ƒé…ç½®ç±»ä¸Šæ·»åŠ @EnableWebMvcæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMVCConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CommonsMultipartResolver <span class="title function_">multipartResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">CommonsMultipartResolver</span> <span class="variable">multipartResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CommonsMultipartResolver</span>();</span><br><span class="line">        multipartResolver.setDefaultEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        multipartResolver.setMaxUploadSize(<span class="number">5000000</span>);</span><br><span class="line">        <span class="keyword">return</span> multipartResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="5-2-DispatcherServleté…ç½®ç±»">5.2 DispatcherServleté…ç½®ç±»</h3><div class="tabs" id="8be97b62-9b86-45b2-aa60-c48a9fd18aeb"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#8be97b62-9b86-45b2-aa60-c48a9fd18aeb-1"><i class="fas fa-cat"></i>xmlé…ç½®</button></li><li class="tab"><button type="button" data-href="#8be97b62-9b86-45b2-aa60-c48a9fd18aeb-2"><i class="fas fa-horse"></i>æ³¨è§£é…ç½®</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="8be97b62-9b86-45b2-aa60-c48a9fd18aeb-1"><p>DispatcherServletåœ¨è¿›è¡ŒSpringMVCé…ç½®æ–‡ä»¶åŠ è½½æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ä»¥ä¸‹æ–¹å¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æŒ‡å®šspringMVCé…ç½®æ–‡ä»¶ä½ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æœåŠ¡å™¨å¯åŠ¨å°±åˆ›å»º--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="8be97b62-9b86-45b2-aa60-c48a9fd18aeb-2"><p>ç°åœ¨æ˜¯ä½¿ç”¨SpringMVCConfigæ ¸å¿ƒé…ç½®ç±»ææ›¿ä»£çš„spring-mvc.xmlï¼Œæ€ä¹ˆåŠ è½½å‘¢ï¼Ÿå‚ç…§Springçš„ContextLoaderListeneråŠ è½½æ ¸å¿ƒé…ç½®ç±»çš„åšæ³•ï¼Œå®šä¹‰äº†ä¸€ä¸ªAnnotationConfigWebApplicationContextï¼Œé€šè¿‡ä»£ç æ³¨å†Œæ ¸å¿ƒé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAnnotationConfigWebApplicationContext</span> <span class="keyword">extends</span> <span class="title class_">AnnotationConfigWebApplicationContext</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyAnnotationConfigWebApplicationContext</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//æ³¨å†Œæ ¸å¿ƒé…ç½®ç±»</span></span><br><span class="line">        <span class="built_in">super</span>.register(SpringMVCConfig.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æŒ‡å®šspringMVCçš„applicationContextå…¨é™å®šå --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextClass<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>com.itheima.config.MyAnnotationConfigWebApplicationContext<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="5-3-æ¶ˆé™¤web-xml">5.3 æ¶ˆé™¤web.xml</h3><div class="tabs" id="9213ea2e-edef-4166-931e-30d4de02cc8d"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#9213ea2e-edef-4166-931e-30d4de02cc8d-1"><i class="fas fa-award"></i>web.xml</button></li><li class="tab"><button type="button" data-href="#9213ea2e-edef-4166-931e-30d4de02cc8d-2"><i class="fas fa-baseball-ball"></i>è§£å†³æ€è·¯</button></li><li class="tab"><button type="button" data-href="#9213ea2e-edef-4166-931e-30d4de02cc8d-3"><i class="fas fa-bone"></i>æ³¨è§£é…ç½®</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="9213ea2e-edef-4166-931e-30d4de02cc8d-1"><p>ç›®å‰ï¼Œå‡ ä¹æ¶ˆé™¤äº†é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯webå·¥ç¨‹çš„å…¥å£è¿˜æ˜¯ä½¿ç”¨çš„web.xmlè¿›è¡Œé…ç½®çš„ï¼Œå¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®springMVCå‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!--æŒ‡å®šspringMVCçš„applicationContextå…¨é™å®šå --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextClass<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>com.itheima.config.MyAnnotationConfigWebApplicationContext<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æœåŠ¡å™¨å¯åŠ¨å°±åˆ›å»º--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9213ea2e-edef-4166-931e-30d4de02cc8d-2"><ul><li>Servlet3.0ç¯å¢ƒä¸­ï¼Œwebå®¹å™¨æä¾›äº†javax.servlet.ServletContainerInitializeræ¥å£ï¼Œå®ç°äº†è¯¥æ¥å£åï¼Œåœ¨å¯¹åº”çš„ç±»åŠ è½½è·¯å¾„çš„META-INF/services ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸ºjavax.servlet.ServletContainerInitializerçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æŒ‡å®šå…·ä½“çš„ServletContainerInitializerå®ç°ç±»ï¼Œé‚£ä¹ˆï¼Œå½“webå®¹å™¨å¯åŠ¨æ—¶å°±ä¼šè¿è¡Œè¿™ä¸ªåˆå§‹åŒ–å™¨åšä¸€äº›ç»„ä»¶å†…çš„åˆå§‹åŒ–å·¥ä½œï¼›</li><li>åŸºäºè¿™ä¸ªç‰¹æ€§ï¼ŒSpringå°±å®šä¹‰äº†ä¸€ä¸ªSpringServletContainerInitializerå®ç°äº†ServletContainerInitializeræ¥å£;</li><li>è€ŒSpringServletContainerInitializerä¼šæŸ¥æ‰¾å®ç°äº†WebApplicationInitializerçš„ç±»ï¼ŒSpringåˆæä¾›äº†ä¸€ä¸ªWebApplicationInitializerçš„åŸºç¡€å®ç°ç±»AbstractAnnotationConfigDispatcherServletInitializerï¼Œå½“æˆ‘ä»¬ç¼–å†™ç±»ç»§æ‰¿AbstractAnnotationConfigDispatcherServletInitializeræ—¶ï¼Œå®¹å™¨å°±ä¼šè‡ªåŠ¨å‘ç°æˆ‘ä»¬è‡ªå·±çš„ç±»ï¼Œåœ¨è¯¥ç±»ä¸­æˆ‘ä»¬å°±å¯ä»¥é…ç½®Springå’ŒSpringMVCçš„å…¥å£äº†ã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9213ea2e-edef-4166-931e-30d4de02cc8d-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAnnotationConfigDispatcherServletInitializer</span> <span class="keyword">extends</span></span><br><span class="line">        <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="comment">//æä¾›Springå®¹å™¨æ ¸å¿ƒé…ç½®ç±»</span></span><br><span class="line">    <span class="comment">//è¿”å›çš„å¸¦æœ‰@Configurationæ³¨è§£çš„ç±»ç”¨æ¥é…ç½®ContextLoaderListener</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŠ è½½æ ¸å¿ƒé…ç½®ç±»åˆ›å»ºContextLoaderListener&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;ApplicationContextConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æä¾›SpringMVCå®¹å™¨æ ¸å¿ƒé…ç½®ç±»</span></span><br><span class="line">    <span class="comment">//è¿”å›çš„å¸¦æœ‰@Configurationæ³¨è§£çš„ç±»ç”¨æ¥é…ç½®DispatcherServlet</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åŠ è½½æ ¸å¿ƒé…ç½®ç±»åˆ›å»ºDispatcherServlet&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMVCConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æä¾›å‰ç«¯æ§åˆ¶å™¨çš„æ˜ å°„è·¯å¾„</span></span><br><span class="line">    <span class="comment">//å°†ä¸€ä¸ªæˆ–å¤šä¸ªè·¯å¾„æ˜ å°„åˆ°DispatcherServletä¸Š</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div> <hr><hr><h2 id="6-SpringMVCçš„ç»„ä»¶åŸç†å‰–æ">6. SpringMVCçš„ç»„ä»¶åŸç†å‰–æ</h2><h3 id="6-1-å‰ç«¯æ§åˆ¶å™¨åˆå§‹åŒ–">6.1 å‰ç«¯æ§åˆ¶å™¨åˆå§‹åŒ–</h3><p>å‰ç«¯æ§åˆ¶å™¨DispatcherServletæ˜¯SpringMVCçš„å…¥å£ï¼Œä¹Ÿæ˜¯SpringMVCçš„å¤§è„‘ï¼Œä¸»æµç¨‹çš„å·¥ä½œéƒ½æ˜¯åœ¨æ­¤å®Œæˆçš„ï¼Œæ¢³ç†ä¸€ä¸‹DispatcherServlet ä»£ç ã€‚DispatcherServlet æœ¬è´¨æ˜¯ä¸ªServletï¼Œå½“é…ç½®äº† load-on-startup æ—¶ï¼Œä¼šåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶å°±æ‰§è¡Œåˆ›å»ºå’Œæ‰§è¡Œåˆå§‹åŒ–initæ–¹æ³•ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šæ‰§è¡Œserviceæ–¹æ³•ã€‚<br>DispatcherServletçš„åˆå§‹åŒ–ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š</p><ul><li><p>è·å¾—äº†ä¸€ä¸ª SpringMVC çš„ApplicationContextå®¹å™¨ï¼›</p></li><li><p>æ³¨å†Œäº† SpringMVCçš„ä¹å¤§ç»„ä»¶ã€‚</p></li></ul><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/DispatcherServlet1.png" alt="DispatcherServlet1" style="zoom:67%;" /><div class="tabs" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-1"><i class="fas fa-bug"></i>1</button></li><li class="tab"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-2"><i class="fas fa-cannabis"></i>2</button></li><li class="tab"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-3"><i class="fas fa-candy-cane"></i>3</button></li><li class="tab"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-4"><i class="fas fa-child"></i>4</button></li><li class="tab"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-5"><i class="fas fa-heartbeat"></i>5</button></li><li class="tab"><button type="button" data-href="#ca3a4e03-2303-45ae-916c-f64e2a303cdc-6"><i class="fas fa-cookie-bite"></i>6</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-1"><p>SpringMVC çš„ApplicationContextå®¹å™¨åˆ›å»ºæ—¶æœºï¼ŒServlet è§„èŒƒçš„ init(ServletConfig config) æ–¹æ³•ç»è¿‡å­ç±»é‡å†™ ï¼Œæœ€ç»ˆä¼šè°ƒç”¨ FrameworkServlet æŠ½è±¡ç±»çš„initWebApplicationContext() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æœ€ç»ˆè·å¾— ä¸€ä¸ªæ ¹Springå®¹å™¨ï¼ˆSpringäº§ç”Ÿçš„ï¼‰ï¼Œä¸€ä¸ªå­Springå®¹å™¨ï¼ˆSpringMVCäº§ç”Ÿçš„ï¼‰</p><p>HttpServletBean çš„åˆå§‹åŒ–æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="built_in">this</span>.initServletBean();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>FrameworkServletçš„initServletBeanæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">initServletBean</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="built_in">this</span>.webApplicationContext = <span class="built_in">this</span>.initWebApplicationContext();<span class="comment">//åˆå§‹åŒ–ApplicationContext </span></span><br><span class="line">    <span class="built_in">this</span>.initFrameworkServlet();<span class="comment">//æ¨¡æ¿è®¾è®¡æ¨¡å¼ï¼Œä¾›å­ç±»è¦†ç›–å®ç°ï¼Œä½†æ˜¯å­ç±»DispatcherServletæ²¡åšä½¿ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-2"><p>åœ¨initWebApplicationContextæ–¹æ³•ä¸­ä½“ç°çš„çˆ¶å­å®¹å™¨çš„é€»è¾‘å…³ç³»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–ApplicationContextæ˜¯ä¸€ä¸ªåŠå…¶å…³é”®çš„ä»£ç </span></span><br><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">initWebApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//è·å¾—æ ¹å®¹å™¨ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ContextLoaderListeneråˆ›å»ºçš„ApplicationContext</span></span><br><span class="line">    <span class="comment">//å¦‚æœé…ç½®äº†ContextLoaderListeneråˆ™è·å¾—æ ¹å®¹å™¨ï¼Œæ²¡é…ç½®è·å¾—çš„æ˜¯null</span></span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">rootContext</span> <span class="operator">=</span></span><br><span class="line">            WebApplicationContextUtils.getWebApplicationContext(<span class="built_in">this</span>.getServletContext());</span><br><span class="line">    <span class="comment">//å®šä¹‰SpringMVCäº§ç”Ÿçš„ApplicationContextå­å®¹å™¨</span></span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">//==&gt;åˆ›å»ºSpringMVCçš„å­å®¹å™¨ï¼Œåˆ›å»ºåŒæ—¶å°†Springçš„åˆ›å»ºçš„rootContextä¼ é€’äº†è¿‡å»</span></span><br><span class="line">        wac = <span class="built_in">this</span>.createWebApplicationContext(rootContext);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å°†SpringMVCäº§ç”Ÿçš„ApplicationContextå­å®¹å™¨å­˜å‚¨åˆ°ServletContextåŸŸä¸­</span></span><br><span class="line">    <span class="comment">//keyåæ˜¯ï¼šorg.springframework.web.servlet.FrameworkServlet.CONTEXT.DispatcherServlet</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.publishContext) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">attrName</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContextAttributeName();</span><br><span class="line">        <span class="built_in">this</span>.getServletContext().setAttribute(attrName, wac);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-3"><p>è·Ÿè¿›åˆ›å»ºå­å®¹å™¨çš„æºç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">createWebApplicationContext</span><span class="params">(<span class="meta">@Nullable</span> ApplicationContext parent)</span> &#123;</span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–å­å®¹å™¨ApplicationContext</span></span><br><span class="line">    <span class="type">ConfigurableWebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span></span><br><span class="line">            (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">    <span class="comment">//è®¾ç½®ä¼ é€’è¿‡æ¥çš„ContextLoaderListenerçš„rootContextä¸ºçˆ¶å®¹å™¨</span></span><br><span class="line">    wac.setParent(parent);</span><br><span class="line">    <span class="comment">//è·å¾—web.xmlé…ç½®çš„classpath:spring-mvc.xml</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">configLocation</span> <span class="operator">=</span> <span class="built_in">this</span>.getContextConfigLocation();</span><br><span class="line">    <span class="keyword">if</span> (configLocation != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">//ä¸ºå­å®¹å™¨è®¾ç½®é…ç½®åŠ è½½è·¯å¾„</span></span><br><span class="line">        wac.setConfigLocation(configLocation);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å­å®¹å™¨(å°±æ˜¯åŠ è½½spring-mvc.xmlé…ç½®çš„Bean)</span></span><br><span class="line">    <span class="built_in">this</span>.configureAndRefreshWebApplicationContext(wac);</span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-4"><p>å­å®¹å™¨ä¸­çš„parentç»´æŠ¤ç€çˆ¶å®¹å™¨çš„å¼•ç”¨</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427153645421.png" alt="image-20230427153645421"></p><p>çˆ¶å®¹å™¨å’Œå­å®¹å™¨æ¦‚å¿µå’Œå…³ç³»ï¼š</p><ul><li>çˆ¶å®¹å™¨ï¼šSpring é€šè¿‡ContextLoaderListenerä¸ºå…¥å£äº§ç”Ÿçš„applicationContextå®¹å™¨ï¼Œå†…éƒ¨ä¸»è¦ç»´æŠ¤çš„æ˜¯applicationContext.xmlï¼ˆæˆ–ç›¸åº”é…ç½®ç±»ï¼‰é…ç½®çš„Beanä¿¡æ¯ï¼›</li><li>å­å®¹å™¨ï¼šSpringMVCé€šè¿‡DispatcherServletçš„init() æ–¹æ³•äº§ç”Ÿçš„applicationContextå®¹å™¨ï¼Œå†…éƒ¨ä¸»è¦ç»´æŠ¤çš„æ˜¯spring-mvc.xmlï¼ˆæˆ–ç›¸åº”é…ç½®ç±»ï¼‰é…ç½®çš„Beanä¿¡æ¯ï¼Œä¸”å†…éƒ¨è¿˜é€šè¿‡parentå±æ€§ç»´æŠ¤è¿™çˆ¶å®¹å™¨çš„å¼•ç”¨ã€‚</li><li>Beançš„æ£€ç´¢é¡ºåºï¼šæ ¹æ®ä¸Šé¢å­çˆ¶å®¹å™¨çš„æ¦‚å¿µï¼Œå¯ä»¥çŸ¥é“Controllerå­˜åœ¨ä¸å­å®¹å™¨ä¸­ï¼Œè€ŒControllerä¸­è¦æ³¨å…¥Serviceæ—¶ï¼Œä¼šå…ˆä»å­å®¹å™¨æœ¬èº«å»åŒ¹é…ï¼ŒåŒ¹é…ä¸æˆåŠŸæ—¶åœ¨å»çˆ¶å®¹å™¨ä¸­å»åŒ¹é…ï¼Œäºæ˜¯æœ€ç»ˆä»çˆ¶å®¹å™¨ä¸­åŒ¹é…åˆ°çš„UserServiceï¼Œè¿™æ ·å­çˆ¶å®¹å™¨å°±å¯ä»¥è¿›è¡Œè”é€šäº†ã€‚ä½†æ˜¯çˆ¶å®¹å™¨åªèƒ½ä»è‡ªå·±å®¹å™¨ä¸­è¿›è¡ŒåŒ¹é…ï¼Œä¸èƒ½ä»å­å®¹å™¨ä¸­è¿›è¡ŒåŒ¹é…ã€‚</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-5"><p>æ³¨å†Œ SpringMVCçš„ ä¹å¤§ç»„ä»¶ï¼Œåœ¨åˆå§‹åŒ–å®¹å™¨initWebApplicationContextæ–¹æ³•ä¸­æ‰§è¡Œäº†onRefreshæ–¹æ³•ï¼Œè¿›è€Œæ‰§è¡Œäº†åˆå§‹åŒ–ç­–ç•¥initStrategiesæ–¹æ³•ï¼Œæ³¨å†Œäº†ä¹ä¸ªè§£æå™¨ç»„ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DispatcherServletåˆå§‹åŒ–SpringMVCä¹å¤§ç»„ä»¶</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initStrategies</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.initMultipartResolver(context);<span class="comment">//1ã€åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ è§£æå™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initLocaleResolver(context);<span class="comment">//2ã€åˆå§‹åŒ–å›½é™…åŒ–è§£æå™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initThemeResolver(context);<span class="comment">//3ã€åˆå§‹åŒ–æ¨¡æ¿è§£æå™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initHandlerMappings(context);<span class="comment">//4ã€åˆå§‹åŒ–å¤„ç†å™¨æ˜ å°„å™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initHandlerAdapters(context);<span class="comment">//5ã€åˆå§‹åŒ–å¤„ç†å™¨é€‚é…å™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initHandlerExceptionResolvers(context);<span class="comment">//6ã€åˆå§‹åŒ–å¤„ç†å™¨å¼‚å¸¸è§£æå™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initRequestToViewNameTranslator(context);<span class="comment">//7ã€åˆå§‹åŒ–è¯·æ±‚è§†å›¾è½¬æ¢å™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initViewResolvers(context);<span class="comment">//8ã€åˆå§‹åŒ–è§†å›¾è§£æå™¨</span></span><br><span class="line">    <span class="built_in">this</span>.initFlashMapManager(context);<span class="comment">//9ã€åˆå§‹åŒ–lashMapManagerç­–ç•¥ç»„ä»¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ca3a4e03-2303-45ae-916c-f64e2a303cdc-6"><p>ä»¥ this.initHandlerMappings(context) ä¸ºä¾‹ï¼Œè¿›ä¸€æ­¥çœ‹ä¸€ä¸‹åˆå§‹åŒ–å¤„ç†å™¨æ˜ å°„å™¨çš„ç»†èŠ‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰Listå®¹å™¨å­˜å‚¨HandlerMapping</span></span><br><span class="line"><span class="keyword">private</span> List&lt;HandlerMapping&gt; handlerMappings;</span><br><span class="line"><span class="comment">//åˆå§‹åŒ–HandlerMappingçš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initHandlerMappings</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.handlerMappings = <span class="literal">null</span>;<span class="comment">//åˆå§‹åŒ–é›†åˆä¸ºnull</span></span><br><span class="line">    <span class="comment">//detectAllHandlerMappingsé»˜è®¤ä¸ºtrueï¼Œä»£è¡¨æ˜¯å¦ä»æ‰€æœ‰å®¹å™¨ä¸­(çˆ¶å­å®¹å™¨)æ£€æµ‹HandlerMapping</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.detectAllHandlerMappings) &#123;</span><br><span class="line">        <span class="comment">//ä»Springå®¹å™¨ä¸­å»åŒ¹é…HandlerMapping</span></span><br><span class="line">        Map&lt;String, HandlerMapping&gt; matchingBeans = BeanFactoryUtils.beansOfTypeIncludingAncestors(context,</span><br><span class="line">                HandlerMapping.class, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœä»å®¹å™¨ä¸­è·å–çš„HandlerMappingä¸ä¸ºnullå°±åŠ å…¥åˆ°äº‹å…ˆå®šä¹‰å¥½çš„handlerMappingså®¹å™¨ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (!matchingBeans.isEmpty()) &#123;</span><br><span class="line">            <span class="built_in">this</span>.handlerMappings = <span class="keyword">new</span> <span class="title class_">ArrayList</span>(matchingBeans.values());</span><br><span class="line">            AnnotationAwareOrderComparator.sort(<span class="built_in">this</span>.handlerMappings);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¦‚æœä»å®¹å™¨ä¸­æ²¡æœ‰è·å¾—HandlerMappingï¼Œæ„å‘³ç€handlerMappingsé›†åˆæ˜¯ç©ºçš„</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.handlerMappings == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">//åŠ è½½é»˜è®¤çš„HandlerMappingï¼Œå°±æ˜¯åŠ è½½DispatcherServlet.propertiesæ–‡ä»¶ä¸­çš„é”®å€¼å¯¹</span></span><br><span class="line">            <span class="built_in">this</span>.handlerMappings = <span class="built_in">this</span>.getDefaultStrategies(context, HandlerMapping.class);</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427154215264.png" alt="image-20230427154215264"></p><p>åˆå§‹åŒ–åï¼Œæ˜ å°„ä¿¡æ¯å°±å·²ç»è¢«å°è£…åˆ°HandlerMappingä¸­äº†ï¼Œå¯ä»¥åœ¨è·å–matchingBeanså¤„æ‰“æ–­ç‚¹éªŒè¯</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="6-2-å‰ç«¯æ§åˆ¶å™¨æ‰§è¡Œä¸»æµç¨‹">6.2 å‰ç«¯æ§åˆ¶å™¨æ‰§è¡Œä¸»æµç¨‹</h3><p>ä¸Šé¢è®²è§£äº†ä¸€ä¸‹ï¼Œå½“æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼ŒDispatcherServlet ä¼šæ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ¥ä¸‹æ¥ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šæ‰§è¡Œserviceæ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆå®è§‚çš„çœ‹ä¸€ä¸‹æ‰§è¡Œæµç¨‹ï¼Œåœ¨å»ç ”ç©¶æºç å’Œç»„ä»¶æ‰§è¡Œç»†èŠ‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230429111137565.png" alt="image-20230429111137565" style="zoom:67%;" /><div class="tabs" id="3437a5f1-ec27-476f-9b69-58f18848f585"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#3437a5f1-ec27-476f-9b69-58f18848f585-1"><i class="fas fa-cat"></i>processRequest</button></li><li class="tab"><button type="button" data-href="#3437a5f1-ec27-476f-9b69-58f18848f585-2"><i class="fas fa-horse"></i>doService</button></li><li class="tab"><button type="button" data-href="#3437a5f1-ec27-476f-9b69-58f18848f585-3"><i class="fas fa-dove"></i>â­ï¸doDispatch</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="3437a5f1-ec27-476f-9b69-58f18848f585-1"><p>FrameworkServlet å¤å†™äº†service(HttpServletRequest request, HttpServletResponse response) ã€ doGet(HttpServletRequest request, HttpServletResponse response)ã€doPost(HttpServletRequest request, HttpServletResponse response)ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½ä¼šè°ƒç”¨processRequestæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">processRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.doService(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="3437a5f1-ec27-476f-9b69-58f18848f585-2"><p>è¿›ä¸€æ­¥è°ƒç”¨äº†doServiceæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å†…éƒ¨åˆè°ƒç”¨äº†doDispatchæ–¹æ³•ï¼Œè€ŒSpringMVC ä¸»æµç¨‹æœ€æ ¸å¿ƒçš„æ–¹æ³•å°±æ˜¯doDispatch æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.doDispatch(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="3437a5f1-ec27-476f-9b69-58f18848f585-3"><p>doDispatchæ–¹æ³•æºç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="comment">// å¯¹åŸå§‹çš„è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ URL çš„ç¼–ç </span></span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">processedRequest</span> <span class="operator">=</span> checkMultipart(request);</span><br><span class="line">    <span class="comment">//å®šä¹‰å¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡</span></span><br><span class="line">    <span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//å®šä¹‰æ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="literal">null</span>; </span><br><span class="line">    <span class="comment">//åŒ¹é…å¤„ç†å™¨æ˜ å°„å™¨HandlerMappingï¼Œè¿”å›å¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡</span></span><br><span class="line">    mappedHandler = <span class="built_in">this</span>.getHandler(processedRequest);</span><br><span class="line">    <span class="comment">//åŒ¹é…å¤„ç†å™¨é€‚é…å™¨HandlerAdapterï¼Œè¿”å›å¤„ç†å™¨é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">    <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> <span class="built_in">this</span>.getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line">    <span class="comment">//æ‰§è¡ŒInterceptorçš„å‰ç½®æ–¹æ³•preHandle</span></span><br><span class="line">    mappedHandler.applyPreHandle(processedRequest, response);</span><br><span class="line">    <span class="comment">//å¤„ç†å™¨é€‚é…å™¨æ‰§è¡Œæ§åˆ¶å™¨Handlerï¼Œè¿”å›æ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">    mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line">    <span class="comment">//æ‰§è¡ŒInterceptorçš„åç½®æ–¹æ³•postHandle</span></span><br><span class="line">    mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">    <span class="comment">//è·å–è§†å›¾æ¸²æŸ“è§†å›¾</span></span><br><span class="line">    <span class="built_in">this</span>.processDispatchResult(processedRequest, response, mappedHandler, mv, (Exception)dispatchException);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="6-2-1-getHandleræ–¹æ³•è¯¦è§£">6.2.1 getHandleræ–¹æ³•è¯¦è§£</h4><p>doDispatch() ä¸­è°ƒç”¨ getHandler æ–¹æ³•è·å–æ‰€æœ‰çš„æ˜ å°„å™¨</p><p>æ€»ä½“æµç¨‹ï¼š</p><ul><li>æ‰€æœ‰çš„è¯·æ±‚æ˜ å°„éƒ½åœ¨ HandlerMapping ä¸­ï¼Œ<span class='p green'>RequestMappingHandlerMapping å¤„ç† @RequestMapping æ³¨è§£çš„æ˜ å°„è§„åˆ™</span></li><li>éå†æ‰€æœ‰çš„ HandlerMapping çœ‹æ˜¯å¦å¯ä»¥åŒ¹é…å½“å‰è¯·æ±‚ï¼ŒåŒ¹é…æˆåŠŸåè¿”å›ï¼ŒåŒ¹é…å¤±è´¥è®¾ç½® HTTP 404 å“åº”ç </li><li>ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰çš„æ˜ å°„å¤„ç†ï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ”¾å…¥è‡ªå®šä¹‰ HandlerMapping</li></ul><p>è®¿é—® URLï¼š<a href="http://localhost:8080/hello">http://localhost:8080/hello</a></p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/gethandler2.jpg" alt="gethandler2" style="zoom: 33%;" /><div class="tabs" id="aaad200b-ee69-49ad-912a-ba4b279fb02d"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#aaad200b-ee69-49ad-912a-ba4b279fb02d-1"><i class="fas fa-seedling"></i>1.getHandler()</button></li><li class="tab"><button type="button" data-href="#aaad200b-ee69-49ad-912a-ba4b279fb02d-2"><i class="fas fa-leaf"></i>2.getHandler()</button></li><li class="tab"><button type="button" data-href="#aaad200b-ee69-49ad-912a-ba4b279fb02d-3"><i class="fab fa-apple"></i>3.getHandlerInterna()</button></li><li class="tab"><button type="button" data-href="#aaad200b-ee69-49ad-912a-ba4b279fb02d-4"><i class="fas fa-tree"></i>4.lookupHandlerMethod()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="aaad200b-ee69-49ad-912a-ba4b279fb02d-1"><p>HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œä¿å­˜äº†æ‰€æœ‰ <code>@RequestMapping</code> å’Œ <code>handler</code> çš„æ˜ å°„è§„åˆ™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> HandlerExecutionChain <span class="title function_">getHandler</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.handlerMappings != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰çš„ HandlerMapping</span></span><br><span class="line">        <span class="keyword">for</span> (HandlerMapping mapping : <span class="built_in">this</span>.handlerMappings) &#123;</span><br><span class="line">            <span class="comment">// å°è¯•å»æ¯ä¸ª HandlerMapping ä¸­åŒ¹é…å½“å‰è¯·æ±‚çš„å¤„ç† </span></span><br><span class="line">            <span class="type">HandlerExecutionChain</span> <span class="variable">handler</span> <span class="operator">=</span> mapping.getHandler(request);<span class="comment">// è·³è½¬åˆ°2</span></span><br><span class="line">            <span class="keyword">if</span> (handler != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> handler;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430111413036.png" alt="image-20230430111413036" style="zoom: 50%;" /><p>æœ‰ 5 ä¸ª Mapping ï¼ŒæŸ¥çœ‹ RequestMappingHandlerMapping ï¼Œå¯ä»¥æŸ¥çœ‹è¯·æ±‚æ˜ å°„çš„æ³¨å†Œï¼š/errorã€/helloï¼Œè¿™é‡Œå°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„å¤„ç†æ–¹æ³•ï¼šcom.yuyu.demo.controller.DemoController.test()</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430111649469.png" alt="image-20230430111649469" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aaad200b-ee69-49ad-912a-ba4b279fb02d-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> HandlerExecutionChain <span class="title function_">getHandler</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// è·å–æ˜ å°„å™¨ï¼Œåº•å±‚è°ƒç”¨ RequestMappingInfoHandlerMapping ç±»çš„æ–¹æ³•ï¼Œåˆè°ƒç”¨ AbstractHandlerMethodMapping#getHandlerInternal</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">handler</span> <span class="operator">=</span> getHandlerInternal(request); <span class="comment">// è·³è½¬åˆ°3</span></span><br><span class="line">    <span class="keyword">if</span> (handler == <span class="literal">null</span>) &#123;</span><br><span class="line">        handler = getDefaultHandler();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (handler == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Bean name or resolved handler?</span></span><br><span class="line">    <span class="keyword">if</span> (handler <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">handlerName</span> <span class="operator">=</span> (String) handler;</span><br><span class="line">        handler = obtainApplicationContext().getBean(handlerName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ensure presence of cached lookupPath for interceptors and others</span></span><br><span class="line">    <span class="keyword">if</span> (!ServletRequestPathUtils.hasCachedPath(request)) &#123;</span><br><span class="line">        initLookupPath(request);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¸ºå½“å‰è¯·æ±‚å’Œæ–¹æ³•æ„å»ºä¸ºä¸€ä¸ªæ‹¦æˆªå™¨é“¾</span></span><br><span class="line">    <span class="type">HandlerExecutionChain</span> <span class="variable">executionChain</span> <span class="operator">=</span> getHandlerExecutionChain(handler, request);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> executionChain; <span class="comment">//è¿”å›åˆ°1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aaad200b-ee69-49ad-912a-ba4b279fb02d-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> HandlerMethod <span class="title function_">getHandlerInternal</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// åœ°å€æ çš„ uriï¼Œè¿™é‡Œçš„ lookupPath ä¸º /hello</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">lookupPath</span> <span class="operator">=</span> initLookupPath(request);</span><br><span class="line">    <span class="comment">// åŠ é”</span></span><br><span class="line">    <span class="built_in">this</span>.mappingRegistry.acquireReadLock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡è·¯å¾„ä»æ˜ å°„æ³¨å†Œå™¨é‡Œæ‰¾åˆ°å¯¹åº”çš„æ˜ å°„</span></span><br><span class="line">        <span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> lookupHandlerMethod(lookupPath, request); <span class="comment">// è·³è½¬åˆ°4</span></span><br><span class="line">        <span class="keyword">return</span> (handlerMethod != <span class="literal">null</span> ? handlerMethod.createWithResolvedBean() : <span class="literal">null</span>); <span class="comment">//è¿”å›2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mappingRegistry.releaseReadLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aaad200b-ee69-49ad-912a-ba4b279fb02d-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> HandlerMethod <span class="title function_">lookupHandlerMethod</span><span class="params">(String lookupPath, HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    List&lt;Match&gt; matches = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// è·å–å½“å‰çš„æ˜ å°„å™¨ä¸å½“å‰è¯·æ±‚çš„ URI æœ‰å…³çš„æ‰€æœ‰æ˜ å°„è§„åˆ™</span></span><br><span class="line">    List&lt;T&gt; directPathMatches = <span class="built_in">this</span>.mappingRegistry.getMappingsByDirectPath(lookupPath);</span><br><span class="line">    <span class="keyword">if</span> (directPathMatches != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// åŒ¹é…æŸä¸ªæ˜ å°„è§„åˆ™</span></span><br><span class="line">        addMatchingMappings(directPathMatches, matches, request);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// è¿”å›æ‰¾åˆ°çš„æœ€åŒ¹é…çš„ å¤„ç†æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> bestMatch.getHandlerMethod(); <span class="comment">//è¿”å›åˆ°3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230430114056174.png" alt="image-20230430114056174" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h4 id="6-2-2-å‚æ•°å¤„ç†åŸç†">6.2.2 å‚æ•°å¤„ç†åŸç†</h4><p>doDispatchä¸­</p><ul><li>HandlerMappingä¸­æ‰¾åˆ°èƒ½å¤„ç†è¯·æ±‚çš„Handler(controller.method())</li><li>ä¸ºå½“å‰Handleræ‰¾ä¸€ä¸ªé€‚é…å™¨HandlerAdapter</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//åŒ¹é…å¤„ç†å™¨æ˜ å°„å™¨HandlerMappingï¼Œè¿”å›å¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡</span></span><br><span class="line">  mappedHandler = <span class="built_in">this</span>.getHandler(processedRequest);</span><br><span class="line">  <span class="comment">//åŒ¹é…å¤„ç†å™¨é€‚é…å™¨HandlerAdapterï¼Œè¿”å›å¤„ç†å™¨é€‚é…å™¨å¯¹è±¡</span></span><br><span class="line">  <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> <span class="built_in">this</span>.getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"><span class="comment">// Actually invoke the handler.</span></span><br><span class="line">mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br></pre></td></tr></table></figure><div class="tabs" id="2b53a8bd-c0b4-4fed-bb79-497cd459a76a"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#2b53a8bd-c0b4-4fed-bb79-497cd459a76a-1"><i class="fas fa-seedling"></i>getHandlerAdapter</button></li><li class="tab"><button type="button" data-href="#2b53a8bd-c0b4-4fed-bb79-497cd459a76a-2"><i class="fas fa-leaf"></i>handle</button></li><li class="tab"><button type="button" data-href="#2b53a8bd-c0b4-4fed-bb79-497cd459a76a-3"><i class="fab fa-apple"></i>invokeHandlerMethod</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="2b53a8bd-c0b4-4fed-bb79-497cd459a76a-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> HandlerAdapter <span class="title function_">getHandlerAdapter</span><span class="params">(Object handler)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.handlerAdapters != <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (HandlerAdapter adapter : <span class="built_in">this</span>.handlerAdapters) &#123;</span><br><span class="line"><span class="keyword">if</span> (adapter.supports(handler)) &#123;</span><br><span class="line"><span class="keyword">return</span> adapter;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServletException</span>(<span class="string">&quot;No adapter for handler [&quot;</span> + handler +</span><br><span class="line"><span class="string">&quot;]: The DispatcherServlet configuration needs to include a HandlerAdapter that supports this handler&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§å¤šæ•°æ‰¾åˆ°çš„éƒ½æ˜¯ç¬¬ä¸€ä¸ª<code>RequestMappingHandlerAdapter</code>,æ‰¾åˆ°é€‚é…å™¨åè¿”å›æ”¹é€‚é…å™¨ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230505150121343.png" alt="image-20230505150121343" style="zoom:67%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2b53a8bd-c0b4-4fed-bb79-497cd459a76a-2"><p><code>mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</code></p><p>åˆ©ç”¨å‰é¢æ‰¾åˆ°çš„HandlerAdapterï¼ŒæŠŠç›®æ ‡Handlerï¼Œä»¥åŠRequestå’ŒResponseå…¨éƒ¨ä¼ è¿›å»ï¼Œæ¥æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚</p><p>å†…éƒ¨çš„å¤„ç†ç»†èŠ‚å°±åˆ°äº†</p><p><code>RequestMappingHandlerAdapter</code>#<code>handleInternal(request, response, handlerMethod)</code>æ–¹æ³•ä¸­</p><p>åœ¨è¯¥æ–¹æ³•é‡Œ</p><p><code>mav = invokeHandlerMethod(request, response, handlerMethod);</code>æ‰§è¡Œç›®æ ‡æ–¹æ³•</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="2b53a8bd-c0b4-4fed-bb79-497cd459a76a-3"><p>åœ¨è¯¥æ–¹æ³•ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletInvocableHandlerMethod</span> <span class="variable">invocableMethod</span> <span class="operator">=</span> createInvocableHandlerMethod(handlerMethod);</span><br><span class="line"><span class="comment">//è®¾ç½®å‚æ•°è§£æå™¨</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.argumentResolvers != <span class="literal">null</span>) &#123;</span><br><span class="line">    invocableMethod.setHandlerMethodArgumentResolvers(<span class="built_in">this</span>.argumentResolvers);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¾ç½®è¿”å›å€¼å¤„ç†å™¨</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.returnValueHandlers != <span class="literal">null</span>) &#123;</span><br><span class="line">    invocableMethod.setHandlerMethodReturnValueHandlers(<span class="built_in">this</span>.returnValueHandlers);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ......</span></span><br><span class="line"><span class="comment">// è°ƒç”¨å¤„ç†å™¨æ–¹æ³•å¹¶å¤„ç†è¿”å›å€¼</span></span><br><span class="line">invocableMethod.invokeAndHandle(webRequest, mavContainer);</span><br></pre></td></tr></table></figure><div class="tabs" id="7deda36b-990c-4db1-b08b-716deabfeee1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#7deda36b-990c-4db1-b08b-716deabfeee1-1"><i class="fas fa-cat"></i>å‚æ•°è§£æå™¨</button></li><li class="tab"><button type="button" data-href="#7deda36b-990c-4db1-b08b-716deabfeee1-2"><i class="fas fa-horse"></i>è¿”å›å€¼å¤„ç†å™¨</button></li><li class="tab"><button type="button" data-href="#7deda36b-990c-4db1-b08b-716deabfeee1-3"><i class="fas fa-dove"></i>æ‰§è¡Œç›®æ ‡æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="7deda36b-990c-4db1-b08b-716deabfeee1-1"><p><code>argumentResolvers</code>å‚æ•°è§£æå™¨ï¼šç¡®å®šå°†è¦æ‰§è¡Œçš„ç›®æ ‡æ–¹æ³•çš„æ¯ä¸€ä¸ªå‚æ•°çš„å€¼æ˜¯ä»€ä¹ˆ</p><p>å‚æ•°è§£æå™¨å…±æœ‰26ä¸ªï¼ŒSpringMVCç›®æ ‡æ–¹æ³•èƒ½å†™å¤šå°‘ç§å‚æ•°ç±»å‹ã€‚å–å†³äºå‚æ•°è§£æå™¨ã€‚</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230505152933897.png" alt="image-20230505152933897" style="zoom: 50%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7deda36b-990c-4db1-b08b-716deabfeee1-2"><p>è¿”å›å€¼å¤„ç†å™¨å…±æœ‰15ç§</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230505153622226.png" alt="image-20230505153622226" style="zoom:50%;" /><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="7deda36b-990c-4db1-b08b-716deabfeee1-3"><p>æŠŠå‚æ•°è§£æå™¨å’Œè¿”å›å€¼å¤„ç†å™¨éƒ½è®¾ç½®åˆ°<code>invocableMethod</code>ä¸­åå°±å¯ä»¥è¿›è¡Œæ–¹æ³•æ‰§è¡Œäº†</p><p>åœ¨<code>invocableMethod.invokeAndHandle(webRequest, mavContainer);</code>æ–¹æ³•ä¸­ï¼ŒçœŸæ­£æ‰§è¡Œäº†Controllerä¸­çš„æ–¹æ³•</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
    
    
    <summary type="html">è¯·æ±‚å¤„ç†ã€å“åº”å¤„ç†ã€æ‹¦æˆªå™¨ã€å…¨æ³¨è§£å¼€å‘ã€ç»„ä»¶åŸç†å‰–æ</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
    <category term="SpringMVC" scheme="https://wuwawawa.github.io/tags/SpringMVC/"/>
    
  </entry>
  
  <entry>
    <title>Springæ•´åˆWeb</title>
    <link href="https://wuwawawa.github.io/posts/6b43be99.html"/>
    <id>https://wuwawawa.github.io/posts/6b43be99.html</id>
    <published>2023-04-30T01:31:36.000Z</published>
    <updated>2023-05-16T05:27:11.031Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Springæ•´åˆwebç¯å¢ƒ">1. Springæ•´åˆwebç¯å¢ƒ</h2><h3 id="1-1-Javawebä¸‰å¤§ç»„ä»¶åŠç¯å¢ƒç‰¹ç‚¹">1.1 Javawebä¸‰å¤§ç»„ä»¶åŠç¯å¢ƒç‰¹ç‚¹</h3><p>åœ¨Javaè¯­è¨€èŒƒç•´å†…ï¼Œwebå±‚æ¡†æ¶éƒ½æ˜¯åŸºäºJavawebåŸºç¡€ç»„ä»¶å®Œæˆçš„ï¼Œæ‰€ä»¥æœ‰å¿…è¦å¤ä¹ ä¸€ä¸‹Javawebç»„ä»¶çš„ç‰¹ç‚¹</p><table><thead><tr><th style="text-align:left">ç»„ä»¶</th><th style="text-align:left">ä½œç”¨</th><th style="text-align:left">ç‰¹ç‚¹</th></tr></thead><tbody><tr><td style="text-align:left">Servlet</td><td style="text-align:left">æœåŠ¡ç«¯å°ç¨‹åºï¼Œè´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚å¹¶ä½œå‡ºå“åº”çš„</td><td style="text-align:left">å•ä¾‹å¯¹è±¡ï¼Œé»˜è®¤ç¬¬ä¸€æ¬¡è®¿é—®åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡é…ç½®æŒ‡å®šæœåŠ¡å™¨å¯åŠ¨å°±åˆ›å»ºï¼ŒServletåˆ›å»ºå®Œæ¯•ä¼šæ‰§è¡Œåˆå§‹åŒ–initæ–¹æ³•ã€‚æ¯ä¸ªServletæœ‰ä¸€ä¸ªserviceæ–¹æ³•ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šæ‰§è¡Œserviceæ–¹æ³•ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½å°±éœ€è¦é…ç½®ä¸€ä¸ªServlet</td></tr><tr><td style="text-align:left">Filter</td><td style="text-align:left">è¿‡æ»¤å™¨ï¼Œè´Ÿè´£å¯¹å®¢æˆ·ç«¯è¯·æ±‚è¿›è¡Œè¿‡æ»¤æ“ä½œçš„</td><td style="text-align:left">å•ä¾‹å¯¹è±¡ï¼ŒæœåŠ¡å™¨å¯åŠ¨æ—¶å°±åˆ›å»ºï¼Œå¯¹è±¡åˆ›å»ºå®Œæ¯•æ‰§è¡Œinitæ–¹æ³•ï¼Œå¯¹å®¢æˆ·ç«¯çš„è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¬¦åˆè¦æ±‚çš„æ”¾è¡Œï¼Œä¸ç¬¦åˆè¦æ±‚çš„ç›´æ¥å“åº”å®¢æˆ·ç«¯ï¼Œæ‰§è¡Œè¿‡æ»¤çš„æ ¸å¿ƒæ–¹æ³•doFilter</td></tr><tr><td style="text-align:left">Listener</td><td style="text-align:left">ç›‘å¬å™¨ï¼Œè´Ÿè´£å¯¹åŸŸå¯¹è±¡çš„åˆ›å»ºå’Œå±æ€§å˜åŒ–è¿›è¡Œç›‘å¬çš„</td><td style="text-align:left">æ ¹æ®ç±»å‹å’Œä½œç”¨ä¸åŒï¼Œåˆå¯åˆ†ä¸ºç›‘å¬åŸŸå¯¹è±¡åˆ›å»ºé”€æ¯å’ŒåŸŸå¯¹è±¡å±æ€§å†…å®¹å˜åŒ–çš„ï¼Œæ ¹æ®ç›‘å¬çš„åŸŸä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸ºç›‘å¬RequeståŸŸçš„ï¼Œç›‘å¬SessionåŸŸçš„ï¼Œç›‘å¬ServletContextåŸŸçš„</td></tr></tbody></table><mark class="hl-label green">ServletçŸ¥è¯†è¡¥å……</mark> <div class="tabs" id="ba4120be-81c6-4c79-8d1d-62ec49c11029"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ba4120be-81c6-4c79-8d1d-62ec49c11029-1"><i class="fas fa-cat"></i>å®ç°æ–¹å¼</button></li><li class="tab"><button type="button" data-href="#ba4120be-81c6-4c79-8d1d-62ec49c11029-2"><i class="fas fa-dove"></i>æ‰§è¡ŒåŸç†</button></li><li class="tab"><button type="button" data-href="#ba4120be-81c6-4c79-8d1d-62ec49c11029-3"><i class="fas fa-dragon"></i>ç”Ÿå‘½å‘¨æœŸ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ba4120be-81c6-4c79-8d1d-62ec49c11029-1"><p>Servletå®ç°æ–¹å¼</p><ul><li>å®ç°Servletæ¥å£</li><li>ç»§æ‰¿GenericServeltæŠ½è±¡ç±»ï¼ˆè¿™ä¸ªç±»æ˜¯Servletæ¥å£çš„ä¸€çº§å®ç°ç±»ï¼‰</li><li>ç»§æ‰¿HttpServletæŠ½è±¡ç±»å°±å¯ä»¥é—´æ¥çš„å®ç°Servletæ¥å£ï¼ˆä½äºjavax.servlet.httpåŒ…ä¸­çš„HttpServletæŠ½è±¡ç±»ç»§æ‰¿è‡ªGenericServletç±»ï¼Œæ˜¯Servletæ¥å£çš„äºŒçº§å®ç°ç±»ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig var1)</span> <span class="keyword">throws</span> ServletException;</span><br><span class="line"></span><br><span class="line">    ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest var1, ServletResponse var2)</span> <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">getServletInfo</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/874710-20170216094438629-1196159083.png" alt="img" style="zoom:50%;" /><p>åœ¨HttpServletçš„APIä¸­ï¼Œæ–°å¢äº†ä¸¤ä¸ªç‰¹æ®Šçš„æ–¹æ³•doGetå’ŒdoPostï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯å¯¹servletæ–¹æ³•çš„æ‹†åˆ†ï¼Œç›®çš„æ˜¯å¸Œæœ›ä¸åŒçš„è¯·æ±‚æ–¹å¼ä½¿ç”¨ä¸åŒçš„æ–¹æ³•å¤„ç†ã€‚è€Œserviceæ–¹æ³•å¯ä»¥å¤„ç†ä»»ä½•ç±»å‹çš„è¯·æ±‚ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ba4120be-81c6-4c79-8d1d-62ec49c11029-2"><ol><li>å½“æœåŠ¡å™¨æ¥å—åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨çš„è¯·æ±‚åï¼Œä¼šè§£æè¯·æ±‚URLè·¯å¾„ï¼Œè·å–è®¿é—®çš„Servletçš„èµ„æºè·¯å¾„</li><li>æŸ¥æ‰¾web.xmlæ–‡ä»¶ï¼Œæ˜¯å¦æœ‰å¯¹åº”çš„<code>&lt;url-pattern&gt;</code>æ ‡ç­¾ä½“å†…å®¹ã€‚</li><li>å¦‚æœæœ‰ï¼Œåˆ™åœ¨æ‰¾åˆ°å¯¹åº”çš„<code>&lt;servlet-class&gt;</code>å…¨ç±»å</li><li>tomcatä¼šå°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œå¹¶ä¸”åˆ›å»ºå…¶å¯¹è±¡</li><li>è°ƒç”¨å…¶Serviceæ–¹æ³•</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ba4120be-81c6-4c79-8d1d-62ec49c11029-3"><ul><li>åŠ è½½å’Œå®ä¾‹åŒ–ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“Servletç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶ï¼Œç”±å®¹å™¨åˆ›å»ºServletå¯¹è±¡</li><li>åˆå§‹åŒ–ï¼šåœ¨Servletå®ä¾‹åŒ–ä¹‹åï¼Œå®¹å™¨å°†è°ƒç”¨Servletçš„init()æ–¹æ³•åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡ï¼Œå®Œæˆä¸€äº›å¦‚åŠ è½½é…ç½®æ–‡ä»¶ã€åˆ›å»ºè¿æ¥ç­‰åˆå§‹åŒ–çš„å·¥ä½œã€‚è¯¥æ–¹æ³•åªè°ƒç”¨ä¸€æ¬¡</li><li>è¯·æ±‚å¤„ç†ï¼šæ¯æ¬¡è¯·æ±‚Servletæ—¶ï¼ŒServletå®¹å™¨éƒ½ä¼šè°ƒç”¨Servletçš„service()æ–¹æ³•å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚</li><li>æœåŠ¡ç»ˆæ­¢ï¼šå½“éœ€è¦é‡Šæ”¾å†…å­˜æˆ–è€…å®¹å™¨å…³é—­æ—¶ï¼Œå®¹å™¨å°±ä¼šè°ƒç”¨Servletå®ä¾‹çš„destroy()æ–¹æ³•å®Œæˆèµ„æºçš„é‡Šæ”¾ã€‚åœ¨destroy()æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œå®¹å™¨ä¼šé‡Šæ”¾è¿™ä¸ªServletå®ä¾‹ï¼Œè¯¥å®ä¾‹éšåä¼šè¢«Javaçš„åƒåœ¾æ”¶é›†å™¨æ‰€å›æ”¶</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="1-2-æ•´åˆwebç¯å¢ƒæ€è·¯åŠå®ç°">1.2 æ•´åˆwebç¯å¢ƒæ€è·¯åŠå®ç°</h3><p>åœ¨è¿›è¡ŒJavaå¼€å‘æ—¶è¦éµå¾ªä¸‰å±‚æ¶æ„+MVCï¼ŒSpringæ“ä½œæœ€æ ¸å¿ƒçš„å°±æ˜¯Springå®¹å™¨ï¼Œwebå±‚éœ€è¦æ³¨å…¥Serviceï¼Œserviceå±‚éœ€è¦æ³¨å…¥Daoï¼ˆMapperï¼‰ï¼Œwebå±‚ä½¿ç”¨ServletæŠ€æœ¯å……å½“çš„è¯ï¼Œéœ€è¦åœ¨Servletä¸­è·å¾—Springå®¹å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AnnotationConfigApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(ApplicationContextConfig.class);</span><br><span class="line"><span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> (AccountService)applicationContext.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">accountService.transferMoney(<span class="string">&quot;tom&quot;</span>,<span class="string">&quot;lucy&quot;</span>,<span class="number">100</span>);</span><br></pre></td></tr></table></figure><p>Webå±‚ä»£ç å¦‚æœéƒ½å»ç¼–å†™åˆ›å»ºAnnotationConfigApplicationContextçš„ä»£ç ï¼Œé‚£ä¹ˆé…ç½®ç±»é‡å¤è¢«åŠ è½½äº†ï¼Œ Springå®¹å™¨ä¹Ÿé‡å¤è¢«åˆ›å»ºäº†ï¼Œä¸èƒ½æ¯æ¬¡æƒ³ä»å®¹å™¨ä¸­è·å¾—ä¸€ä¸ªBeanéƒ½å¾—å…ˆåˆ›å»ºä¸€æ¬¡å®¹å™¨ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸å…è®¸ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ç°åœ¨çš„è¯‰æ±‚å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š</p><ul><li><code>ApplicationContext</code>åˆ›å»ºä¸€æ¬¡ï¼Œé…ç½®ç±»åŠ è½½ä¸€æ¬¡;</li><li>æœ€å¥½webæœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œå°±æ‰§è¡Œç¬¬1æ­¥æ“ä½œï¼Œåç»­ç›´æ¥ä»å®¹å™¨ä¸­è·å–Beanä½¿ç”¨å³å¯;</li><li><code>ApplicationContext</code>çš„å¼•ç”¨éœ€è¦åœ¨webå±‚ä»»ä½•ä½ç½®éƒ½å¯ä»¥è·å–åˆ°ã€‚</li></ul><span class='p green'>é’ˆå¯¹ä»¥ä¸Šè¯‰æ±‚æˆ‘ä»¬ç»™å‡ºè§£å†³æ€è·¯ï¼Œå¦‚ä¸‹</span><ul><li>åœ¨<code>ServletContextListener</code>çš„<code>contextInitialized</code>æ–¹æ³•ä¸­æ‰§è¡Œ<code>ApplicationContext</code>çš„åˆ›å»ºã€‚æˆ–åœ¨Servletçš„initæ–¹æ³•ä¸­æ‰§è¡Œ<code>ApplicationContext</code>çš„åˆ›å»ºï¼Œå¹¶ç»™Servletçš„load-on-startupå±æ€§ä¸€ä¸ªæ•°å­—å€¼ï¼Œç¡®ä¿æœåŠ¡å™¨å¯åŠ¨Servletå°±åˆ›å»º;</li><li>å°†åˆ›å»ºå¥½çš„<code>ApplicationContext</code>å­˜å‚¨åˆ°<code>ServletContext</code>åŸŸä¸­ï¼Œè¿™æ ·æ•´ä¸ªwebå±‚ä»»ä½•ä½ç½®å°±éƒ½å¯ä»¥è·å–åˆ°äº†</li></ul><blockquote><p>è‡ªå®šä¹‰ä»£ç å®Œæˆä¸Šè¿°ContextLoaderListenerå’ŒWebApplicationContextUtilsï¼ˆè§ä»£ç ï¼‰</p></blockquote><div class="tabs" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#985af088-6b5b-4ddc-844e-be0c5d5b5dec-1"><i class="fas fa-seedling"></i>ContextLoaderListener</button></li><li class="tab"><button type="button" data-href="#985af088-6b5b-4ddc-844e-be0c5d5b5dec-2"><i class="fab fa-apple"></i>é…ç½®Listeneråˆ°web.xmlä¸­</button></li><li class="tab"><button type="button" data-href="#985af088-6b5b-4ddc-844e-be0c5d5b5dec-3"><i class="fas fa-leaf"></i>è·å–Springå®¹å™¨</button></li><li class="tab"><button type="button" data-href="#985af088-6b5b-4ddc-844e-be0c5d5b5dec-4"><i class="fas fa-tree"></i>å­˜åœ¨çš„é—®é¢˜</button></li><li class="tab"><button type="button" data-href="#985af088-6b5b-4ddc-844e-be0c5d5b5dec-5"><i class="fas fa-cookie-bite"></i>è§£å†³æ–¹å¼</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContextLoaderListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        <span class="comment">//1. åˆ›å»ºSpringå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. å°†å®¹å™¨å­˜å‚¨åˆ°ServletContextåŸŸä¸­</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> sce.getServletContext();</span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;applicationContext&quot;</span>,app);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.itheima.listener.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (ApplicationContext) servletContext.getAttribute(<span class="string">&quot;applicationContext&quot;</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec-4"><p>é…ç½®æ–‡ä»¶åå­—å’Œè·å–Springå®¹å™¨keyå†™æ­»</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="985af088-6b5b-4ddc-844e-be0c5d5b5dec-5"><div class="tabs" id="a76920d6-2ba5-4775-ac57-231a39a2183d"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#a76920d6-2ba5-4775-ac57-231a39a2183d-1"><i class="fas fa-cat"></i>å®šä¹‰é…ç½®æ–‡ä»¶å…¨å±€å‚æ•°</button></li><li class="tab"><button type="button" data-href="#a76920d6-2ba5-4775-ac57-231a39a2183d-2"><i class="fas fa-horse"></i>è·å–é…ç½®æ–‡ä»¶åç§°</button></li><li class="tab"><button type="button" data-href="#a76920d6-2ba5-4775-ac57-231a39a2183d-3"><i class="fas fa-dove"></i>è§£è€¦æ–¹æ³•</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="a76920d6-2ba5-4775-ac57-231a39a2183d-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰å…¨å±€å‚æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.itheima.listener.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a76920d6-2ba5-4775-ac57-231a39a2183d-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContextLoaderListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String CONTEXT_CONFIG_LOCATION= <span class="string">&quot;contextConfigLocation&quot;</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent sce)</span> &#123;</span><br><span class="line">        <span class="comment">//0. è·å–contextConfigLocationé…ç½®æ–‡ä»¶åç§°</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> sce.getServletContext();</span><br><span class="line">        <span class="comment">//è§£æé…ç½®æ–‡ä»¶åå­—</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contextConfigLocation</span> <span class="operator">=</span> servletContext.getInitParameter(CONTEXT_CONFIG_LOCATION);</span><br><span class="line">        contextConfigLocation= contextConfigLocation.substring(<span class="string">&quot;classpath:&quot;</span>.length());</span><br><span class="line">        <span class="comment">//1. åˆ›å»ºSpringå®¹å™¨</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(contextConfigLocation);</span><br><span class="line">        <span class="comment">//2. å°†å®¹å™¨å­˜å‚¨åˆ°ServletContextåŸŸä¸­</span></span><br><span class="line"></span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;applicationContext&quot;</span>,app);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="a76920d6-2ba5-4775-ac57-231a39a2183d-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebApplicationContextUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ApplicationContext <span class="title function_">getWebApplicationContext</span><span class="params">(ServletContext servletContext)</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (ApplicationContext) servletContext.getAttribute(<span class="string">&quot;applicationContext&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="1-3-Webå¼€å‘ç»„ä»¶spring-web">1.3 Webå¼€å‘ç»„ä»¶spring-web</h3><p>åˆ°æ­¤ï¼Œå°±å°†ä¸€å¼€å§‹çš„è¯‰æ±‚éƒ½è§£å†³äº†ï¼Œå½“ç„¶æˆ‘ä»¬èƒ½æƒ³åˆ°çš„Spring æ¡†æ¶è‡ªç„¶ä¹Ÿä¼šæƒ³åˆ°ï¼ŒSpringå…¶å®å·²ç»ä¸ºæˆ‘ä»¬å®šä¹‰å¥½äº†ä¸€ä¸ª<code>ContextLoaderListener</code>ï¼Œä½¿ç”¨æ–¹å¼è·Ÿæˆ‘ä»¬ä¸Šé¢è‡ªå·±å®šä¹‰çš„å¤§ä½“ä¸€æ ·ï¼Œä½†æ˜¯åŠŸèƒ½è¦æ¯”æˆ‘ä»¬å¼ºç™¾å€ï¼Œæ‰€ä»¥ ï¼Œéµå¾ªSpring â€œæ‹¿æ¥ä¸»ä¹‰â€ çš„ç²¾ç¥ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨Springæä¾›çš„å°±å¯ä»¥äº†ã€‚å¼€å‘å¦‚ä¸‹ï¼š</p><div class="tabs" id="b05494f3-2fe1-4bf0-935f-436241e8a631"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#b05494f3-2fe1-4bf0-935f-436241e8a631-1"><i class="fas fa-seedling"></i>å¯¼å…¥åæ ‡</button></li><li class="tab"><button type="button" data-href="#b05494f3-2fe1-4bf0-935f-436241e8a631-2"><i class="fas fa-leaf"></i>é…ç½®web.xml</button></li><li class="tab"><button type="button" data-href="#b05494f3-2fe1-4bf0-935f-436241e8a631-3"><i class="fab fa-apple"></i>ä½¿ç”¨</button></li><li class="tab"><button type="button" data-href="#b05494f3-2fe1-4bf0-935f-436241e8a631-4"><i class="fas fa-tree"></i>è¡¥å……</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="b05494f3-2fe1-4bf0-935f-436241e8a631-1"><p>å…ˆå¯¼å…¥Spring-webçš„åæ ‡ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b05494f3-2fe1-4bf0-935f-436241e8a631-2"><p>åœ¨web.xmlä¸­å»é…ç½®<code>ContextLoaderListener</code>ï¼Œå¹¶æŒ‡å®šé…ç½®æ–‡ä»¶çš„ä½ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å®šä¹‰å…¨å±€å‚æ•°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®Listener--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b05494f3-2fe1-4bf0-935f-436241e8a631-3"><p>åœ¨Servletä¸­ç›´æ¥ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/accountServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">app</span> <span class="operator">=</span> WebApplicationContextUtils.getWebApplicationContext(servletContext);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> app.getBean(AccountService.class);</span><br><span class="line">        accountService.transferMoney(<span class="string">&quot;tom&quot;</span>,<span class="string">&quot;lucy&quot;</span>,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b05494f3-2fe1-4bf0-935f-436241e8a631-4"><p>å¦‚æœæ ¸å¿ƒé…ç½®ç±»ä½¿ç”¨çš„æ˜¯æ³¨è§£å½¢å¼çš„ï¼Œé‚£ä¹ˆSpringå®¹å™¨æ˜¯<code>AnnotationConfigWebApplicationContext</code>ï¼Œå¦‚ä¸‹é…ç½®æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAnnotationConfigWebApplicationContext</span> <span class="keyword">extends</span> <span class="title class_">AnnotationConfigWebApplicationContext</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyAnnotationConfigWebApplicationContext</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//æ³¨å†Œæ ¸å¿ƒé…ç½®ç±»</span></span><br><span class="line">        <span class="built_in">super</span>.register(ApplicationContextConfig.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextClass<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>com.itheima.web.MyAnnotationConfigWebApplicationContext<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h2 id="2-Webå±‚MVCæ¡†æ¶æ€æƒ³ä¸è®¾è®¡æ€è·¯">2. Webå±‚MVCæ¡†æ¶æ€æƒ³ä¸è®¾è®¡æ€è·¯</h2><p>Javaç¨‹åºå‘˜åœ¨å¼€å‘ä¸€èˆ¬éƒ½æ˜¯MVC+ä¸‰å±‚æ¶æ„ï¼ŒMVCæ˜¯webå¼€å‘æ¨¡å¼ï¼Œä¼ ç»Ÿçš„JavawebæŠ€æœ¯æ ˆå®ç°çš„MVCå¦‚ä¸‹</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427202851806.png" alt="image-20230427202851806" style="zoom: 50%;" /><p>åŸå§‹Javawebå¼€å‘ä¸­ï¼ŒServletå……å½“Controllerçš„è§’è‰²ï¼ŒJspå……å½“Viewè§’è‰²ï¼ŒJavaBeanå……å½“æ¨¡å‹è§’è‰²ï¼ŒåæœŸAjaxå¼‚æ­¥æµè¡Œåï¼Œåœ¨åŠ ä¸Šç°åœ¨å‰åç«¯åˆ†ç¦»å¼€å‘æ¨¡å¼æˆç†Ÿåï¼ŒViewå°±è¢«åŸå§‹Html+Vueæ›¿ä»£ã€‚åŸå§‹Javawebå¼€å‘ä¸­ï¼Œ Serviceå……å½“Controlleræœ‰å¾ˆå¤šå¼Šç«¯ï¼Œæ˜¾è€Œæ˜“è§çš„æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</p><table><thead><tr><th style="text-align:left">Servletä½œä¸ºControllerçš„é—®é¢˜</th><th style="text-align:left">è§£å†³æ€è·¯å’Œæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td style="text-align:left">æ¯ä¸ªä¸šåŠ¡åŠŸèƒ½è¯·æ±‚éƒ½å¯¹åº”ä¸€ä¸ªServlet</td><td style="text-align:left">æ ¹æ®ä¸šåŠ¡æ¨¡å—å»åˆ’åˆ†Controller</td></tr><tr><td style="text-align:left">æ¯ä¸ªServletçš„ä¸šåŠ¡æ“ä½œå¤ªç¹ç</td><td style="text-align:left">å°†é€šç”¨çš„è¡Œä¸ºï¼ŒåŠŸèƒ½è¿›è¡ŒæŠ½å–å°è£…</td></tr><tr><td style="text-align:left">Servletè·å¾—Springå®¹å™¨çš„ç»„ä»¶åªèƒ½é€šè¿‡å®¢æˆ·ç«¯ä»£ç å»è·å–ï¼Œä¸èƒ½ä¼˜é›…çš„æ•´åˆ</td><td style="text-align:left">é€šè¿‡Springçš„æ‰©å±•ç‚¹ï¼Œå»å°è£…ä¸€ä¸ªæ¡†æ¶ï¼Œä»åŸæœ‰çš„Servletå®Œå…¨æ¥æ‰‹è¿‡æ¥webå±‚çš„ä¸šåŠ¡</td></tr></tbody></table><p>åˆ†æå‰ç«¯æ§åˆ¶å™¨åŸºæœ¬åŠŸèƒ½å¦‚ä¸‹ï¼š</p><p>1ã€å…·å¤‡å¯ä»¥æ˜ å°„åˆ°ä¸šåŠ¡Beançš„èƒ½åŠ›</p><p>2ã€å…·å¤‡å¯ä»¥è§£æè¯·æ±‚å‚æ•°ã€å°è£…å®ä½“ç­‰å…±æœ‰åŠŸèƒ½</p><p>3ã€å…·å¤‡å“åº”è§†å›¾åŠå“åº”å…¶ä»–æ•°æ®çš„åŠŸèƒ½</p><span class='p green'>è´Ÿè´£å…±æœ‰è¡Œä¸º</span>çš„Servletç§°ä¹‹ä¸º`å‰ç«¯æ§åˆ¶å™¨`<span class='p blue'>è´Ÿè´£ä¸šåŠ¡è¡Œä¸º</span>çš„JavaBeanç§°ä¹‹ä¸º`æ§åˆ¶å™¨Controller`<img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427100450596.png" alt="image-20230427100450596" style="zoom: 67%;" />]]></content>
    
    
    <summary type="html">Springæ•´åˆwebç¯å¢ƒã€Webå±‚MVCæ¡†æ¶æ€æƒ³ä¸è®¾è®¡æ€è·¯</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
    <category term="SpringMVC" scheme="https://wuwawawa.github.io/tags/SpringMVC/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºAOPçš„ç”³æ˜å¼äº‹åŠ¡æ§åˆ¶</title>
    <link href="https://wuwawawa.github.io/posts/8f292d64.html"/>
    <id>https://wuwawawa.github.io/posts/8f292d64.html</id>
    <published>2023-04-29T13:33:55.000Z</published>
    <updated>2023-05-16T05:26:56.734Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-Springäº‹åŠ¡ç¼–ç¨‹æ¦‚è¿°">1. Springäº‹åŠ¡ç¼–ç¨‹æ¦‚è¿°</h2><p>äº‹åŠ¡æ˜¯å¼€å‘ä¸­å¿…ä¸å¯å°‘çš„ä¸œè¥¿ï¼Œä½¿ç”¨JDBCå¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨connnectionå¯¹äº‹åŠ¡è¿›è¡Œæ§åˆ¶ï¼Œä½¿ç”¨MyBatisæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>SqlSession</code>å¯¹äº‹åŠ¡è¿›è¡Œæ§åˆ¶ï¼Œç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼Œå½“æˆ‘ä»¬åˆ‡æ¢æ•°æ®åº“è®¿é—®æŠ€æœ¯æ—¶ï¼Œäº‹åŠ¡æ§åˆ¶çš„æ–¹å¼æ€»ä¼šå˜åŒ–ï¼Œ Spring å°±å°†è¿™äº›æŠ€æœ¯åŸºç¡€ä¸Šï¼Œæä¾›äº†ç»Ÿä¸€çš„æ§åˆ¶äº‹åŠ¡çš„æ¥å£ã€‚Springçš„äº‹åŠ¡åˆ†ä¸ºï¼š<code>ç¼–ç¨‹å¼äº‹åŠ¡æ§åˆ¶</code>å’Œ<code>å£°æ˜å¼äº‹åŠ¡æ§åˆ¶</code></p><table><thead><tr><th>äº‹åŠ¡æ§åˆ¶æ–¹å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>ç¼–ç¨‹å¼äº‹åŠ¡æ§åˆ¶</td><td>Springæä¾›äº†äº‹åŠ¡æ§åˆ¶çš„ç±»å’Œæ–¹æ³•ï¼Œä½¿ç”¨ç¼–ç çš„æ–¹å¼å¯¹ä¸šåŠ¡ä»£ç è¿›è¡Œäº‹åŠ¡æ§åˆ¶ï¼Œäº‹åŠ¡æ§åˆ¶ä»£ç å’Œä¸šåŠ¡æ“ä½œä»£ç è€¦åˆåˆ°äº†ä¸€èµ·ï¼Œå¼€å‘ä¸­ä¸ä½¿ç”¨</td></tr><tr><td>å£°æ˜å¼äº‹åŠ¡æ§åˆ¶</td><td>Springå°†äº‹åŠ¡æ§åˆ¶çš„ä»£ç å°è£…ï¼Œå¯¹å¤–æä¾›äº†Xmlå’Œæ³¨è§£é…ç½®æ–¹å¼ï¼Œé€šè¿‡é…ç½®çš„æ–¹å¼å®Œæˆäº‹åŠ¡çš„æ§åˆ¶ï¼Œå¯ä»¥è¾¾åˆ°äº‹åŠ¡æ§åˆ¶ä¸ä¸šåŠ¡æ“ä½œä»£ç è§£è€¦åˆï¼Œå¼€å‘ä¸­æ¨èä½¿ç”¨</td></tr></tbody></table><p>Springäº‹åŠ¡ç¼–ç¨‹ç›¸å…³çš„ç±»ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ä¸ª</p><table><thead><tr><th style="text-align:left">äº‹åŠ¡æ§åˆ¶ç›¸å…³ç±»</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left">å¹³å°äº‹åŠ¡ç®¡ç†å™¨<br/><code>PlatformTransactionManager</code></td><td style="text-align:left">æ˜¯ä¸€ä¸ªæ¥å£æ ‡å‡†ï¼Œå®ç°ç±»éƒ½å…·å¤‡äº‹åŠ¡æäº¤ã€å›æ»šå’Œè·å¾—äº‹åŠ¡å¯¹è±¡çš„åŠŸèƒ½ï¼Œä¸åŒæŒä¹…å±‚æ¡†æ¶å¯èƒ½ä¼šæœ‰ä¸åŒå®ç°æ–¹æ¡ˆ</td></tr><tr><td style="text-align:left">äº‹åŠ¡å®šä¹‰<br/><code>TransactionDefinition</code></td><td style="text-align:left">å°è£…äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºã€è¿‡æœŸæ—¶é—´ç­‰å±æ€§ä¿¡æ¯</td></tr><tr><td style="text-align:left">äº‹åŠ¡çŠ¶æ€<br/><code>TransactionStatus</code></td><td style="text-align:left">å­˜å‚¨å½“å‰äº‹åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚æœäº‹åŠ¡æ˜¯å¦æäº¤ã€æ˜¯å¦å›æ»šã€æ˜¯å¦æœ‰å›æ»šç‚¹ç­‰</td></tr></tbody></table><p>è™½ç„¶ç¼–ç¨‹å¼äº‹åŠ¡æ§åˆ¶æˆ‘ä»¬ä¸å­¦ä¹ ï¼Œä½†æ˜¯ç¼–ç¨‹å¼äº‹åŠ¡æ§åˆ¶å¯¹åº”çš„è¿™äº›ç±»æˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é€šè¿‡é…ç½®çš„æ–¹å¼è¿›è¡Œå£°æ˜å¼äº‹åŠ¡æ§åˆ¶æ—¶ä¹Ÿä¼šçœ‹åˆ°è¿™äº›ç±»çš„å½±å­</p><hr><h2 id="2-æ­å»ºæµ‹è¯•ç¯å¢ƒ">2. æ­å»ºæµ‹è¯•ç¯å¢ƒ</h2><p>æ­å»ºä¸€ä¸ªè½¬è´¦çš„ç¯å¢ƒï¼Œdaoå±‚ä¸€ä¸ªè½¬å‡ºé’±çš„æ–¹æ³•ï¼Œä¸€ä¸ªè½¬å…¥é’±çš„æ–¹æ³•ï¼Œserviceå±‚ä¸€ä¸ªè½¬è´¦ä¸šåŠ¡æ–¹æ³•ï¼Œå†…éƒ¨åˆ†åˆ«è°ƒç”¨daoå±‚è½¬å‡ºé’±å’Œè½¬å…¥é’±çš„æ–¹æ³•ï¼Œå‡†å¤‡å·¥ä½œå¦‚ä¸‹ï¼š</p><ul><li><p>æ•°æ®åº“å‡†å¤‡ä¸€ä¸ªè´¦æˆ·è¡¨tb_account;</p></li><li><p>daoå±‚å‡†å¤‡ä¸€ä¸ªAccountMapperï¼ŒåŒ…æ‹¬incrMoneyå’ŒdecrMoneyä¸¤ä¸ªæ–¹æ³•ï¼›</p></li><li><p>serviceå±‚å‡†å¤‡ä¸€ä¸ªtransferMoneyæ–¹æ³•ï¼Œåˆ†åˆ«è°ƒç”¨incrMoneyå’ŒdecrMoneyæ–¹æ³•ï¼›</p></li><li><p>åœ¨applicationContextæ–‡ä»¶ä¸­è¿›è¡ŒBeançš„ç®¡ç†é…ç½®ï¼›</p></li><li><p>æµ‹è¯•æ­£å¸¸è½¬è´¦ä¸å¼‚å¸¸è½¬è´¦ã€‚</p></li></ul><hr><h2 id="3-åŸºäºxmlå£°æ˜å¼äº‹åŠ¡æ§åˆ¶">3. åŸºäºxmlå£°æ˜å¼äº‹åŠ¡æ§åˆ¶</h2><p>ç»“åˆä¸Šé¢æˆ‘ä»¬å­¦ä¹ çš„AOPçš„æŠ€æœ¯ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥æƒ³åˆ°ï¼Œå¯ä»¥ä½¿ç”¨AOPå¯¹Serviceçš„æ–¹æ³•è¿›è¡Œäº‹åŠ¡çš„å¢å¼ºã€‚</p><ul><li><p>ç›®æ ‡ç±»ï¼šAccountServiceImpl</p></li><li><p>åˆ‡ç‚¹ï¼šserviceä¸šåŠ¡ç±»ä¸­çš„æ‰€æœ‰ä¸šåŠ¡æ–¹æ³•</p></li><li><p>é€šçŸ¥ç±»ï¼šSpringæä¾›çš„ï¼Œé€šçŸ¥æ–¹æ³•å·²ç»å®šä¹‰å¥½ï¼Œåªéœ€è¦é…ç½®å³å¯</p></li></ul><p>æˆ‘ä»¬åˆ†æï¼š</p><p>ç›®æ ‡ç±»æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ï¼›</p><ul><li><p>é€šçŸ¥ç±»æ˜¯Springæä¾›çš„ï¼Œéœ€è¦å¯¼å…¥Springäº‹åŠ¡çš„ç›¸å…³çš„åæ ‡ï¼›</p></li><li><p>é…ç½®ç›®æ ‡ç±»AccountServiceImplï¼›</p></li><li><p>ä½¿ç”¨advisoræ ‡ç­¾é…ç½®åˆ‡é¢ã€‚</p></li></ul><p>å¯¼å…¥Springäº‹åŠ¡çš„ç›¸å…³çš„åæ ‡ï¼Œspring-jdbcåæ ‡å·²ç»å¼•å…¥çš„spring-txåæ ‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.13.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230426103319358.png" alt="image-20230426103319358"></p><p>é…ç½®ç›®æ ‡ç±»AccountServiceImpl</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.AccoutServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;accountMapper&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;accountMapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨advisoræ ‡ç­¾é…ç½®åˆ‡é¢</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;Springæä¾›çš„é€šçŸ¥ç±»&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* com.itheima.service.impl.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç–‘é—®ï¼šSpringæä¾›çš„é€šçŸ¥ç±»æ˜¯è°ï¼Ÿæ˜¯è°ï¼Ÿ</p><p>æ˜¯spring-txåŒ…ä¸‹çš„adviceæ ‡ç­¾é…ç½®æä¾›çš„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; </span><br><span class="line">http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Springæä¾›çš„äº‹åŠ¡é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;transferMoney&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;READ_COMMITTED&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;add*&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;3&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update*&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete*&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;select*&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¹³å°äº‹åŠ¡ç®¡ç†å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* com.itheima.service.impl.*.*(..))&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹ä¸Šè¿°é…ç½®è¿›è¡Œè¯¦è§£ä¸€ä¸‹<br>é¦–å…ˆï¼Œå¹³å°äº‹åŠ¡ç®¡ç†å™¨PlatformTransactionManageræ˜¯Springæä¾›çš„å°è£…äº‹åŠ¡å…·ä½“æ“ä½œçš„è§„èŒƒæ¥å£ï¼Œå°è£…äº†äº‹åŠ¡çš„æäº¤å’Œå›æ»šæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PlatformTransactionManager</span> <span class="keyword">extends</span> <span class="title class_">TransactionManager</span> &#123;</span><br><span class="line">    TransactionStatus <span class="title function_">getTransaction</span><span class="params">(<span class="meta">@Nullable</span> TransactionDefinition var1)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">commit</span><span class="params">(TransactionStatus var1)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">(TransactionStatus var1)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸åŒçš„æŒä¹…å±‚æ¡†æ¶äº‹åŠ¡æ“ä½œçš„æ–¹å¼æœ‰å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥ä¸åŒçš„æŒä¹…å±‚æ¡†æ¶æœ‰å¯èƒ½ä¼šæœ‰ä¸åŒçš„å¹³å°äº‹åŠ¡ç®¡ç†å™¨å®ç°ï¼Œä¾‹å¦‚ï¼ŒMyBatisä½œä¸ºæŒä¹…å±‚æ¡†æ¶æ—¶ï¼Œä½¿ç”¨çš„å¹³å°äº‹åŠ¡ç®¡ç†å™¨å®ç°æ˜¯DataSourceTransactionManagerã€‚ Hibernateä½œä¸ºæŒä¹…å±‚æ¡†æ¶æ—¶ï¼Œä½¿ç”¨çš„å¹³å°äº‹åŠ¡ç®¡ç†å™¨æ˜¯HibernateTransactionManagerã€‚</p><p>å…¶æ¬¡ï¼Œäº‹åŠ¡å®šä¹‰ä¿¡æ¯é…ç½®ï¼Œæ¯ä¸ªäº‹åŠ¡æœ‰å¾ˆå¤šç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šéš”ç¦»çº§åˆ«ã€åªè¯»çŠ¶æ€ã€è¶…æ—¶æ—¶é—´ç­‰ï¼Œè¿™äº›ä¿¡æ¯åœ¨å¼€å‘æ—¶å¯ä»¥é€šè¿‡connectionè¿›è¡ŒæŒ‡å®šï¼Œè€Œæ­¤å¤„è¦é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;æ–¹æ³•åç§°&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;éš”ç¦»çº§åˆ«&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;ä¼ æ’­è¡Œä¸º&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;åªè¯»çŠ¶æ€&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;è¶…æ—¶æ—¶é—´&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œnameå±æ€§åç§°æŒ‡å®šå“ªä¸ªæ–¹æ³•è¦è¿›è¡Œå“ªäº›äº‹åŠ¡çš„å±æ€§é…ç½®ï¼Œæ­¤å¤„éœ€è¦åŒºåˆ†çš„æ˜¯åˆ‡ç‚¹è¡¨è¾¾å¼æŒ‡å®šçš„æ–¹æ³•ä¸æ­¤å¤„æŒ‡å®šçš„æ–¹æ³•çš„åŒºåˆ«ï¼Ÿåˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œæ˜¯è¿‡æ»¤å“ªäº›æ–¹æ³•å¯ä»¥è¿›è¡Œäº‹åŠ¡å¢å¼ºï¼›äº‹åŠ¡å±æ€§ä¿¡æ¯çš„nameï¼Œæ˜¯æŒ‡å®šå“ªä¸ªæ–¹æ³•è¦è¿›è¡Œå“ªäº›äº‹åŠ¡å±æ€§çš„é…ç½®</p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230427092027314.png" alt="image-20230427092027314" style="zoom:67%;" /><p>ç¬¬ä¸€å±‚ç­›é€‰æ˜¯ç¬¦åˆåˆ‡é¢è¡¨è¾¾å¼çš„æ–¹æ³•</p><p>ç¬¬äºŒå±‚æ˜¯å¯¹æ–¹æ³•æŒ‡å®šäº‹åŠ¡çš„å±æ€§</p><p>æ–¹æ³•ååœ¨é…ç½®æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ * è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç²¾ç¡®åŒ¹é…transferMoneyæ–¹æ³•--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;transferMoney&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ¨¡ç³ŠåŒ¹é…ä»¥Serviceç»“å°¾çš„æ–¹æ³•--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*Service&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ¨¡ç³ŠåŒ¹é…ä»¥insertå¼€å¤´çš„æ–¹æ³•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;insert*&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ¨¡ç³ŠåŒ¹é…ä»¥updateå¼€å¤´çš„æ–¹æ³•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update*&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ¨¡ç³ŠåŒ¹é…ä»»æ„æ–¹æ³•ï¼Œä¸€èˆ¬æ”¾åˆ°æœ€åä½œä¸ºä¿åº•åŒ¹é…--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure><p>isolationå±æ€§ï¼šæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œäº‹åŠ¡å¹¶å‘å­˜åœ¨ä¸‰å¤§é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»/è™šè¯»ã€‚å¯ä»¥é€šè¿‡è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æ¥ä¿è¯å¹¶å‘é—®é¢˜çš„å‡ºç°ï¼Œå¸¸ç”¨çš„æ˜¯READ_COMMITTED å’ŒREPEATABLE_READ</p><table><thead><tr><th style="text-align:left">isolationå±æ€§</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left">DEFAULT</td><td style="text-align:left">é»˜è®¤éš”ç¦»çº§åˆ«ï¼Œå–å†³äºå½“å‰æ•°æ®åº“éš”ç¦»çº§åˆ«ï¼Œä¾‹å¦‚MySQLé»˜è®¤éš”ç¦»çº§åˆ«æ˜¯REPEATABLE_READ</td></tr><tr><td style="text-align:left">READ_UNCOMMITTED</td><td style="text-align:left">Aäº‹åŠ¡å¯ä»¥è¯»å–åˆ°Bäº‹åŠ¡å°šæœªæäº¤çš„äº‹åŠ¡è®°å½•ï¼Œä¸èƒ½è§£å†³ä»»ä½•å¹¶å‘é—®é¢˜ï¼Œå®‰å…¨æ€§æœ€ä½ï¼Œæ€§èƒ½æœ€é«˜</td></tr><tr><td style="text-align:left">READ_COMMITTED</td><td style="text-align:left">Aäº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡å·²ç»æäº¤çš„è®°å½•ï¼Œä¸èƒ½è¯»å–åˆ°æœªæäº¤çš„è®°å½•ã€‚å¯ä»¥è§£å†³è„è¯»é—®é¢˜ï¼Œä½†æ˜¯ä¸èƒ½è§£å†³ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</td></tr><tr><td style="text-align:left">REPEATABLE_READ</td><td style="text-align:left">Aäº‹åŠ¡å¤šæ¬¡ä»æ•°æ®åº“è¯»å–æŸæ¡è®°å½•ç»“æœä¸€è‡´ï¼Œå¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»ï¼Œä¸å¯ä»¥è§£å†³å¹»è¯»</td></tr><tr><td style="text-align:left">SERIALIZABLE</td><td style="text-align:left">ä¸²è¡ŒåŒ–ï¼Œå¯ä»¥è§£å†³ä»»ä½•å¹¶å‘é—®é¢˜ï¼Œå®‰å…¨æ€§æœ€é«˜ï¼Œä½†æ˜¯æ€§èƒ½æœ€ä½</td></tr></tbody></table><p>read-onlyå±æ€§ï¼šè®¾ç½®å½“å‰çš„åªè¯»çŠ¶æ€ï¼Œå¦‚æœæ˜¯æŸ¥è¯¢åˆ™è®¾ç½®ä¸ºtrueï¼Œå¯ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œå¦‚æœæ˜¯æ›´æ–°ï¼ˆå¢åˆ æ”¹ï¼‰æ“ä½œåˆ™è®¾ç½®ä¸ºfalse</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¸€èˆ¬æŸ¥è¯¢ç›¸å…³çš„ä¸šåŠ¡æ“ä½œéƒ½ä¼šè®¾ç½®ä¸ºåªè¯»æ¨¡å¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;select*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>timeoutå±æ€§ï¼šè®¾ç½®äº‹åŠ¡æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œå¦‚æœè¶…è¿‡è¯¥æ—¶é—´é™åˆ¶ä½†äº‹åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œåˆ™è‡ªåŠ¨å›æ»šäº‹åŠ¡ ï¼Œä¸åœ¨ç»§ç»­æ‰§è¡Œã€‚é»˜è®¤å€¼æ˜¯-1ï¼Œå³æ²¡æœ‰è¶…æ—¶æ—¶é—´é™åˆ¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è®¾ç½®æŸ¥è¯¢æ“ä½œçš„è¶…æ—¶æ—¶é—´æ˜¯3ç§’ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;select*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> <span class="attr">timeout</span>=<span class="string">&quot;3&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>propagationå±æ€§ï¼šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œä¸»è¦è§£å†³æ˜¯Aæ–¹æ³•è°ƒç”¨Bæ–¹æ³•æ—¶ï¼Œäº‹åŠ¡çš„ä¼ æ’­æ–¹å¼é—®é¢˜çš„ï¼Œä¾‹å¦‚ï¼šä½¿ç”¨å•æ–¹çš„äº‹åŠ¡ï¼Œè¿˜æ˜¯Aå’ŒBéƒ½ä½¿ç”¨è‡ªå·±çš„äº‹åŠ¡ç­‰ã€‚äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºæœ‰å¦‚ä¸‹ä¸ƒç§å±æ€§å€¼å¯é…ç½®</p><table><thead><tr><th style="text-align:left">äº‹åŠ¡ä¼ æ’­è¡Œä¸º</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left">REQUIREDï¼ˆé»˜è®¤å€¼ï¼‰</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBéœ€è¦äº‹åŠ¡ï¼Œå¦‚æœAæœ‰äº‹åŠ¡Bå°±åŠ å…¥Açš„äº‹åŠ¡ä¸­ï¼Œå¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°±è‡ªå·±åˆ›å»ºä¸€ä¸ªäº‹åŠ¡</td></tr><tr><td style="text-align:left">REQUIRED_NEW</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBéœ€è¦æ–°äº‹åŠ¡ï¼Œå¦‚æœAæœ‰äº‹åŠ¡å°±æŒ‚èµ·ï¼ŒBè‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡</td></tr><tr><td style="text-align:left">SUPPORTS</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBæœ‰æ— äº‹åŠ¡æ— æ‰€è°“ï¼ŒAæœ‰äº‹åŠ¡å°±åŠ å…¥åˆ°Aäº‹åŠ¡ä¸­ï¼ŒAæ— äº‹åŠ¡Bå°±ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œ</td></tr><tr><td style="text-align:left">NOT_SUPPORTS</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBä»¥æ— äº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼ŒAå¦‚æœ‰äº‹åŠ¡åˆ™æŒ‚èµ·</td></tr><tr><td style="text-align:left">NEVER</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBä»¥æ— äº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼ŒAå¦‚æœ‰äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸</td></tr><tr><td style="text-align:left">MANDATORY</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBè¦åŠ å…¥Açš„äº‹åŠ¡ä¸­ï¼Œå¦‚æœAæ— äº‹åŠ¡å°±æŠ›å‡ºå¼‚å¸¸</td></tr><tr><td style="text-align:left">NESTED</td><td style="text-align:left">Aè°ƒç”¨Bï¼ŒBåˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼ŒAæœ‰äº‹åŠ¡å°±ä½œä¸ºåµŒå¥—äº‹åŠ¡å­˜åœ¨ï¼ŒAæ²¡äº‹åŠ¡å°±ä»¥åˆ›å»ºçš„æ–°äº‹åŠ¡æ‰§è¡Œ</td></tr></tbody></table><p>xmlæ–¹å¼å£°æ˜å¼äº‹åŠ¡æ§åˆ¶çš„åŸç†æµ…æä¸€ä¸‹</p><p><code>&lt;tx:advice&gt;</code>æ ‡ç­¾ä½¿ç”¨çš„å‘½åç©ºé—´å¤„ç†å™¨æ˜¯<code>TxNamespaceHandler</code>ï¼Œå†…éƒ¨æ³¨å†Œçš„æ˜¯è§£æå™¨æ˜¯<code>TxAdviceBeanDefinitionParser</code></p><p><code>this.registerBeanDefinitionParser(&quot;advice&quot;, new TxAdviceBeanDefinitionParser());</code></p><p><code>TxAdviceBeanDefinitionParser</code>ä¸­æŒ‡å®šäº†è¦æ³¨å†Œçš„BeanDefinition</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; getBeanClass(Element element) &#123;</span><br><span class="line">    <span class="keyword">return</span> TransactionInterceptor.class;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>TxAdviceBeanDefinitionParser</code>äºŒçº§çˆ¶ç±»AbstractBeanDefinitionParserçš„parseæ–¹æ³•å°†<code>TransactionInterceptor</code>ä»¥é…ç½®çš„åç§°(myAdvice)æ³¨å†Œåˆ°äº†Springå®¹å™¨ä¸­</p><p><code>parserContext.registerComponent(componentDefinition);</code></p><p>TransactionInterceptorå®ç°äº†MethodInterceptoræ¥å£ï¼šAOPçš„å¦ä¸€ç§é…ç½®æ–¹å¼ï¼Œè¯¥æ–¹å¼éœ€è¦é€šçŸ¥ç±»å®ç°Adviceçš„å­åŠŸèƒ½æ¥å£ã€‚ç›¸å½“äºç¯ç»•é€šçŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionInterceptor</span> <span class="keyword">extends</span> <span class="title class_">TransactionAspectSupport</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span>, Serializable&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(MethodInvocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// Work out the target class: may be &#123;@code null&#125;.</span></span><br><span class="line">        <span class="comment">// The TransactionAttributeSource should be passed the target class</span></span><br><span class="line">        <span class="comment">// as well as the method, which may be from an interface.</span></span><br><span class="line">        Class&lt;?&gt; targetClass = (invocation.getThis() != <span class="literal">null</span> ? AopUtils.getTargetClass(invocation.getThis()) : <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Adapt to TransactionAspectSupport&#x27;s invokeWithinTransaction...</span></span><br><span class="line">        <span class="keyword">return</span> invokeWithinTransaction(invocation.getMethod(), targetClass, invocation::proceed);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>TransactionInterceptor</code>ä¸­çš„invokeæ–¹æ³•ä¼šè¢«æ‰§è¡Œï¼Œè·Ÿè¸ªinvokeæ–¹æ³•ï¼Œæœ€ç»ˆä¼šçœ‹åˆ°äº‹åŠ¡çš„å¼€å¯å’Œæäº¤</p><ul><li>åœ¨AbstractPlatformTransactionManagerå¼€å¯çš„äº‹åŠ¡ï¼›</li><li>åœ¨TransactionAspectSupportæäº¤äº†äº‹åŠ¡ã€‚</li></ul><hr><h2 id="4-åŸºäºæ³¨è§£å£°æ˜å¼äº‹åŠ¡æ§åˆ¶">4. åŸºäºæ³¨è§£å£°æ˜å¼äº‹åŠ¡æ§åˆ¶</h2><p>æ³¨è§£å°±æ˜¯å¯¹xmlçš„æ›¿ä»£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;accountService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccoutServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountMapper accountMapper;</span><br><span class="line">    <span class="comment">//&lt;tx:method name=&quot;*&quot; isolation=&quot;REPEATABLE_READ&quot; propagation=&quot;REQUIREDâ€œ/&gt;</span></span><br><span class="line">    <span class="meta">@Transactional(isolation = Isolation.REPEATABLE_READ,propagation = Propagation.REQUIRED,readOnly = false,timeout = 5)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transferMoney</span><span class="params">(String decrAccountName, String incrAccountName, <span class="type">int</span> money)</span> &#123;</span><br><span class="line">        accountMapper.decrMoney(decrAccountName,money); <span class="comment">//è½¬å‡ºé’±</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>; <span class="comment">//æ¨¡æ‹ŸæŸäº›é€»è¾‘äº§ç”Ÿçš„å¼‚å¸¸</span></span><br><span class="line">        accountMapper.incrMoney(incrAccountName,money); <span class="comment">//è½¬å…¥é’±</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œä½¿ç”¨çš„äº‹åŠ¡çš„æ³¨è§£ï¼Œå¹³å°äº‹åŠ¡ç®¡ç†å™¨ä»ç„¶éœ€è¦é…ç½®ï¼Œè¿˜éœ€è¦è¿›è¡Œäº‹åŠ¡æ³¨è§£å¼€å…³çš„å¼€å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡çš„æ³¨è§£é©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨å…¨æ³¨è§£çš„è¯ï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®ç±»çš„å½¢å¼ä»£æ›¿é…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.service&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.itheima.mapper&quot;)</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationContextConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PlatformTransactionManager <span class="title function_">tansactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... çœç•¥å…¶ä»–é…ç½® ...</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Springäº‹åŠ¡ç¼–ç¨‹</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºæ³¨è§£é…ç½®çš„AOP</title>
    <link href="https://wuwawawa.github.io/posts/62726e73.html"/>
    <id>https://wuwawawa.github.io/posts/62726e73.html</id>
    <published>2023-04-28T13:33:28.000Z</published>
    <updated>2023-05-16T05:26:48.509Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-æ³¨è§£æ–¹å¼AOPåŸºæœ¬ä½¿ç”¨">1. æ³¨è§£æ–¹å¼AOPåŸºæœ¬ä½¿ç”¨</h2><p>Springçš„AOPä¹Ÿæä¾›äº†æ³¨è§£æ–¹å¼é…ç½®ï¼Œä½¿ç”¨ç›¸åº”çš„æ³¨è§£æ›¿ä»£ä¹‹å‰çš„xmlé…ç½®ï¼Œxmlé…ç½®AOPæ—¶ï¼Œæˆ‘ä»¬ä¸»è¦é…ç½®äº†ä¸‰éƒ¨åˆ†ï¼š<code>ç›®æ ‡ç±»è¢«Springå®¹å™¨ç®¡ç†</code>ã€<code>é€šçŸ¥ç±»è¢«Springç®¡ç†</code>ã€<code>é€šçŸ¥ä¸åˆ‡ç‚¹çš„ç»‡å…¥ï¼ˆåˆ‡é¢ï¼‰</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®ç›®æ ‡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;target&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.aop.TargetImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;advices&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.aop.Advices&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®aop--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;advices&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;around&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* com.itheima.aop.*.*(..))&quot;</span>/&gt;</span> <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›®æ ‡ç±»è¢«Springå®¹å™¨ç®¡ç†ã€é€šçŸ¥ç±»è¢«Springç®¡ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;target&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TargetImpl</span> <span class="keyword">implements</span> <span class="title class_">Target</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;show Target running...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnoAdvice</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•å‰é€šçŸ¥...&quot;</span>); </span><br><span class="line">        joinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•åé€šçŸ¥...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®aopï¼Œå…¶å®é…ç½®aopä¸»è¦å°±æ˜¯é…ç½®é€šçŸ¥ç±»ä¸­çš„å“ªä¸ªæ–¹æ³•ï¼ˆé€šçŸ¥ç±»å‹ï¼‰å¯¹åº”çš„åˆ‡ç‚¹è¡¨è¾¾å¼æ˜¯ä»€ä¹ˆ</p><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230426100037391.png" alt="image-20230426100037391"></p><p>æ³¨è§£@Aspectã€@Aroundéœ€è¦è¢«Springè§£æï¼Œæ‰€ä»¥åœ¨Springæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­éœ€è¦é…ç½®aspectjçš„è‡ªåŠ¨ä»£ç†</p><p><code>&lt;aop:aspectj-autoproxy/&gt;</code></p><p>å¦‚æœæ ¸å¿ƒé…ç½®ä½¿ç”¨çš„æ˜¯é…ç½®ç±»çš„è¯ï¼Œéœ€è¦é…ç½®æ³¨è§£æ–¹å¼çš„aopè‡ªåŠ¨ä»£ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.aop&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span>    <span class="comment">//ç¬¬ä¸‰æ­¥</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationContextConfig</span> &#123; &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="2-æ³¨è§£æ–¹å¼AOPé…ç½®è¯¦è§£">2. æ³¨è§£æ–¹å¼AOPé…ç½®è¯¦è§£</h2><p>å„ç§æ³¨è§£æ–¹å¼é€šçŸ¥ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line"><span class="meta">@Before(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//åç½®é€šçŸ¥</span></span><br><span class="line"><span class="meta">@AfterReturning(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">AfterReturning</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//ç¯ç»•é€šçŸ¥</span></span><br><span class="line"><span class="meta">@Around(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable &#123;&#125;</span><br><span class="line"><span class="comment">//å¼‚å¸¸é€šçŸ¥</span></span><br><span class="line"><span class="meta">@AfterThrowing(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">AfterThrowing</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br><span class="line"><span class="comment">//æœ€ç»ˆé€šçŸ¥</span></span><br><span class="line"><span class="meta">@After(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">After</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>åˆ‡ç‚¹è¡¨è¾¾å¼çš„æŠ½å–ï¼Œä½¿ç”¨ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œå°†åˆ‡ç‚¹è¡¨è¾¾å¼æ ‡æ³¨åœ¨ç©ºæ–¹æ³•ä¸Šï¼Œå…¶ä»–é€šçŸ¥æ–¹æ³•å¼•ç”¨å³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnoAdvice</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itheima.aop.*.*(..))&quot;)</span> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line">    <span class="meta">@Before(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br><span class="line">    <span class="comment">//åç½®é€šçŸ¥</span></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;AnnoAdvice.pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">AfterReturning</span><span class="params">(JoinPoint joinPoint)</span>&#123;&#125;</span><br><span class="line">    <span class="comment">// ...  çœç•¥å…¶ä»–ä»£ç  ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="3-æ³¨è§£æ–¹å¼AOPåŸç†å‰–æ">3. æ³¨è§£æ–¹å¼AOPåŸç†å‰–æ</h2><p>ä¹‹å‰åœ¨ä½¿ç”¨xmlé…ç½®AOPæ—¶ï¼Œæ˜¯å€ŸåŠ©çš„Springçš„å¤–éƒ¨å‘½åç©ºé—´çš„åŠ è½½æ–¹å¼å®Œæˆçš„ï¼Œä½¿ç”¨æ³¨è§£é…ç½®åï¼Œå°±æŠ›å¼ƒäº†<code>&lt;aop:config&gt;</code>æ ‡ç­¾ï¼Œè€Œè¯¥æ ‡ç­¾æœ€ç»ˆåŠ è½½äº†åä¸º<code>AspectJAwareAdvisorAutoProxyCreator</code>çš„<code>BeanPostProcessor</code> ï¼Œæœ€ç»ˆï¼Œåœ¨è¯¥<code>BeanPostProcessor</code>ä¸­å®Œæˆäº†ä»£ç†å¯¹è±¡çš„ç”Ÿæˆã€‚åŒæ ·ï¼Œä»aspectj-autoproxyæ ‡ç­¾çš„è§£æå™¨å…¥æ‰‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼€å¯aop aspectjçš„è‡ªåŠ¨ä»£ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><code>this.registerBeanDefinitionParser(&quot;aspectj-autoproxy&quot;, new AspectJAutoProxyBeanDefinitionParser());</code></p><p>è€Œ<code>AspectJAutoProxyBeanDefinitionParser</code>ä»£ç å†…éƒ¨ï¼Œæœ€ç»ˆä¹Ÿæ˜¯æ‰§è¡Œäº†å’Œxmlæ–¹å¼AOPä¸€æ ·çš„ä»£ç </p><p><code>registerOrEscalateApcAsRequired(AnnotationAwareAspectJAutoProxyCreator.class, registry, source)</code></p><p>å¦‚æœä½¿ç”¨çš„æ˜¯æ ¸å¿ƒé…ç½®ç±»çš„è¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.aop&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationContextConfig</span> &#123; &#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹<code>@EnableAspectJAutoProxy</code>æºç ï¼Œä½¿ç”¨çš„ä¹Ÿæ˜¯@Importå¯¼å…¥ç›¸å…³è§£æç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(AspectJAutoProxyRegistrar.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableAspectJAutoProxy &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">proxyTargetClass</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">exposeProxy</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨@Importå¯¼å…¥çš„<code>AspectJAutoProxyRegistrar</code>æºç ï¼Œä¸€è·¯è¿½è¸ªä¸‹å»ï¼Œæœ€ç»ˆè¿˜æ˜¯æ³¨å†Œäº†<code>AnnotationAwareAspectJAutoProxyCreator</code> è¿™ä¸ªç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AspectJAutoProxyRegistrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(</span></span><br><span class="line"><span class="params">            AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">        AopConfigUtils.registerAspectJAnnotationAutoProxyCreatorIfNecessary(registry);</span><br><span class="line">       <span class="comment">//çœç•¥éƒ¨åˆ†ä»£ç ã€‚ã€‚ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> BeanDefinition <span class="title function_">registerAspectJAnnotationAutoProxyCreatorIfNecessary</span><span class="params">(BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> registerAspectJAnnotationAutoProxyCreatorIfNecessary(registry, (Object)<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> BeanDefinition <span class="title function_">registerAspectJAnnotationAutoProxyCreatorIfNecessary</span><span class="params">(BeanDefinitionRegistry registry, <span class="meta">@Nullable</span> Object source)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> registerOrEscalateApcAsRequired(AnnotationAwareAspectJAutoProxyCreator.class, registry, source);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230426102339961.png" alt="image-20230426102339961"></p>]]></content>
    
    
    <summary type="html">æ³¨è§£æ–¹å¼AOPä½¿ç”¨</summary>
    
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/categories/Spring/"/>
    
    
    <category term="Spring" scheme="https://wuwawawa.github.io/tags/Spring/"/>
    
  </entry>
  
</feed>
