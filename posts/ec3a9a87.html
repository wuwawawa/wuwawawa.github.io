<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ– | LuckyBoyğŸ¥</title><meta name="keywords" content="MySQL"><meta name="author" content="LuckyBoyğŸ¥"><meta name="copyright" content="LuckyBoyğŸ¥"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="ç´¢å¼•å¤±æ•ˆæ¡ˆä¾‹åˆ†æã€æŸ¥è¯¢ä¼˜åŒ–"><meta property="og:type" content="article"><meta property="og:title" content="ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ–"><meta property="og:url" content="https://wuwawawa.github.io/posts/ec3a9a87.html"><meta property="og:site_name" content="LuckyBoyğŸ¥"><meta property="og:description" content="ç´¢å¼•å¤±æ•ˆæ¡ˆä¾‹åˆ†æã€æŸ¥è¯¢ä¼˜åŒ–"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_18.webp"><meta property="article:published_time" content="2023-04-12T00:00:00.000Z"><meta property="article:modified_time" content="2023-04-18T06:20:49.219Z"><meta property="article:author" content="LuckyBoyğŸ¥"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_18.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://wuwawawa.github.io/posts/ec3a9a87"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:void 0,noticeOutdate:{limitDay:365,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:640},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!0,post:!0},runtime:"",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js",css:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ–",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-04-18 14:20:49"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="LuckyBoyğŸ¥" type="application/atom+xml"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.webp" onerror='onerror=null,src="/assets/r1.jpg"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">7</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-home"></use></svg> <span class="menu_word" style="font-size:17px">é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--article"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-guidang1"></use></svg> <span class="menu_word" style="font-size:17px">å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-sekuaibiaoqian"></use></svg> <span class="menu_word" style="font-size:17px">æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-fenlei"></use></svg> <span class="menu_word" style="font-size:17px">åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pinweishenghuo"></use></svg> <span class="menu_word" style="font-size:17px">ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-yinle"></use></svg> <span class="menu_word" style="font-size:17px">å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-dianying1"></use></svg> <span class="menu_word" style="font-size:17px">å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-youxishoubing"></use></svg> <span class="menu_word" style="font-size:17px">æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xiangzi"></use></svg> <span class="menu_word" style="font-size:17px">å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-tubiaozhizuomoban"></use></svg> <span class="menu_word" style="font-size:17px">ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-nvwumao"></use></svg> <span class="menu_word" style="font-size:17px">åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-zhifengche"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shejiaoxinxi"></use></svg> <span class="menu_word" style="font-size:17px">ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pengyouquan"></use></svg> <span class="menu_word" style="font-size:17px">æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-liuyan"></use></svg> <span class="menu_word" style="font-size:17px">ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-lianjie"></use></svg> <span class="menu_word" style="font-size:17px">å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-wangye"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--tongjibiao"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shujutongji1"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xianxingshalou"></use></svg> <span class="menu_word" style="font-size:17px">æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-maoliang"></use></svg> <span class="menu_word" style="font-size:17px">ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-qunliaotian"></use></svg> <span class="menu_word" style="font-size:17px">å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-love-sign"></use></svg> <span class="menu_word" style="font-size:17px">æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-paperplane"></use></svg> <span class="menu_word" style="font-size:17px">å…³äº</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LuckyBoyğŸ¥</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-home"></use></svg> <span class="menu_word" style="font-size:17px">é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--article"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-guidang1"></use></svg> <span class="menu_word" style="font-size:17px">å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-sekuaibiaoqian"></use></svg> <span class="menu_word" style="font-size:17px">æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-fenlei"></use></svg> <span class="menu_word" style="font-size:17px">åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pinweishenghuo"></use></svg> <span class="menu_word" style="font-size:17px">ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-yinle"></use></svg> <span class="menu_word" style="font-size:17px">å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-dianying1"></use></svg> <span class="menu_word" style="font-size:17px">å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-youxishoubing"></use></svg> <span class="menu_word" style="font-size:17px">æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xiangzi"></use></svg> <span class="menu_word" style="font-size:17px">å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-tubiaozhizuomoban"></use></svg> <span class="menu_word" style="font-size:17px">ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-nvwumao"></use></svg> <span class="menu_word" style="font-size:17px">åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-zhifengche"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shejiaoxinxi"></use></svg> <span class="menu_word" style="font-size:17px">ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pengyouquan"></use></svg> <span class="menu_word" style="font-size:17px">æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-liuyan"></use></svg> <span class="menu_word" style="font-size:17px">ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-lianjie"></use></svg> <span class="menu_word" style="font-size:17px">å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-wangye"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--tongjibiao"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shujutongji1"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xianxingshalou"></use></svg> <span class="menu_word" style="font-size:17px">æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-maoliang"></use></svg> <span class="menu_word" style="font-size:17px">ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-qunliaotian"></use></svg> <span class="menu_word" style="font-size:17px">å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/love/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-love-sign"></use></svg> <span class="menu_word" style="font-size:17px">æ‹çˆ±å°å±‹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-paperplane"></use></svg> <span class="menu_word" style="font-size:17px">å…³äº</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg> <span>æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ–</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº</span> <time class="post-meta-date-created" datetime="2023-04-12T00:00:00.000Z" title="å‘è¡¨äº 2023-04-12 08:00:00">2023-04-12</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-04-18T06:20:49.219Z" title="æ›´æ–°äº 2023-04-18 14:20:49">2023-04-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">1.7w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>61åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ–"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>éƒ½æœ‰å“ªäº›ç»´åº¦å¯ä»¥è¿›è¡Œæ•°æ®åº“è°ƒä¼˜ï¼Ÿç®€è¨€ä¹‹ï¼š</p><ul><li>ç´¢å¼•å¤±æ•ˆã€æ²¡æœ‰å……åˆ†åˆ©ç”¨åˆ°ç´¢å¼•â€”â€”å»ºç«‹ç´¢å¼•</li><li>å…³è”æŸ¥è¯¢å¤ªå¤šJOINï¼ˆè®¾è®¡ç¼ºé™·æˆ–ä¸å¾—å·²çš„éœ€æ±‚ï¼‰â€”â€”SQLä¼˜åŒ–</li><li>æœåŠ¡å™¨è°ƒä¼˜åŠå„ä¸ªå‚æ•°è®¾ç½®ï¼ˆç¼“å†²ã€çº¿ç¨‹æ•°ç­‰ï¼‰â€”â€”è°ƒæ•´my.cnf</li><li>æ•°æ®è¿‡å¤šâ€”â€”åˆ†åº“åˆ†è¡¨</li></ul><p>å…³äºæ•°æ®åº“è°ƒä¼˜çš„çŸ¥è¯†éå¸¸åˆ†æ•£ã€‚ä¸åŒçš„DBMSï¼Œä¸åŒçš„å…¬å¸ï¼Œä¸åŒçš„èŒä½ï¼Œä¸åŒçš„é¡¹ç›®é‡åˆ°çš„é—®é¢˜éƒ½ä¸å°½ç›¸åŒã€‚è¿™é‡Œæˆ‘ä»¬åˆ†ä¸ºä¸‰ä¸ªç« èŠ‚è¿›è¡Œç»†è‡´è®²è§£ã€‚</p><p>è™½ç„¶SQLæŸ¥è¯¢ä¼˜åŒ–çš„æŠ€æœ¯æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¤§æ–¹å‘ä¸Šå®Œå…¨å¯ä»¥åˆ†æˆ<code>ç‰©ç†æŸ¥è¯¢ä¼˜åŒ–</code>å’Œ<code>é€»è¾‘æŸ¥è¯¢ä¼˜åŒ–</code>ä¸¤å¤§å—ã€‚</p><ul><li>ç‰©ç†æŸ¥è¯¢ä¼˜åŒ–æ˜¯é€šè¿‡<code>ç´¢å¼•</code>å’Œ<code>è¡¨è¿æ¥æ–¹å¼</code>ç­‰æŠ€æœ¯æ¥è¿›è¡Œä¼˜åŒ–ï¼Œè¿™é‡Œé‡ç‚¹éœ€è¦æŒæ¡ç´¢å¼•çš„ä½¿ç”¨ã€‚</li><li>é€»è¾‘æŸ¥è¯¢ä¼˜åŒ–å°±æ˜¯é€šè¿‡SQL<code>ç­‰ä»·å˜æ¢</code>æå‡æŸ¥è¯¢æ•ˆç‡ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è¯´ï¼Œæ¢ä¸€ç§æŸ¥è¯¢å†™æ³•æ•ˆç‡å¯èƒ½æ›´é«˜ã€‚</li></ul><hr><h2 id="1-æ•°æ®å‡†å¤‡">1. æ•°æ®å‡†å¤‡</h2><div class="tabs" id="06aba016-1b98-4fdf-aa5a-0362d8823a19"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-1"><i class="fas fa-bug"></i>æ­¥éª¤1</button></li><li class="tab"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-2"><i class="fas fa-cannabis"></i>æ­¥éª¤2</button></li><li class="tab"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-3"><i class="fas fa-candy-cane"></i>æ­¥éª¤3</button></li><li class="tab"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-4"><i class="fas fa-child"></i>æ­¥éª¤4</button></li><li class="tab"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-5"><i class="fas fa-cat"></i>æ­¥éª¤5</button></li><li class="tab"><button type="button" data-href="#06aba016-1b98-4fdf-aa5a-0362d8823a19-6"><i class="fas fa-horse"></i>æ­¥éª¤6</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-1"><blockquote><p>å»ºè¡¨</p></blockquote><p><code>å­¦å‘˜è¡¨</code>æ’<code>50ä¸‡</code>æ¡ï¼Œ<code>ç­çº§è¡¨</code>æ’<code>1ä¸‡</code>æ¡ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE atguigudb2;</span><br><span class="line">USE atguigudb2;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>`class`(</span><br><span class="line">  `id`<span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `className`<span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `address`<span class="type">VARCHAR</span>(<span class="number">40</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `monitor`<span class="type">INT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>`student`(</span><br><span class="line">  `id`<span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `stuno`<span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">  `name`<span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age`<span class="type">INT</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `classId`<span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">    #<span class="keyword">CONSTRAINT</span>`fk_class_id`<span class="keyword">FOREIGN</span> KEY (`classId`) <span class="keyword">REFERENCES</span>`t_class`(`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-2"><blockquote><p>è®¾ç½®å‚æ•°</p></blockquote><ul><li>å‘½ä»¤å¼€å¯ï¼šå…è®¸åˆ›å»ºå‡½æ•°è®¾ç½®ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> log_bin_trust_function_creators<span class="operator">=</span><span class="number">1</span>; # ä¸åŠ <span class="keyword">global</span>åªæ˜¯å½“å‰çª—å£æœ‰æ•ˆã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-3"><blockquote><p>åˆ›å»ºå‡½æ•°</p></blockquote><p>ä¿è¯æ¯æ¡æ•°æ®éƒ½ä¸åŒã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#éšæœºäº§ç”Ÿå­—ç¬¦ä¸²</span><br><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> rand_string(n <span class="type">INT</span>) <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">255</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> chars_str <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span></span><br><span class="line"><span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFJHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> return_str <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">WHILE i <span class="operator">&lt;</span> n DO</span><br><span class="line"><span class="keyword">SET</span> return_str <span class="operator">=</span>CONCAT(return_str,<span class="built_in">SUBSTRING</span>(chars_str,<span class="built_in">FLOOR</span>(<span class="number">1</span><span class="operator">+</span>RAND()<span class="operator">*</span><span class="number">52</span>),<span class="number">1</span>));</span><br><span class="line"><span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">RETURN</span> return_str;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br><span class="line">#å‡å¦‚è¦åˆ é™¤</span><br><span class="line">#<span class="keyword">drop</span> <span class="keyword">function</span> rand_string;</span><br></pre></td></tr></table></figure><p>éšæœºäº§ç”Ÿç­çº§ç¼–å·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#ç”¨äºéšæœºäº§ç”Ÿå¤šå°‘åˆ°å¤šå°‘çš„ç¼–å·</span><br><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> rand_num (from_num <span class="type">INT</span> ,to_num <span class="type">INT</span>) <span class="keyword">RETURNS</span> <span class="type">INT</span>(<span class="number">11</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> i <span class="operator">=</span> <span class="built_in">FLOOR</span>(from_num <span class="operator">+</span>RAND()<span class="operator">*</span>(to_num <span class="operator">-</span> from_num<span class="operator">+</span><span class="number">1</span>)) ;</span><br><span class="line"><span class="keyword">RETURN</span> i;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br><span class="line">#å‡å¦‚è¦åˆ é™¤</span><br><span class="line">#<span class="keyword">drop</span> <span class="keyword">function</span> rand_num;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-4"><blockquote><p>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#åˆ›å»ºå¾€stuè¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹</span><br><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> insert_stu( <span class="keyword">START</span> <span class="type">INT</span> , max_num <span class="type">INT</span> )</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>; #è®¾ç½®æ‰‹åŠ¨æäº¤äº‹åŠ¡</span><br><span class="line">REPEAT #å¾ªç¯</span><br><span class="line"><span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>; #èµ‹å€¼</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (stuno, name ,age ,classId ) <span class="keyword">VALUES</span></span><br><span class="line">((<span class="keyword">START</span><span class="operator">+</span>i),rand_string(<span class="number">6</span>),rand_num(<span class="number">1</span>,<span class="number">50</span>),rand_num(<span class="number">1</span>,<span class="number">1000</span>));</span><br><span class="line">UNTIL i <span class="operator">=</span> max_num</span><br><span class="line"><span class="keyword">END</span> REPEAT;</span><br><span class="line"><span class="keyword">COMMIT</span>; #æäº¤äº‹åŠ¡</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br><span class="line">#å‡å¦‚è¦åˆ é™¤</span><br><span class="line">#<span class="keyword">drop</span> <span class="keyword">PROCEDURE</span> insert_stu;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå¾€classè¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€classè¡¨æ·»åŠ éšæœºæ•°æ®</span><br><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span>`insert_class`( max_num <span class="type">INT</span> )</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">REPEAT</span><br><span class="line"><span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> class ( classname,address,monitor ) <span class="keyword">VALUES</span></span><br><span class="line">(rand_string(<span class="number">8</span>),rand_string(<span class="number">10</span>),rand_num(<span class="number">1</span>,<span class="number">100000</span>));</span><br><span class="line">UNTIL i <span class="operator">=</span> max_num</span><br><span class="line"><span class="keyword">END</span> REPEAT;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br><span class="line">#å‡å¦‚è¦åˆ é™¤</span><br><span class="line">#<span class="keyword">drop</span> <span class="keyword">PROCEDURE</span> insert_class;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-5"><blockquote><p>è°ƒç”¨å­˜å‚¨è¿‡ç¨‹</p></blockquote><p>class</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€classè¡¨æ·»åŠ <span class="number">1</span>ä¸‡æ¡æ•°æ®</span><br><span class="line"><span class="keyword">CALL</span> insert_class(<span class="number">10000</span>);</span><br></pre></td></tr></table></figure><p>stu</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€stuè¡¨æ·»åŠ <span class="number">50</span>ä¸‡æ¡æ•°æ®</span><br><span class="line"><span class="keyword">CALL</span> insert_stu(<span class="number">100000</span>,<span class="number">500000</span>);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="06aba016-1b98-4fdf-aa5a-0362d8823a19-6"><blockquote><p>åˆ é™¤æŸè¡¨ä¸Šçš„ç´¢å¼• åç»­æ¼”ç¤ºè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé¢‘ç¹åˆ é™¤ç´¢å¼• æ‰€ä»¥å®šä¹‰æ­¤å‡½æ•°</p></blockquote><p>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span>`proc_drop_index`(dbname <span class="type">VARCHAR</span>(<span class="number">200</span>),tablename <span class="type">VARCHAR</span>(<span class="number">200</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> done <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> ct <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _index <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _cur <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> index_name <span class="keyword">FROM</span></span><br><span class="line">information_schema.STATISTICS <span class="keyword">WHERE</span> table_schema<span class="operator">=</span>dbname <span class="keyword">AND</span> table_name<span class="operator">=</span>tablename <span class="keyword">AND</span></span><br><span class="line">seq_in_index<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> index_name <span class="operator">&lt;&gt;</span><span class="string">&#x27;PRIMARY&#x27;</span> ;</span><br><span class="line">#æ¯ä¸ªæ¸¸æ ‡å¿…é¡»ä½¿ç”¨ä¸åŒçš„<span class="keyword">declare</span> continue handler <span class="keyword">for</span> <span class="keyword">not</span> found <span class="keyword">set</span> done<span class="operator">=</span><span class="number">1</span>æ¥æ§åˆ¶æ¸¸æ ‡çš„ç»“æŸ</span><br><span class="line">		<span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">set</span> done<span class="operator">=</span><span class="number">2</span> ;</span><br><span class="line">#è‹¥æ²¡æœ‰æ•°æ®è¿”å›,ç¨‹åºç»§ç»­,å¹¶å°†å˜é‡doneè®¾ä¸º<span class="number">2</span></span><br><span class="line">        <span class="keyword">OPEN</span> _cur;</span><br><span class="line">        <span class="keyword">FETCH</span> _cur <span class="keyword">INTO</span> _index;</span><br><span class="line">        WHILE _index<span class="operator">&lt;&gt;</span><span class="string">&#x27;&#x27;</span> DO</span><br><span class="line">            <span class="keyword">SET</span> <span class="variable">@str</span> <span class="operator">=</span> CONCAT(&quot;drop index &quot; , _index , &quot; on &quot; , tablename );</span><br><span class="line">            <span class="keyword">PREPARE</span> sql_str <span class="keyword">FROM</span> <span class="variable">@str</span> ;</span><br><span class="line">            <span class="keyword">EXECUTE</span> sql_str;</span><br><span class="line">            <span class="keyword">DEALLOCATE</span> <span class="keyword">PREPARE</span> sql_str;</span><br><span class="line">            <span class="keyword">SET</span> _index<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">FETCH</span> _cur <span class="keyword">INTO</span> _index;</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line">    <span class="keyword">CLOSE</span> _cur;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> proc_drop_index(&quot;dbname&quot;,&quot;tablename&quot;);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h2 id="2-ç´¢å¼•å¤±æ•ˆæ¡ˆä¾‹">2. ç´¢å¼•å¤±æ•ˆæ¡ˆä¾‹</h2><p>MySQLä¸­<code>æé«˜æ€§èƒ½</code>çš„ä¸€ä¸ªæœ€æœ‰æ•ˆçš„æ–¹å¼æ˜¯å¯¹æ•°æ®è¡¨<code>è®¾è®¡åˆç†çš„ç´¢å¼•</code>ã€‚ç´¢å¼•æä¾›äº†é«˜æ•ˆè®¿é—®æ•°æ®çš„æ–¹æ³•ï¼Œå¹¶ä¸”åŠ å¿«æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œå› æ­¤ç´¢å¼•å¯¹æŸ¥è¯¢çš„é€Ÿåº¦æœ‰ç€è‡³å…³é‡è¦çš„å½±å“ã€‚</p><ul><li><p>ä½¿ç”¨ç´¢å¼•å¯ä»¥<code>å¿«é€Ÿåœ°å®šä½</code>è¡¨ä¸­çš„æŸæ¡è®°å½•ï¼Œä»è€Œæé«˜æ•°æ®åº“æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œæé«˜æ•°æ®åº“çš„æ€§èƒ½ã€‚</p></li><li><p>å¦‚æœæŸ¥è¯¢æ—¶æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼ŒæŸ¥è¯¢è¯­å¥å°±ä¼š<code>æ‰«æè¡¨ä¸­çš„æ‰€æœ‰è®°å½•</code>ã€‚åœ¨æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·æŸ¥è¯¢çš„é€Ÿåº¦ä¼šå¾ˆæ…¢ã€‚</p></li></ul><p>å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ï¼ˆé»˜è®¤ï¼‰é‡‡ç”¨<code>B+æ ‘</code>æ¥æ„å»ºç´¢å¼•ã€‚åªæ˜¯ç©ºé—´åˆ—ç±»å‹çš„ç´¢å¼•ä½¿ç”¨<code>R-</code>æ ‘ï¼Œå¹¶ä¸”MEMORYè¡¨è¿˜æ”¯æŒ<code>hash ç´¢å¼•</code>ã€‚</p><p>å…¶å®ï¼Œç”¨ä¸ç”¨ç´¢å¼•ï¼Œæœ€ç»ˆéƒ½æ˜¯ä¼˜åŒ–å™¨è¯´äº†ç®—ã€‚ä¼˜åŒ–å™¨æ˜¯åŸºäºä»€ä¹ˆçš„ä¼˜åŒ–å™¨ï¼ŸåŸºäº<code>costå¼€é”€ (CostBaseOptimizer)</code>ï¼Œå®ƒä¸æ˜¯åŸºäº<code>è§„åˆ™(Rule-Basedoptimizerï¼‰</code>ï¼Œä¹Ÿä¸æ˜¯åŸºäº<code>è¯­ä¹‰</code>ã€‚æ€ä¹ˆæ ·å¼€é”€å°å°±æ€ä¹ˆæ¥ã€‚å¦å¤–ï¼Œ<span class="p red">SQLè¯­å¥æ˜¯å¦ä½¿ç”¨ç´¢å¼•ï¼Œè·Ÿæ•°æ®åº“ç‰ˆæœ¬ã€æ•°æ®é‡ã€æ•°æ®é€‰æ‹©åº¦éƒ½æœ‰å…³ç³»ã€‚</span></p><div class="tabs" id="e9211a91-00fa-43d6-9499-a527e5d5888d"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-1"><i class="fas fa-atom"></i>1.å…¨å€¼åŒ¹é…æˆ‘æœ€çˆ±</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-2"><i class="far fa-sun"></i>2.æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-3"><i class="fas fa-wind"></i>3.ä¸»é”®æ’å…¥é¡ºåº</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-4"><i class="fas fa-fire-alt"></i>è®¡ç®—ã€å‡½æ•°ã€ç±»å‹è½¬æ¢å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-5"><i class="fas fa-award"></i>ç±»å‹è½¬æ¢å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-6"><i class="fas fa-baseball-ball"></i>èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ—ç´¢å¼•å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-7"><i class="fas fa-bone"></i>ä¸ç­‰äºç´¢å¼•å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-8"><i class="fas fa-dragon"></i>is nullå¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œis not nullæ— æ³•ä½¿ç”¨ç´¢å¼•</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-9"><i class="fas fa-dove"></i>likeä»¥é€šé…ç¬¦%å¼€å¤´ç´¢å¼•å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#e9211a91-00fa-43d6-9499-a527e5d5888d-10"><i class="fas fa-horse"></i>ORå‰åå­˜åœ¨éç´¢å¼•çš„åˆ—ç´¢å¼•å¤±æ•ˆ</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="e9211a91-00fa-43d6-9499-a527e5d5888d-1"><p>ç³»ç»Ÿä¸­ç»å¸¸å‡ºç°çš„sqlè¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">30</span>;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> classId<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> classId<span class="operator">=</span><span class="number">4</span> <span class="keyword">AND</span> name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å»ºç«‹ç´¢å¼•å‰æ‰§è¡Œï¼šï¼ˆå…³æ³¨æ‰§è¡Œæ—¶é—´ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> classId<span class="operator">=</span><span class="number">4</span> <span class="keyword">AND</span> name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.28</span> sec)</span><br></pre></td></tr></table></figure><p><strong>å»ºç«‹ç´¢å¼•</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_age <span class="keyword">ON</span> student(age);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_classid <span class="keyword">ON</span> student(age,classId);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_classid_name <span class="keyword">ON</span> student(age,classId,name);</span><br></pre></td></tr></table></figure><p>å»ºç«‹ç´¢å¼•åæ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> classId<span class="operator">=</span><span class="number">4</span> <span class="keyword">AND</span> name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºç´¢å¼•å‰çš„æŸ¥è¯¢æ—¶é—´æ˜¯ 0.28ç§’ï¼Œåˆ›å»ºç´¢å¼•åçš„æŸ¥è¯¢æ—¶é—´æ˜¯0.01 ç§’ï¼Œç´¢å¼•å¸®åŠ©æˆ‘ä»¬æå¤§çš„æé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-2"><p>åœ¨MySQLå»ºç«‹è”åˆç´¢å¼•æ—¶ä¼šéµå®ˆæœ€ä½³å·¦å‰ç¼€åŸåˆ™ï¼Œå³æœ€å·¦ä¼˜å…ˆï¼Œåœ¨æ£€ç´¢æ•°æ®æ—¶ä»è”åˆç´¢å¼•çš„æœ€å·¦è¾¹å¼€å§‹åŒ¹é…ã€‚</p><p>ä¸¾ä¾‹1ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹2ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.classId<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¾‹3ï¼šç´¢å¼•<code>idx_age_classid_name</code>è¿˜èƒ½å¦æ­£å¸¸ä½¿ç”¨ï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.classId<span class="operator">=</span><span class="number">4</span> <span class="keyword">AND</span> student.age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚æŒ‡çš„æ˜¯æŸ¥è¯¢ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹å¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚<span class="p green">ä¸SQLä¸­ANDé¡ºåºæ— å…³ï¼Œä¼˜åŒ–å™¨ä¼šä¼˜åŒ–ã€‚</span></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704211116351.png" alt="image-20220704211116351"></p><p>è™½ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯åªæœ‰éƒ¨åˆ†è¢«ä½¿ç”¨åˆ°äº†ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.classId<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abcd&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704211254581.png" alt="image-20220704211254581"></p><p>å®Œå…¨æ²¡æœ‰ä½¿ç”¨ä¸Šç´¢å¼•ã€‚</p><p>ç»“è®ºï¼šMySQLå¯ä»¥ä¸ºå¤šä¸ªå­—æ®µåˆ›å»ºç´¢å¼•ï¼Œä¸€ä¸ªç´¢å¼•å¯ä»¥åŒ…å«16ä¸ªå­—æ®µã€‚å¯¹äºå¤šåˆ—ç´¢å¼•ï¼Œ<span class="p red">è¿‡æ»¤æ¡ä»¶è¦ä½¿ç”¨ç´¢å¼•å¿…é¡»æŒ‰ç…§ç´¢å¼•å»ºç«‹æ—¶çš„é¡ºåºï¼Œä¾æ¬¡æ»¡è¶³ï¼Œä¸€æ—¦è·³è¿‡æŸä¸ªå­—æ®µï¼Œç´¢å¼•åé¢çš„å­—æ®µéƒ½æ— æ³•è¢«ä½¿ç”¨ã€‚</span>å¦‚æœæŸ¥è¯¢æ¡ä»¶ä¸­æ²¡æœ‰ç”¨è¿™äº›å­—æ®µä¸­ç¬¬ä¸€ä¸ªå­—æ®µæ—¶ï¼Œå¤šåˆ—ï¼ˆæˆ–è”åˆï¼‰ç´¢å¼•ä¸ä¼šè¢«ä½¿ç”¨ã€‚</p><blockquote><p>æ‹“å±•ï¼šAlibabaã€ŠJavaå¼€å‘æ‰‹å†Œã€‹</p><p>ç´¢å¼•æ–‡ä»¶å…·æœ‰ B-Tree çš„æœ€å·¦å‰ç¼€åŒ¹é…ç‰¹æ€§ï¼Œå¦‚æœå·¦è¾¹çš„å€¼æœªç¡®å®šï¼Œé‚£ä¹ˆæ— æ³•ä½¿ç”¨æ­¤ç´¢å¼•ã€‚</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-3"><p>å¯¹äºä¸€ä¸ªä½¿ç”¨<code>InnoDB</code>å­˜å‚¨å¼•æ“çš„è¡¨æ¥è¯´ï¼Œåœ¨æˆ‘ä»¬æ²¡æœ‰æ˜¾å¼çš„åˆ›å»ºç´¢å¼•æ—¶ï¼Œè¡¨ä¸­çš„æ•°æ®å®é™…ä¸Šéƒ½æ˜¯å­˜å‚¨åœ¨<code>èšç°‡ç´¢å¼•</code>çš„å¶å­èŠ‚ç‚¹çš„ã€‚è€Œè®°å½•åˆæ˜¯å­˜å‚¨åœ¨æ•°æ®é¡µä¸­çš„ï¼Œæ•°æ®é¡µå’Œè®°å½•åˆæ˜¯æŒ‰ç…§è®°å½•<code>ä¸»é”®å€¼ä»å°åˆ°å¤§</code>çš„é¡ºåºè¿›è¡Œæ’åºï¼Œ æ‰€ä»¥å¦‚æœæˆ‘ä»¬æ’å…¥çš„è®°å½•çš„<code>ä¸»é”®å€¼æ˜¯ä¾æ¬¡å¢å¤§</code>çš„è¯ï¼Œé‚£æˆ‘ä»¬æ¯æ’æ»¡ä¸€ä¸ªæ•°æ®é¡µå°±æ¢åˆ°ä¸‹ä¸€ä¸ªæ•°æ®é¡µç»§ç»­æ’ï¼Œè€Œå¦‚æœæˆ‘ä»¬æ’å…¥çš„ä¸»é”®å€¼å¿½å¤§å¿½å°çš„è¯ï¼Œå°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå‡è®¾æŸä¸ªæ•°æ®é¡µå­˜å‚¨çš„è®°å½•å·²ç»æ»¡äº†ï¼Œå®ƒå­˜å‚¨çš„ä¸»é”®å€¼åœ¨ 1~100ä¹‹é—´ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230411123722529.png" alt="image-20230411123722529"></p><p>å¦‚æœæ­¤æ—¶å†æ’å…¥ä¸€æ¡ä¸»é”®å€¼ä¸º 9 çš„è®°å½•ï¼Œé‚£å®ƒæ’å…¥çš„ä½ç½®å°±å¦‚ä¸‹å›¾ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704212428607.png" alt="image-20220704212428607"></p><p>å¯è¿™ä¸ªæ•°æ®é¡µå·²ç»æ»¡äº†ï¼Œå†æ’è¿›æ¥å’‹åŠå‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦æŠŠå½“å‰<code>é¡µé¢åˆ†è£‚</code>æˆä¸¤ä¸ªé¡µé¢ï¼ŒæŠŠæœ¬é¡µä¸­çš„ä¸€äº›è®°å½•ç§»åŠ¨åˆ°æ–°åˆ›å»ºçš„è¿™ä¸ªé¡µä¸­ã€‚é¡µé¢åˆ†è£‚å’Œè®°å½•ç§»ä½æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ„å‘³ç€ï¼š<code>æ€§èƒ½æŸè€—</code>ï¼æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³å°½é‡é¿å…è¿™æ ·æ— è°“çš„æ€§èƒ½æŸè€—ï¼Œæœ€å¥½è®©æ’å…¥çš„è®°å½•çš„<code>ä¸»é”®å€¼ä¾æ¬¡é€’å¢</code>ï¼Œè¿™æ ·å°±ä¸ä¼šå‘ç”Ÿè¿™æ ·çš„æ€§èƒ½æŸè€—äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬å»ºè®®ï¼šè®©ä¸»é”®å…·æœ‰<code>AUTO_INCREMENT</code>ï¼Œè®©å­˜å‚¨å¼•æ“è‡ªå·±ä¸ºè¡¨ç”Ÿæˆä¸»é”®ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ’å…¥ ï¼Œ æ¯”å¦‚ï¼š<code>person_info</code>è¡¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person_info(</span><br><span class="line">    id <span class="type">INT</span> UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    birthday <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    phone_number <span class="type">CHAR</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    country <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">    KEY idx_name_birthday_phone_number (name(<span class="number">10</span>), birthday, phone_number)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸»é”®åˆ—<code>id</code>æ‹¥æœ‰<code>AUTO_INCREMENT</code>å±æ€§ï¼Œåœ¨æ’å…¥è®°å½•æ—¶å­˜å‚¨å¼•æ“ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬å¡«å…¥è‡ªå¢çš„ä¸»é”®å€¼ã€‚è¿™æ ·çš„ä¸»é”®å ç”¨ç©ºé—´å°ï¼Œé¡ºåºå†™å…¥ï¼Œå‡å°‘é¡µåˆ†è£‚ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-4"><ol><li>è¿™ä¸¤æ¡sqlå“ªç§å†™æ³•æ›´å¥½</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.name <span class="keyword">LIKE</span> <span class="string">&#x27;abc%&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="keyword">LEFT</span>(student.name,<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;abc&#x27;</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºç´¢å¼•</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_name <span class="keyword">ON</span> student(NAME);</span><br></pre></td></tr></table></figure><div class="tabs" id="5f71e3f3-b819-4070-a29c-d6d9664e2d12"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#5f71e3f3-b819-4070-a29c-d6d9664e2d12-1"><i class="fas fa-seedling"></i>ç¬¬ä¸€ç§ï¼šç´¢å¼•ä¼˜åŒ–ç”Ÿæ•ˆ</button></li><li class="tab"><button type="button" data-href="#5f71e3f3-b819-4070-a29c-d6d9664e2d12-2"><i class="fas fa-leaf"></i>ç¬¬äºŒç§ï¼šç´¢å¼•ä¼˜åŒ–å¤±æ•ˆ</button></li><li class="tab"><button type="button" data-href="#5f71e3f3-b819-4070-a29c-d6d9664e2d12-3"><i class="fab fa-apple"></i>å†ä¸¾ä¾‹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="5f71e3f3-b819-4070-a29c-d6d9664e2d12-1"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.name <span class="keyword">LIKE</span> <span class="string">&#x27;abc%&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.name <span class="keyword">LIKE</span> <span class="string">&#x27;abc%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> stuno   <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> classId <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5301379</span> <span class="operator">|</span> <span class="number">1233401</span> <span class="operator">|</span> AbCHEa <span class="operator">|</span> <span class="number">164</span>  <span class="operator">|</span> <span class="number">259</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7170042</span> <span class="operator">|</span> <span class="number">3102064</span> <span class="operator">|</span> ABcHeB <span class="operator">|</span> <span class="number">199</span>  <span class="operator">|</span> <span class="number">161</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1901614</span> <span class="operator">|</span> <span class="number">1833636</span> <span class="operator">|</span> ABcHeC <span class="operator">|</span> <span class="number">226</span>  <span class="operator">|</span> <span class="number">275</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5195021</span> <span class="operator">|</span> <span class="number">1127043</span> <span class="operator">|</span> abchEC <span class="operator">|</span> <span class="number">486</span>  <span class="operator">|</span> <span class="number">72</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4047089</span> <span class="operator">|</span> <span class="number">3810031</span> <span class="operator">|</span> AbCHFd <span class="operator">|</span> <span class="number">268</span>  <span class="operator">|</span> <span class="number">210</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4917074</span> <span class="operator">|</span> <span class="number">849096</span>  <span class="operator">|</span> ABcHfD <span class="operator">|</span> <span class="number">264</span>  <span class="operator">|</span> <span class="number">442</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1540859</span> <span class="operator">|</span> <span class="number">141979</span>  <span class="operator">|</span> abchFF <span class="operator">|</span> <span class="number">119</span>  <span class="operator">|</span> <span class="number">140</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5121801</span> <span class="operator">|</span> <span class="number">1053823</span> <span class="operator">|</span> AbCHFg <span class="operator">|</span> <span class="number">412</span>  <span class="operator">|</span> <span class="number">327</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2441254</span> <span class="operator">|</span> <span class="number">2373276</span> <span class="operator">|</span> abchFJ <span class="operator">|</span> <span class="number">170</span>  <span class="operator">|</span> <span class="number">362</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7039146</span> <span class="operator">|</span> <span class="number">2971168</span> <span class="operator">|</span> ABcHgI <span class="operator">|</span> <span class="number">502</span>  <span class="operator">|</span> <span class="number">465</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1636826</span> <span class="operator">|</span> <span class="number">1580286</span> <span class="operator">|</span> ABcHgK <span class="operator">|</span> <span class="number">71</span>   <span class="operator">|</span> <span class="number">262</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">374344</span>  <span class="operator">|</span> <span class="number">474345</span>  <span class="operator">|</span> abchHL <span class="operator">|</span> <span class="number">367</span>  <span class="operator">|</span> <span class="number">212</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1596534</span> <span class="operator">|</span> <span class="number">169191</span>  <span class="operator">|</span> AbCHHl <span class="operator">|</span> <span class="number">102</span>  <span class="operator">|</span> <span class="number">146</span> <span class="operator">|</span></span><br><span class="line">...</span><br><span class="line"><span class="operator">|</span> <span class="number">5266837</span> <span class="operator">|</span> <span class="number">1198859</span> <span class="operator">|</span> abclXe <span class="operator">|</span> <span class="number">292</span> <span class="operator">|</span> <span class="number">298</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">8126968</span> <span class="operator">|</span> <span class="number">4058990</span> <span class="operator">|</span> aBClxE <span class="operator">|</span> <span class="number">316</span> <span class="operator">|</span> <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4298305</span> <span class="operator">|</span> <span class="number">399962</span>  <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">72</span>  <span class="operator">|</span> <span class="number">423</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5813628</span> <span class="operator">|</span> <span class="number">1745650</span> <span class="operator">|</span> aBClxF <span class="operator">|</span> <span class="number">356</span> <span class="operator">|</span> <span class="number">323</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6980448</span> <span class="operator">|</span> <span class="number">2912470</span> <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">107</span> <span class="operator">|</span> <span class="number">78</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7881979</span> <span class="operator">|</span> <span class="number">3814001</span> <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">89</span>  <span class="operator">|</span> <span class="number">497</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4955576</span> <span class="operator">|</span> <span class="number">887598</span>  <span class="operator">|</span> ABcLxg <span class="operator">|</span> <span class="number">121</span> <span class="operator">|</span> <span class="number">385</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3653460</span> <span class="operator">|</span> <span class="number">3585482</span> <span class="operator">|</span> AbCLXJ <span class="operator">|</span> <span class="number">130</span> <span class="operator">|</span> <span class="number">174</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1231990</span> <span class="operator">|</span> <span class="number">1283439</span> <span class="operator">|</span> AbCLYH <span class="operator">|</span> <span class="number">189</span> <span class="operator">|</span> <span class="number">429</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6110615</span> <span class="operator">|</span> <span class="number">2042637</span> <span class="operator">|</span> ABcLyh <span class="operator">|</span> <span class="number">157</span> <span class="operator">|</span> <span class="number">40</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="number">401</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5f71e3f3-b819-4070-a29c-d6d9664e2d12-2"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="keyword">LEFT</span>(student.name,<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704214905412.png" alt="image-20220704214905412"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="keyword">LEFT</span>(student.name,<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> stuno   <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> classId <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5301379</span> <span class="operator">|</span> <span class="number">1233401</span> <span class="operator">|</span> AbCHEa <span class="operator">|</span> <span class="number">164</span> <span class="operator">|</span> <span class="number">259</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7170042</span> <span class="operator">|</span> <span class="number">3102064</span> <span class="operator">|</span> ABcHeB <span class="operator">|</span> <span class="number">199</span> <span class="operator">|</span> <span class="number">161</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1901614</span> <span class="operator">|</span> <span class="number">1833636</span> <span class="operator">|</span> ABcHeC <span class="operator">|</span> <span class="number">226</span> <span class="operator">|</span> <span class="number">275</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5195021</span> <span class="operator">|</span> <span class="number">1127043</span> <span class="operator">|</span> abchEC <span class="operator">|</span> <span class="number">486</span> <span class="operator">|</span> <span class="number">72</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4047089</span> <span class="operator">|</span> <span class="number">3810031</span> <span class="operator">|</span> AbCHFd <span class="operator">|</span> <span class="number">268</span> <span class="operator">|</span> <span class="number">210</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4917074</span> <span class="operator">|</span> <span class="number">849096</span>  <span class="operator">|</span> ABcHfD <span class="operator">|</span> <span class="number">264</span> <span class="operator">|</span> <span class="number">442</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1540859</span> <span class="operator">|</span> <span class="number">141979</span>  <span class="operator">|</span> abchFF <span class="operator">|</span> <span class="number">119</span> <span class="operator">|</span> <span class="number">140</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5121801</span> <span class="operator">|</span> <span class="number">1053823</span> <span class="operator">|</span> AbCHFg <span class="operator">|</span> <span class="number">412</span> <span class="operator">|</span> <span class="number">327</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2441254</span> <span class="operator">|</span> <span class="number">2373276</span> <span class="operator">|</span> abchFJ <span class="operator">|</span> <span class="number">170</span> <span class="operator">|</span> <span class="number">362</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7039146</span> <span class="operator">|</span> <span class="number">2971168</span> <span class="operator">|</span> ABcHgI <span class="operator">|</span> <span class="number">502</span> <span class="operator">|</span> <span class="number">465</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1636826</span> <span class="operator">|</span> <span class="number">1580286</span> <span class="operator">|</span> ABcHgK <span class="operator">|</span> <span class="number">71</span>  <span class="operator">|</span> <span class="number">262</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">374344</span>  <span class="operator">|</span> <span class="number">474345</span>  <span class="operator">|</span> abchHL <span class="operator">|</span> <span class="number">367</span> <span class="operator">|</span> <span class="number">212</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1596534</span> <span class="operator">|</span> <span class="number">169191</span>  <span class="operator">|</span> AbCHHl <span class="operator">|</span> <span class="number">102</span> <span class="operator">|</span> <span class="number">146</span> <span class="operator">|</span></span><br><span class="line">...</span><br><span class="line"><span class="operator">|</span> <span class="number">5266837</span> <span class="operator">|</span> <span class="number">1198859</span> <span class="operator">|</span> abclXe <span class="operator">|</span> <span class="number">292</span> <span class="operator">|</span> <span class="number">298</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">8126968</span> <span class="operator">|</span> <span class="number">4058990</span> <span class="operator">|</span> aBClxE <span class="operator">|</span> <span class="number">316</span> <span class="operator">|</span> <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4298305</span> <span class="operator">|</span> <span class="number">399962</span>  <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">72</span>  <span class="operator">|</span> <span class="number">423</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5813628</span> <span class="operator">|</span> <span class="number">1745650</span> <span class="operator">|</span> aBClxF <span class="operator">|</span> <span class="number">356</span> <span class="operator">|</span> <span class="number">323</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6980448</span> <span class="operator">|</span> <span class="number">2912470</span> <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">107</span> <span class="operator">|</span> <span class="number">78</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">7881979</span> <span class="operator">|</span> <span class="number">3814001</span> <span class="operator">|</span> AbCLXF <span class="operator">|</span> <span class="number">89</span>  <span class="operator">|</span> <span class="number">497</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4955576</span> <span class="operator">|</span> <span class="number">887598</span>  <span class="operator">|</span> ABcLxg <span class="operator">|</span> <span class="number">121</span> <span class="operator">|</span> <span class="number">385</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3653460</span> <span class="operator">|</span> <span class="number">3585482</span> <span class="operator">|</span> AbCLXJ <span class="operator">|</span> <span class="number">130</span> <span class="operator">|</span> <span class="number">174</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1231990</span> <span class="operator">|</span> <span class="number">1283439</span> <span class="operator">|</span> AbCLYH <span class="operator">|</span> <span class="number">189</span> <span class="operator">|</span> <span class="number">429</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6110615</span> <span class="operator">|</span> <span class="number">2042637</span> <span class="operator">|</span> ABcLyh <span class="operator">|</span> <span class="number">157</span> <span class="operator">|</span> <span class="number">40</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+--------+------+---------+</span></span><br><span class="line"><span class="number">401</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">3.62</span> sec)</span><br></pre></td></tr></table></figure><p>typeä¸ºâ€œALLâ€ï¼Œè¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•ï¼ŒæŸ¥è¯¢æ—¶é—´ä¸º 3.62 ç§’ï¼ŒæŸ¥è¯¢æ•ˆç‡è¾ƒä¹‹å‰ä½å¾ˆå¤šã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="5f71e3f3-b819-4070-a29c-d6d9664e2d12-3"><ul><li>studentè¡¨çš„å­—æ®µstunoä¸Šè®¾ç½®æœ‰ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_sno <span class="keyword">ON</span> student(stuno);</span><br></pre></td></tr></table></figure><ul><li>ç´¢å¼•ä¼˜åŒ–å¤±æ•ˆï¼šï¼ˆå‡è®¾ï¼šstudentè¡¨çš„å­—æ®µstunoä¸Šè®¾ç½®æœ‰ç´¢å¼•ï¼‰</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE id, stuno, NAME <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> stuno<span class="operator">+</span><span class="number">1</span> <span class="operator">=</span> <span class="number">900001</span>;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704215159768.png" alt="image-20220704215159768"></p><ul><li>ç´¢å¼•ä¼˜åŒ–ç”Ÿæ•ˆï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE id, stuno, NAME <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> stuno <span class="operator">=</span> <span class="number">900000</span>;</span><br></pre></td></tr></table></figure><p><strong>å†ä¸¾ä¾‹ï¼š</strong></p><ul><li>studentè¡¨çš„å­—æ®µnameä¸Šè®¾ç½®æœ‰ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_name <span class="keyword">ON</span> student(NAME);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> id, stuno, name <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="built_in">SUBSTRING</span>(name, <span class="number">1</span>,<span class="number">3</span>)<span class="operator">=</span><span class="string">&#x27;abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704215533871.png" alt="image-20220704215533871"></p><ul><li>ç´¢å¼•ä¼˜åŒ–ç”Ÿæ•ˆ</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> id, stuno, NAME <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;abc%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704215600507.png" alt="image-20220704215600507"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-5"><p>ä¸‹åˆ—å“ªä¸ªsqlè¯­å¥å¯ä»¥ç”¨åˆ°ç´¢å¼•ã€‚ï¼ˆå‡è®¾nameå­—æ®µä¸Šè®¾ç½®æœ‰ç´¢å¼•ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æœªä½¿ç”¨åˆ°ç´¢å¼•</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="number">123</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704215658526.png" alt="image-20220704215658526"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨åˆ°ç´¢å¼•</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;123&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704215721216.png" alt="image-20220704215721216"></p><p>name=123å‘ç”Ÿç±»å‹è½¬æ¢ï¼Œç´¢å¼•å¤±æ•ˆã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-6"><ol><li>ç³»ç»Ÿç»å¸¸å‡ºç°çš„sqlå¦‚ä¸‹ï¼š</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">DROP</span> INDEX idx_name;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">DROP</span> INDEX idx_age;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">DROP</span> INDEX idx_age_classid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_classid_name <span class="keyword">ON</span> student (age, classId, NAME);</span><br><span class="line"></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> student.classId<span class="operator">&gt;</span><span class="number">20</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abc&#x27;</span> ;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20190704220123647.png" alt="image-20220704220123647"></p><p>key_len=10 åªç”¨ä¸Šäº†ä¸¤ä¸ªint+2NULL ageå’Œclassidï¼Œnameå¤±æ•ˆ</p><blockquote><p>è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆèŒƒå›´æŸ¥è¯¢ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼š</p><p>ä¾‹å¦‚ï¼ša_b_cè¿™ä¸ªç´¢å¼•ï¼Œä½ æ ¹æ®bèŒƒå›´æŸ¥æ‰¾&gt;2çš„</p><p>å› ä¸ºæ ¹æ®èŒƒå›´æŸ¥æ‰¾ç­›é€‰åçš„æ•°æ®ï¼Œæ— æ³•ä¿è¯èŒƒå›´æŸ¥æ‰¾åé¢çš„å­—æ®µæ˜¯æœ‰åºçš„</p></blockquote><ol start="2"><li>é‚£ä¹ˆç´¢å¼• idx_age_classId_name è¿™ä¸ªç´¢å¼•è¿˜èƒ½æ­£å¸¸ä½¿ç”¨ä¹ˆï¼Ÿ</li></ol><ul><li>ä¸èƒ½ï¼ŒèŒƒå›´å³è¾¹çš„åˆ—ä¸èƒ½ä½¿ç”¨ã€‚æ¯”å¦‚ï¼š(&lt;) (&lt;=) (&gt;) (&gt;=) å’Œ between ç­‰</li><li>å¦‚æœè¿™ç§sqlå‡ºç°è¾ƒå¤šï¼Œåº”è¯¥å»ºç«‹ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_age_name_classId <span class="keyword">on</span> student(age,name,classId);</span><br></pre></td></tr></table></figure><ul><li>å°†èŒƒå›´æŸ¥è¯¢æ¡ä»¶æ”¾ç½®è¯­å¥æœ€åï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.age<span class="operator">=</span><span class="number">30</span> <span class="keyword">AND</span> student.name <span class="operator">=</span> <span class="string">&#x27;abc&#x27;</span> <span class="keyword">AND</span> student.classId<span class="operator">&gt;</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure><blockquote><p>åº”ç”¨å¼€å‘ä¸­èŒƒå›´æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼šé‡‘é¢æŸ¥è¯¢ï¼Œæ—¥æœŸæŸ¥è¯¢å¾€å¾€éƒ½æ˜¯èŒƒå›´æŸ¥è¯¢ã€‚ï¼ˆåˆ›å»ºçš„è”åˆç´¢å¼•ä¸­ï¼ŒåŠ¡å¿…æŠŠèŒƒå›´æ¶‰åŠåˆ°çš„å­—æ®µå†™åœ¨æœ€åï¼‰</p></blockquote><ol start="3"><li>æ•ˆæœ</li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704223211981.png" alt="image-20220704223211981"></p><p>name varchar(20) 60+2+1</p><p>int 4+1</p><p>int 4+1</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-7"><ul><li>ä¸ºnameå­—æ®µåˆ›å»ºç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_name <span class="keyword">ON</span> student(NAME);</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ç´¢å¼•æ˜¯å¦å¤±æ•ˆ</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.name <span class="operator">&lt;&gt;</span> <span class="string">&#x27;abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704224552374.png" alt="image-20220704224552374"></p><p>æˆ–è€…</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> student.name <span class="operator">!=</span> <span class="string">&#x27;abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704224916117.png" alt="image-20220704224916117"></p><p>åœºæ™¯ä¸¾ä¾‹ï¼šç”¨æˆ·æå‡ºéœ€æ±‚ï¼Œå°†è´¢åŠ¡æ•°æ®ï¼Œäº§å“åˆ©æ¶¦é‡‘é¢ä¸ç­‰äº0çš„éƒ½ç»Ÿè®¡å‡ºæ¥ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-8"><ul><li>IS NULL: å¯ä»¥è§¦å‘ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><ul><li>IS NOT NULL: æ— æ³•è§¦å‘ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220704225333199.png" alt="image-20220704225333199"></p><blockquote><p>ç»“è®ºï¼šæœ€å¥½åœ¨è®¾è®¡æ•°æ®åº“çš„æ—¶å€™å°±å°†<code>å­—æ®µè®¾ç½®ä¸º NOT NULL çº¦æŸ</code>ï¼Œæ¯”å¦‚ä½ å¯ä»¥å°† INT ç±»å‹çš„å­—æ®µï¼Œé»˜è®¤å€¼è®¾ç½®ä¸º0ã€‚å°†å­—ç¬¦ç±»å‹çš„é»˜è®¤å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²(â€˜â€™)ã€‚</p><p>æ‰©å±•ï¼šåŒç†ï¼Œåœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨<code>not like</code>ä¹Ÿæ— æ³•ä½¿ç”¨ç´¢å¼•ï¼Œå¯¼è‡´å…¨è¡¨æ‰«æã€‚</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-9"><p>åœ¨ä½¿ç”¨LIKEå…³é”®å­—è¿›è¡ŒæŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¦‚æœåŒ¹é…å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºâ€™%â€˜ï¼Œç´¢å¼•å°±ä¸ä¼šèµ·ä½œç”¨ã€‚åªæœ‰â€™%'ä¸åœ¨ç¬¬ä¸€ä¸ªä½ç½®ï¼Œç´¢å¼•æ‰ä¼šèµ·ä½œç”¨ã€‚</p><ul><li>ä½¿ç”¨åˆ°ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;ab%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705131643304.png" alt="image-20220705131643304"></p><ul><li>æœªä½¿ç”¨åˆ°ç´¢å¼•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%ab%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705131717329.png" alt="image-20220705131717329"></p><blockquote><p>æ‹“å±•ï¼šAlibabaã€ŠJavaå¼€å‘æ‰‹å†Œã€‹</p><p>ã€å¼ºåˆ¶ã€‘é¡µé¢æœç´¢ä¸¥ç¦å·¦æ¨¡ç³Šæˆ–è€…å…¨æ¨¡ç³Šï¼Œå¦‚æœéœ€è¦è¯·èµ°æœç´¢å¼•æ“æ¥è§£å†³ã€‚</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="e9211a91-00fa-43d6-9499-a527e5d5888d-10"><p>åœ¨WHEREå­å¥ä¸­ï¼Œå¦‚æœåœ¨ORå‰çš„æ¡ä»¶åˆ—è¿›è¡Œäº†ç´¢å¼•ï¼Œè€Œåœ¨ORåçš„æ¡ä»¶åˆ—æ²¡æœ‰è¿›è¡Œç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•ä¼šå¤±æ•ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>ORå‰åçš„ä¸¤ä¸ªæ¡ä»¶ä¸­çš„åˆ—éƒ½æ˜¯ç´¢å¼•æ—¶ï¼ŒæŸ¥è¯¢ä¸­æ‰ä½¿ç”¨ç´¢å¼•ã€‚</strong></p><p>å› ä¸ºORçš„å«ä¹‰å°±æ˜¯ä¸¤ä¸ªåªè¦æ»¡è¶³ä¸€ä¸ªå³å¯ï¼Œå› æ­¤<code>åªæœ‰ä¸€ä¸ªæ¡ä»¶åˆ—è¿›è¡Œäº†ç´¢å¼•æ˜¯æ²¡æœ‰æ„ä¹‰çš„</code>ï¼Œåªè¦æœ‰æ¡ä»¶åˆ—æ²¡æœ‰è¿›è¡Œç´¢å¼•ï¼Œå°±ä¼šè¿›è¡Œ<code>å…¨è¡¨æ‰«æ</code>ï¼Œå› æ­¤æ‰€ä»¥çš„æ¡ä»¶åˆ—ä¹Ÿä¼šå¤±æ•ˆã€‚</p><p>æŸ¥è¯¢è¯­å¥ä½¿ç”¨ORå…³é”®å­—çš„æƒ…å†µï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æœªä½¿ç”¨åˆ°ç´¢å¼•</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">10</span> <span class="keyword">OR</span> classid <span class="operator">=</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705132221045.png" alt="image-20220705132221045"></p><p>å› ä¸ºclassIdå­—æ®µä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ä¸Šè¿°æŸ¥è¯¢è¯­å¥æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#ä½¿ç”¨åˆ°ç´¢å¼•</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">10</span> <span class="keyword">OR</span> name <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705132239232.png" alt="image-20220705132239232"></p><p>å› ä¸ºageå­—æ®µå’Œnameå­—æ®µä¸Šéƒ½æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢ä¸­ä½¿ç”¨äº†ç´¢å¼•ã€‚ä½ èƒ½çœ‹åˆ°è¿™é‡Œä½¿ç”¨åˆ°äº†<code>index_merge</code>ï¼Œç®€å•æ¥è¯´index_mergeå°±æ˜¯å¯¹ageå’Œnameåˆ†åˆ«è¿›è¡Œäº†æ‰«æï¼Œç„¶åå°†è¿™ä¸¤ä¸ªç»“æœé›†è¿›è¡Œäº†åˆå¹¶ã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯<code>é¿å…äº†å…¨è¡¨æ‰«æ</code>ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>æ³¨æ„ï¼šæ•°æ®åº“å’Œè¡¨çš„å­—ç¬¦é›†ç»Ÿä¸€ä½¿ç”¨utf8mb4</p><p>ç»Ÿä¸€ä½¿ç”¨utf8mb4( 5.5.3ç‰ˆæœ¬ä»¥ä¸Šæ”¯æŒ)å…¼å®¹æ€§æ›´å¥½ï¼Œç»Ÿä¸€å­—ç¬¦é›†å¯ä»¥é¿å…ç”±äºå­—ç¬¦é›†è½¬æ¢äº§ç”Ÿçš„ä¹±ç ã€‚ä¸ åŒçš„<code>å­—ç¬¦é›†</code>è¿›è¡Œæ¯”è¾ƒå‰éœ€è¦è¿›è¡Œ<code>è½¬æ¢</code>ä¼šé€ æˆç´¢å¼•å¤±æ•ˆã€‚</p></blockquote><p>ç»ƒä¹ ï¼šå‡è®¾å­˜åœ¨ç´¢å¼•index(a,b,c)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705145225852.png" alt="image-20220705145225852"></p><p><strong>ä¸€èˆ¬æ€§å»ºè®®</strong></p><ul><li>å¯¹äºå•åˆ—ç´¢å¼•ï¼Œå°½é‡é€‰æ‹©é’ˆå¯¹å½“å‰queryè¿‡æ»¤æ€§æ›´å¥½çš„ç´¢å¼•</li><li>åœ¨é€‰æ‹©ç»„åˆç´¢å¼•çš„æ—¶å€™ï¼Œå½“å‰queryä¸­è¿‡æ»¤æ€§æœ€å¥½çš„å­—æ®µåœ¨ç´¢å¼•å­—æ®µé¡ºåºä¸­ï¼Œä½ç½®è¶Šé å‰è¶Šå¥½ã€‚</li><li>åœ¨é€‰æ‹©ç»„åˆç´¢å¼•çš„æ—¶å€™ï¼Œå°½é‡é€‰æ‹©èƒ½å¤Ÿå½“å‰queryä¸­whereå­å¥ä¸­æ›´å¤šçš„ç´¢å¼•ã€‚</li><li>åœ¨é€‰æ‹©ç»„åˆç´¢å¼•çš„æ—¶å€™ï¼Œå¦‚æœæŸä¸ªå­—æ®µå¯èƒ½å‡ºç°èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå°½é‡æŠŠè¿™ä¸ªå­—æ®µæ”¾åœ¨ç´¢å¼•æ¬¡åºçš„æœ€åé¢ã€‚</li></ul><p><strong>æ€»ä¹‹ï¼Œä¹¦å†™SQLè¯­å¥æ—¶ï¼Œå°½é‡é¿å…é€ æˆç´¢å¼•å¤±æ•ˆçš„æƒ…å†µ</strong></p><hr><h2 id="3-å…³è”æŸ¥è¯¢ä¼˜åŒ–">3. å…³è”æŸ¥è¯¢ä¼˜åŒ–</h2><h3 id="1-æ•°æ®å‡†å¤‡-2">1 æ•°æ®å‡†å¤‡</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># åˆ†ç±»</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>`type`(</span><br><span class="line">`id`<span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`card`<span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">);</span><br><span class="line">#å›¾ä¹¦</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>`book`(</span><br><span class="line">`bookid`<span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`card`<span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`bookid`)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#å‘åˆ†ç±»è¡¨ä¸­æ·»åŠ <span class="number">20</span>æ¡è®°å½•</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>`type`(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"></span><br><span class="line">#å‘å›¾ä¹¦è¡¨ä¸­æ·»åŠ <span class="number">20</span>æ¡è®°å½•</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br></pre></td></tr></table></figure><hr><h3 id="3-2-é‡‡ç”¨å·¦å¤–è¿æ¥">3.2 é‡‡ç”¨å·¦å¤–è¿æ¥</h3><p>ä¸‹é¢å¼€å§‹ EXPLAIN åˆ†æ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card <span class="operator">=</span> book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705160504018.png" alt="image-20220705160504018"></p><p>ç»“è®ºï¼štype æœ‰All</p><p>æ·»åŠ ç´¢å¼•ä¼˜åŒ–</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book <span class="keyword">ADD</span> INDEX Y (card); #ã€è¢«é©±åŠ¨è¡¨ã€‘ï¼Œå¯ä»¥é¿å…å…¨è¡¨æ‰«æ</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card <span class="operator">=</span> book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705160935109.png" alt="image-20220705160935109"></p><p>å¯ä»¥çœ‹åˆ°ç¬¬äºŒè¡Œçš„ type å˜ä¸ºäº† refï¼Œrows ä¹Ÿå˜æˆäº†ä¼˜åŒ–æ¯”è¾ƒæ˜æ˜¾ã€‚è¿™æ˜¯ç”±å·¦è¿æ¥ç‰¹æ€§å†³å®šçš„ã€‚LEFT JOIN æ¡ä»¶ç”¨äºç¡®å®šå¦‚ä½•ä»å³è¡¨æœç´¢è¡Œï¼Œå·¦è¾¹ä¸€å®šéƒ½æœ‰ï¼Œæ‰€ä»¥<code>å³è¾¹æ˜¯æˆ‘ä»¬çš„å…³é”®ç‚¹,ä¸€å®šéœ€è¦å»ºç«‹ç´¢å¼•</code>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>`type`<span class="keyword">ADD</span> INDEX X (card); #ã€é©±åŠ¨è¡¨ã€‘ï¼Œæ— æ³•é¿å…å…¨è¡¨æ‰«æ</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card <span class="operator">=</span> book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161243838.png" alt="image-20220705161243838"></p><p>æ¥ç€ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX Y <span class="keyword">ON</span> book;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card <span class="operator">=</span> book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161515545.png" alt="image-20220705161515545"></p><hr><h3 id="3-3-é‡‡ç”¨å†…è¿æ¥">3.3 é‡‡ç”¨å†…è¿æ¥</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> index X <span class="keyword">on</span> type;</span><br><span class="line"><span class="keyword">drop</span> index Y <span class="keyword">on</span> book;ï¼ˆå¦‚æœå·²ç»åˆ é™¤äº†å¯ä»¥ä¸ç”¨å†æ‰§è¡Œè¯¥æ“ä½œï¼‰</span><br></pre></td></tr></table></figure><p>æ¢æˆ inner joinï¼ˆMySQLè‡ªåŠ¨é€‰æ‹©é©±åŠ¨è¡¨ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> type <span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card<span class="operator">=</span>book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161602362.png" alt="image-20220705161602362"></p><p>æ·»åŠ ç´¢å¼•ä¼˜åŒ–</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book <span class="keyword">ADD</span> INDEX Y (card);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> type <span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card<span class="operator">=</span>book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161746184.png" alt="image-20220705161746184"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> type <span class="keyword">ADD</span> INDEX X (card);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> type <span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card<span class="operator">=</span>book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161843558.png" alt="image-20220705161843558"></p><p>å¯¹äºå†…è¿æ¥æ¥è¯´ï¼Œ</p><ol><li><p>æŸ¥è¯¢ä¼˜åŒ–å™¨å¯ä»¥å†³å®šè°ä½œä¸ºé©±åŠ¨è¡¨ï¼Œè°ä½œä¸ºè¢«é©±åŠ¨è¡¨å‡ºç°çš„</p></li><li><span class="p green">å¦‚æœè¡¨çš„è¿æ¥æ¡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µæœ‰ç´¢å¼•ï¼Œåˆ™æœ‰ç´¢å¼•çš„å­—æ®µæ‰€åœ¨çš„è¡¨ä¼šè¢«ä½œä¸ºè¢«é©±åŠ¨è¡¨ã€‚</span></li><li><p>åœ¨ä¸¤ä¸ªè¡¨çš„é“¾æ¥æ¡ä»¶éƒ½å­˜åœ¨ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œä¼šé€‰æ‹©å°è¡¨ä½œä¸ºé©±åŠ¨è¡¨ã€‚ â€œå°è¡¨é©±åŠ¨å¤§è¡¨â€</p></li></ol><p>æ¼”ç¤ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX X <span class="keyword">ON</span>`type`;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> TYPE <span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card<span class="operator">=</span>book.card;</span><br></pre></td></tr></table></figure><p>äº¤æ¢äº†ä½ç½®</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705161929544.png" alt="image-20220705161929544"></p><p>æ¥ç€ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>`type`<span class="keyword">ADD</span> INDEX X (card);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span> type.card<span class="operator">=</span>book.card;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705162009145.png" alt="image-20220705162009145"></p><p>æ¥ç€ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#å‘å›¾ä¹¦è¡¨ä¸­æ·»åŠ <span class="number">20</span>æ¡è®°å½•</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(card) <span class="keyword">VALUES</span>(<span class="built_in">FLOOR</span>(<span class="number">1</span> <span class="operator">+</span> (RAND() <span class="operator">*</span> <span class="number">20</span>)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book <span class="keyword">ADD</span> INDEX Y (card);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span>`type`<span class="keyword">INNER</span> <span class="keyword">JOIN</span> book <span class="keyword">ON</span>`type`.card <span class="operator">=</span> book.card;</span><br></pre></td></tr></table></figure><p>å‘ç°ï¼Œç”±äºbookè¡¨æ•°æ®å¤§äºtypeè¡¨æ•°æ®ï¼ŒMySQLé€‰æ‹©å°†bookä½œä¸ºè¢«é©±åŠ¨è¡¨ã€‚</p><hr><h3 id="3-4-joinè¯­å¥åŸç†">3.4 joinè¯­å¥åŸç†</h3><p>joinæ–¹å¼è¿æ¥å¤šä¸ªè¡¨ï¼Œæœ¬è´¨å°±æ˜¯å„ä¸ªè¡¨ä¹‹é—´æ•°æ®çš„å¾ªç¯åŒ¹é…ã€‚MySQL5.5ç‰ˆæœ¬ä¹‹å‰ï¼ŒMySQLåªæ”¯æŒä¸€ç§è¡¨é—´å…³è”æ–¹å¼ï¼Œå°±æ˜¯åµŒå¥—å¾ªç¯(Nested Loop Join)ã€‚å¦‚æœå…³è”è¡¨çš„æ•°æ®é‡å¾ˆå¤§ï¼Œåˆ™joinå…³è”çš„æ‰§è¡Œæ—¶é—´ä¼šå¾ˆé•¿ã€‚åœ¨MySQL5.5ä»¥åçš„ç‰ˆæœ¬ä¸­ï¼ŒMySQLé€šè¿‡å¼•å…¥BNLJç®—æ³•æ¥ä¼˜åŒ–åµŒå¥—æ‰§è¡Œã€‚</p><div class="tabs" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#9fba7784-d8d4-46ae-8707-b7612bc1d72f-1"><i class="fas fa-cat"></i>é©±åŠ¨è¡¨å’Œè¢«é©±åŠ¨è¡¨</button></li><li class="tab"><button type="button" data-href="#9fba7784-d8d4-46ae-8707-b7612bc1d72f-2"><i class="fas fa-horse"></i>ç®€å•åµŒå¥—å¾ªç¯è¿æ¥</button></li><li class="tab"><button type="button" data-href="#9fba7784-d8d4-46ae-8707-b7612bc1d72f-3"><i class="fas fa-dove"></i>ç´¢å¼•åµŒå¥—å¾ªç¯è¿æ¥</button></li><li class="tab"><button type="button" data-href="#9fba7784-d8d4-46ae-8707-b7612bc1d72f-4"><i class="fas fa-dragon"></i>å—åµŒå¥—å¾ªç¯è¿æ¥</button></li><li class="tab"><button type="button" data-href="#9fba7784-d8d4-46ae-8707-b7612bc1d72f-5"><i class="fas fa-tree"></i>Joinå°ç»“</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f-1"><p>é©±åŠ¨è¡¨å°±æ˜¯ä¸»è¡¨ï¼Œè¢«é©±åŠ¨è¡¨å°±æ˜¯ä»è¡¨ã€éé©±åŠ¨è¡¨ã€‚</p><ul><li>å¯¹äºå†…è¿æ¥æ¥è¯´ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">JOIN</span> B <span class="keyword">ON</span> ...</span><br></pre></td></tr></table></figure><p>Aä¸€å®šæ˜¯é©±åŠ¨è¡¨å—ï¼Ÿä¸ä¸€å®šï¼Œä¼˜åŒ–å™¨ä¼šæ ¹æ®ä½ æŸ¥è¯¢è¯­å¥åšä¼˜åŒ–ï¼Œå†³å®šå…ˆæŸ¥å“ªå¼ è¡¨ã€‚å…ˆæŸ¥è¯¢çš„é‚£å¼ è¡¨å°±æ˜¯é©±åŠ¨è¡¨ï¼Œåä¹‹å°±æ˜¯è¢«é©±åŠ¨è¡¨ã€‚é€šè¿‡explainå…³é”®å­—å¯ä»¥æŸ¥çœ‹ã€‚</p><ul><li>å¯¹äºå¤–è¿æ¥æ¥è¯´ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> A <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> ...</span><br><span class="line"># æˆ–</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> B <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> A <span class="keyword">ON</span> ... </span><br></pre></td></tr></table></figure><p>é€šå¸¸ï¼Œå¤§å®¶ä¼šè®¤ä¸ºAå°±æ˜¯é©±åŠ¨è¡¨ï¼ŒBå°±æ˜¯è¢«é©±åŠ¨è¡¨ã€‚ä½†ä¹Ÿæœªå¿…ã€‚æµ‹è¯•å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> a(f1 <span class="type">INT</span>, f2 <span class="type">INT</span>, INDEX(f1)) ENGINE<span class="operator">=</span>INNODB;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> b(f1 <span class="type">INT</span>, f2 <span class="type">INT</span>) ENGINE<span class="operator">=</span>INNODB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> a <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="number">1</span>),(<span class="number">2</span>,<span class="number">2</span>),(<span class="number">3</span>,<span class="number">3</span>),(<span class="number">4</span>,<span class="number">4</span>),(<span class="number">5</span>,<span class="number">5</span>),(<span class="number">6</span>,<span class="number">6</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> b <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="number">3</span>),(<span class="number">4</span>,<span class="number">4</span>),(<span class="number">5</span>,<span class="number">5</span>),(<span class="number">6</span>,<span class="number">6</span>),(<span class="number">7</span>,<span class="number">7</span>),(<span class="number">8</span>,<span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> b;</span><br><span class="line"></span><br><span class="line"># æµ‹è¯•</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> b <span class="keyword">ON</span>(a.f1<span class="operator">=</span>b.f1) <span class="keyword">WHERE</span> (a.f2<span class="operator">=</span>b.f2);</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230412102452266.png" alt="image-20230412102452266"></p><p>ä¼˜åŒ–å™¨æŠŠå¤–è¿æ¥ä¼˜åŒ–æˆä¸ºå†…è¿æ¥ï¼Œä¹‹åå°±ä¼˜åŒ–å™¨å¸®ä½ é€‰æ‹©å“ªä¸ªã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f-2"><p><span class="p green">Simple Nested-Loop Join</span></p><p>ç®—æ³•ç›¸å½“ç®€å•ï¼Œä»è¡¨Aä¸­å–å‡ºä¸€æ¡æ•°æ®1ï¼Œéå†è¡¨Bï¼Œå°†åŒ¹é…åˆ°çš„æ•°æ®æ”¾åˆ°resultâ€¦ ä»¥æ­¤ç±»æ¨ï¼Œé©±åŠ¨è¡¨Aä¸­çš„æ¯ä¸€æ¡è®°å½•ä¸è¢«é©±åŠ¨è¡¨Bçš„è®°å½•è¿›è¡Œåˆ¤æ–­ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705165559127.png" alt="image-20220705165559127"></p><p>å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œä»¥ä¸Šè¿°è¡¨Aæ•°æ®100æ¡ï¼Œè¡¨Bæ•°æ®1000æ¡è®¡ç®—ï¼Œåˆ™A*B=10ä¸‡æ¬¡ã€‚å¼€é”€ç»Ÿè®¡å¦‚ä¸‹:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705165646252.png" alt="image-20220705165646252"></p><p>å½“ç„¶mysqlè‚¯å®šä¸ä¼šè¿™ä¹ˆç²—æš´çš„å»è¿›è¡Œè¡¨çš„è¿æ¥ï¼Œæ‰€ä»¥å°±å‡ºç°äº†åé¢çš„ä¸¤ç§å¯¹Nested-Loop Joinä¼˜åŒ–ç®—æ³•ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f-3"><p><span class="p green">Index Nested-Loop Join</span></p><p>Index Nested-Loop Joinå…¶ä¼˜åŒ–çš„æ€è·¯ä¸»è¦æ˜¯ä¸ºäº†<code>å‡å°‘å†…å­˜è¡¨æ•°æ®çš„åŒ¹é…æ¬¡æ•°</code>ï¼Œæ‰€ä»¥è¦æ±‚è¢«é©±åŠ¨è¡¨ä¸Šå¿…é¡»<code>æœ‰ç´¢å¼•</code>æ‰è¡Œã€‚é€šè¿‡å¤–å±‚è¡¨åŒ¹é…æ¡ä»¶ç›´æ¥ä¸å†…å±‚è¡¨ç´¢å¼•è¿›è¡ŒåŒ¹é…ï¼Œé¿å…å’Œå†…å­˜è¡¨çš„æ¯æ¡è®°å½•å»è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·æå¤§çš„å‡å°‘äº†å¯¹å†…å­˜è¡¨çš„åŒ¹é…æ¬¡æ•°ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705172315554.png" alt="image-20220705172315554"></p><p>é©±åŠ¨è¡¨ä¸­çš„æ¯æ¡è®°å½•é€šè¿‡è¢«é©±åŠ¨è¡¨çš„ç´¢å¼•è¿›è¡Œè®¿é—®ï¼Œå› ä¸ºç´¢å¼•æŸ¥è¯¢çš„æˆæœ¬æ˜¯æ¯”è¾ƒå›ºå®šçš„ï¼Œæ•…mysqlä¼˜åŒ–å™¨éƒ½å€¾å‘äºä½¿ç”¨è®°å½•æ•°å°‘çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼ˆå¤–è¡¨ï¼‰ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705172650749.png" alt="image-20220705172650749"></p><p>å¦‚æœè¢«é©±åŠ¨è¡¨åŠ ç´¢å¼•ï¼Œæ•ˆç‡æ˜¯éå¸¸é«˜çš„ï¼Œä½†å¦‚æœç´¢å¼•ä¸æ˜¯ä¸»é”®ç´¢å¼•ï¼Œæ‰€ä»¥è¿˜å¾—è¿›è¡Œä¸€æ¬¡å›è¡¨æŸ¥è¯¢ã€‚ç›¸æ¯”ï¼Œè¢«é©±åŠ¨è¡¨çš„ç´¢å¼•æ˜¯ä¸»é”®ç´¢å¼•ï¼Œæ•ˆç‡ä¼šæ›´é«˜ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f-4"><p><span class="p green">Block Nested-Loop Join</span></p><p>å¦‚æœå­˜åœ¨ç´¢å¼•ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨indexçš„æ–¹å¼è¿›è¡Œjoinï¼Œå¦‚æœjoinçš„åˆ—æ²¡æœ‰ç´¢å¼•ï¼Œè¢«é©±åŠ¨è¡¨è¦æ‰«æçš„æ¬¡æ•°å¤ªå¤šäº†ã€‚æ¯æ¬¡è®¿é—®è¢«é©±åŠ¨è¡¨ï¼Œå…¶è¡¨ä¸­çš„è®°å½•éƒ½ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†ä»é©±åŠ¨è¡¨ä¸­å–ä¸€æ¡ä¸å…¶åŒ¹é…ï¼ŒåŒ¹é…ç»“æŸåæ¸…é™¤å†…å­˜ï¼Œç„¶åå†ä»é©±åŠ¨è¡¨ä¸­åŠ è½½ä¸€æ¡è®°å½•ï¼Œç„¶åæŠŠè¢«é©±åŠ¨è¡¨çš„è®°å½•åœ¨åŠ è½½åˆ°å†…å­˜åŒ¹é…ï¼Œè¿™æ ·å‘¨è€Œå¤å§‹ï¼Œå¤§å¤§å¢åŠ äº†10çš„æ¬¡æ•°ã€‚ä¸ºäº†å‡å°‘è¢«é©±åŠ¨è¡¨çš„10æ¬¡æ•°ï¼Œå°±å‡ºç°äº†Block Nested-Loop Joinçš„æ–¹å¼ã€‚</p><p>ä¸å†æ˜¯é€æ¡è·å–é©±åŠ¨è¡¨çš„æ•°æ®ï¼Œè€Œæ˜¯ä¸€å—ä¸€å—çš„è·å–ï¼Œå¼•å…¥äº†<code>join bufferç¼“å†²åŒº</code>ï¼Œå°†é©±åŠ¨è¡¨joinç›¸å…³çš„éƒ¨åˆ†æ•°æ®åˆ—(å¤§å°å—join bufferçš„é™åˆ¶ç¼“å­˜åˆ°join buferä¸­ï¼Œç„¶åå…¨è¡¨æ‰«æè¢«é©±åŠ¨è¡¨ï¼Œè¢«é©±åŠ¨è¡¨çš„æ¯ä¸€æ¡è®°å½•ä¸€æ¬¡æ€§å’Œjoin bufferä¸­çš„æ‰€æœ‰é©±åŠ¨è¡¨è®°å½•è¿›è¡ŒåŒ¹é…ï¼ˆå†…å­˜ä¸­æ“ä½œï¼‰ï¼Œå°†ç®€å•åµŒå¥—å¾ªç¯ä¸­çš„å¤šæ¬¡æ¯”è¾ƒåˆå¹¶æˆä¸€æ¬¡ï¼Œé™ä½äº†è¢«é©±åŠ¨è¡¨çš„è®¿é—®é¢‘ç‡ã€‚</p><blockquote><p>æ³¨æ„ï¼š</p><p>è¿™é‡Œç¼“å­˜çš„ä¸åªæ˜¯å…³è”è¡¨çš„åˆ—ï¼Œselectåé¢çš„åˆ—ä¹Ÿä¼šç¼“å­˜èµ·æ¥ã€‚</p><p>åœ¨ä¸€ä¸ªæœ‰Nä¸ªjoinå…³è”çš„sqlä¸­ä¼šåˆ†é…N-1ä¸ªjoin bufferã€‚æ‰€ä»¥æŸ¥è¯¢çš„æ—¶å€™å°½é‡å‡å°‘ä¸å¿…è¦çš„å­—æ®µï¼Œå¯ä»¥è®©join bufferä¸­å¯ä»¥å­˜æ”¾æ›´å¤šçš„åˆ—ã€‚</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705174005280.png" alt="image-20220705174005280"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705174250551.png" alt="image-20220705174250551"></p><p>å‚æ•°è®¾ç½®ï¼š</p><ul><li>block_nested_loop</li></ul><p>é€šè¿‡<code>show variables like '%optimizer_switch%</code>æŸ¥çœ‹<code>block_nested_loop</code>çŠ¶æ€ã€‚é»˜è®¤æ˜¯å¼€å¯çš„ã€‚</p><ul><li>join_buffer_size</li></ul><p>é©±åŠ¨è¡¨èƒ½ä¸èƒ½ä¸€æ¬¡åŠ è½½å®Œï¼Œè¦çœ‹join bufferèƒ½ä¸èƒ½å­˜å‚¨æ‰€æœ‰çš„æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹<code>join_buffer_size=256k</code>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%join_buffer%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>join_buffer_sizeçš„æœ€å¤§å€¼åœ¨32ä½æ“ä½œç³»ç»Ÿå¯ä»¥ç”³è¯·4Gï¼Œè€Œåœ¨64ä½æ“ä½œç³»ç»Ÿä¸‹å¯ä»¥ç”³è¯·å¤§äº4Gçš„Join Bufferç©ºé—´ï¼ˆ64ä½Windowsé™¤å¤–ï¼Œå…¶å¤§å€¼ä¼šè¢«æˆªæ–­ä¸º4GBå¹¶å‘å‡ºè­¦å‘Šï¼‰ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="9fba7784-d8d4-46ae-8707-b7612bc1d72f-5"><p>1ã€<strong>æ•´ä½“æ•ˆç‡æ¯”è¾ƒï¼šINLJ &gt; BNLJ &gt; SNLJ</strong></p><p>2ã€æ°¸è¿œç”¨å°ç»“æœé›†é©±åŠ¨å¤§ç»“æœé›†ï¼ˆå…¶æœ¬è´¨å°±æ˜¯å‡å°‘å¤–å±‚å¾ªç¯çš„æ•°æ®æ•°é‡ï¼‰ï¼ˆå°çš„åº¦é‡å•ä½æŒ‡çš„æ˜¯è¡¨è¡Œæ•° * æ¯è¡Œå¤§å°ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.b,t2.<span class="operator">*</span> <span class="keyword">from</span> t1 straight_join t2 <span class="keyword">on</span> (t1.b<span class="operator">=</span>t2.b) <span class="keyword">where</span> t2.id<span class="operator">&lt;=</span><span class="number">100</span>; # æ¨è</span><br><span class="line"><span class="keyword">select</span> t1.b,t2.<span class="operator">*</span> <span class="keyword">from</span> t2 straight_join t1 <span class="keyword">on</span> (t1.b<span class="operator">=</span>t2.b) <span class="keyword">where</span> t2.id<span class="operator">&lt;=</span><span class="number">100</span>; # ä¸æ¨è</span><br></pre></td></tr></table></figure><p>3ã€ä¸ºè¢«é©±åŠ¨è¡¨åŒ¹é…çš„æ¡ä»¶å¢åŠ ç´¢å¼•(å‡å°‘å†…å­˜è¡¨çš„å¾ªç¯åŒ¹é…æ¬¡æ•°)</p><p>4ã€å¢å¤§join buffer sizeçš„å¤§å°ï¼ˆä¸€æ¬¡ç´¢å¼•çš„æ•°æ®è¶Šå¤šï¼Œé‚£ä¹ˆå†…å±‚åŒ…çš„æ‰«ææ¬¡æ•°å°±è¶Šå°‘ï¼‰</p><p>5ã€å‡å°‘é©±åŠ¨è¡¨ä¸å¿…è¦çš„å­—æ®µæŸ¥è¯¢ï¼ˆå­—æ®µè¶Šå°‘ï¼Œjoin bufferæ‰€ç¼“å­˜çš„æ•°æ®å°±è¶Šå¤šï¼‰</p><blockquote><p>Hash Join</p></blockquote><p><strong>ä»MySQLçš„8.0.20ç‰ˆæœ¬å¼€å§‹å°†åºŸå¼ƒBNLJï¼Œå› ä¸ºä»MySQL8.0.18ç‰ˆæœ¬å¼€å§‹å°±åŠ å…¥äº†hash joiné»˜è®¤éƒ½ä¼šä½¿ç”¨hash join</strong></p><ul><li><p>Nested Loop:</p><p>å¯¹äºè¢«è¿æ¥çš„æ•°æ®å­é›†è¾ƒå°çš„æƒ…å†µï¼ŒNested Loopæ˜¯ä¸ªè¾ƒå¥½çš„é€‰æ‹©ã€‚</p></li><li><p>Hash Joinæ˜¯åš<code>å¤§æ•°æ®é›†è¿æ¥</code>æ—¶çš„å¸¸ç”¨æ–¹å¼ï¼Œä¼˜åŒ–å™¨ä½¿ç”¨ä¸¤ä¸ªè¡¨ä¸­è¾ƒå°ï¼ˆç›¸å¯¹è¾ƒå°ï¼‰çš„è¡¨åˆ©ç”¨Join Keyåœ¨å†…å­˜ä¸­å»ºç«‹<code>æ•£åˆ—è¡¨</code>ï¼Œç„¶åæ‰«æè¾ƒå¤§çš„è¡¨å¹¶æ¢æµ‹æ•£åˆ—è¡¨ï¼Œæ‰¾å‡ºä¸Hashè¡¨åŒ¹é…çš„è¡Œã€‚</p><ul><li>è¿™ç§æ–¹å¼é€‚åˆäºè¾ƒå°çš„è¡¨å®Œå…¨å¯ä»¥æ”¾äºå†…å­˜ä¸­çš„æƒ…å†µï¼Œè¿™æ ·æ€»æˆæœ¬å°±æ˜¯è®¿é—®ä¸¤ä¸ªè¡¨çš„æˆæœ¬ä¹‹å’Œã€‚</li><li>åœ¨è¡¨å¾ˆå¤§çš„æƒ…å†µä¸‹å¹¶ä¸èƒ½å®Œå…¨æ”¾å…¥å†…å­˜ï¼Œè¿™æ—¶ä¼˜åŒ–å™¨ä¼šå°†å®ƒåˆ†å‰²æˆ<code>è‹¥å¹²ä¸åŒçš„åˆ†åŒº</code>ï¼Œä¸èƒ½æ”¾å…¥å†…å­˜çš„éƒ¨åˆ†å°±æŠŠè¯¥åˆ†åŒºå†™å…¥ç£ç›˜çš„ä¸´æ—¶æ®µï¼Œæ­¤æ—¶è¦æ±‚æœ‰è¾ƒå¤§çš„ä¸´æ—¶æ®µä»è€Œå°½é‡æé«˜I/Oçš„æ€§èƒ½ã€‚</li><li>å®ƒèƒ½å¤Ÿå¾ˆå¥½çš„å·¥ä½œäºæ²¡æœ‰ç´¢å¼•çš„å¤§è¡¨å’Œå¹¶è¡ŒæŸ¥è¯¢çš„ç¯å¢ƒä¸­ï¼Œå¹¶æä¾›æœ€å¥½çš„æ€§èƒ½ã€‚å¤§å¤šæ•°äººéƒ½è¯´å®ƒæ˜¯Joinçš„é‡å‹å‡é™æœºã€‚Hash Joinåªèƒ½åº”ç”¨äºç­‰å€¼è¿æ¥ï¼ˆå¦‚WHERE A.COL1 = B.COL2ï¼‰ï¼Œè¿™æ˜¯ç”±Hashçš„ç‰¹ç‚¹å†³å®šçš„ã€‚</li></ul></li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705205050280.png" alt="image-20220705205050280"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h3 id="3-5-å°ç»“">3.5 å°ç»“</h3><ul><li>ä¿è¯è¢«é©±åŠ¨è¡¨çš„JOINå­—æ®µå·²ç»åˆ›å»ºäº†ç´¢å¼•</li><li>éœ€è¦JOIN çš„å­—æ®µï¼Œæ•°æ®ç±»å‹ä¿æŒç»å¯¹ä¸€è‡´ã€‚</li><li>LEFT JOIN æ—¶ï¼Œé€‰æ‹©å°è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œ å¤§è¡¨ä½œä¸ºè¢«é©±åŠ¨è¡¨ ã€‚å‡å°‘å¤–å±‚å¾ªç¯çš„æ¬¡æ•°ã€‚</li><li>INNER JOIN æ—¶ï¼ŒMySQLä¼šè‡ªåŠ¨å°† å°ç»“æœé›†çš„è¡¨é€‰ä¸ºé©±åŠ¨è¡¨ ã€‚é€‰æ‹©ç›¸ä¿¡MySQLä¼˜åŒ–ç­–ç•¥ã€‚</li><li>èƒ½å¤Ÿç›´æ¥å¤šè¡¨å…³è”çš„å°½é‡ç›´æ¥å…³è”ï¼Œä¸ç”¨å­æŸ¥è¯¢ã€‚(å‡å°‘æŸ¥è¯¢çš„è¶Ÿæ•°)</li><li>ä¸å»ºè®®ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå»ºè®®å°†å­æŸ¥è¯¢SQLæ‹†å¼€ç»“åˆç¨‹åºå¤šæ¬¡æŸ¥è¯¢ï¼Œæˆ–ä½¿ç”¨ JOIN æ¥ä»£æ›¿å­æŸ¥è¯¢ã€‚</li><li>è¡ç”Ÿè¡¨å»ºä¸äº†ç´¢å¼•</li></ul><hr><h2 id="4-å­æŸ¥è¯¢ä¼˜åŒ–">4. å­æŸ¥è¯¢ä¼˜åŒ–</h2><p>MySQLä»4.1ç‰ˆæœ¬å¼€å§‹æ”¯æŒå­æŸ¥è¯¢ï¼Œä½¿ç”¨å­æŸ¥è¯¢å¯ä»¥è¿›è¡ŒSELECTè¯­å¥çš„åµŒå¥—æŸ¥è¯¢ï¼Œå³ä¸€ä¸ªSELECTæŸ¥è¯¢çš„ç»“ æœä½œä¸ºå¦ä¸€ä¸ªSELECTè¯­å¥çš„æ¡ä»¶ã€‚<code>å­æŸ¥è¯¢å¯ä»¥ä¸€æ¬¡æ€§å®Œæˆå¾ˆå¤šé€»è¾‘ä¸Šéœ€è¦å¤šä¸ªæ­¥éª¤æ‰èƒ½å®Œæˆçš„SQLæ“ä½œ</code>ã€‚</p><span class="p red">å­æŸ¥è¯¢æ˜¯ MySQL çš„ä¸€é¡¹é‡è¦çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª SQL è¯­å¥å®ç°æ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢ã€‚ä½†æ˜¯ï¼Œå­æŸ¥è¯¢çš„æ‰§è¡Œæ•ˆç‡ä¸é«˜ã€‚</span>åŸå› ï¼š<p>â‘  æ‰§è¡Œå­æŸ¥è¯¢æ—¶ï¼ŒMySQLéœ€è¦ä¸ºå†…å±‚æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ç»“æœ<code>å»ºç«‹ä¸€ä¸ªä¸´æ—¶è¡¨</code>ï¼Œç„¶åå¤–å±‚æŸ¥è¯¢è¯­å¥ä»ä¸´æ—¶è¡¨ ä¸­æŸ¥è¯¢è®°å½•ã€‚æŸ¥è¯¢å®Œæ¯•åï¼Œå†<code>æ’¤é”€è¿™äº›ä¸´æ—¶è¡¨</code>ã€‚è¿™æ ·ä¼šæ¶ˆè€—è¿‡å¤šçš„CPUå’ŒIOèµ„æºï¼Œäº§ç”Ÿå¤§é‡çš„æ…¢æŸ¥è¯¢ã€‚</p><p>â‘¡ å­æŸ¥è¯¢çš„ç»“æœé›†å­˜å‚¨çš„ä¸´æ—¶è¡¨ï¼Œä¸è®ºæ˜¯å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨éƒ½<code>ä¸ä¼šå­˜åœ¨ç´¢å¼•</code>ï¼Œæ‰€ä»¥æŸ¥è¯¢æ€§èƒ½ä¼šå—åˆ°ä¸€å®šçš„å½±å“ã€‚</p><p>â‘¢ å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ä¹Ÿå°±è¶Šå¤§ã€‚</p><span class="p red">åœ¨MySQLä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ï¼ˆJOINï¼‰æŸ¥è¯¢æ¥æ›¿ä»£å­æŸ¥è¯¢ã€‚</span> è¿æ¥æŸ¥è¯¢ä¸éœ€è¦å»ºç«‹ä¸´æ—¶ï¼Œå…¶é€Ÿåº¦æ¯”å­æŸ¥è¯¢è¦å¿« ï¼Œå¦‚æœæŸ¥è¯¢ä¸­ä½¿ç”¨ç´¢å¼•çš„è¯ï¼Œæ€§èƒ½å°±ä¼šæ›´å¥½ã€‚<p>ä¸¾ä¾‹1ï¼šæŸ¥è¯¢å­¦ç”Ÿè¡¨ä¸­æ˜¯ç­é•¿çš„å­¦ç”Ÿä¿¡æ¯</p><ul><li>ä½¿ç”¨å­æŸ¥è¯¢</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºç­çº§è¡¨ä¸­ç­é•¿çš„ç´¢å¼•</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_monitor <span class="keyword">ON</span> class(monitor);</span><br><span class="line"># æŸ¥è¯¢ç­é•¿ä¿¡æ¯</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student stu1</span><br><span class="line"><span class="keyword">WHERE</span> stu1.`stuno`<span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> monitor</span><br><span class="line"><span class="keyword">FROM</span> class c</span><br><span class="line"><span class="keyword">WHERE</span> monitor <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230412113820338.png" alt="image-20230412113820338"></p><ul><li>æ¨èä½¿ç”¨å¤šè¡¨æŸ¥è¯¢</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> stu1.<span class="operator">*</span> <span class="keyword">FROM</span> student stu1 <span class="keyword">JOIN</span> class c</span><br><span class="line"><span class="keyword">ON</span> stu1.`stuno`<span class="operator">=</span> c.`monitor`</span><br><span class="line"><span class="keyword">WHERE</span> c.`monitor`<span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230412113950052.png" alt="image-20230412113950052"></p><p>ä¸¾ä¾‹2ï¼šå–æ‰€æœ‰ä¸ä¸ºç­é•¿çš„åŒå­¦</p><ul><li>ä¸æ¨è</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE a.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> student a</span><br><span class="line"><span class="keyword">WHERE</span> a.stuno <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> monitor <span class="keyword">FROM</span> class b</span><br><span class="line">    <span class="keyword">WHERE</span> monitor <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705210708343.png" alt="image-20220705210708343"></p><ul><li>æ¨èï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE a.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> student a <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> class b</span><br><span class="line"><span class="keyword">ON</span> a.stuno <span class="operator">=</span> b.monitor</span><br><span class="line"><span class="keyword">WHERE</span> b.monitor <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705210839437.png" alt="image-20220705210839437"></p><blockquote><p>ç»“è®ºï¼šå°½é‡ä¸è¦ä½¿ç”¨NOT INæˆ–è€…NOT EXISTSï¼Œç”¨LEFT JOIN xxx ON xx WHERE xx IS NULLæ›¿ä»£</p></blockquote><hr><h2 id="5-æ’åºä¼˜åŒ–">5. æ’åºä¼˜åŒ–</h2><h3 id="5-1-æ’åºä¼˜åŒ–">5.1 æ’åºä¼˜åŒ–</h3><p><strong>é—®é¢˜</strong>ï¼šåœ¨ WHERE æ¡ä»¶å­—æ®µä¸ŠåŠ ç´¢å¼•ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆåœ¨ ORDER BY å­—æ®µä¸Šè¿˜è¦åŠ ç´¢å¼•å‘¢ï¼Ÿ</p><p><strong>å›ç­”ï¼š</strong></p><p>åœ¨MySQLä¸­ï¼Œæ”¯æŒä¸¤ç§æ’åºæ–¹å¼ï¼Œåˆ†åˆ«æ˜¯<code>FileSort</code>å’Œ<code>Index</code>æ’åºã€‚</p><ul><li>Index æ’åºä¸­ï¼Œç´¢å¼•å¯ä»¥ä¿è¯æ•°æ®çš„æœ‰åºæ€§ï¼Œä¸éœ€è¦å†è¿›è¡Œæ’åºï¼Œ<code>æ•ˆç‡æ›´é«˜</code>ã€‚</li><li>FileSort æ’åºåˆ™ä¸€èˆ¬åœ¨<code>å†…å­˜ä¸­</code>è¿›è¡Œæ’åºï¼Œå ç”¨<code>CPUè¾ƒå¤š</code>ã€‚å¦‚æœå¾…æ’ç»“æœè¾ƒå¤§ï¼Œä¼šäº§ç”Ÿä¸´æ—¶æ–‡ä»¶ I/O åˆ°ç£ç›˜è¿›è¡Œæ’åºçš„æƒ…å†µï¼Œæ•ˆç‡è¾ƒä½ã€‚</li></ul><p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p><ol><li>SQL ä¸­ï¼Œå¯ä»¥åœ¨ WHERE å­å¥å’Œ ORDER BY å­å¥ä¸­ä½¿ç”¨ç´¢å¼•ï¼Œç›®çš„æ˜¯åœ¨ WHERE å­å¥ä¸­<code>é¿å…å…¨è¡¨æ‰«æ</code>ï¼Œåœ¨ ORDER BY å­å¥<code>é¿å…ä½¿ç”¨ FileSort æ’åº</code>ã€‚å½“ç„¶ï¼ŒæŸäº›æƒ…å†µä¸‹å…¨è¡¨æ‰«æï¼Œæˆ–è€… FileSort æ’åºä¸ä¸€å®šæ¯”ç´¢å¼•æ…¢ã€‚ä½†æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦é¿å…ï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li><li>å°½é‡ä½¿ç”¨ Index å®Œæˆ ORDER BY æ’åºã€‚å¦‚æœ WHERE å’Œ ORDER BY åé¢æ˜¯ç›¸åŒçš„åˆ—å°±ä½¿ç”¨å•ç´¢å¼•åˆ—ï¼› å¦‚æœä¸åŒå°±ä½¿ç”¨è”åˆç´¢å¼•ã€‚</li><li>æ— æ³•ä½¿ç”¨ Index æ—¶ï¼Œéœ€è¦å¯¹ FileSort æ–¹å¼è¿›è¡Œè°ƒä¼˜ã€‚</li></ol><h3 id="5-2-æµ‹è¯•">5.2 æµ‹è¯•</h3><p>åˆ é™¤studentè¡¨å’Œclassè¡¨ä¸­å·²åˆ›å»ºçš„ç´¢å¼•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># æ–¹å¼<span class="number">1</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_monitor <span class="keyword">ON</span> class;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_cid <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_name <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age_name_classId <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age_classId_name <span class="keyword">ON</span> student;</span><br><span class="line"></span><br><span class="line"># æ–¹å¼<span class="number">2</span></span><br><span class="line"><span class="keyword">call</span> proc_drop_index(<span class="string">&#x27;atguigudb2&#x27;</span>,<span class="string">&#x27;student&#x27;</span>;)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯å¦èƒ½ä½¿ç”¨åˆ°ç´¢å¼•ï¼Œ<code>èƒ½å¦å»æ‰using filesort</code></p><p><strong>è¿‡ç¨‹ä¸€ï¼š</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705215436102.png" alt="image-20220705215436102"></p><p><strong>è¿‡ç¨‹äºŒï¼š order by æ—¶ä¸limit,ç´¢å¼•å¤±æ•ˆ</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705215909350.png" alt="image-20220705215909350"></p><p><strong>è¿‡ç¨‹ä¸‰ï¼šorder by æ—¶é¡ºåºé”™è¯¯ï¼Œç´¢å¼•å¤±æ•ˆ</strong></p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705220033520.png" alt="image-20220705220033520" style="zoom:80%"><p><strong>è¿‡ç¨‹å››ï¼šorder by æ—¶è§„åˆ™ä¸ä¸€è‡´ï¼Œç´¢å¼•å¤±æ•ˆï¼ˆé¡ºåºé”™ï¼Œä¸ç´¢å¼•ï¼›æ–¹å‘åï¼Œä¸ç´¢å¼•ï¼‰</strong></p><p>ç¬¬å››ä¸ªåè€Œèƒ½ç´¢å¼•éƒ½å€’äº†</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705220404802.png" alt="image-20220705220404802" style="zoom:80%"><blockquote><p>ç»“è®ºï¼šORDER BY å­å¥ï¼Œå°½é‡ä½¿ç”¨ Index æ–¹å¼æ’åºï¼Œé¿å…ä½¿ç”¨ FileSort æ–¹å¼æ’åº</p></blockquote><p><strong>è¿‡ç¨‹äº”ï¼šæ— è¿‡æ»¤ï¼Œä¸ç´¢å¼•</strong></p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705221212879.png" alt="image-20220705221212879" style="zoom:80%"><p><strong>å°ç»“</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">INDEX a_b_c(a,b,c)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> èƒ½ä½¿ç”¨ç´¢å¼•æœ€å·¦å‰ç¼€</span><br><span class="line"><span class="operator">-</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> a</span><br><span class="line"><span class="operator">-</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> a,b</span><br><span class="line"><span class="operator">-</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> a,b,c</span><br><span class="line"><span class="operator">-</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> a <span class="keyword">DESC</span>,b <span class="keyword">DESC</span>,c <span class="keyword">DESC</span></span><br><span class="line">å¦‚æœ<span class="keyword">WHERE</span>ä½¿ç”¨ç´¢å¼•çš„æœ€å·¦å‰ç¼€å®šä¹‰ä¸ºå¸¸é‡ï¼Œåˆ™<span class="keyword">order</span> <span class="keyword">by</span> èƒ½ä½¿ç”¨ç´¢å¼•</span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> b,c</span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">AND</span> b <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> c</span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> b,c</span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">AND</span> b <span class="operator">&gt;</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> b,c</span><br><span class="line">ä¸èƒ½ä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åº</span><br><span class="line"><span class="operator">-</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> a <span class="keyword">ASC</span>,b <span class="keyword">DESC</span>,c <span class="keyword">DESC</span> <span class="comment">/* æ’åºä¸ä¸€è‡´ */</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> g <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> b,c <span class="comment">/*ä¸¢å¤±aç´¢å¼•*/</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> c <span class="comment">/*ä¸¢å¤±bç´¢å¼•*/</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="operator">=</span> const <span class="keyword">ORDER</span> <span class="keyword">BY</span> a,d <span class="comment">/*dä¸æ˜¯ç´¢å¼•çš„ä¸€éƒ¨åˆ†*/</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">WHERE</span> a <span class="keyword">in</span> (...) <span class="keyword">ORDER</span> <span class="keyword">BY</span> b,c <span class="comment">/*å¯¹äºæ’åºæ¥è¯´ï¼Œå¤šä¸ªç›¸ç­‰æ¡ä»¶ä¹Ÿæ˜¯èŒƒå›´æŸ¥è¯¢*/</span></span><br></pre></td></tr></table></figure><h3 id="5-3-æ¡ˆä¾‹å®æˆ˜">5.3 æ¡ˆä¾‹å®æˆ˜</h3><p>ORDER BYå­å¥ï¼Œå°½é‡ä½¿ç”¨Indexæ–¹å¼æ’åºï¼Œé¿å…ä½¿ç”¨FileSortæ–¹å¼æ’åºã€‚</p><p>æ‰§è¡Œæ¡ˆä¾‹å‰å…ˆæ¸…é™¤studentä¸Šçš„ç´¢å¼•ï¼Œåªç•™ä¸»é”®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX idx_age <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age_classid_stuno <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age_classid_name <span class="keyword">ON</span> student;</span><br><span class="line"></span><br><span class="line">#æˆ–è€…</span><br><span class="line"><span class="keyword">call</span> proc_drop_index(<span class="string">&#x27;atguigudb2&#x27;</span>,<span class="string">&#x27;student&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>åœºæ™¯:æŸ¥è¯¢å¹´é¾„ä¸º30å²çš„ï¼Œä¸”å­¦ç”Ÿç¼–å·å°äº101000çš„å­¦ç”Ÿï¼ŒæŒ‰ç”¨æˆ·åç§°æ’åº</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> stuno <span class="operator">&lt;</span><span class="number">101000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME ;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705222027812.png" alt="image-20220705222027812"></p><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> stuno <span class="operator">&lt;</span><span class="number">101000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> stuno  <span class="operator">|</span>  name  <span class="operator">|</span> age  <span class="operator">|</span> classId <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">922</span>     <span class="operator">|</span> <span class="number">100923</span> <span class="operator">|</span> elTLXD <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">249</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3723263</span> <span class="operator">|</span> <span class="number">100412</span> <span class="operator">|</span> hKcjLb <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">59</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3724152</span> <span class="operator">|</span> <span class="number">100827</span> <span class="operator">|</span> iHLJmh <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">387</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3724030</span> <span class="operator">|</span> <span class="number">100776</span> <span class="operator">|</span> LgxWoD <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">253</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">30</span>      <span class="operator">|</span> <span class="number">100031</span> <span class="operator">|</span> LZMOIa <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">97</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3722887</span> <span class="operator">|</span> <span class="number">100237</span> <span class="operator">|</span> QzbJdx <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">440</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">609</span>     <span class="operator">|</span> <span class="number">100610</span> <span class="operator">|</span> vbRimN <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">481</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">139</span>     <span class="operator">|</span> <span class="number">100140</span> <span class="operator">|</span> ZqFbuR <span class="operator">|</span> <span class="number">30</span>   <span class="operator">|</span> <span class="number">351</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------+--------+------+---------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">3.16</span> sec)</span><br></pre></td></tr></table></figure><blockquote><p>ç»“è®ºï¼štype æ˜¯ ALLï¼Œå³æœ€åçš„æƒ…å†µã€‚Extra é‡Œè¿˜å‡ºç°äº† Using filesort,ä¹Ÿæ˜¯æœ€åçš„æƒ…å†µã€‚ä¼˜åŒ–æ˜¯å¿…é¡»çš„ã€‚</p></blockquote><p><strong>æ–¹æ¡ˆä¸€: ä¸ºäº†å»æ‰filesortæˆ‘ä»¬å¯ä»¥æŠŠç´¢å¼•å»ºæˆ</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#åˆ›å»ºæ–°ç´¢å¼•</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_name <span class="keyword">ON</span> student(age,NAME);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> stuno <span class="operator">&lt;</span><span class="number">101000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705222912521.png" alt="image-20220705222912521"></p><p>è¿™æ ·æˆ‘ä»¬ä¼˜åŒ–æ‰äº† using filesort</p><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705222954971.png" alt="image-20220705222954971"><p><strong>æ–¹æ¡ˆäºŒï¼šå°½é‡è®©whereçš„è¿‡æ»¤æ¡ä»¶å’Œæ’åºä½¿ç”¨ä¸Šç´¢å¼•</strong></p><p>å»ºä¸€ä¸ªä¸‰ä¸ªå­—æ®µçš„ç»„åˆç´¢å¼•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX idx_age_name <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_stuno_name <span class="keyword">ON</span> student (age,stuno,NAME);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> stuno <span class="operator">&lt;</span><span class="number">101000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705223111883.png" alt="image-20220705223111883"></p><p>æˆ‘ä»¬å‘ç°using filesortä¾ç„¶å­˜åœ¨ï¼Œæ‰€ä»¥nameå¹¶æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œè€Œä¸”typeè¿˜æ˜¯rangeå…‰çœ‹åå­—å…¶å®å¹¶ä¸ç¾å¥½ã€‚åŸå› æ˜¯ï¼Œå› ä¸º<code>stunoæ˜¯ä¸€ä¸ªèŒƒå›´è¿‡æ»¤</code>ï¼Œæ‰€ä»¥ç´¢å¼•åé¢çš„å­—æ®µä¸ä¼šåœ¨ä½¿ç”¨ç´¢å¼•äº† ã€‚</p><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SQL_NO_CACHE <span class="operator">*</span> <span class="keyword">FROM</span> student</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> stuno <span class="operator">&lt;</span><span class="number">101000</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> NAME ;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----+--------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> stuno <span class="operator">|</span> name <span class="operator">|</span> age <span class="operator">|</span> classId <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+--------+--------+------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">167</span> <span class="operator">|</span> <span class="number">100168</span> <span class="operator">|</span> AClxEF <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">319</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">323</span> <span class="operator">|</span> <span class="number">100324</span> <span class="operator">|</span> bwbTpQ <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">654</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">651</span> <span class="operator">|</span> <span class="number">100652</span> <span class="operator">|</span> DRwIac <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">997</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">517</span> <span class="operator">|</span> <span class="number">100518</span> <span class="operator">|</span> HNSYqJ <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">256</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">344</span> <span class="operator">|</span> <span class="number">100345</span> <span class="operator">|</span> JuepiX <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">329</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">905</span> <span class="operator">|</span> <span class="number">100906</span> <span class="operator">|</span> JuWALd <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">892</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">574</span> <span class="operator">|</span> <span class="number">100575</span> <span class="operator">|</span> kbyqjX <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">260</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">703</span> <span class="operator">|</span> <span class="number">100704</span> <span class="operator">|</span> KJbprS <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">594</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">723</span> <span class="operator">|</span> <span class="number">100724</span> <span class="operator">|</span> OTdJkY <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">236</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">656</span> <span class="operator">|</span> <span class="number">100657</span> <span class="operator">|</span> Pfgqmj <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">600</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">982</span> <span class="operator">|</span> <span class="number">100983</span> <span class="operator">|</span> qywLqw <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">837</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">468</span> <span class="operator">|</span> <span class="number">100469</span> <span class="operator">|</span> sLEKQW <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">346</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">988</span> <span class="operator">|</span> <span class="number">100989</span> <span class="operator">|</span> UBYqJl <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">457</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">173</span> <span class="operator">|</span> <span class="number">100174</span> <span class="operator">|</span> UltkTN <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">830</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">332</span> <span class="operator">|</span> <span class="number">100333</span> <span class="operator">|</span> YjWiZw <span class="operator">|</span> <span class="number">30</span> <span class="operator">|</span> <span class="number">824</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+--------+--------+------+---------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>ç»“æœç«Ÿç„¶æœ‰ filesortçš„ sql è¿è¡Œé€Ÿåº¦ï¼Œ è¶…è¿‡äº†å·²ç»ä¼˜åŒ–æ‰ filesortçš„ sql ï¼Œè€Œä¸”å¿«äº†å¾ˆå¤šï¼Œå‡ ä¹ä¸€ç¬é—´å°±å‡ºç°äº†ç»“æœã€‚</p><p>åŸå› ï¼š</p><p>æ‰€æœ‰çš„æ’åºéƒ½æ˜¯åœ¨æ¡ä»¶è¿‡æ»¤ä¹‹åæ‰æ‰§è¡Œçš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ¡ä»¶è¿‡æ»¤æ‰å¤§éƒ¨åˆ†æ•°æ®çš„è¯ï¼Œå‰©ä¸‹å‡ ç™¾å‡ å¹²æ¡æ•°æ®è¿›è¡Œæ’åºå…¶å®å¹¶ä¸æ˜¯å¾ˆæ¶ˆè€—æ€§èƒ½ï¼Œå³ä½¿ç´¢å¼•ä¼˜åŒ–äº†æ’åºï¼Œä½†å®é™…æå‡æ€§èƒ½å¾ˆæœ‰é™ã€‚ç›¸å¯¹çš„ stuno&lt;101000 è¿™ä¸ªæ¡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°ç´¢å¼•çš„è¯ï¼Œè¦å¯¹å‡ ä¸‡æ¡çš„æ•°æ®è¿›è¡Œæ‰«æï¼Œè¿™æ˜¯éå¸¸æ¶ˆè€—æ€§èƒ½çš„ï¼Œæ‰€ä»¥ç´¢å¼•æ”¾åœ¨è¿™ä¸ªå­—æ®µä¸Šæ€§ä»·æ¯”æœ€é«˜ï¼Œæ˜¯æœ€ä¼˜é€‰æ‹©ã€‚</p><blockquote><p>ç»“è®ºï¼š</p><ol><li>ä¸¤ä¸ªç´¢å¼•åŒæ—¶å­˜åœ¨ï¼Œmysqlè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„æ–¹æ¡ˆã€‚ï¼ˆå¯¹äºè¿™ä¸ªä¾‹å­ï¼Œmysqlé€‰æ‹© idx_age_stuno_nameï¼‰ã€‚ä½†æ˜¯ï¼Œ<code>éšç€æ•°æ®é‡çš„å˜åŒ–ï¼Œé€‰æ‹©çš„ç´¢å¼•ä¹Ÿä¼šéšä¹‹å˜åŒ–çš„</code>ã€‚</li><li><strong>å½“ã€èŒƒå›´æ¡ä»¶ã€‘å’Œã€group by æˆ–è€… order byã€‘çš„å­—æ®µå‡ºç°äºŒé€‰ä¸€æ—¶ï¼Œä¼˜å…ˆè§‚å¯Ÿæ¡ä»¶å­—æ®µçš„è¿‡ æ»¤æ•°é‡ï¼Œå¦‚æœè¿‡æ»¤çš„æ•°æ®è¶³å¤Ÿå¤šï¼Œè€Œéœ€è¦æ’åºçš„æ•°æ®å¹¶ä¸å¤šæ—¶ï¼Œä¼˜å…ˆæŠŠç´¢å¼•æ”¾åœ¨èŒƒå›´å­—æ®µä¸Šã€‚åä¹‹ï¼Œäº¦ç„¶ã€‚</strong></li></ol></blockquote><p>æ€è€ƒï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹ç´¢å¼•ï¼Œæ˜¯å¦å¯è¡Œï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX idx_age_stuno_name <span class="keyword">ON</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_stuno <span class="keyword">ON</span> student(age,stuno);</span><br></pre></td></tr></table></figure><p>å½“ç„¶å¯ä»¥ã€‚</p><h3 id="5-4-filesortç®—æ³•ï¼šåŒè·¯æ’åºå’Œå•è·¯æ’åº">5.4 filesortç®—æ³•ï¼šåŒè·¯æ’åºå’Œå•è·¯æ’åº</h3><p>æ’åºçš„å­—æ®µè‹¥ä¸åœ¨ç´¢å¼•åˆ—ä¸Šï¼Œåˆ™filesortä¼šæœ‰ä¸¤ç§ç®—æ³•ï¼šåŒè·¯æ’åºå’Œå•è·¯æ’åº</p><p><strong>åŒè·¯æ’åº ï¼ˆæ…¢ï¼‰</strong></p><ul><li>MySQL 4.1ä¹‹å‰æ˜¯ä½¿ç”¨åŒè·¯æ’åº ï¼Œå­—é¢æ„æ€å°±æ˜¯ä¸¤æ¬¡æ‰«æç£ç›˜ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®ï¼Œ è¯»å–è¡ŒæŒ‡é’ˆå’Œ order byåˆ— ï¼Œå¯¹ä»–ä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«æå·²ç»æ’åºå¥½çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­è¯»å–å¯¹åº”çš„æ•°æ®è¾“å‡º</li><li>ä»ç£ç›˜å–æ’åºå­—æ®µï¼Œåœ¨bufferè¿›è¡Œæ’åºï¼Œå†ä»ç£ç›˜å–å…¶ä»–å­—æ®µ ã€‚</li></ul><p>å–ä¸€æ‰¹æ•°æ®ï¼Œè¦å¯¹ç£ç›˜è¿›è¡Œä¸¤æ¬¡æ‰«æï¼Œä¼—æ‰€å‘¨çŸ¥ï¼ŒIOæ˜¯å¾ˆè€—æ—¶çš„ï¼Œæ‰€ä»¥åœ¨mysql4.1ä¹‹åï¼Œå‡ºç°äº†ç¬¬äºŒç§ æ”¹è¿›çš„ç®—æ³•ï¼Œå°±æ˜¯å•è·¯æ’åºã€‚</p><p><strong>å•è·¯æ’åº ï¼ˆå¿«ï¼‰</strong></p><p>ä»ç£ç›˜è¯»å–æŸ¥è¯¢éœ€è¦çš„ æ‰€æœ‰åˆ— ï¼ŒæŒ‰ç…§order byåˆ—åœ¨bufferå¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«ææ’åºåçš„åˆ—è¡¨è¿›è¡Œè¾“å‡ºï¼Œ å®ƒçš„æ•ˆç‡æ›´å¿«ä¸€äº›ï¼Œé¿å…äº†ç¬¬äºŒæ¬¡è¯»å–æ•°æ®ã€‚å¹¶ä¸”æŠŠéšæœºIOå˜æˆäº†é¡ºåºIOï¼Œä½†æ˜¯å®ƒä¼šä½¿ç”¨æ›´å¤šçš„ç©ºé—´ï¼Œ å› ä¸ºå®ƒæŠŠæ¯ä¸€è¡Œéƒ½ä¿å­˜åœ¨å†…å­˜ä¸­äº†ã€‚</p><p><strong>ç»“è®ºåŠå¼•ç”³å‡ºçš„é—®é¢˜</strong></p><ul><li>ç”±äºå•è·¯æ˜¯åå‡ºçš„ï¼Œæ€»ä½“è€Œè¨€å¥½è¿‡åŒè·¯</li><li>ä½†æ˜¯ç”¨å•è·¯æœ‰é—®é¢˜<ul><li>åœ¨sort_bufferä¸­ï¼Œå•è·¯è¦æ¯”å¤šè·¯å¤šå ç”¨å¾ˆå¤šç©ºé—´ï¼Œå› ä¸ºå•è·¯æ˜¯æŠŠæ‰€æœ‰å­—æ®µéƒ½å–å‡ºï¼Œæ‰€ä»¥æœ‰å¯èƒ½å–å‡ºçš„æ•°æ®çš„æ€»å¤§å°è¶…å‡ºäº†<code>sort_buffer</code>çš„å®¹é‡ï¼Œå¯¼è‡´æ¯æ¬¡åªèƒ½å–<code>sort_buffer</code>å®¹é‡å¤§å°çš„æ•°æ®ï¼Œè¿›è¡Œæ’åºï¼ˆåˆ›å»ºtmpæ–‡ä»¶ï¼Œå¤šè·¯åˆå¹¶ï¼‰ï¼Œæ’å®Œå†å–sort_bufferå®¹é‡å¤§å°ï¼Œå†æ’â€¦ä»è€Œå¤šæ¬¡I/Oã€‚</li><li>å•è·¯æœ¬æ¥æƒ³çœä¸€æ¬¡I/Oæ“ä½œï¼Œåè€Œå¯¼è‡´äº†å¤§é‡çš„I/Oæ“ä½œï¼Œåè€Œå¾—ä¸å¿å¤±ã€‚</li></ul></li></ul><p><strong>ä¼˜åŒ–ç­–ç•¥</strong></p><p><strong>1. å°è¯•æé«˜ sort_buffer_size</strong></p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705224410340.png" alt="image-20220705224410340" style="zoom:80%"><p><strong>2. å°è¯•æé«˜ max_length_for_sort_data</strong></p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705224505668.png" alt="image-20220705224505668" style="zoom:80%"><p><strong>3. Order by æ—¶select * æ˜¯ä¸€ä¸ªå¤§å¿Œã€‚æœ€å¥½åªQueryéœ€è¦çš„å­—æ®µã€‚</strong></p><ul><li><p>å½“Queryçš„å­—æ®µå¤§å°æ€»å’Œå°äº<code>max_length_for-sort_data</code>ï¼Œè€Œä¸”æ’åºå­—æ®µä¸æ˜¯TEXT | BLOB ç±»å‹æ—¶ï¼Œä¼šç”¨æ”¹è¿›åçš„ç®—æ³•ä¸€ä¸€å•è·¯æ’åºï¼Œå¦åˆ™ç”¨è€ç®—æ³•ä¸€ä¸€å¤šè·¯æ’åºã€‚</p></li><li><p>ä¸¤ç§ç®—æ³•çš„æ•°æ®éƒ½æœ‰å¯èƒ½è¶…å‡ºsort_buffer_sizeçš„å®¹é‡ï¼Œè¶…å‡ºä¹‹åï¼Œä¼šåˆ›å»ºtmpæ–‡ä»¶è¿›è¡Œåˆå¹¶æ’åºï¼Œå¯¼è‡´å¤šæ¬¡ I/Oï¼Œä½†æ˜¯ç”¨å•è·¯æ’åºç®—æ³•çš„é£é™©ä¼šæ›´å¤§ä¸€äº›ï¼Œæ‰€ä»¥è¦æé«˜<code>sort_buffer-size</code>ã€‚</p></li></ul><hr><h2 id="6-GROUP-BYä¼˜åŒ–">6. GROUP BYä¼˜åŒ–</h2><ul><li>group by ä½¿ç”¨ç´¢å¼•çš„åŸåˆ™å‡ ä¹è·Ÿorder byä¸€è‡´ ï¼Œgroup by å³ä½¿æ²¡æœ‰è¿‡æ»¤æ¡ä»¶ç”¨åˆ°ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ç´¢å¼•ã€‚</li><li>group by å…ˆæ’åºå†åˆ†ç»„ï¼Œéµç…§ç´¢å¼•å»ºçš„æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</li><li>å½“æ— æ³•ä½¿ç”¨ç´¢å¼•åˆ—ï¼Œå¢å¤§ max_length_for_sort_data å’Œ sort_buffer_size å‚æ•°çš„è®¾ç½®</li><li>whereæ•ˆç‡é«˜äºhavingï¼Œèƒ½å†™åœ¨whereé™å®šçš„æ¡ä»¶å°±ä¸è¦å†™åœ¨havingä¸­äº†</li><li>å‡å°‘ä½¿ç”¨order byï¼Œå’Œä¸šåŠ¡æ²Ÿé€šèƒ½ä¸æ’åºå°±ä¸æ’åºï¼Œæˆ–å°†æ’åºæ”¾åˆ°ç¨‹åºç«¯å»åšã€‚Order byã€group byã€distinctè¿™äº›è¯­å¥è¾ƒä¸ºè€—è´¹CPUï¼Œæ•°æ®åº“çš„CPUèµ„æºæ˜¯æå…¶å®è´µçš„ã€‚</li><li>åŒ…å«äº†order byã€group byã€distinctè¿™äº›æŸ¥è¯¢çš„è¯­å¥ï¼Œwhereæ¡ä»¶è¿‡æ»¤å‡ºæ¥çš„ç»“æœé›†è¯·ä¿æŒåœ¨1000è¡Œ ä»¥å†…ï¼Œå¦åˆ™SQLä¼šå¾ˆæ…¢ã€‚</li></ul><hr><h2 id="7-ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢">7. ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢</h2><p>ä¸€èˆ¬åˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œé€šè¿‡åˆ›å»ºè¦†ç›–ç´¢å¼•èƒ½å¤Ÿæ¯”è¾ƒå¥½åœ°æé«˜æ€§èƒ½ã€‚ä¸€ä¸ªå¸¸è§åˆéå¸¸å¤´ç–¼çš„é—®é¢˜å°±æ˜¯ limit 2000000,10 æ­¤æ—¶éœ€è¦MySQLæ’åºå‰2000010è®°å½•ï¼Œä»…ä»…è¿”å›2000000-2000010çš„è®°å½•ï¼Œå…¶ä»–è®°å½•ä¸¢å¼ƒï¼ŒæŸ¥è¯¢æ’åºçš„ä»£ä»·éå¸¸å¤§ã€‚</p><p><code>EXPLAIN SELECT * FROM student LIMIT 2000000,10</code>;</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230411140225812.png" alt="image-20230411140225812"></p><p><strong>ä¼˜åŒ–æ€è·¯ä¸€</strong></p><p>åœ¨ç´¢å¼•ä¸Šå®Œæˆæ’åºåˆ†é¡µæ“ä½œï¼Œæœ€åæ ¹æ®ä¸»é”®å…³è”å›åŸè¡¨æŸ¥è¯¢æ‰€éœ€è¦çš„å…¶ä»–åˆ—å†…å®¹ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student t,(<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">2000000</span>,<span class="number">10</span>) a <span class="keyword">WHERE</span> t.id <span class="operator">=</span> a.id;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705225625166.png" alt="image-20220705225625166"></p><p><strong>ä¼˜åŒ–æ€è·¯äºŒ</strong></p><p>è¯¥æ–¹æ¡ˆé€‚ç”¨äºä¸»é”®è‡ªå¢çš„è¡¨ï¼Œå¯ä»¥æŠŠLimit æŸ¥è¯¢è½¬æ¢æˆæŸä¸ªä½ç½®çš„æŸ¥è¯¢ ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id <span class="operator">&gt;</span> <span class="number">2000000</span> LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220705225654124.png" alt="image-20220705225654124"></p><hr><h2 id="8-ä¼˜å…ˆè€ƒè™‘è¦†ç›–ç´¢å¼•">8. ä¼˜å…ˆè€ƒè™‘è¦†ç›–ç´¢å¼•</h2><h3 id="8-1-ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ">8.1 ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ</h3><p><strong>ç†è§£æ–¹å¼ä¸€</strong>ï¼šç´¢å¼•æ˜¯é«˜æ•ˆæ‰¾åˆ°è¡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ä¸€èˆ¬æ•°æ®åº“ä¹Ÿèƒ½ä½¿ç”¨ç´¢å¼•æ‰¾åˆ°ä¸€ä¸ªåˆ—çš„æ•°æ®ï¼Œå› æ­¤å®ƒä¸å¿…è¯»å–æ•´ä¸ªè¡Œã€‚æ¯•ç«Ÿç´¢å¼•å¶å­èŠ‚ç‚¹å­˜å‚¨äº†å®ƒä»¬ç´¢å¼•çš„æ•°æ®ï¼›å½“èƒ½é€šè¿‡è¯»å–ç´¢å¼•å°±å¯ä»¥å¾—åˆ°æƒ³è¦çš„æ•°æ®ï¼Œé‚£å°±ä¸éœ€è¦è¯»å–è¡Œäº†ã€‚<strong>ä¸€ä¸ªç´¢å¼•åŒ…å«äº†æ»¡è¶³æŸ¥è¯¢ç»“æœçš„æ•°æ®å°±å«åšè¦†ç›–ç´¢å¼•</strong>ã€‚</p><p><strong>ç†è§£æ–¹å¼äºŒ</strong>ï¼šéèšç°‡å¤åˆç´¢å¼•çš„ä¸€ç§å½¢å¼ï¼Œå®ƒåŒ…æ‹¬åœ¨æŸ¥è¯¢é‡Œçš„SELECTã€JOINå’ŒWHEREå­å¥ç”¨åˆ°çš„æ‰€æœ‰åˆ— ï¼ˆå³å»ºç´¢å¼•çš„å­—æ®µæ­£å¥½æ˜¯è¦†ç›–æŸ¥è¯¢æ¡ä»¶ä¸­æ‰€æ¶‰åŠçš„å­—æ®µï¼‰ã€‚</p><p>ç®€å•è¯´å°±æ˜¯ï¼Œ<code>ç´¢å¼•åˆ—+ä¸»é”®</code>åŒ…å«<code>SELECT åˆ° FROMä¹‹é—´æŸ¥è¯¢çš„åˆ—</code>ã€‚</p><p><strong>ä¸¾ä¾‹ä¸€ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åˆ é™¤ä¹‹å‰çš„ç´¢å¼•</span><br><span class="line"><span class="keyword">DROP</span> INDEX idx_age_stuno <span class="keyword">ON</span> student;</span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_name <span class="keyword">ON</span> student(age, NAME);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">&lt;&gt;</span> <span class="number">20</span>;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> age,name <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">&lt;&gt;</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706124528680.png" alt="image-20220706124528680"></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20230412144559891.png" alt="image-20230412144559891"></p><p>æœ¬æ¥ç”±äºä¸ç­‰å·ç´¢å¼•å¤±æ•ˆ ï¼Œä½†æ˜¯è¦†ç›–ç´¢å¼•</p><p><strong>ä¸¾ä¾‹äºŒï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;%abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706124612180.png" alt="image-20220706124612180"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_age_name <span class="keyword">ON</span> student(age, NAME);</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> id,age,NAME <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;%abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706125113658.png" alt="image-20220706125113658"></p><p>ä½¿ç”¨ä¸Šäº†ç´¢å¼•ï¼Œå³ä½¿æ˜¯å·¦æ¨¡ç³ŠæŸ¥è¯¢</p><p>åŠ ä¸Šäº†ç´¢å¼•ä¸åœ¨çš„åˆ—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> id,age,NAME,classId <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;%abc&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706125351116.png" alt="image-20220706125351116"></p><h3 id="8-2-è¦†ç›–ç´¢å¼•çš„åˆ©å¼Š">8.2 è¦†ç›–ç´¢å¼•çš„åˆ©å¼Š</h3><p>å¥½å¤„ï¼š</p><ol><li><p>é¿å…Innodbè¡¨è¿›è¡Œç´¢å¼•çš„äºŒæ¬¡æŸ¥è¯¢ï¼ˆå›è¡¨ï¼‰</p><p>Innodbæ˜¯ä»¥èšé›†ç´¢å¼•çš„é¡ºåºæ¥å­˜å‚¨çš„ï¼Œå¯¹äºInnodbæ¥è¯´ï¼ŒäºŒçº§ç´¢å¼•åœ¨å¶å­èŠ‚ç‚¹ä¸­æ‰€ä¿å­˜çš„æ˜¯è¡Œçš„ä¸»é”®ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ç”¨äºŒçº§ç´¢å¼•æŸ¥è¯¢æ•°æ®ï¼Œåœ¨æŸ¥æ‰¾åˆ°ç›¸åº”çš„é”®å€¼åï¼Œè¿˜éœ€é€šè¿‡ä¸»é”®è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢æ‰èƒ½è·å–æˆ‘ä»¬çœŸå®æ‰€éœ€è¦çš„æ•°æ®ã€‚</p><p>åœ¨è¦†ç›–ç´¢å¼•ä¸­ï¼ŒäºŒçº§ç´¢å¼•çš„é”®å€¼ä¸­å¯ä»¥è·å–æ‰€è¦çš„æ•°æ®ï¼Œ<code>é¿å…äº†å¯¹ä¸»é”®çš„äºŒæ¬¡æŸ¥è¯¢ï¼Œå‡å°‘äº†I0æ“ä½œ</code>ï¼Œæå‡äº†æŸ¥è¯¢æ•ˆç‡ã€‚</p></li><li><p>å¯ä»¥æŠŠéšæœºIOå˜æˆé¡ºåºIOåŠ å¿«æŸ¥è¯¢æ•ˆç‡</p><p>ç”±äºè¦†ç›–ç´¢å¼•æ˜¯æŒ‰é”®å€¼çš„é¡ºåºå­˜å‚¨çš„ï¼Œå¯¹äºI0å¯†é›†å‹çš„èŒƒå›´æŸ¥æ‰¾æ¥è¯´ï¼Œå¯¹æ¯”éšæœºä»ç£ç›˜è¯»å–æ¯ä¸€è¡Œçš„æ•°æ®IOè¦å°‘çš„å¤šï¼Œå› æ­¤åˆ©ç”¨è¦†ç›–ç´¢å¼•åœ¨è®¿é—®æ—¶ä¹Ÿå¯ä»¥æŠŠç£ç›˜çš„<code>éšæœºè¯»å–çš„IO</code>è½¬å˜æˆç´¢å¼•æŸ¥æ‰¾çš„<code>é¡ºåºIO</code>ã€‚</p><span class="p green">ç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚</span></li></ol><p>å¼Šç«¯ï¼š</p><p><code>ç´¢å¼•å­—æ®µçš„ç»´æŠ¤</code>æ€»æ˜¯æœ‰ä»£ä»·çš„ã€‚å› æ­¤ï¼Œåœ¨å»ºç«‹å†—ä½™ç´¢å¼•æ¥æ”¯æŒè¦†ç›–ç´¢å¼•æ—¶å°±éœ€è¦æƒè¡¡è€ƒè™‘äº†ã€‚è¿™æ˜¯ä¸šåŠ¡DBAï¼Œæˆ–è€…ç§°ä¸ºä¸šåŠ¡æ•°æ®æ¶æ„å¸ˆçš„å·¥ä½œã€‚</p><hr><h2 id="9-å¦‚ä½•ç»™å­—ç¬¦ä¸²æ·»åŠ ç´¢å¼•">9. å¦‚ä½•ç»™å­—ç¬¦ä¸²æ·»åŠ ç´¢å¼•</h2><p>æœ‰ä¸€å¼ æ•™å¸ˆè¡¨ï¼Œè¡¨å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher(</span><br><span class="line">ID <span class="type">bigint</span> unsigned <span class="keyword">primary</span> key,</span><br><span class="line">email <span class="type">varchar</span>(<span class="number">64</span>),</span><br><span class="line">...</span><br><span class="line">)engine<span class="operator">=</span>innodb;</span><br></pre></td></tr></table></figure><p>è®²å¸ˆè¦ä½¿ç”¨é‚®ç®±ç™»å½•ï¼Œæ‰€ä»¥ä¸šåŠ¡ä»£ç ä¸­ä¸€å®šä¼šå‡ºç°ç±»ä¼¼äºè¿™æ ·çš„è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> col1, col2 <span class="keyword">from</span> teacher <span class="keyword">where</span> email<span class="operator">=</span><span class="string">&#x27;xxx&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœemailè¿™ä¸ªå­—æ®µä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥å°±åªèƒ½åš<code>å…¨è¡¨æ‰«æ</code>ã€‚</p><h3 id="9-1-å‰ç¼€ç´¢å¼•">9.1 å‰ç¼€ç´¢å¼•</h3><p>MySQLæ˜¯æ”¯æŒå‰ç¼€ç´¢å¼•çš„ã€‚é»˜è®¤åœ°ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•çš„è¯­å¥ä¸æŒ‡å®šå‰ç¼€é•¿åº¦ï¼Œé‚£ä¹ˆç´¢å¼•å°±ä¼šåŒ…å«æ•´ä¸ªå­— ç¬¦ä¸²ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> teacher <span class="keyword">add</span> index index1(email);</span><br><span class="line">#æˆ–</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> teacher <span class="keyword">add</span> index index2(email(<span class="number">6</span>));</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ç§ä¸åŒçš„å®šä¹‰åœ¨æ•°æ®ç»“æ„å’Œå­˜å‚¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸‹å›¾å°±æ˜¯è¿™ä¸¤ä¸ªç´¢å¼•çš„ç¤ºæ„å›¾ã€‚</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706130901307.png" alt="image-20220706130901307" style="zoom:50%"><p>ä»¥åŠ</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706130921934.png" alt="image-20220706130921934" style="zoom:50%"><p><strong>å¦‚æœä½¿ç”¨çš„æ˜¯index1</strong>ï¼ˆå³emailæ•´ä¸ªå­—ç¬¦ä¸²çš„ç´¢å¼•ç»“æ„ï¼‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š</p><ol><li>ä»index1ç´¢å¼•æ ‘æ‰¾åˆ°æ»¡è¶³ç´¢å¼•å€¼æ˜¯â€™ <a href="mailto:zhangssxyz@xxx.com">zhangssxyz@xxx.com</a>â€™çš„è¿™æ¡è®°å½•ï¼Œå–å¾—ID2çš„å€¼ï¼›</li><li>åˆ°ä¸»é”®ä¸ŠæŸ¥åˆ°ä¸»é”®å€¼æ˜¯ID2çš„è¡Œï¼Œåˆ¤æ–­emailçš„å€¼æ˜¯æ­£ç¡®çš„ï¼Œå°†è¿™è¡Œè®°å½•åŠ å…¥ç»“æœé›†ï¼›</li><li>å–index1ç´¢å¼•æ ‘ä¸ŠåˆšåˆšæŸ¥åˆ°çš„ä½ç½®çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå‘ç°å·²ç»ä¸æ»¡è¶³email=â€™ <a href="mailto:zhangssxyz@xxx.com">zhangssxyz@xxx.com</a> â€™çš„ æ¡ä»¶äº†ï¼Œå¾ªç¯ç»“æŸã€‚</li></ol><p>è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦å›ä¸»é”®ç´¢å¼•å–ä¸€æ¬¡æ•°æ®ï¼Œæ‰€ä»¥ç³»ç»Ÿè®¤ä¸ºåªæ‰«æäº†ä¸€è¡Œã€‚</p><p><strong>å¦‚æœä½¿ç”¨çš„æ˜¯index2</strong>ï¼ˆå³email(6)ç´¢å¼•ç»“æ„ï¼‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š</p><ol><li>ä»index2ç´¢å¼•æ ‘æ‰¾åˆ°æ»¡è¶³ç´¢å¼•å€¼æ˜¯â€™zhangsâ€™çš„è®°å½•ï¼Œæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªæ˜¯ID1ï¼›</li><li>åˆ°ä¸»é”®ä¸ŠæŸ¥åˆ°ä¸»é”®å€¼æ˜¯ID1çš„è¡Œï¼Œåˆ¤æ–­å‡ºemailçš„å€¼ä¸æ˜¯â€™ <a href="mailto:zhangssxyz@xxx.com">zhangssxyz@xxx.com</a> â€™ï¼Œè¿™è¡Œè®°å½•ä¸¢å¼ƒï¼›</li><li>å–index2ä¸ŠåˆšåˆšæŸ¥åˆ°çš„ä½ç½®çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå‘ç°ä»ç„¶æ˜¯â€™zhangsâ€™ï¼Œå–å‡ºID2ï¼Œå†åˆ°IDç´¢å¼•ä¸Šå–æ•´è¡Œç„¶ ååˆ¤æ–­ï¼Œè¿™æ¬¡å€¼å¯¹äº†ï¼Œå°†è¿™è¡Œè®°å½•åŠ å…¥ç»“æœé›†ï¼›</li><li>é‡å¤ä¸Šä¸€æ­¥ï¼Œç›´åˆ°åœ¨idxe2ä¸Šå–åˆ°çš„å€¼ä¸æ˜¯â€™zhangsâ€™æ—¶ï¼Œå¾ªç¯ç»“æŸã€‚</li></ol><p>ä¹Ÿå°±æ˜¯è¯´**ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå®šä¹‰å¥½é•¿åº¦ï¼Œå°±å¯ä»¥åšåˆ°æ—¢èŠ‚çœç©ºé—´ï¼Œåˆä¸ç”¨é¢å¤–å¢åŠ å¤ªå¤šçš„æŸ¥è¯¢æˆæœ¬ã€‚**å‰é¢ å·²ç»è®²è¿‡åŒºåˆ†åº¦ï¼ŒåŒºåˆ†åº¦è¶Šé«˜è¶Šå¥½ã€‚å› ä¸ºåŒºåˆ†åº¦è¶Šé«˜ï¼Œæ„å‘³ç€é‡å¤çš„é”®å€¼è¶Šå°‘ã€‚</p><h3 id="9-2-å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“">9.2 å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“</h3><blockquote><p>ç»“è®ºï¼š ä½¿ç”¨å‰ç¼€ç´¢å¼•å°±ç”¨ä¸ä¸Šè¦†ç›–ç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„ä¼˜åŒ–äº†ï¼Œè¿™ä¹Ÿæ˜¯ä½ åœ¨é€‰æ‹©æ˜¯å¦ä½¿ç”¨å‰ç¼€ç´¢å¼•æ—¶éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªå› ç´ ã€‚</p></blockquote><hr><h2 id="10-ç´¢å¼•ä¸‹æ¨">10. ç´¢å¼•ä¸‹æ¨</h2><h3 id="10-1-ä½¿ç”¨å‰åå¯¹æ¯”">10.1 ä½¿ç”¨å‰åå¯¹æ¯”</h3><p>Index Condition Pushdown(ICP)æ˜¯MySQL 5.6ä¸­æ–°ç‰¹æ€§ï¼Œæ˜¯ä¸€ç§åœ¨å­˜å‚¨å¼•æ“å±‚ä½¿ç”¨ç´¢å¼•è¿‡æ»¤æ•°æ®çš„ä¸€ç§ä¼˜åŒ–æ–¹å¼ã€‚æŠŠæœ¬åº”è¯¥åœ¨ server å±‚è¿›è¡Œç­›é€‰çš„æ¡ä»¶ï¼Œä¸‹æ¨åˆ°å­˜å‚¨å¼•æ“å±‚æ¥è¿›è¡Œç­›é€‰åˆ¤æ–­ï¼Œè¿™æ ·èƒ½æœ‰æ•ˆå‡å°‘å›è¡¨IOæ¬¡æ•°ã€‚</p><ul><li><p>å¦‚æœæ²¡æœ‰ICPï¼Œå­˜å‚¨å¼•æ“ä¼šéå†ç´¢å¼•ä»¥å®šä½åŸºè¡¨ä¸­çš„è¡Œï¼Œå¹¶å°†å®ƒä»¬è¿”å›ç»™ MySQLæœåŠ¡å™¨ï¼Œç”± MysQLæœåŠ¡å™¨è¯„ä¼°<code>WHERE</code>åé¢çš„æ¡ä»¶æ˜¯å¦ä¿ç•™è¡Œã€‚</p></li><li><p>å¯ç”¨ICP åï¼Œå¦‚æœéƒ¨åˆ†<code>WHERE</code>æ¡ä»¶å¯ä»¥ä»…ä½¿ç”¨ç´¢å¼•ä¸­çš„åˆ—è¿›è¡Œç­›é€‰ï¼Œåˆ™ MySQLæœåŠ¡å™¨ä¼šæŠŠè¿™éƒ¨åˆ†<code>WHERE</code>æ¡ä»¶æ”¾åˆ°å­˜å‚¨å¼•æ“ç­›é€‰ã€‚ç„¶åï¼Œå­˜å‚¨å¼•æ“é€šè¿‡ä½¿ç”¨ç´¢å¼•æ¡ç›®æ¥ç­›é€‰æ•°æ®ï¼Œå¹¶ä¸”åªæœ‰åœ¨æ»¡è¶³è¿™ä¸€æ¡ä»¶æ—¶æ‰ä»è¡¨ä¸­è¯»å–è¡Œã€‚</p><ul><li>å¥½å¤„ï¼šICPå¯ä»¥å‡å°‘å­˜å‚¨å¼•æ“å¿…é¡»è®¿é—®åŸºè¡¨çš„æ¬¡æ•°å’ŒMySQLæœåŠ¡å™¨å¿…é¡»è®¿é—®å­˜å‚¨å¼•æ“çš„æ¬¡æ•°ã€‚</li><li>ä½†æ˜¯ï¼ŒICPçš„<code>åŠ é€Ÿæ•ˆæœ</code>å–å†³äºåœ¨å­˜å‚¨å¼•æ“å†…é€šè¿‡<code>ICPç­›é€‰</code>æ‰çš„æ•°æ®çš„æ¯”ä¾‹ã€‚</li></ul></li></ul><h3 id="10-2-ICPçš„å¼€å¯-å…³é—­">10.2 ICPçš„å¼€å¯/å…³é—­</h3><ul><li>é»˜è®¤æƒ…å†µä¸‹å¯åŠ¨ç´¢å¼•æ¡ä»¶ä¸‹æ¨ã€‚å¯ä»¥é€šè¿‡è®¾ç½®ç³»ç»Ÿå˜é‡<code>optimizer_switch</code>æ§åˆ¶ï¼š<code>index_condition_pushdown</code></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ‰“å¼€ç´¢å¼•ä¸‹æ¨</span><br><span class="line"><span class="keyword">SET</span> optimizer_switch <span class="operator">=</span> <span class="string">&#x27;index_condition_pushdown=on&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># å…³é—­ç´¢å¼•ä¸‹æ¨</span><br><span class="line"><span class="keyword">SET</span> optimizer_switch <span class="operator">=</span> <span class="string">&#x27;index_condition_pushdown=off&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>å½“ä½¿ç”¨ç´¢å¼•æ¡ä»¶ä¸‹æ¨æ˜¯ï¼Œ<code>EXPLAIN</code>è¯­å¥è¾“å‡ºç»“æœä¸­<code>Extra</code>åˆ—å†…å®¹æ˜¾ç¤ºä¸º<code>Using index condition</code>ã€‚</li></ul><hr><h3 id="10-3-ICPä½¿ç”¨æ¡ˆä¾‹">10.3 ICPä½¿ç”¨æ¡ˆä¾‹</h3><p>å‡è®¾ä¸€ä¸ªè¡¨åŒ…å«æœ‰å…³äººå‘˜åŠå…¶åœ°å€çš„ä¿¡æ¯ï¼Œå¹¶ä¸”è¯¥è¡¨çš„ç´¢å¼•å®šä¹‰ä¸º<code>INDEX (zipcode, lastname, firstname)</code>ã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªäººçš„<code>zipcode</code>ä½†ä¸ç¡®å®šå§“æ°ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æœç´¢ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> people</span><br><span class="line">  <span class="keyword">WHERE</span> zipcode<span class="operator">=</span><span class="string">&#x27;95054&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> lastname <span class="keyword">LIKE</span> <span class="string">&#x27;%etrunia%&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> address <span class="keyword">LIKE</span> <span class="string">&#x27;%Main Street%&#x27;</span>;</span><br></pre></td></tr></table></figure><p>MySQLå¯ä»¥ä½¿ç”¨ç´¢å¼•æ‰«æzipcode='95054â€™çš„ç”¨æˆ·ï¼Œç¬¬äºŒéƒ¨åˆ†å§“æ°ä¸èƒ½ä½¿ç”¨ç´¢å¼•ã€‚å› æ­¤å¦‚æœæ²¡æœ‰ç´¢å¼•æ¡ä»¶ä¸‹æ¨ï¼Œåˆ™æ­¤æŸ¥è¯¢å¿…é¡»ä¸ºæ‰€æœ‰é‚®æ”¿ç¼–ç ä¸ºâ€œ95054â€çš„äººæ£€ç´¢å®Œæ•´çš„è¡Œã€‚</p><p>ä½¿ç”¨ç´¢å¼•æ¡ä»¶ä¸‹æ¨ï¼ŒMySQLåœ¨è¯»å–æ•´ä¸ªè¡¨è¡Œä¹‹å‰ï¼Œåœ¨ç´¢å¼•ä¸­æ£€æŸ¥å§“æ°LIKEâ€œ%etrunia%â€éƒ¨åˆ†ã€‚è¿™æ ·å¯ä»¥é¿å…è¯»å–ä¸zipcodeæ¡ä»¶åŒ¹é…ä½†ä¸lastnameæ¡ä»¶ä¸åŒ¹é…çš„ç´¢å¼•å…ƒç»„å¯¹åº”çš„å®Œæ•´è¡Œã€‚</p><h3 id="10-4-IPçš„ä½¿ç”¨æ¡ä»¶">10.4 IPçš„ä½¿ç”¨æ¡ä»¶</h3><ol><li>å¦‚æœè¡¨çš„è®¿é—®ç±»å‹ä¸º range ã€ ref ã€ eq_ref æˆ–è€… ref_or_null å¯ä»¥ä½¿ç”¨ICPã€‚</li><li>ICPå¯ä»¥ä½¿ç”¨<code>InnDB</code>å’Œ<code>MyISAM</code>è¡¨ï¼ŒåŒ…æ‹¬åˆ†åŒºè¡¨<code>InnoDB</code>å’Œ<code>MyISAM</code>è¡¨</li><li>å¯¹äº<code>InnoDB</code>è¡¨ï¼ŒICPä»…ç”¨äº<code>äºŒçº§ç´¢å¼•</code>ã€‚ICPçš„ç›®æ ‡æ˜¯å‡å°‘å…¨è¡Œè¯»å–æ¬¡æ•°ï¼Œä»è€Œå‡å°‘I/Oæ“ä½œã€‚</li><li>å½“SQLä½¿ç”¨è¦†ç›–ç´¢å¼•æ—¶ï¼Œä¸æ”¯æŒICPä¼˜åŒ–æ–¹æ³•ã€‚å› ä¸ºè¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ICPä¸ä¼šå‡å°‘I/Oã€‚</li><li>ç›¸å…³å­æŸ¥è¯¢çš„æ¡ä»¶ä¸èƒ½ä½¿ç”¨ICP</li></ol><hr><h2 id="11-æ™®é€šç´¢å¼•-vs-å”¯ä¸€ç´¢å¼•">11. æ™®é€šç´¢å¼• vs å”¯ä¸€ç´¢å¼•</h2><p>ä»æ€§èƒ½çš„è§’åº¦è€ƒè™‘ï¼Œä½ é€‰æ‹©å”¯ä¸€ç´¢å¼•è¿˜æ˜¯æ™®é€šç´¢å¼•å‘¢ï¼Ÿé€‰æ‹©çš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸»é”®åˆ—ä¸ºIDçš„è¡¨ï¼Œè¡¨ä¸­æœ‰å­—æ®µkï¼Œå¹¶ä¸”åœ¨kä¸Šæœ‰ç´¢å¼•ï¼Œå‡è®¾å­—æ®µ k ä¸Šçš„å€¼éƒ½ä¸é‡å¤ã€‚</p><p>è¿™ä¸ªè¡¨çš„å»ºè¡¨è¯­å¥æ˜¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> test(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">k <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">16</span>),</span><br><span class="line">index (k)</span><br><span class="line">)engine<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure><p>è¡¨ä¸­R1~R5çš„(ID,k)å€¼åˆ†åˆ«ä¸º(100,1)ã€(200,2)ã€(300,3)ã€(500,5)å’Œ(600,6)ã€‚</p><h3 id="11-1-æŸ¥è¯¢è¿‡ç¨‹">11.1 æŸ¥è¯¢è¿‡ç¨‹</h3><p>å‡è®¾ï¼Œæ‰§è¡ŒæŸ¥è¯¢çš„è¯­å¥æ˜¯ select id from test where k=5ã€‚</p><ul><li>å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼ŒæŸ¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªè®°å½•(5,500)åï¼Œéœ€è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè®°å½•ï¼Œç›´åˆ°ç¢°åˆ°ç¬¬ä¸€ ä¸ªä¸æ»¡è¶³k=5æ¡ä»¶çš„è®°å½•ã€‚</li><li>å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œç”±äºç´¢å¼•å®šä¹‰äº†å”¯ä¸€æ€§ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åï¼Œå°±ä¼šåœæ­¢ç»§ç»­æ£€ ç´¢ã€‚</li></ul><p>é‚£ä¹ˆï¼Œè¿™ä¸ªä¸åŒå¸¦æ¥çš„æ€§èƒ½å·®è·ä¼šæœ‰å¤šå°‘å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œ å¾®ä¹å…¶å¾® ã€‚</p><h3 id="11-2-æ›´æ–°è¿‡ç¨‹">11.2 æ›´æ–°è¿‡ç¨‹</h3><p>ä¸ºäº†è¯´æ˜æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•å¯¹æ›´æ–°è¯­å¥æ€§èƒ½çš„å½±å“è¿™ä¸ªé—®é¢˜ï¼Œä»‹ç»ä¸€ä¸‹change bufferã€‚</p><p>å½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œ åœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼Œ<code>InooDBä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨change bufferä¸­</code>ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚åœ¨ä¸‹æ¬¡æŸ¥è¯¢éœ€è¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œç„¶åæ‰§è¡Œchange bufferä¸­ä¸è¿™ä¸ªé¡µæœ‰å…³çš„æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼å°±èƒ½ä¿è¯è¿™ä¸ªæ•°æ®é€»è¾‘çš„æ­£ç¡®æ€§ã€‚</p><p>å°†change bufferä¸­çš„æ“ä½œåº”ç”¨åˆ°åŸæ•°æ®é¡µï¼Œå¾—åˆ°æœ€æ–°ç»“æœçš„è¿‡ç¨‹ç§°ä¸º merge ã€‚é™¤äº†<code>è®¿é—®è¿™ä¸ªæ•°æ®é¡µ</code>ä¼šè§¦ å‘mergeå¤–ï¼Œç³»ç»Ÿæœ‰<code>åå°çº¿ç¨‹ä¼šå®šæœŸ</code>mergeã€‚åœ¨<code>æ•°æ®åº“æ­£å¸¸å…³é—­ï¼ˆshutdownï¼‰</code>çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šæ‰§è¡Œmerge æ“ä½œã€‚</p><p>å¦‚æœèƒ½å¤Ÿå°†æ›´æ–°æ“ä½œå…ˆè®°å½•åœ¨change bufferï¼Œ<code>å‡å°‘è¯»ç£ç›˜</code>ï¼Œè¯­å¥çš„æ‰§è¡Œé€Ÿåº¦ä¼šå¾—åˆ°æ˜æ˜¾çš„æå‡ã€‚è€Œä¸”ï¼Œ æ•°æ®è¯»å…¥å†…å­˜æ˜¯éœ€è¦å ç”¨ buffer pool çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼è¿˜èƒ½å¤Ÿ<code>é¿å…å ç”¨å†…å­˜</code>ï¼Œæé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚</p><p><code>å”¯ä¸€ç´¢å¼•çš„æ›´æ–°å°±ä¸èƒ½ä½¿ç”¨change buffer</code>ï¼Œå®é™…ä¸Šä¹Ÿåªæœ‰æ™®é€šç´¢å¼•å¯ä»¥ä½¿ç”¨ã€‚</p><p>å¦‚æœè¦åœ¨è¿™å¼ è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°è®°å½•(4,400)çš„è¯ï¼ŒInnoDBçš„å¤„ç†æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</p><h3 id="11-3-change-bufferçš„ä½¿ç”¨åœºæ™¯">11.3 change bufferçš„ä½¿ç”¨åœºæ™¯</h3><ol><li>æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿå…¶å®ï¼Œè¿™ä¸¤ç±»ç´¢å¼•åœ¨æŸ¥è¯¢èƒ½åŠ›ä¸Šæ˜¯æ²¡å·®åˆ«çš„ï¼Œä¸»è¦è€ƒè™‘çš„æ˜¯ å¯¹ æ›´æ–°æ€§èƒ½ çš„å½±å“ã€‚æ‰€ä»¥ï¼Œå»ºè®®ä½  å°½é‡é€‰æ‹©æ™®é€šç´¢å¼• ã€‚</li><li>åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šå‘ç°ï¼Œ æ™®é€šç´¢å¼• å’Œ change buffer çš„é…åˆä½¿ç”¨ï¼Œå¯¹äº æ•°æ®é‡å¤§ çš„è¡¨çš„æ›´æ–°ä¼˜åŒ– è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚</li><li>å¦‚æœæ‰€æœ‰çš„æ›´æ–°åé¢ï¼Œéƒ½é©¬ä¸Š ä¼´éšç€å¯¹è¿™ä¸ªè®°å½•çš„æŸ¥è¯¢ ï¼Œé‚£ä¹ˆä½ åº”è¯¥ å…³é—­change buffer ã€‚è€Œåœ¨ å…¶ä»–æƒ…å†µä¸‹ï¼Œchange bufferéƒ½èƒ½æå‡æ›´æ–°æ€§èƒ½ã€‚</li><li>ç”±äºå”¯ä¸€ç´¢å¼•ç”¨ä¸ä¸Šchange bufferçš„ä¼˜åŒ–æœºåˆ¶ï¼Œå› æ­¤å¦‚æœ ä¸šåŠ¡å¯ä»¥æ¥å— ï¼Œä»æ€§èƒ½è§’åº¦å‡ºå‘å»ºè®®ä¼˜ å…ˆè€ƒè™‘éå”¯ä¸€ç´¢å¼•ã€‚ä½†æ˜¯å¦‚æœ&quot;ä¸šåŠ¡å¯èƒ½æ— æ³•ç¡®ä¿&quot;çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ<ul><li>é¦–å…ˆï¼Œ ä¸šåŠ¡æ­£ç¡®æ€§ä¼˜å…ˆ ã€‚æˆ‘ä»¬çš„å‰ææ˜¯â€œä¸šåŠ¡ä»£ç å·²ç»ä¿è¯ä¸ä¼šå†™å…¥é‡å¤æ•°æ®â€çš„æƒ…å†µä¸‹ï¼Œè®¨è®ºæ€§èƒ½ é—®é¢˜ã€‚å¦‚æœä¸šåŠ¡ä¸èƒ½ä¿è¯ï¼Œæˆ–è€…ä¸šåŠ¡å°±æ˜¯è¦æ±‚æ•°æ®åº“æ¥åšçº¦æŸï¼Œé‚£ä¹ˆæ²¡å¾—é€‰ï¼Œå¿…é¡»åˆ›å»ºå”¯ä¸€ç´¢å¼•ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œæœ¬èŠ‚çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœç¢°ä¸Šäº†å¤§é‡æ’å…¥æ•°æ®æ…¢ã€å†…å­˜å‘½ä¸­ç‡ä½çš„æ—¶å€™ï¼Œç»™ä½ å¤šæä¾›ä¸€ ä¸ªæ’æŸ¥æ€è·¯ã€‚</li><li>ç„¶åï¼Œåœ¨ä¸€äº›â€œ å½’æ¡£åº“ â€çš„åœºæ™¯ï¼Œä½ æ˜¯å¯ä»¥è€ƒè™‘ä½¿ç”¨å”¯ä¸€ç´¢å¼•çš„ã€‚æ¯”å¦‚ï¼Œçº¿ä¸Šæ•°æ®åªéœ€è¦ä¿ç•™åŠå¹´ï¼Œ ç„¶åå†å²æ•°æ®ä¿å­˜åœ¨å½’æ¡£åº“ã€‚è¿™æ—¶å€™ï¼Œå½’æ¡£æ•°æ®å·²ç»æ˜¯ç¡®ä¿æ²¡æœ‰å”¯ä¸€é”®å†²çªäº†ã€‚è¦æé«˜å½’æ¡£æ•ˆç‡ï¼Œ å¯ä»¥è€ƒè™‘æŠŠè¡¨é‡Œé¢çš„å”¯ä¸€ç´¢å¼•æ”¹æˆæ™®é€šç´¢å¼•ã€‚</li></ul></li></ol><hr><h2 id="12-å…¶å®ƒæŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥">12. å…¶å®ƒæŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥</h2><h3 id="1-EXISTS-å’Œ-IN-çš„åŒºåˆ†">.1 EXISTS å’Œ IN çš„åŒºåˆ†</h3><p><strong>é—®é¢˜ï¼š</strong></p><p>ä¸å¤ªç†è§£å“ªç§æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ EXISTSï¼Œå“ªç§æƒ…å†µåº”è¯¥ç”¨ INã€‚é€‰æ‹©çš„æ ‡å‡†æ˜¯çœ‹èƒ½å¦ä½¿ç”¨è¡¨çš„ç´¢å¼•å—ï¼Ÿ</p><p><strong>å›ç­”ï¼š</strong></p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706141957185.png" alt="image-20220706141957185" style="zoom:80%;float:right"><h3 id="12-2-COUNT-ä¸COUNT-å…·ä½“å­—æ®µ-æ•ˆç‡">12.2 COUNT(*)ä¸COUNT(å…·ä½“å­—æ®µ)æ•ˆç‡</h3><p>é—®ï¼šåœ¨ MySQL ä¸­ç»Ÿè®¡æ•°æ®è¡¨çš„è¡Œæ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰ç§æ–¹å¼ï¼š SELECT COUNT(*) ã€ SELECT COUNT(1) å’Œ SELECT COUNT(å…·ä½“å­—æ®µ) ï¼Œä½¿ç”¨è¿™ä¸‰è€…ä¹‹é—´çš„æŸ¥è¯¢æ•ˆç‡æ˜¯æ€æ ·çš„ï¼Ÿ</p><p>ç­”ï¼š</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706142648452.png" alt="image-20220706142648452" style="zoom:80%;float:right"><h3 id="12-3-å…³äºSELECT">12.3 å…³äºSELECT(*)</h3><p>åœ¨è¡¨æŸ¥è¯¢ä¸­ï¼Œå»ºè®®æ˜ç¡®å­—æ®µï¼Œä¸è¦ä½¿ç”¨ * ä½œä¸ºæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨ï¼Œæ¨èä½¿ç”¨SELECT &lt;å­—æ®µåˆ—è¡¨&gt; æŸ¥è¯¢ã€‚åŸå› ï¼š</p><p>â‘  MySQL åœ¨è§£æçš„è¿‡ç¨‹ä¸­ï¼Œä¼šé€šè¿‡æŸ¥è¯¢æ•°æ®å­—å…¸ å°†&quot;*&quot;æŒ‰åºè½¬æ¢æˆæ‰€æœ‰åˆ—åï¼Œè¿™ä¼šå¤§å¤§çš„è€—è´¹èµ„æºå’Œæ—¶é—´ã€‚</p><p>â‘¡ æ— æ³•ä½¿ç”¨ è¦†ç›–ç´¢å¼•</p><h3 id="12-4-LIMIT-1-å¯¹ä¼˜åŒ–çš„å½±å“">12.4 LIMIT 1 å¯¹ä¼˜åŒ–çš„å½±å“</h3><p>é’ˆå¯¹çš„æ˜¯ä¼šæ‰«æå…¨è¡¨çš„ SQL è¯­å¥ï¼Œå¦‚æœä½ å¯ä»¥ç¡®å®šç»“æœé›†åªæœ‰ä¸€æ¡ï¼Œé‚£ä¹ˆåŠ ä¸Š LIMIT 1 çš„æ—¶å€™ï¼Œå½“æ‰¾åˆ°ä¸€æ¡ç»“æœçš„æ—¶å€™å°±ä¸ä¼šç»§ç»­æ‰«æäº†ï¼Œè¿™æ ·ä¼šåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚</p><p>å¦‚æœæ•°æ®è¡¨å·²ç»å¯¹å­—æ®µå»ºç«‹äº†å”¯ä¸€ç´¢å¼•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸ä¼šå…¨è¡¨æ‰«æçš„è¯ï¼Œå°±ä¸éœ€è¦åŠ ä¸Š LIMIT 1 äº†ã€‚</p><h3 id="12-5-å¤šä½¿ç”¨COMMIT">12.5 å¤šä½¿ç”¨COMMIT</h3><p>åªè¦æœ‰å¯èƒ½ï¼Œåœ¨ç¨‹åºä¸­å°½é‡å¤šä½¿ç”¨ COMMITï¼Œè¿™æ ·ç¨‹åºçš„æ€§èƒ½å¾—åˆ°æé«˜ï¼Œéœ€æ±‚ä¹Ÿä¼šå› ä¸º COMMIT æ‰€é‡Šæ”¾ çš„èµ„æºè€Œå‡å°‘ã€‚</p><p>COMMIT æ‰€é‡Šæ”¾çš„èµ„æºï¼š</p><ul><li>å›æ»šæ®µä¸Šç”¨äºæ¢å¤æ•°æ®çš„ä¿¡æ¯</li><li>è¢«ç¨‹åºè¯­å¥è·å¾—çš„é”</li><li>redo / undo log buffer ä¸­çš„ç©ºé—´</li><li>ç®¡ç†ä¸Šè¿° 3 ç§èµ„æºä¸­çš„å†…éƒ¨èŠ±è´¹</li></ul><hr><h2 id="13-æ·˜å®æ•°æ®åº“ä¸»é”®å¦‚ä½•è®¾è®¡ï¼Ÿ">13. æ·˜å®æ•°æ®åº“ä¸»é”®å¦‚ä½•è®¾è®¡ï¼Ÿ</h2><p>èŠä¸€ä¸ªå®é™…é—®é¢˜ï¼šæ·˜å®çš„æ•°æ®åº“ï¼Œä¸»é”®æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼Ÿ</p><p>æŸäº›é”™çš„ç¦»è°±çš„ç­”æ¡ˆè¿˜åœ¨ç½‘ä¸Šå¹´å¤ä¸€å¹´çš„æµä¼ ç€ï¼Œç”šè‡³è¿˜æˆä¸ºäº†æ‰€è°“çš„MySQLå†›è§„ã€‚å…¶ä¸­ï¼Œä¸€ä¸ªæœ€æ˜æ˜¾çš„é”™è¯¯å°±æ˜¯å…³äºMySQLçš„ä¸»é”®è®¾è®¡ã€‚</p><p>å¤§éƒ¨åˆ†äººçš„å›ç­”å¦‚æ­¤è‡ªä¿¡ï¼šç”¨8å­—èŠ‚çš„ BIGINT åšä¸»é”®ï¼Œè€Œä¸è¦ç”¨INTã€‚<code>é”™</code>ï¼</p><p>è¿™æ ·çš„å›ç­”ï¼Œåªç«™åœ¨äº†æ•°æ®åº“è¿™ä¸€å±‚ï¼Œè€Œæ²¡æœ‰<code>ä»ä¸šåŠ¡çš„è§’åº¦</code>æ€è€ƒä¸»é”®ã€‚ä¸»é”®å°±æ˜¯ä¸€ä¸ªè‡ªå¢IDå—ï¼Ÿç«™åœ¨ 2022å¹´çš„æ–°å¹´æ¡£å£ï¼Œç”¨è‡ªå¢åšä¸»é”®ï¼Œæ¶æ„è®¾è®¡ä¸Šå¯èƒ½<code>è¿åŠæ ¼éƒ½æ‹¿ä¸åˆ°</code>ã€‚</p><h3 id="13-1-è‡ªå¢IDçš„é—®é¢˜">13.1 è‡ªå¢IDçš„é—®é¢˜</h3><p>è‡ªå¢IDåšä¸»é”®ï¼Œç®€å•æ˜“æ‡‚ï¼Œå‡ ä¹æ‰€æœ‰æ•°æ®åº“éƒ½æ”¯æŒè‡ªå¢ç±»å‹ï¼Œåªæ˜¯å®ç°ä¸Šå„è‡ªæœ‰æ‰€ä¸åŒè€Œå·²ã€‚è‡ªå¢IDé™¤ äº†ç®€å•ï¼Œå…¶ä»–éƒ½æ˜¯ç¼ºç‚¹ï¼Œæ€»ä½“æ¥çœ‹å­˜åœ¨ä»¥ä¸‹å‡ æ–¹é¢çš„é—®é¢˜ï¼š</p><ol><li><p><strong>å¯é æ€§ä¸é«˜</strong></p><p>å­˜åœ¨è‡ªå¢IDå›æº¯çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜ç›´åˆ°æœ€æ–°ç‰ˆæœ¬çš„MySQL 8.0æ‰ä¿®å¤ã€‚</p></li><li><p>**å®‰å…¨æ€§ä¸é«˜ **</p><p>å¯¹å¤–æš´éœ²çš„æ¥å£å¯ä»¥éå¸¸å®¹æ˜“çŒœæµ‹å¯¹åº”çš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼š/User/1/è¿™æ ·çš„æ¥å£ï¼Œå¯ä»¥éå¸¸å®¹æ˜“çŒœæµ‹ç”¨æˆ·IDçš„ å€¼ä¸ºå¤šå°‘ï¼Œæ€»ç”¨æˆ·æ•°é‡æœ‰å¤šå°‘ï¼Œä¹Ÿå¯ä»¥éå¸¸å®¹æ˜“åœ°é€šè¿‡æ¥å£è¿›è¡Œæ•°æ®çš„çˆ¬å–ã€‚</p></li><li><p><strong>æ€§èƒ½å·®</strong></p><p>è‡ªå¢IDçš„æ€§èƒ½è¾ƒå·®ï¼Œéœ€è¦åœ¨æ•°æ®åº“æœåŠ¡å™¨ç«¯ç”Ÿæˆã€‚</p></li><li><p><strong>äº¤äº’å¤š</strong></p><p>ä¸šåŠ¡è¿˜éœ€è¦é¢å¤–æ‰§è¡Œä¸€æ¬¡ç±»ä¼¼ last_insert_id() çš„å‡½æ•°æ‰èƒ½çŸ¥é“åˆšæ‰æ’å…¥çš„è‡ªå¢å€¼ï¼Œè¿™éœ€è¦å¤šä¸€æ¬¡çš„ ç½‘ç»œäº¤äº’ã€‚åœ¨æµ·é‡å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œå¤š1æ¡SQLï¼Œå°±å¤šä¸€æ¬¡æ€§èƒ½ä¸Šçš„å¼€é”€ã€‚</p></li><li><p>**å±€éƒ¨å”¯ä¸€æ€§ **</p><p>æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œè‡ªå¢IDæ˜¯å±€éƒ¨å”¯ä¸€ï¼Œåªåœ¨å½“å‰æ•°æ®åº“å®ä¾‹ä¸­å”¯ä¸€ï¼Œè€Œä¸æ˜¯å…¨å±€å”¯ä¸€ï¼Œåœ¨ä»»æ„æœåŠ¡å™¨é—´éƒ½ æ˜¯å”¯ä¸€çš„ã€‚å¯¹äºç›®å‰åˆ†å¸ƒå¼ç³»ç»Ÿæ¥è¯´ï¼Œè¿™ç®€ç›´å°±æ˜¯å™©æ¢¦ã€‚</p></li></ol><h3 id="13-2-ä¸šåŠ¡å­—æ®µåšä¸»é”®">13.2 ä¸šåŠ¡å­—æ®µåšä¸»é”®</h3><p>ä¸ºäº†èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è¯†ä¸€ä¸ªä¼šå‘˜çš„ä¿¡æ¯ï¼Œéœ€è¦ä¸º ä¼šå‘˜ä¿¡æ¯è¡¨ è®¾ç½®ä¸€ä¸ªä¸»é”®ã€‚é‚£ä¹ˆï¼Œæ€ä¹ˆä¸ºè¿™ä¸ªè¡¨è®¾ç½®ä¸» é”®ï¼Œæ‰èƒ½è¾¾åˆ°æˆ‘ä»¬ç†æƒ³çš„ç›®æ ‡å‘¢ï¼Ÿ è¿™é‡Œæˆ‘ä»¬è€ƒè™‘ä¸šåŠ¡å­—æ®µåšä¸»é”®ã€‚</p><p>è¡¨æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706151506580.png" alt="image-20220706151506580"></p><p>åœ¨è¿™ä¸ªè¡¨é‡Œï¼Œå“ªä¸ªå­—æ®µæ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿ</p><ul><li><strong>é€‰æ‹©å¡å·ï¼ˆcardnoï¼‰</strong></li></ul><p>ä¼šå‘˜å¡å·ï¼ˆcardnoï¼‰çœ‹èµ·æ¥æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºä¼šå‘˜å¡å·ä¸èƒ½ä¸ºç©ºï¼Œè€Œä¸”æœ‰å”¯ä¸€æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è¯†ä¸€æ¡ä¼šå‘˜ è®°å½•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo.membermaster</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> (</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> cardno <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">PRIMARY</span> KEY, <span class="comment">-- ä¼šå‘˜å¡å·ä¸ºä¸»é”®</span></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> membername TEXT,</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> memberphone TEXT,</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> memberpid TEXT,</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> memberaddress TEXT,</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> sex TEXT,</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> birthday DATETIME</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.06</span> sec)</span><br></pre></td></tr></table></figure><p>ä¸åŒçš„ä¼šå‘˜å¡å·å¯¹åº”ä¸åŒçš„ä¼šå‘˜ï¼Œå­—æ®µâ€œcardnoâ€å”¯ä¸€åœ°æ ‡è¯†æŸä¸€ä¸ªä¼šå‘˜ã€‚å¦‚æœéƒ½æ˜¯è¿™æ ·ï¼Œä¼šå‘˜å¡å·ä¸ä¼šå‘˜ä¸€ä¸€å¯¹åº”ï¼Œç³»ç»Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ã€‚</p><p>ä½†å®é™…æƒ…å†µæ˜¯ï¼Œ ä¼šå‘˜å¡å·å¯èƒ½å­˜åœ¨é‡å¤ä½¿ç”¨çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œå¼ ä¸‰å› ä¸ºå·¥ä½œå˜åŠ¨æ¬ç¦»äº†åŸæ¥çš„åœ°å€ï¼Œä¸å† åˆ°å•†å®¶çš„é—¨åº—æ¶ˆè´¹äº† ï¼ˆé€€è¿˜äº†ä¼šå‘˜å¡ï¼‰ï¼Œäºæ˜¯å¼ ä¸‰å°±ä¸å†æ˜¯è¿™ä¸ªå•†å®¶é—¨åº—çš„ä¼šå‘˜äº†ã€‚ä½†æ˜¯ï¼Œå•†å®¶ä¸æƒ³è®© è¿™ä¸ªä¼š å‘˜å¡ç©ºç€ï¼Œå°±æŠŠå¡å·æ˜¯â€œ10000001â€çš„ä¼šå‘˜å¡å‘ç»™äº†ç‹äº”ã€‚</p><p>ä»ç³»ç»Ÿè®¾è®¡çš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªå˜åŒ–åªæ˜¯ä¿®æ”¹äº†ä¼šå‘˜ä¿¡æ¯è¡¨ä¸­çš„å¡å·æ˜¯â€œ10000001â€è¿™ä¸ªä¼šå‘˜ ä¿¡æ¯ï¼Œå¹¶ä¸ä¼šå½± å“åˆ°æ•°æ®ä¸€è‡´æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿®æ”¹ä¼šå‘˜å¡å·æ˜¯â€œ10000001â€çš„ä¼šå‘˜ä¿¡æ¯ï¼Œ ç³»ç»Ÿçš„å„ä¸ªæ¨¡å—ï¼Œéƒ½ä¼šè·å–åˆ°ä¿® æ”¹åçš„ä¼šå‘˜ä¿¡æ¯ï¼Œä¸ä¼šå‡ºç°â€œæœ‰çš„æ¨¡å—è·å–åˆ°ä¿®æ”¹ä¹‹å‰çš„ä¼šå‘˜ä¿¡æ¯ï¼Œæœ‰çš„æ¨¡å—è·å–åˆ°ä¿®æ”¹åçš„ä¼šå‘˜ä¿¡æ¯ï¼Œ è€Œå¯¼è‡´ç³»ç»Ÿå†…éƒ¨æ•°æ®ä¸ä¸€è‡´â€çš„æƒ…å†µã€‚å› æ­¤ï¼Œä» ä¿¡æ¯ç³»ç»Ÿå±‚é¢ ä¸Šçœ‹æ˜¯æ²¡é—®é¢˜çš„ã€‚</p><p>ä½†æ˜¯ä»ä½¿ç”¨ ç³»ç»Ÿçš„ä¸šåŠ¡å±‚é¢ æ¥çœ‹ï¼Œå°±æœ‰å¾ˆå¤§çš„é—®é¢˜ äº†ï¼Œä¼šå¯¹å•†å®¶é€ æˆå½±å“ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé”€å”®æµæ°´è¡¨ï¼ˆtransï¼‰ï¼Œè®°å½•äº†æ‰€æœ‰çš„é”€å”®æµæ°´æ˜ç»†ã€‚2020 å¹´ 12 æœˆ 01 æ—¥ï¼Œå¼ ä¸‰åœ¨é—¨åº— è´­ä¹°äº†ä¸€æœ¬ä¹¦ï¼Œæ¶ˆè´¹äº† 89 å…ƒã€‚é‚£ä¹ˆï¼Œç³»ç»Ÿä¸­å°±æœ‰äº†å¼ ä¸‰ä¹°ä¹¦çš„æµæ°´è®°å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706151715106.png" alt="image-20220706151715106"></p><p>æ¥ç€ï¼Œæˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸‹ 2020 å¹´ 12 æœˆ 01 æ—¥çš„ä¼šå‘˜é”€å”®è®°å½•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> b.membername,c.goodsname,a.quantity,a.salesvalue,a.transdate</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> demo.trans <span class="keyword">AS</span> a</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> demo.membermaster <span class="keyword">AS</span> b</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> demo.goodsmaster <span class="keyword">AS</span> c</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> (a.cardno <span class="operator">=</span> b.cardno <span class="keyword">AND</span> a.itemnumber<span class="operator">=</span>c.itemnumber);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> membername <span class="operator">|</span> goodsname <span class="operator">|</span> quantity <span class="operator">|</span> salesvalue <span class="operator">|</span> transdate <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>     å¼ ä¸‰   <span class="operator">|</span> ä¹¦         <span class="operator">|</span> <span class="number">1.000</span>    <span class="operator">|</span> <span class="number">89.00</span>      <span class="operator">|</span> <span class="number">2020</span><span class="number">-12</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>å¦‚æœä¼šå‘˜å¡â€œ10000001â€åˆå‘ç»™äº†ç‹äº”ï¼Œæˆ‘ä»¬ä¼šæ›´æ”¹ä¼šå‘˜ä¿¡æ¯è¡¨ã€‚å¯¼è‡´æŸ¥è¯¢æ—¶ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> b.membername,c.goodsname,a.quantity,a.salesvalue,a.transdate</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> demo.trans <span class="keyword">AS</span> a</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> demo.membermaster <span class="keyword">AS</span> b</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> demo.goodsmaster <span class="keyword">AS</span> c</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> (a.cardno <span class="operator">=</span> b.cardno <span class="keyword">AND</span> a.itemnumber<span class="operator">=</span>c.itemnumber);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> membername <span class="operator">|</span> goodsname <span class="operator">|</span> quantity <span class="operator">|</span> salesvalue <span class="operator">|</span> transdate <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> ç‹äº”        <span class="operator">|</span> ä¹¦        <span class="operator">|</span> <span class="number">1.000</span>    <span class="operator">|</span> <span class="number">89.00</span>      <span class="operator">|</span> <span class="number">2020</span><span class="number">-12</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-----------+----------+------------+---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡å¾—åˆ°çš„ç»“æœæ˜¯ï¼šç‹äº”åœ¨ 2020 å¹´ 12 æœˆ 01 æ—¥ï¼Œä¹°äº†ä¸€æœ¬ä¹¦ï¼Œæ¶ˆè´¹ 89 å…ƒã€‚æ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼ç»“è®ºï¼šåƒä¸‡ ä¸èƒ½æŠŠä¼šå‘˜å¡å·å½“åšä¸»é”®ã€‚</p><ul><li><strong>é€‰æ‹©ä¼šå‘˜ç”µè¯ æˆ– èº«ä»½è¯å·</strong></li></ul><p>ä¼šå‘˜ç”µè¯å¯ä»¥åšä¸»é”®å—ï¼Ÿä¸è¡Œçš„ã€‚åœ¨å®é™…æ“ä½œä¸­ï¼Œæ‰‹æœºå·ä¹Ÿå­˜åœ¨ è¢«è¿è¥å•†æ”¶å› ï¼Œé‡æ–°å‘ç»™åˆ«äººç”¨çš„æƒ…å†µã€‚</p><p>é‚£èº«ä»½è¯å·è¡Œä¸è¡Œå‘¢ï¼Ÿå¥½åƒå¯ä»¥ã€‚å› ä¸ºèº«ä»½è¯å†³ä¸ä¼šé‡å¤ï¼Œèº«ä»½è¯å·ä¸ä¸€ä¸ªäººå­˜åœ¨ä¸€ä¸€å¯¹ åº”çš„å…³ç³»ã€‚å¯ é—®é¢˜æ˜¯ï¼Œèº«ä»½è¯å·å±äº ä¸ªäººéšç§ ï¼Œé¡¾å®¢ä¸ä¸€å®šæ„¿æ„ç»™ä½ ã€‚è¦æ˜¯å¼ºåˆ¶è¦æ±‚ä¼šå‘˜å¿…é¡»ç™»è®°èº«ä»½è¯å·ï¼Œä¼šæŠŠå¾ˆ å¤šå®¢äººèµ¶è·‘çš„ã€‚å…¶å®ï¼Œå®¢æˆ·ç”µè¯ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨è®¾è®¡ä¼šå‘˜ä¿¡æ¯è¡¨çš„æ—¶å€™ï¼Œå…è®¸èº«ä»½è¯å·å’Œ ç”µè¯éƒ½ä¸ºç©ºçš„åŸå› ã€‚</p><p><strong>æ‰€ä»¥ï¼Œå»ºè®®å°½é‡ä¸è¦ç”¨è·Ÿä¸šåŠ¡æœ‰å…³çš„å­—æ®µåšä¸»é”®ã€‚æ¯•ç«Ÿï¼Œä½œä¸ºé¡¹ç›®è®¾è®¡çš„æŠ€æœ¯äººå‘˜ï¼Œæˆ‘ä»¬è°ä¹Ÿæ— æ³•é¢„æµ‹ åœ¨é¡¹ç›®çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå“ªä¸ªä¸šåŠ¡å­—æ®µä¼šå› ä¸ºé¡¹ç›®çš„ä¸šåŠ¡éœ€æ±‚è€Œæœ‰é‡å¤ï¼Œæˆ–è€…é‡ç”¨ä¹‹ç±»çš„æƒ…å†µå‡ºç°ã€‚</strong></p><blockquote><p>ç»éªŒï¼š åˆšå¼€å§‹ä½¿ç”¨ MySQL æ—¶ï¼Œå¾ˆå¤šäººéƒ½å¾ˆå®¹æ˜“çŠ¯çš„é”™è¯¯æ˜¯å–œæ¬¢ç”¨ä¸šåŠ¡å­—æ®µåšä¸»é”®ï¼Œæƒ³å½“ç„¶åœ°è®¤ä¸ºäº†è§£ä¸š åŠ¡éœ€æ±‚ï¼Œä½†å®é™…æƒ…å†µå¾€å¾€å‡ºä¹æ„æ–™ï¼Œè€Œæ›´æ”¹ä¸»é”®è®¾ç½®çš„æˆæœ¬éå¸¸é«˜ã€‚</p></blockquote><h3 id="13-3-æ·˜å®çš„ä¸»é”®è®¾è®¡">13.3 æ·˜å®çš„ä¸»é”®è®¾è®¡</h3><p>åœ¨æ·˜å®çš„ç”µå•†ä¸šåŠ¡ä¸­ï¼Œè®¢å•æœåŠ¡æ˜¯ä¸€ä¸ªæ ¸å¿ƒä¸šåŠ¡ã€‚è¯·é—®ï¼Œè®¢å•è¡¨çš„ä¸»é”®æ·˜å®æ˜¯å¦‚ä½•è®¾è®¡çš„å‘¢ï¼Ÿæ˜¯è‡ªå¢ID å—ï¼Ÿ</p><p>æ‰“å¼€æ·˜å®ï¼Œçœ‹ä¸€ä¸‹è®¢å•ä¿¡æ¯ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706161436920.png" alt="image-20220706161436920"></p><p>ä»ä¸Šå›¾å¯ä»¥å‘ç°ï¼Œè®¢å•å·ä¸æ˜¯è‡ªå¢IDï¼æˆ‘ä»¬è¯¦ç»†çœ‹ä¸‹ä¸Šè¿°4ä¸ªè®¢å•å·ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1550672064762308113</span></span><br><span class="line"><span class="number">1481195847180308113</span></span><br><span class="line"><span class="number">1431156171142308113</span></span><br><span class="line"><span class="number">1431146631521308113</span></span><br></pre></td></tr></table></figure><p>è®¢å•å·æ˜¯19ä½çš„é•¿åº¦ï¼Œä¸”è®¢å•çš„æœ€å5ä½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯08113ã€‚ä¸”è®¢å•å·çš„å‰é¢14ä½éƒ¨åˆ†æ˜¯å•è°ƒé€’å¢çš„ã€‚</p><p>å¤§èƒ†çŒœæµ‹ï¼Œæ·˜å®çš„è®¢å•IDè®¾è®¡åº”è¯¥æ˜¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¢å•ID <span class="operator">=</span> æ—¶é—´ <span class="operator">+</span> å»é‡å­—æ®µ <span class="operator">+</span> ç”¨æˆ·IDå<span class="number">6</span>ä½å°¾å·</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è®¾è®¡èƒ½åšåˆ°å…¨å±€å”¯ä¸€ï¼Œä¸”å¯¹åˆ†å¸ƒå¼ç³»ç»ŸæŸ¥è¯¢åŠå…¶å‹å¥½ã€‚</p><h3 id="13-4-æ¨èçš„ä¸»é”®è®¾è®¡">13.4 æ¨èçš„ä¸»é”®è®¾è®¡</h3><p><strong>éæ ¸å¿ƒä¸šåŠ¡</strong> ï¼šå¯¹åº”è¡¨çš„ä¸»é”®è‡ªå¢IDï¼Œå¦‚å‘Šè­¦ã€æ—¥å¿—ã€ç›‘æ§ç­‰ä¿¡æ¯ã€‚</p><p><strong>æ ¸å¿ƒä¸šåŠ¡</strong> ï¼š<code>ä¸»é”®è®¾è®¡è‡³å°‘åº”è¯¥æ˜¯å…¨å±€å”¯ä¸€ä¸”æ˜¯å•è°ƒé€’å¢</code>ã€‚å…¨å±€å”¯ä¸€ä¿è¯åœ¨å„ç³»ç»Ÿä¹‹é—´éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå•è°ƒ é€’å¢æ˜¯å¸Œæœ›æ’å…¥æ—¶ä¸å½±å“æ•°æ®åº“æ€§èƒ½ã€‚</p><p>è¿™é‡Œæ¨èæœ€ç®€å•çš„ä¸€ç§ä¸»é”®è®¾è®¡ï¼šUUIDã€‚</p><p><strong>UUIDçš„ç‰¹ç‚¹ï¼š</strong></p><p>å…¨å±€å”¯ä¸€ï¼Œå ç”¨36å­—èŠ‚ï¼Œæ•°æ®æ— åºï¼Œæ’å…¥æ€§èƒ½å·®ã€‚</p><p><strong>è®¤è¯†UUIDï¼š</strong></p><ul><li>ä¸ºä»€ä¹ˆUUIDæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆUUIDå ç”¨36ä¸ªå­—èŠ‚ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆUUIDæ˜¯æ— åºçš„ï¼Ÿ</li></ul><p>MySQLæ•°æ®åº“çš„UUIDç»„æˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID <span class="operator">=</span> æ—¶é—´<span class="operator">+</span>UUIDç‰ˆæœ¬ï¼ˆ<span class="number">16</span>å­—èŠ‚ï¼‰<span class="operator">-</span> æ—¶é’Ÿåºåˆ—ï¼ˆ<span class="number">4</span>å­—èŠ‚ï¼‰ <span class="operator">-</span> MACåœ°å€ï¼ˆ<span class="number">12</span>å­—èŠ‚ï¼‰</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»¥UUIDå€¼e0ea12d4-6473-11eb-943c-00155dbaa39dä¸¾ä¾‹ï¼š</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706162131362.png" alt="image-20220706162131362"></p><p><code>ä¸ºä»€ä¹ˆUUIDæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Ÿ</code></p><p>åœ¨UUIDä¸­æ—¶é—´éƒ¨åˆ†å ç”¨60ä½ï¼Œå­˜å‚¨çš„ç±»ä¼¼TIMESTAMPçš„æ—¶é—´æˆ³ï¼Œä½†è¡¨ç¤ºçš„æ˜¯ä»1582-10-15 00ï¼š00ï¼š00.00 åˆ°ç°åœ¨çš„100nsçš„è®¡æ•°ã€‚å¯ä»¥çœ‹åˆ°UUIDå­˜å‚¨çš„æ—¶é—´ç²¾åº¦æ¯”TIMESTAMPEæ›´é«˜ï¼Œæ—¶é—´ç»´åº¦å‘ç”Ÿé‡å¤çš„æ¦‚ç‡é™ ä½åˆ°1/100nsã€‚</p><p>æ—¶é’Ÿåºåˆ—æ˜¯ä¸ºäº†é¿å…æ—¶é’Ÿè¢«å›æ‹¨å¯¼è‡´äº§ç”Ÿæ—¶é—´é‡å¤çš„å¯èƒ½æ€§ã€‚MACåœ°å€ç”¨äºå…¨å±€å”¯ä¸€ã€‚</p><p><code>ä¸ºä»€ä¹ˆUUIDå ç”¨36ä¸ªå­—èŠ‚ï¼Ÿ</code></p><p>UUIDæ ¹æ®å­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨ï¼Œè®¾è®¡æ—¶è¿˜å¸¦æœ‰æ— ç”¨&quot;-&quot;å­—ç¬¦ä¸²ï¼Œå› æ­¤æ€»å…±éœ€è¦36ä¸ªå­—èŠ‚ã€‚</p><p><code>ä¸ºä»€ä¹ˆUUIDæ˜¯éšæœºæ— åºçš„å‘¢ï¼Ÿ</code></p><p>å› ä¸ºUUIDçš„è®¾è®¡ä¸­ï¼Œå°†æ—¶é—´ä½ä½æ”¾åœ¨æœ€å‰é¢ï¼Œè€Œè¿™éƒ¨åˆ†çš„æ•°æ®æ˜¯ä¸€ç›´åœ¨å˜åŒ–çš„ï¼Œå¹¶ä¸”æ˜¯æ— åºã€‚</p><p><strong>æ”¹é€ UUID</strong></p><p>è‹¥å°†æ—¶é—´é«˜ä½ä½äº’æ¢ï¼Œåˆ™æ—¶é—´å°±æ˜¯å•è°ƒé€’å¢çš„äº†ï¼Œä¹Ÿå°±å˜å¾—å•è°ƒé€’å¢äº†ã€‚MySQL 8.0å¯ä»¥æ›´æ¢æ—¶é—´ä½ä½å’Œæ—¶é—´é«˜ä½çš„å­˜å‚¨æ–¹å¼ï¼Œè¿™æ ·UUIDå°±æ˜¯æœ‰åºçš„UUIDäº†ã€‚</p><p>MySQL 8.0è¿˜è§£å†³äº†UUIDå­˜åœ¨çš„ç©ºé—´å ç”¨çš„é—®é¢˜ï¼Œé™¤å»äº†UUIDå­—ç¬¦ä¸²ä¸­æ— æ„ä¹‰çš„&quot;-&quot;å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å°†å­—ç¬¦ä¸²ç”¨äºŒè¿›åˆ¶ç±»å‹ä¿å­˜ï¼Œè¿™æ ·å­˜å‚¨ç©ºé—´é™ä½ä¸ºäº†16å­—èŠ‚ã€‚</p><p>å¯ä»¥é€šè¿‡MySQL8.0æä¾›çš„uuid_to_binå‡½æ•°å®ç°ä¸Šè¿°åŠŸèƒ½ï¼ŒåŒæ ·çš„ï¼ŒMySQLä¹Ÿæä¾›äº†bin_to_uuidå‡½æ•°è¿›è¡Œè½¬åŒ–ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="variable">@uuid</span> <span class="operator">=</span> UUID();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@uuid</span>,uuid_to_bin(<span class="variable">@uuid</span>),uuid_to_bin(<span class="variable">@uuid</span>,<span class="literal">TRUE</span>);</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706162657448.png" alt="image-20220706162657448"></p><p><strong>é€šè¿‡å‡½æ•°uuid_to_bin(@uuid,true)å°†UUIDè½¬åŒ–ä¸ºæœ‰åºUUIDäº†</strong>ã€‚å…¨å±€å”¯ä¸€ + å•è°ƒé€’å¢ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¸»é”®ï¼</p><p><strong>æœ‰åºUUIDæ€§èƒ½æµ‹è¯•</strong></p><p>16å­—èŠ‚çš„æœ‰åºUUIDï¼Œç›¸æ¯”ä¹‹å‰8å­—èŠ‚çš„è‡ªå¢IDï¼Œæ€§èƒ½å’Œå­˜å‚¨ç©ºé—´å¯¹æ¯”ç©¶ç«Ÿå¦‚ä½•å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ¥åšä¸€ä¸ªæµ‹è¯•ï¼Œæ’å…¥1äº¿æ¡æ•°æ®ï¼Œæ¯æ¡æ•°æ®å ç”¨500å­—èŠ‚ï¼Œå«æœ‰3ä¸ªäºŒçº§ç´¢å¼•ï¼Œæœ€ç»ˆçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/image-20220706162947613.png" alt="image-20220706162947613" style="zoom:67%"><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°æ’å…¥1äº¿æ¡æ•°æ®æœ‰åºUUIDæ˜¯æœ€å¿«çš„ï¼Œè€Œä¸”åœ¨å®é™…ä¸šåŠ¡ä½¿ç”¨ä¸­æœ‰åºUUIDåœ¨<code>ä¸šåŠ¡ç«¯å°±å¯ä»¥ç”Ÿæˆ</code>ã€‚è¿˜å¯ä»¥è¿›ä¸€æ­¥å‡å°‘SQLçš„äº¤äº’æ¬¡æ•°ã€‚</p><p>å¦å¤–ï¼Œè™½ç„¶æœ‰åºUUIDç›¸æ¯”è‡ªå¢IDå¤šäº†8ä¸ªå­—èŠ‚ï¼Œä½†å®é™…åªå¢å¤§äº†3Gçš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜å¯ä»¥æ¥å—ã€‚</p><blockquote><p>åœ¨å½“ä»Šçš„äº’è”ç½‘ç¯å¢ƒä¸­ï¼Œéå¸¸ä¸æ¨èè‡ªå¢IDä½œä¸ºä¸»é”®çš„æ•°æ®åº“è®¾è®¡ã€‚æ›´æ¨èç±»ä¼¼æœ‰åºUUIDçš„å…¨å±€ å”¯ä¸€çš„å®ç°ã€‚</p><p>å¦å¤–åœ¨çœŸå®çš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œä¸»é”®è¿˜å¯ä»¥åŠ å…¥ä¸šåŠ¡å’Œç³»ç»Ÿå±æ€§ï¼Œå¦‚ç”¨æˆ·çš„å°¾å·ï¼Œæœºæˆ¿çš„ä¿¡æ¯ç­‰ã€‚è¿™æ · çš„ä¸»é”®è®¾è®¡å°±æ›´ä¸ºè€ƒéªŒæ¶æ„å¸ˆçš„æ°´å¹³äº†ã€‚</p></blockquote><p><strong>å¦‚æœä¸æ˜¯MySQL8.0 è‚¿ä¹ˆåŠï¼Ÿ</strong></p><p>æ‰‹åŠ¨èµ‹å€¼å­—æ®µåšä¸»é”®ï¼</p><p>æ¯”å¦‚ï¼Œè®¾è®¡å„ä¸ªåˆ†åº—çš„ä¼šå‘˜è¡¨çš„ä¸»é”®ï¼Œå› ä¸ºå¦‚æœæ¯å°æœºå™¨å„è‡ªäº§ç”Ÿçš„æ•°æ®éœ€è¦åˆå¹¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°ä¸»é”®é‡å¤çš„é—®é¢˜ã€‚</p><p>å¯ä»¥åœ¨æ€»éƒ¨ MySQL æ•°æ®åº“ä¸­ï¼Œæœ‰ä¸€ä¸ªç®¡ç†ä¿¡æ¯è¡¨ï¼Œåœ¨è¿™ä¸ªè¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œä¸“é—¨ç”¨æ¥è®°å½•å½“å‰ä¼šå‘˜ç¼–å·çš„æœ€å¤§å€¼ã€‚</p><p>é—¨åº—åœ¨æ·»åŠ ä¼šå‘˜çš„æ—¶å€™ï¼Œå…ˆåˆ°æ€»éƒ¨ MySQL æ•°æ®åº“ä¸­è·å–è¿™ä¸ªæœ€å¤§å€¼ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸ŠåŠ 1ï¼Œç„¶åç”¨è¿™ä¸ªå€¼ä½œä¸ºæ–°ä¼šå‘˜çš„â€œidâ€ï¼ŒåŒæ—¶ï¼Œæ›´æ–°æ€»éƒ¨ MySQL æ•°æ®åº“ç®¡ç†ä¿¡æ¯è¡¨ä¸­çš„å½“å‰ä¼šå‘˜ç¼–å·çš„æœ€å¤§å€¼ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œå„ä¸ªé—¨åº—æ·»åŠ ä¼šå‘˜çš„æ—¶å€™ï¼Œéƒ½å¯¹åŒä¸€ä¸ªæ€»éƒ¨ MySQL æ•°æ®åº“ä¸­çš„æ•°æ®è¡¨å­—æ®µè¿›è¡Œæ“ä½œï¼Œå°±è§£å†³äº†å„é—¨åº—æ·»åŠ ä¼šå‘˜æ—¶ä¼šå‘˜ç¼–å·å†²çªçš„é—®é¢˜ã€‚</p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>ç´¢å¼•å¤±æ•ˆä¸æŸ¥è¯¢ä¼˜åŒ–</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://wuwawawa.github.io/posts/ec3a9a87.html">https://wuwawawa.github.io/posts/ec3a9a87.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>LuckyBoyğŸ¥</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-04-12</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-04-18</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>MySQL</a></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/c1110203.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_19.webp" onerror='onerror=null,src="/assets/r2.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">å¯»æ‰¾æŒ‡å®šä½ç½®-äºŒåˆ†æ³•</div></div></a></div><div class="next-post pull-right"><a href="/posts/95870c9e.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_20.webp" onerror='onerror=null,src="/assets/r2.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æ•°æ®åº“è®¾è®¡è§„èŒƒ</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/351b5179.html" title="ä¸»ä»å¤åˆ¶"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_27.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-19</div><div class="title">ä¸»ä»å¤åˆ¶</div></div></a></div><div><a href="/posts/1f4b46b6.html" title="MySQLå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_25.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-18</div><div class="title">MySQLå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</div></div></a></div><div><a href="/posts/2ba1a1a7.html" title="æ•°æ®åº“äº‹åŠ¡åŸºç¡€"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_22.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-19</div><div class="title">æ•°æ®åº“äº‹åŠ¡åŸºç¡€</div></div></a></div><div><a href="/posts/13910bb8.html" title="MySQLé€»è¾‘æ¶æ„ä¸å­˜å‚¨å¼•æ“"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_12.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-18</div><div class="title">MySQLé€»è¾‘æ¶æ„ä¸å­˜å‚¨å¼•æ“</div></div></a></div><div><a href="/posts/a42250fc.html" title="å…¶ä»–æ•°æ®åº“æ—¥å¿—"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_26.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-18</div><div class="title">å…¶ä»–æ•°æ®åº“æ—¥å¿—</div></div></a></div><div><a href="/posts/73985825.html" title="æ•°æ®å¤‡ä»½ä¸æ¢å¤"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_28.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-18</div><div class="title">æ•°æ®å¤‡ä»½ä¸æ¢å¤</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:700">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-text">1. æ•°æ®å‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E6%A1%88%E4%BE%8B"><span class="toc-text">2. ç´¢å¼•å¤±æ•ˆæ¡ˆä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-text">3. å…³è”æŸ¥è¯¢ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-2"><span class="toc-text">1 æ•°æ®å‡†å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E9%87%87%E7%94%A8%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">3.2 é‡‡ç”¨å·¦å¤–è¿æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E9%87%87%E7%94%A8%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-text">3.3 é‡‡ç”¨å†…è¿æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-join%E8%AF%AD%E5%8F%A5%E5%8E%9F%E7%90%86"><span class="toc-text">3.4 joinè¯­å¥åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%B0%8F%E7%BB%93"><span class="toc-text">3.5 å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-text">4. å­æŸ¥è¯¢ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%8E%92%E5%BA%8F%E4%BC%98%E5%8C%96"><span class="toc-text">5. æ’åºä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%8E%92%E5%BA%8F%E4%BC%98%E5%8C%96"><span class="toc-text">5.1 æ’åºä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%B5%8B%E8%AF%95"><span class="toc-text">5.2 æµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%A1%88%E4%BE%8B%E5%AE%9E%E6%88%98"><span class="toc-text">5.3 æ¡ˆä¾‹å®æˆ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-filesort%E7%AE%97%E6%B3%95%EF%BC%9A%E5%8F%8C%E8%B7%AF%E6%8E%92%E5%BA%8F%E5%92%8C%E5%8D%95%E8%B7%AF%E6%8E%92%E5%BA%8F"><span class="toc-text">5.4 filesortç®—æ³•ï¼šåŒè·¯æ’åºå’Œå•è·¯æ’åº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-GROUP-BY%E4%BC%98%E5%8C%96"><span class="toc-text">6. GROUP BYä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E4%BC%98%E5%8C%96%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">7. ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%BC%98%E5%85%88%E8%80%83%E8%99%91%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-text">8. ä¼˜å…ˆè€ƒè™‘è¦†ç›–ç´¢å¼•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BB%80%E4%B9%88%E6%98%AF%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95%EF%BC%9F"><span class="toc-text">8.1 ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95%E7%9A%84%E5%88%A9%E5%BC%8A"><span class="toc-text">8.2 è¦†ç›–ç´¢å¼•çš„åˆ©å¼Š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%A6%82%E4%BD%95%E7%BB%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95"><span class="toc-text">9. å¦‚ä½•ç»™å­—ç¬¦ä¸²æ·»åŠ ç´¢å¼•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95"><span class="toc-text">9.1 å‰ç¼€ç´¢å¼•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95%E5%AF%B9%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-text">9.2 å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8"><span class="toc-text">10. ç´¢å¼•ä¸‹æ¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E4%BD%BF%E7%94%A8%E5%89%8D%E5%90%8E%E5%AF%B9%E6%AF%94"><span class="toc-text">10.1 ä½¿ç”¨å‰åå¯¹æ¯”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-ICP%E7%9A%84%E5%BC%80%E5%90%AF-%E5%85%B3%E9%97%AD"><span class="toc-text">10.2 ICPçš„å¼€å¯&#x2F;å…³é—­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-ICP%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">10.3 ICPä½¿ç”¨æ¡ˆä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-IP%E7%9A%84%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="toc-text">10.4 IPçš„ä½¿ç”¨æ¡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95-vs-%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95"><span class="toc-text">11. æ™®é€šç´¢å¼• vs å”¯ä¸€ç´¢å¼•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E6%9F%A5%E8%AF%A2%E8%BF%87%E7%A8%8B"><span class="toc-text">11.1 æŸ¥è¯¢è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B"><span class="toc-text">11.2 æ›´æ–°è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-change-buffer%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">11.3 change bufferçš„ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%85%B6%E5%AE%83%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-text">12. å…¶å®ƒæŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-EXISTS-%E5%92%8C-IN-%E7%9A%84%E5%8C%BA%E5%88%86"><span class="toc-text">.1 EXISTS å’Œ IN çš„åŒºåˆ†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-COUNT-%E4%B8%8ECOUNT-%E5%85%B7%E4%BD%93%E5%AD%97%E6%AE%B5-%E6%95%88%E7%8E%87"><span class="toc-text">12.2 COUNT(*)ä¸COUNT(å…·ä½“å­—æ®µ)æ•ˆç‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E5%85%B3%E4%BA%8ESELECT"><span class="toc-text">12.3 å…³äºSELECT(*)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-LIMIT-1-%E5%AF%B9%E4%BC%98%E5%8C%96%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-text">12.4 LIMIT 1 å¯¹ä¼˜åŒ–çš„å½±å“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-5-%E5%A4%9A%E4%BD%BF%E7%94%A8COMMIT"><span class="toc-text">12.5 å¤šä½¿ç”¨COMMIT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E6%B7%98%E5%AE%9D%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E9%94%AE%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%EF%BC%9F"><span class="toc-text">13. æ·˜å®æ•°æ®åº“ä¸»é”®å¦‚ä½•è®¾è®¡ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-%E8%87%AA%E5%A2%9EID%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">13.1 è‡ªå¢IDçš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-%E4%B8%9A%E5%8A%A1%E5%AD%97%E6%AE%B5%E5%81%9A%E4%B8%BB%E9%94%AE"><span class="toc-text">13.2 ä¸šåŠ¡å­—æ®µåšä¸»é”®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-%E6%B7%98%E5%AE%9D%E7%9A%84%E4%B8%BB%E9%94%AE%E8%AE%BE%E8%AE%A1"><span class="toc-text">13.3 æ·˜å®çš„ä¸»é”®è®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-%E6%8E%A8%E8%8D%90%E7%9A%84%E4%B8%BB%E9%94%AE%E8%AE%BE%E8%AE%A1"><span class="toc-text">13.4 æ¨èçš„ä¸»é”®è®¾è®¡</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color:transparent"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">é­”æ”¹æŒ‡å—</a><a href="/box/nav/">ç½‘å€å¯¼èˆª</a></li><li><a href="/social/link/">æˆ‘çš„æœ‹å‹</a><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="/personal/about/">å…³äºä½œè€…</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/Gallery/">æˆ‘çš„ç”»å»Š</a><a href="/personal/bb/">æˆ‘çš„å” å¨</a></li><li><a href="/site/time/">å»ºè®¾è¿›ç¨‹</a><a href="/site/census/">ç½‘ç«™ç»Ÿè®¡</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/" title="FomalhautğŸ¥"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/60e5d4e39da7c077.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2023</b></span><span><b>&nbsp;&nbsp;By LuckyBoyğŸ¥</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.3.0"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="æœ¬ç«™æ•°æ®åˆ†æå¾—ç›Šäº51laæŠ€æœ¯æ”¯æŒ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="æœ¬ç«™å·²åŠ å…¥èŒICPè±ªåå¥—é¤ï¼ŒèŒICPå¤‡20226665å·"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/èŒICPå¤‡-20226665-fe1384.svg" alt=""></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="æœ¬ç½‘ç«™ç»Service Workeråˆ†æµè‡³ç¼¤çº·äº‘å¯¹è±¡å­˜å‚¨"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-ç¼¤çº·äº‘-9c62da.svg" alt=""></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨ç½‘ç›¾æ˜Ÿçƒæä¾›CDNåŠ é€Ÿä¸é˜²æŠ¤"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-ç½‘ç›¾æ˜Ÿçƒ-fff2cc.svg" alt=""></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç½‘ç«™æºç ç”±Githubæä¾›å­˜å‚¨ä»“åº“"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>ç¾åŒ–è®¾ç½®</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading()),setTimeout((function(){preloader.endLoading()}),5e3),document.getElementById("loading-box").addEventListener("click",(()=>{preloader.endLoading()}))</script><div class="js-pjax"><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))},o=()=>{"object"!=typeof twikoo?getScript("https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js").then(t):setTimeout(t,0)};btf.loadComment(document.getElementById("twikoo-wrap"),o)})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"===location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/ç®—æ³•/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¡ ç®—æ³•å­¦ä¹ ç¬”è®° (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/Java/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸŸ Javaç¬”è®° (25)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/æ•°æ®åº“/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¨ æ•°æ®åº“ç¬”è®° (19)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/è®¾è®¡æ¨¡å¼/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¥ è®¾è®¡æ¨¡å¼ç¬”è®° (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/Spring/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸŒ¸ Springç¬”è®° (13)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://wuwawawa.github.io/categories/ä¸­é—´ä»¶/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ• ä¸­é—´ä»¶ç¬”è®° (8)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://wuwawawa.github.io/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';console.log("å·²æŒ‚è½½magnet"),parent.insertAdjacentHTML("afterbegin",child)}</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(33.333333333333336% - 5px);background:#e9e9e9;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><script data-pjax>function butterfly_swiper_injector_config(){var a=document.getElementById("recent-posts");console.log("å·²æŒ‚è½½butterfly_swiper"),a.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/397c083a.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_43.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/397c083a.html&quot;);" href="javascript:void(0);" alt="">Java8æ–°ç‰¹æ€§</a><div class="blog-slider__text">Lambdaè¡¨è¾¾å¼ã€å‡½æ•°å¼æ¥å£ã€Stream API</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/397c083a.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/3f9c0b8e.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_4.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/3f9c0b8e.html&quot;);" href="javascript:void(0);" alt="">3.å…±äº«æ¨¡å‹ä¹‹ç®¡ç¨‹</a><div class="blog-slider__text">å…±äº«é—®é¢˜ã€synchronizedã€çº¿ç¨‹å®‰å…¨åˆ†æã€Monitorã€wait/notifyã€çº¿ç¨‹çŠ¶æ€è½¬æ¢ã€æ´»è·ƒæ€§ã€Lock</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/3f9c0b8e.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/9c5b9bb4.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_8.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-03</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/9c5b9bb4.html&quot;);" href="javascript:void(0);" alt="">7.1å…±äº«æ¨¡å‹ä¹‹å·¥å…·</a><div class="blog-slider__text">çº¿ç¨‹æ± ã€AQSã€ReentrantLockã€Semaphoreç­‰é”çš„åŸç†</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/9c5b9bb4.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/f9285b5c.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/cover_9.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/f9285b5c.html&quot;);" href="javascript:void(0);" alt="">å…³äºå­—ç¬¦ä¸²å­—é¢é‡è¿›å…¥åˆ°å­—ç¬¦ä¸²å¸¸é‡æ± çš„æ—¶æœº</a><div class="blog-slider__text">å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä¸€äº›é—®é¢˜</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/f9285b5c.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lmy-picbed.oss-cn-hangzhou.aliyuncs.com/blog/default_cover_60.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","2s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","2s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>function gitcalendar_injector_config(){document.getElementById("gitZone").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>'),console.log("å·²æŒ‚è½½gitcalendar")}document.getElementById("gitZone")&&"/site/census/"===location.pathname&&(gitcalendar_injector_config(),GitCalendarInit("/api?null",["#d9e0df","#c6e0dc","#a8dcd4","#9adcd2","#89ded1","#77e0d0","#5fdecb","#47dcc6","#39dcc3","#1fdabe","#00dab9"],"null"))</script></body></html>